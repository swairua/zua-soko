<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#22c55e" />
    <title>Zuasoko - Agricultural Platform</title>

    <!-- Production optimizations -->
    <script>
      // Completely disable Vite client in production
      window.__vite_is_modern_browser = true;

      // Block HMR WebSocket connections
      if (typeof WebSocket !== 'undefined') {
        const OriginalWebSocket = WebSocket;
        WebSocket = function(url, protocols) {
          if (typeof url === 'string' && (url.includes('vite') || url.includes('hmr') || url.includes('@vite'))) {
            console.log('Blocked HMR WebSocket connection:', url);
            return {
              close: () => {},
              send: () => {},
              addEventListener: () => {},
              removeEventListener: () => {},
              readyState: 3,
              CLOSED: 3,
              CONNECTING: 0,
              OPEN: 1,
              CLOSING: 2
            };
          }
          return new OriginalWebSocket(url, protocols);
        };
      }

      // Block HMR fetch requests
      if (typeof fetch !== 'undefined') {
        const originalFetch = fetch;
        fetch = function(url, options) {
          if (typeof url === 'string' && (url.includes('@vite') || url.includes('vite/client') || url.includes('hmr'))) {
            console.log('Blocked HMR fetch request:', url);
            return Promise.resolve(new Response('{}', { status: 200, headers: { 'Content-Type': 'application/json' } }));
          }
          return originalFetch.call(this, url, options);
        };
      }

      // Disable console HMR messages
      const originalLog = console.log;
      console.log = function(...args) {
        if (args.length > 0 && typeof args[0] === 'string' && args[0].includes('vite')) {
          return;
        }
        originalLog.apply(console, args);
      };
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
