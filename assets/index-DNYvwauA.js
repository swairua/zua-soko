import{a as sn,b as nn,c as e,r as C,g as ln}from"./vendor-9bZoipD1.js";import{u as _e,L as H,a as Zr,b as on,B as cn,R as mn,c as Z,N as Ue}from"./router-BAAhKjlc.js";import{S as $e,L as dr,X as xe,M as Xr,H as es,a as ts,C as dn,U as Re,b as dt,B as Ya,T as re,A as Ke,W as ur,D as gr,c as as,d as La,e as Ht,f as Pt,g as ae,h as fr,i as oe,j as Ve,k as Ie,l as rs,m as lt,K as un,n as gn,o as fn,P as pn,p as yn,q as Qe,r as Pe,Q as hn,s as Fe,t as ca,F as bn,E as Be,u as Za,V as P,v as St,w as En,x as He,y as ia,z as Wt,G as Qt,I as Ee,J as Ye,N as B,O as Aa,R as At,Y as Ae,Z as Xe,_ as xn,$ as Xa,a0 as ot,a1 as ss,a2 as vn,a3 as ns,a4 as Nn,a5 as Jt,a6 as Ma,a7 as wn,a8 as Sn,a9 as et,aa as kn,ab as pr,ac as Cn,ad as Pn,ae as yr,af as Yt,ag as ja,ah as Ua,ai as An,aj as Dn,ak as Rn,al as Fn}from"./ui-C8XMBNd3.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var qa={},hr=sn;qa.createRoot=hr.createRoot,qa.hydrateRoot=hr.hydrateRoot;function $a(t,a){return $a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},$a(t,a)}function ma(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,$a(t,a)}var da=function(){function t(){this.listeners=[]}var a=t.prototype;return a.subscribe=function(s){var n=this,l=s||function(){};return this.listeners.push(l),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(o){return o!==l}),n.onUnsubscribe()}},a.hasListeners=function(){return this.listeners.length>0},a.onSubscribe=function(){},a.onUnsubscribe=function(){},t}();function J(){return J=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},J.apply(null,arguments)}var ls=typeof window>"u";function he(){}function On(t,a){return typeof t=="function"?t(a):t}function Tn(t){return typeof t=="number"&&t>=0&&t!==1/0}function Zt(t){return Array.isArray(t)?t:[t]}function In(t,a){return Math.max(t+(a||0)-Date.now(),0)}function Da(t,a,r){return ua(t)?typeof a=="function"?J({},r,{queryKey:t,queryFn:a}):J({},a,{queryKey:t}):t}function Je(t,a,r){return ua(t)?[J({},a,{queryKey:t}),r]:[t||{},a]}function _n(t,a){if(t===!0&&a===!0||t==null&&a==null)return"all";if(t===!1&&a===!1)return"none";var r=t??!a;return r?"active":"inactive"}function br(t,a){var r=t.active,s=t.exact,n=t.fetching,l=t.inactive,o=t.predicate,c=t.queryKey,y=t.stale;if(ua(c)){if(s){if(a.queryHash!==er(c,a.options))return!1}else if(!Xt(a.queryKey,c))return!1}var m=_n(r,l);if(m==="none")return!1;if(m!=="all"){var u=a.isActive();if(m==="active"&&!u||m==="inactive"&&u)return!1}return!(typeof y=="boolean"&&a.isStale()!==y||typeof n=="boolean"&&a.isFetching()!==n||o&&!o(a))}function Er(t,a){var r=t.exact,s=t.fetching,n=t.predicate,l=t.mutationKey;if(ua(l)){if(!a.options.mutationKey)return!1;if(r){if(at(a.options.mutationKey)!==at(l))return!1}else if(!Xt(a.options.mutationKey,l))return!1}return!(typeof s=="boolean"&&a.state.status==="loading"!==s||n&&!n(a))}function er(t,a){var r=a?.queryKeyHashFn||at;return r(t)}function at(t){var a=Zt(t);return Ln(a)}function Ln(t){return JSON.stringify(t,function(a,r){return Va(r)?Object.keys(r).sort().reduce(function(s,n){return s[n]=r[n],s},{}):r})}function Xt(t,a){return os(Zt(t),Zt(a))}function os(t,a){return t===a?!0:typeof t!=typeof a?!1:t&&a&&typeof t=="object"&&typeof a=="object"?!Object.keys(a).some(function(r){return!os(t[r],a[r])}):!1}function cs(t,a){if(t===a)return t;var r=Array.isArray(t)&&Array.isArray(a);if(r||Va(t)&&Va(a)){for(var s=r?t.length:Object.keys(t).length,n=r?a:Object.keys(a),l=n.length,o=r?[]:{},c=0,y=0;y<l;y++){var m=r?y:n[y];o[m]=cs(t[m],a[m]),o[m]===t[m]&&c++}return s===l&&c===s?t:o}return a}function Va(t){if(!xr(t))return!1;var a=t.constructor;if(typeof a>"u")return!0;var r=a.prototype;return!(!xr(r)||!r.hasOwnProperty("isPrototypeOf"))}function xr(t){return Object.prototype.toString.call(t)==="[object Object]"}function ua(t){return typeof t=="string"||Array.isArray(t)}function Mn(t){return new Promise(function(a){setTimeout(a,t)})}function vr(t){Promise.resolve().then(t).catch(function(a){return setTimeout(function(){throw a})})}function is(){if(typeof AbortController=="function")return new AbortController}var jn=function(t){ma(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!ls&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setFocused(c):o.onFocus()})},r.setFocused=function(n){this.focused=n,n&&this.onFocus()},r.onFocus=function(){this.listeners.forEach(function(n){n()})},r.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},a}(da),$t=new jn,Un=function(t){ma(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!ls&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setOnline(c):o.onOnline()})},r.setOnline=function(n){this.online=n,n&&this.onOnline()},r.onOnline=function(){this.listeners.forEach(function(n){n()})},r.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},a}(da),Vt=new Un;function qn(t){return Math.min(1e3*Math.pow(2,t),3e4)}function ea(t){return typeof t?.cancel=="function"}var ms=function(a){this.revert=a?.revert,this.silent=a?.silent};function Ra(t){return t instanceof ms}var ds=function(a){var r=this,s=!1,n,l,o,c;this.abort=a.abort,this.cancel=function(p){return n?.(p)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return l?.()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(p,b){o=p,c=b});var y=function(b){r.isResolved||(r.isResolved=!0,a.onSuccess==null||a.onSuccess(b),l?.(),o(b))},m=function(b){r.isResolved||(r.isResolved=!0,a.onError==null||a.onError(b),l?.(),c(b))},u=function(){return new Promise(function(b){l=b,r.isPaused=!0,a.onPause==null||a.onPause()}).then(function(){l=void 0,r.isPaused=!1,a.onContinue==null||a.onContinue()})},d=function p(){if(!r.isResolved){var b;try{b=a.fn()}catch(w){b=Promise.reject(w)}n=function(h){if(!r.isResolved&&(m(new ms(h)),r.abort==null||r.abort(),ea(b)))try{b.cancel()}catch{}},r.isTransportCancelable=ea(b),Promise.resolve(b).then(y).catch(function(w){var h,E;if(!r.isResolved){var x=(h=a.retry)!=null?h:3,v=(E=a.retryDelay)!=null?E:qn,D=typeof v=="function"?v(r.failureCount,w):v,S=x===!0||typeof x=="number"&&r.failureCount<x||typeof x=="function"&&x(r.failureCount,w);if(s||!S){m(w);return}r.failureCount++,a.onFail==null||a.onFail(r.failureCount,w),Mn(D).then(function(){if(!$t.isFocused()||!Vt.isOnline())return u()}).then(function(){s?m(w):p()})}})}};d()},$n=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(r){r()},this.batchNotifyFn=function(r){r()}}var a=t.prototype;return a.batch=function(s){var n;this.transactions++;try{n=s()}finally{this.transactions--,this.transactions||this.flush()}return n},a.schedule=function(s){var n=this;this.transactions?this.queue.push(s):vr(function(){n.notifyFn(s)})},a.batchCalls=function(s){var n=this;return function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];n.schedule(function(){s.apply(void 0,o)})}},a.flush=function(){var s=this,n=this.queue;this.queue=[],n.length&&vr(function(){s.batchNotifyFn(function(){n.forEach(function(l){s.notifyFn(l)})})})},a.setNotifyFunction=function(s){this.notifyFn=s},a.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},t}(),ge=new $n,us=console;function gs(){return us}function Vn(t){us=t}var Kn=function(){function t(r){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.cache=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.initialState=r.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=r.meta,this.scheduleGc()}var a=t.prototype;return a.setOptions=function(s){var n;this.options=J({},this.defaultOptions,s),this.meta=s?.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},a.setDefaultOptions=function(s){this.defaultOptions=s},a.scheduleGc=function(){var s=this;this.clearGcTimeout(),Tn(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},a.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},a.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},a.setData=function(s,n){var l,o,c=this.state.data,y=On(s,c);return(l=(o=this.options).isDataEqual)!=null&&l.call(o,c,y)?y=c:this.options.structuralSharing!==!1&&(y=cs(c,y)),this.dispatch({data:y,type:"success",dataUpdatedAt:n?.updatedAt}),y},a.setState=function(s,n){this.dispatch({type:"setState",state:s,setStateOptions:n})},a.cancel=function(s){var n,l=this.promise;return(n=this.retryer)==null||n.cancel(s),l?l.then(he).catch(he):Promise.resolve()},a.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},a.reset=function(){this.destroy(),this.setState(this.initialState)},a.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},a.isFetching=function(){return this.state.isFetching},a.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},a.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!In(this.state.dataUpdatedAt,s)},a.onFocus=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnWindowFocus()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.onOnline=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnReconnect()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},a.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(n){return n!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},a.getObserversCount=function(){return this.observers.length},a.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},a.fetch=function(s,n){var l=this,o,c,y;if(this.state.isFetching){if(this.state.dataUpdatedAt&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var m;return(m=this.retryer)==null||m.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var u=this.observers.find(function(v){return v.options.queryFn});u&&this.setOptions(u.options)}var d=Zt(this.queryKey),p=is(),b={queryKey:d,pageParam:void 0,meta:this.meta};Object.defineProperty(b,"signal",{enumerable:!0,get:function(){if(p)return l.abortSignalConsumed=!0,p.signal}});var w=function(){return l.options.queryFn?(l.abortSignalConsumed=!1,l.options.queryFn(b)):Promise.reject("Missing queryFn")},h={fetchOptions:n,options:this.options,queryKey:d,state:this.state,fetchFn:w,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var E;(E=this.options.behavior)==null||E.onFetch(h)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((c=h.fetchOptions)==null?void 0:c.meta)){var x;this.dispatch({type:"fetch",meta:(x=h.fetchOptions)==null?void 0:x.meta})}return this.retryer=new ds({fn:h.fetchFn,abort:p==null||(y=p.abort)==null?void 0:y.bind(p),onSuccess:function(D){l.setData(D),l.cache.config.onSuccess==null||l.cache.config.onSuccess(D,l),l.cacheTime===0&&l.optionalRemove()},onError:function(D){Ra(D)&&D.silent||l.dispatch({type:"error",error:D}),Ra(D)||(l.cache.config.onError==null||l.cache.config.onError(D,l),gs().error(D)),l.cacheTime===0&&l.optionalRemove()},onFail:function(){l.dispatch({type:"failed"})},onPause:function(){l.dispatch({type:"pause"})},onContinue:function(){l.dispatch({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay}),this.promise=this.retryer.promise,this.promise},a.dispatch=function(s){var n=this;this.state=this.reducer(this.state,s),ge.batch(function(){n.observers.forEach(function(l){l.onQueryUpdate(s)}),n.cache.notify({query:n,type:"queryUpdated",action:s})})},a.getDefaultState=function(s){var n=typeof s.initialData=="function"?s.initialData():s.initialData,l=typeof s.initialData<"u",o=l?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,c=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:c?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:c?"success":"idle"}},a.reducer=function(s,n){var l,o;switch(n.type){case"failed":return J({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return J({},s,{isPaused:!0});case"continue":return J({},s,{isPaused:!1});case"fetch":return J({},s,{fetchFailureCount:0,fetchMeta:(l=n.meta)!=null?l:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return J({},s,{data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=n.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var c=n.error;return Ra(c)&&c.revert&&this.revertState?J({},this.revertState):J({},s,{error:c,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return J({},s,{isInvalidated:!0});case"setState":return J({},s,n.state);default:return s}},t}(),Bn=function(t){ma(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.queries=[],n.queriesMap={},n}var r=a.prototype;return r.build=function(n,l,o){var c,y=l.queryKey,m=(c=l.queryHash)!=null?c:er(y,l),u=this.get(m);return u||(u=new Kn({cache:this,queryKey:y,queryHash:m,options:n.defaultQueryOptions(l),state:o,defaultOptions:n.getQueryDefaults(y),meta:l.meta}),this.add(u)),u},r.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},r.remove=function(n){var l=this.queriesMap[n.queryHash];l&&(n.destroy(),this.queries=this.queries.filter(function(o){return o!==n}),l===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},r.clear=function(){var n=this;ge.batch(function(){n.queries.forEach(function(l){n.remove(l)})})},r.get=function(n){return this.queriesMap[n]},r.getAll=function(){return this.queries},r.find=function(n,l){var o=Je(n,l),c=o[0];return typeof c.exact>"u"&&(c.exact=!0),this.queries.find(function(y){return br(c,y)})},r.findAll=function(n,l){var o=Je(n,l),c=o[0];return Object.keys(c).length>0?this.queries.filter(function(y){return br(c,y)}):this.queries},r.notify=function(n){var l=this;ge.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){var n=this;ge.batch(function(){n.queries.forEach(function(l){l.onFocus()})})},r.onOnline=function(){var n=this;ge.batch(function(){n.queries.forEach(function(l){l.onOnline()})})},a}(da),Gn=function(){function t(r){this.options=J({},r.defaultOptions,r.options),this.mutationId=r.mutationId,this.mutationCache=r.mutationCache,this.observers=[],this.state=r.state||zn(),this.meta=r.meta}var a=t.prototype;return a.setState=function(s){this.dispatch({type:"setState",state:s})},a.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},a.removeObserver=function(s){this.observers=this.observers.filter(function(n){return n!==s})},a.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(he).catch(he)):Promise.resolve()},a.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},a.execute=function(){var s=this,n,l=this.state.status==="loading",o=Promise.resolve();return l||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(c){c!==s.state.context&&s.dispatch({type:"loading",context:c,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(c){n=c,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(n,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(n,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(n,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:n}),n}).catch(function(c){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(c,s.state.variables,s.state.context,s),gs().error(c),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(c,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,c,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:c}),c})})},a.executeMutation=function(){var s=this,n;return this.retryer=new ds({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},a.dispatch=function(s){var n=this;this.state=Hn(this.state,s),ge.batch(function(){n.observers.forEach(function(l){l.onMutationUpdate(s)}),n.mutationCache.notify(n)})},t}();function zn(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Hn(t,a){switch(a.type){case"failed":return J({},t,{failureCount:t.failureCount+1});case"pause":return J({},t,{isPaused:!0});case"continue":return J({},t,{isPaused:!1});case"loading":return J({},t,{context:a.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:a.variables});case"success":return J({},t,{data:a.data,error:null,status:"success",isPaused:!1});case"error":return J({},t,{data:void 0,error:a.error,failureCount:t.failureCount+1,isPaused:!1,status:"error"});case"setState":return J({},t,a.state);default:return t}}var Wn=function(t){ma(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.mutations=[],n.mutationId=0,n}var r=a.prototype;return r.build=function(n,l,o){var c=new Gn({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(l),state:o,defaultOptions:l.mutationKey?n.getMutationDefaults(l.mutationKey):void 0,meta:l.meta});return this.add(c),c},r.add=function(n){this.mutations.push(n),this.notify(n)},r.remove=function(n){this.mutations=this.mutations.filter(function(l){return l!==n}),n.cancel(),this.notify(n)},r.clear=function(){var n=this;ge.batch(function(){n.mutations.forEach(function(l){n.remove(l)})})},r.getAll=function(){return this.mutations},r.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(l){return Er(n,l)})},r.findAll=function(n){return this.mutations.filter(function(l){return Er(n,l)})},r.notify=function(n){var l=this;ge.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){this.resumePausedMutations()},r.onOnline=function(){this.resumePausedMutations()},r.resumePausedMutations=function(){var n=this.mutations.filter(function(l){return l.state.isPaused});return ge.batch(function(){return n.reduce(function(l,o){return l.then(function(){return o.continue().catch(he)})},Promise.resolve())})},a}(da);function Qn(){return{onFetch:function(a){a.fetchFn=function(){var r,s,n,l,o,c,y=(r=a.fetchOptions)==null||(s=r.meta)==null?void 0:s.refetchPage,m=(n=a.fetchOptions)==null||(l=n.meta)==null?void 0:l.fetchMore,u=m?.pageParam,d=m?.direction==="forward",p=m?.direction==="backward",b=((o=a.state.data)==null?void 0:o.pages)||[],w=((c=a.state.data)==null?void 0:c.pageParams)||[],h=is(),E=h?.signal,x=w,v=!1,D=a.options.queryFn||function(){return Promise.reject("Missing queryFn")},S=function(K,z,W,ee){return x=ee?[z].concat(x):[].concat(x,[z]),ee?[W].concat(K):[].concat(K,[W])},R=function(K,z,W,ee){if(v)return Promise.reject("Cancelled");if(typeof W>"u"&&!z&&K.length)return Promise.resolve(K);var se={queryKey:a.queryKey,signal:E,pageParam:W,meta:a.meta},ne=D(se),fe=Promise.resolve(ne).then(function(Ce){return S(K,W,Ce,ee)});if(ea(ne)){var ye=fe;ye.cancel=ne.cancel}return fe},O;if(!b.length)O=R([]);else if(d){var j=typeof u<"u",k=j?u:Nr(a.options,b);O=R(b,j,k)}else if(p){var L=typeof u<"u",g=L?u:Jn(a.options,b);O=R(b,L,g,!0)}else(function(){x=[];var U=typeof a.options.getNextPageParam>"u",K=y&&b[0]?y(b[0],0,b):!0;O=K?R([],U,w[0]):Promise.resolve(S([],w[0],b[0]));for(var z=function(se){O=O.then(function(ne){var fe=y&&b[se]?y(b[se],se,b):!0;if(fe){var ye=U?w[se]:Nr(a.options,ne);return R(ne,U,ye)}return Promise.resolve(S(ne,w[se],b[se]))})},W=1;W<b.length;W++)z(W)})();var I=O.then(function(U){return{pages:U,pageParams:x}}),M=I;return M.cancel=function(){v=!0,h?.abort(),ea(O)&&O.cancel()},I}}}}function Nr(t,a){return t.getNextPageParam==null?void 0:t.getNextPageParam(a[a.length-1],a)}function Jn(t,a){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(a[0],a)}var Yn=function(){function t(r){r===void 0&&(r={}),this.queryCache=r.queryCache||new Bn,this.mutationCache=r.mutationCache||new Wn,this.defaultOptions=r.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var a=t.prototype;return a.mount=function(){var s=this;this.unsubscribeFocus=$t.subscribe(function(){$t.isFocused()&&Vt.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Vt.subscribe(function(){$t.isFocused()&&Vt.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},a.unmount=function(){var s,n;(s=this.unsubscribeFocus)==null||s.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},a.isFetching=function(s,n){var l=Je(s,n),o=l[0];return o.fetching=!0,this.queryCache.findAll(o).length},a.isMutating=function(s){return this.mutationCache.findAll(J({},s,{fetching:!0})).length},a.getQueryData=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state.data},a.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(n){var l=n.queryKey,o=n.state,c=o.data;return[l,c]})},a.setQueryData=function(s,n,l){var o=Da(s),c=this.defaultQueryOptions(o);return this.queryCache.build(this,c).setData(n,l)},a.setQueriesData=function(s,n,l){var o=this;return ge.batch(function(){return o.getQueryCache().findAll(s).map(function(c){var y=c.queryKey;return[y,o.setQueryData(y,n,l)]})})},a.getQueryState=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state},a.removeQueries=function(s,n){var l=Je(s,n),o=l[0],c=this.queryCache;ge.batch(function(){c.findAll(o).forEach(function(y){c.remove(y)})})},a.resetQueries=function(s,n,l){var o=this,c=Je(s,n,l),y=c[0],m=c[1],u=this.queryCache,d=J({},y,{active:!0});return ge.batch(function(){return u.findAll(y).forEach(function(p){p.reset()}),o.refetchQueries(d,m)})},a.cancelQueries=function(s,n,l){var o=this,c=Je(s,n,l),y=c[0],m=c[1],u=m===void 0?{}:m;typeof u.revert>"u"&&(u.revert=!0);var d=ge.batch(function(){return o.queryCache.findAll(y).map(function(p){return p.cancel(u)})});return Promise.all(d).then(he).catch(he)},a.invalidateQueries=function(s,n,l){var o,c,y,m=this,u=Je(s,n,l),d=u[0],p=u[1],b=J({},d,{active:(o=(c=d.refetchActive)!=null?c:d.active)!=null?o:!0,inactive:(y=d.refetchInactive)!=null?y:!1});return ge.batch(function(){return m.queryCache.findAll(d).forEach(function(w){w.invalidate()}),m.refetchQueries(b,p)})},a.refetchQueries=function(s,n,l){var o=this,c=Je(s,n,l),y=c[0],m=c[1],u=ge.batch(function(){return o.queryCache.findAll(y).map(function(p){return p.fetch(void 0,J({},m,{meta:{refetchPage:y?.refetchPage}}))})}),d=Promise.all(u).then(he);return m?.throwOnError||(d=d.catch(he)),d},a.fetchQuery=function(s,n,l){var o=Da(s,n,l),c=this.defaultQueryOptions(o);typeof c.retry>"u"&&(c.retry=!1);var y=this.queryCache.build(this,c);return y.isStaleByTime(c.staleTime)?y.fetch(c):Promise.resolve(y.state.data)},a.prefetchQuery=function(s,n,l){return this.fetchQuery(s,n,l).then(he).catch(he)},a.fetchInfiniteQuery=function(s,n,l){var o=Da(s,n,l);return o.behavior=Qn(),this.fetchQuery(o)},a.prefetchInfiniteQuery=function(s,n,l){return this.fetchInfiniteQuery(s,n,l).then(he).catch(he)},a.cancelMutations=function(){var s=this,n=ge.batch(function(){return s.mutationCache.getAll().map(function(l){return l.cancel()})});return Promise.all(n).then(he).catch(he)},a.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},a.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},a.getQueryCache=function(){return this.queryCache},a.getMutationCache=function(){return this.mutationCache},a.getDefaultOptions=function(){return this.defaultOptions},a.setDefaultOptions=function(s){this.defaultOptions=s},a.setQueryDefaults=function(s,n){var l=this.queryDefaults.find(function(o){return at(s)===at(o.queryKey)});l?l.defaultOptions=n:this.queryDefaults.push({queryKey:s,defaultOptions:n})},a.getQueryDefaults=function(s){var n;return s?(n=this.queryDefaults.find(function(l){return Xt(s,l.queryKey)}))==null?void 0:n.defaultOptions:void 0},a.setMutationDefaults=function(s,n){var l=this.mutationDefaults.find(function(o){return at(s)===at(o.mutationKey)});l?l.defaultOptions=n:this.mutationDefaults.push({mutationKey:s,defaultOptions:n})},a.getMutationDefaults=function(s){var n;return s?(n=this.mutationDefaults.find(function(l){return Xt(s,l.mutationKey)}))==null?void 0:n.defaultOptions:void 0},a.defaultQueryOptions=function(s){if(s?._defaulted)return s;var n=J({},this.defaultOptions.queries,this.getQueryDefaults(s?.queryKey),s,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=er(n.queryKey,n)),n},a.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},a.defaultMutationOptions=function(s){return s?._defaulted?s:J({},this.defaultOptions.mutations,this.getMutationDefaults(s?.mutationKey),s,{_defaulted:!0})},a.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},t}(),Zn=nn.unstable_batchedUpdates;ge.setBatchNotifyFunction(Zn);var Xn=console;Vn(Xn);var wr=e.createContext(void 0),el=e.createContext(!1);function tl(t){return t&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=wr),window.ReactQueryClientContext):wr}var al=function(a){var r=a.client,s=a.contextSharing,n=s===void 0?!1:s,l=a.children;e.useEffect(function(){return r.mount(),function(){r.unmount()}},[r]);var o=tl(n);return e.createElement(el.Provider,{value:n},e.createElement(o.Provider,{value:r},l))};const rl={},Sr=t=>{let a;const r=new Set,s=(u,d)=>{const p=typeof u=="function"?u(a):u;if(!Object.is(p,a)){const b=a;a=d??(typeof p!="object"||p===null)?p:Object.assign({},a,p),r.forEach(w=>w(a,b))}},n=()=>a,y={setState:s,getState:n,getInitialState:()=>m,subscribe:u=>(r.add(u),()=>r.delete(u)),destroy:()=>{(rl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},m=a=t(s,n,y);return y},sl=t=>t?Sr(t):Sr;var fs={exports:{}},ps={},ys={exports:{}},hs={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ut=C;function nl(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var ll=typeof Object.is=="function"?Object.is:nl,ol=ut.useState,cl=ut.useEffect,il=ut.useLayoutEffect,ml=ut.useDebugValue;function dl(t,a){var r=a(),s=ol({inst:{value:r,getSnapshot:a}}),n=s[0].inst,l=s[1];return il(function(){n.value=r,n.getSnapshot=a,Fa(n)&&l({inst:n})},[t,r,a]),cl(function(){return Fa(n)&&l({inst:n}),t(function(){Fa(n)&&l({inst:n})})},[t]),ml(r),r}function Fa(t){var a=t.getSnapshot;t=t.value;try{var r=a();return!ll(t,r)}catch{return!0}}function ul(t,a){return a()}var gl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ul:dl;hs.useSyncExternalStore=ut.useSyncExternalStore!==void 0?ut.useSyncExternalStore:gl;ys.exports=hs;var fl=ys.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ga=C,pl=fl;function yl(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var hl=typeof Object.is=="function"?Object.is:yl,bl=pl.useSyncExternalStore,El=ga.useRef,xl=ga.useEffect,vl=ga.useMemo,Nl=ga.useDebugValue;ps.useSyncExternalStoreWithSelector=function(t,a,r,s,n){var l=El(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=vl(function(){function y(b){if(!m){if(m=!0,u=b,b=s(b),n!==void 0&&o.hasValue){var w=o.value;if(n(w,b))return d=w}return d=b}if(w=d,hl(u,b))return w;var h=s(b);return n!==void 0&&n(w,h)?(u=b,w):(u=b,d=h)}var m=!1,u,d,p=r===void 0?null:r;return[function(){return y(a())},p===null?void 0:function(){return y(p())}]},[a,r,s,n]);var c=bl(t,l[0],l[1]);return xl(function(){o.hasValue=!0,o.value=c},[c]),Nl(c),c};fs.exports=ps;var wl=fs.exports;const Sl=ln(wl),bs={},{useDebugValue:kl}=e,{useSyncExternalStoreWithSelector:Cl}=Sl;let kr=!1;const Pl=t=>t;function Al(t,a=Pl,r){(bs?"production":void 0)!=="production"&&r&&!kr&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),kr=!0);const s=Cl(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,r);return kl(s),s}const Dl=t=>{(bs?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof t=="function"?sl(t):t,r=(s,n)=>Al(a,s,n);return Object.assign(r,a),r},Es=t=>Dl,Rl={};function Fl(t,a){let r;try{r=t()}catch{return}return{getItem:n=>{var l;const o=y=>y===null?null:JSON.parse(y,void 0),c=(l=r.getItem(n))!=null?l:null;return c instanceof Promise?c.then(o):o(c)},setItem:(n,l)=>r.setItem(n,JSON.stringify(l,void 0)),removeItem:n=>r.removeItem(n)}}const kt=t=>a=>{try{const r=t(a);return r instanceof Promise?r:{then(s){return kt(s)(r)},catch(s){return this}}}catch(r){return{then(s){return this},catch(s){return kt(s)(r)}}}},Ol=(t,a)=>(r,s,n)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:E=>E,version:0,merge:(E,x)=>({...x,...E}),...a},o=!1;const c=new Set,y=new Set;let m;try{m=l.getStorage()}catch{}if(!m)return t((...E)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...E)},s,n);const u=kt(l.serialize),d=()=>{const E=l.partialize({...s()});let x;const v=u({state:E,version:l.version}).then(D=>m.setItem(l.name,D)).catch(D=>{x=D});if(x)throw x;return v},p=n.setState;n.setState=(E,x)=>{p(E,x),d()};const b=t((...E)=>{r(...E),d()},s,n);let w;const h=()=>{var E;if(!m)return;o=!1,c.forEach(v=>v(s()));const x=((E=l.onRehydrateStorage)==null?void 0:E.call(l,s()))||void 0;return kt(m.getItem.bind(m))(l.name).then(v=>{if(v)return l.deserialize(v)}).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==l.version){if(l.migrate)return l.migrate(v.state,v.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return v.state}).then(v=>{var D;return w=l.merge(v,(D=s())!=null?D:b),r(w,!0),d()}).then(()=>{x?.(w,void 0),o=!0,y.forEach(v=>v(w))}).catch(v=>{x?.(void 0,v)})};return n.persist={setOptions:E=>{l={...l,...E},E.getStorage&&(m=E.getStorage())},clearStorage:()=>{m?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>h(),hasHydrated:()=>o,onHydrate:E=>(c.add(E),()=>{c.delete(E)}),onFinishHydration:E=>(y.add(E),()=>{y.delete(E)})},h(),w||b},Tl=(t,a)=>(r,s,n)=>{let l={storage:Fl(()=>localStorage),partialize:h=>h,version:0,merge:(h,E)=>({...E,...h}),...a},o=!1;const c=new Set,y=new Set;let m=l.storage;if(!m)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...h)},s,n);const u=()=>{const h=l.partialize({...s()});return m.setItem(l.name,{state:h,version:l.version})},d=n.setState;n.setState=(h,E)=>{d(h,E),u()};const p=t((...h)=>{r(...h),u()},s,n);n.getInitialState=()=>p;let b;const w=()=>{var h,E;if(!m)return;o=!1,c.forEach(v=>{var D;return v((D=s())!=null?D:p)});const x=((E=l.onRehydrateStorage)==null?void 0:E.call(l,(h=s())!=null?h:p))||void 0;return kt(m.getItem.bind(m))(l.name).then(v=>{if(v)if(typeof v.version=="number"&&v.version!==l.version){if(l.migrate)return[!0,l.migrate(v.state,v.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,v.state];return[!1,void 0]}).then(v=>{var D;const[S,R]=v;if(b=l.merge(R,(D=s())!=null?D:p),r(b,!0),S)return u()}).then(()=>{x?.(b,void 0),b=s(),o=!0,y.forEach(v=>v(b))}).catch(v=>{x?.(void 0,v)})};return n.persist={setOptions:h=>{l={...l,...h},h.storage&&(m=h.storage)},clearStorage:()=>{m?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:h=>(c.add(h),()=>{c.delete(h)}),onFinishHydration:h=>(y.add(h),()=>{y.delete(h)})},l.skipHydration||w(),b||p},Il=(t,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?((Rl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Ol(t,a)):Tl(t,a),xs=Il;function vs(t,a){return function(){return t.apply(a,arguments)}}const{toString:_l}=Object.prototype,{getPrototypeOf:tr}=Object,{iterator:fa,toStringTag:Ns}=Symbol,pa=(t=>a=>{const r=_l.call(a);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Le=t=>(t=t.toLowerCase(),a=>pa(a)===t),ya=t=>a=>typeof a===t,{isArray:gt}=Array,Ct=ya("undefined");function Dt(t){return t!==null&&!Ct(t)&&t.constructor!==null&&!Ct(t.constructor)&&Se(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ws=Le("ArrayBuffer");function Ll(t){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(t):a=t&&t.buffer&&ws(t.buffer),a}const Ml=ya("string"),Se=ya("function"),Ss=ya("number"),Rt=t=>t!==null&&typeof t=="object",jl=t=>t===!0||t===!1,Kt=t=>{if(pa(t)!=="object")return!1;const a=tr(t);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(Ns in t)&&!(fa in t)},Ul=t=>{if(!Rt(t)||Dt(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},ql=Le("Date"),$l=Le("File"),Vl=Le("Blob"),Kl=Le("FileList"),Bl=t=>Rt(t)&&Se(t.pipe),Gl=t=>{let a;return t&&(typeof FormData=="function"&&t instanceof FormData||Se(t.append)&&((a=pa(t))==="formdata"||a==="object"&&Se(t.toString)&&t.toString()==="[object FormData]"))},zl=Le("URLSearchParams"),[Hl,Wl,Ql,Jl]=["ReadableStream","Request","Response","Headers"].map(Le),Yl=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ft(t,a,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let s,n;if(typeof t!="object"&&(t=[t]),gt(t))for(s=0,n=t.length;s<n;s++)a.call(null,t[s],s,t);else{if(Dt(t))return;const l=r?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(s=0;s<o;s++)c=l[s],a.call(null,t[c],c,t)}}function ks(t,a){if(Dt(t))return null;a=a.toLowerCase();const r=Object.keys(t);let s=r.length,n;for(;s-- >0;)if(n=r[s],a===n.toLowerCase())return n;return null}const rt=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Cs=t=>!Ct(t)&&t!==rt;function Ka(){const{caseless:t}=Cs(this)&&this||{},a={},r=(s,n)=>{const l=t&&ks(a,n)||n;Kt(a[l])&&Kt(s)?a[l]=Ka(a[l],s):Kt(s)?a[l]=Ka({},s):gt(s)?a[l]=s.slice():a[l]=s};for(let s=0,n=arguments.length;s<n;s++)arguments[s]&&Ft(arguments[s],r);return a}const Zl=(t,a,r,{allOwnKeys:s}={})=>(Ft(a,(n,l)=>{r&&Se(n)?t[l]=vs(n,r):t[l]=n},{allOwnKeys:s}),t),Xl=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),eo=(t,a,r,s)=>{t.prototype=Object.create(a.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:a.prototype}),r&&Object.assign(t.prototype,r)},to=(t,a,r,s)=>{let n,l,o;const c={};if(a=a||{},t==null)return a;do{for(n=Object.getOwnPropertyNames(t),l=n.length;l-- >0;)o=n[l],(!s||s(o,t,a))&&!c[o]&&(a[o]=t[o],c[o]=!0);t=r!==!1&&tr(t)}while(t&&(!r||r(t,a))&&t!==Object.prototype);return a},ao=(t,a,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=a.length;const s=t.indexOf(a,r);return s!==-1&&s===r},ro=t=>{if(!t)return null;if(gt(t))return t;let a=t.length;if(!Ss(a))return null;const r=new Array(a);for(;a-- >0;)r[a]=t[a];return r},so=(t=>a=>t&&a instanceof t)(typeof Uint8Array<"u"&&tr(Uint8Array)),no=(t,a)=>{const s=(t&&t[fa]).call(t);let n;for(;(n=s.next())&&!n.done;){const l=n.value;a.call(t,l[0],l[1])}},lo=(t,a)=>{let r;const s=[];for(;(r=t.exec(a))!==null;)s.push(r);return s},oo=Le("HTMLFormElement"),co=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),Cr=(({hasOwnProperty:t})=>(a,r)=>t.call(a,r))(Object.prototype),io=Le("RegExp"),Ps=(t,a)=>{const r=Object.getOwnPropertyDescriptors(t),s={};Ft(r,(n,l)=>{let o;(o=a(n,l,t))!==!1&&(s[l]=o||n)}),Object.defineProperties(t,s)},mo=t=>{Ps(t,(a,r)=>{if(Se(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=t[r];if(Se(s)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},uo=(t,a)=>{const r={},s=n=>{n.forEach(l=>{r[l]=!0})};return gt(t)?s(t):s(String(t).split(a)),r},go=()=>{},fo=(t,a)=>t!=null&&Number.isFinite(t=+t)?t:a;function po(t){return!!(t&&Se(t.append)&&t[Ns]==="FormData"&&t[fa])}const yo=t=>{const a=new Array(10),r=(s,n)=>{if(Rt(s)){if(a.indexOf(s)>=0)return;if(Dt(s))return s;if(!("toJSON"in s)){a[n]=s;const l=gt(s)?[]:{};return Ft(s,(o,c)=>{const y=r(o,n+1);!Ct(y)&&(l[c]=y)}),a[n]=void 0,l}}return s};return r(t,0)},ho=Le("AsyncFunction"),bo=t=>t&&(Rt(t)||Se(t))&&Se(t.then)&&Se(t.catch),As=((t,a)=>t?setImmediate:a?((r,s)=>(rt.addEventListener("message",({source:n,data:l})=>{n===rt&&l===r&&s.length&&s.shift()()},!1),n=>{s.push(n),rt.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Se(rt.postMessage)),Eo=typeof queueMicrotask<"u"?queueMicrotask.bind(rt):typeof process<"u"&&process.nextTick||As,xo=t=>t!=null&&Se(t[fa]),A={isArray:gt,isArrayBuffer:ws,isBuffer:Dt,isFormData:Gl,isArrayBufferView:Ll,isString:Ml,isNumber:Ss,isBoolean:jl,isObject:Rt,isPlainObject:Kt,isEmptyObject:Ul,isReadableStream:Hl,isRequest:Wl,isResponse:Ql,isHeaders:Jl,isUndefined:Ct,isDate:ql,isFile:$l,isBlob:Vl,isRegExp:io,isFunction:Se,isStream:Bl,isURLSearchParams:zl,isTypedArray:so,isFileList:Kl,forEach:Ft,merge:Ka,extend:Zl,trim:Yl,stripBOM:Xl,inherits:eo,toFlatObject:to,kindOf:pa,kindOfTest:Le,endsWith:ao,toArray:ro,forEachEntry:no,matchAll:lo,isHTMLForm:oo,hasOwnProperty:Cr,hasOwnProp:Cr,reduceDescriptors:Ps,freezeMethods:mo,toObjectSet:uo,toCamelCase:co,noop:go,toFiniteNumber:fo,findKey:ks,global:rt,isContextDefined:Cs,isSpecCompliantForm:po,toJSONObject:yo,isAsyncFn:ho,isThenable:bo,setImmediate:As,asap:Eo,isIterable:xo};function G(t,a,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",a&&(this.code=a),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}A.inherits(G,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:A.toJSONObject(this.config),code:this.code,status:this.status}}});const Ds=G.prototype,Rs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Rs[t]={value:t}});Object.defineProperties(G,Rs);Object.defineProperty(Ds,"isAxiosError",{value:!0});G.from=(t,a,r,s,n,l)=>{const o=Object.create(Ds);return A.toFlatObject(t,o,function(y){return y!==Error.prototype},c=>c!=="isAxiosError"),G.call(o,t.message,a,r,s,n),o.cause=t,o.name=t.name,l&&Object.assign(o,l),o};const vo=null;function Ba(t){return A.isPlainObject(t)||A.isArray(t)}function Fs(t){return A.endsWith(t,"[]")?t.slice(0,-2):t}function Pr(t,a,r){return t?t.concat(a).map(function(n,l){return n=Fs(n),!r&&l?"["+n+"]":n}).join(r?".":""):a}function No(t){return A.isArray(t)&&!t.some(Ba)}const wo=A.toFlatObject(A,{},null,function(a){return/^is[A-Z]/.test(a)});function ha(t,a,r){if(!A.isObject(t))throw new TypeError("target must be an object");a=a||new FormData,r=A.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,E){return!A.isUndefined(E[h])});const s=r.metaTokens,n=r.visitor||u,l=r.dots,o=r.indexes,y=(r.Blob||typeof Blob<"u"&&Blob)&&A.isSpecCompliantForm(a);if(!A.isFunction(n))throw new TypeError("visitor must be a function");function m(w){if(w===null)return"";if(A.isDate(w))return w.toISOString();if(A.isBoolean(w))return w.toString();if(!y&&A.isBlob(w))throw new G("Blob is not supported. Use a Buffer instead.");return A.isArrayBuffer(w)||A.isTypedArray(w)?y&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function u(w,h,E){let x=w;if(w&&!E&&typeof w=="object"){if(A.endsWith(h,"{}"))h=s?h:h.slice(0,-2),w=JSON.stringify(w);else if(A.isArray(w)&&No(w)||(A.isFileList(w)||A.endsWith(h,"[]"))&&(x=A.toArray(w)))return h=Fs(h),x.forEach(function(D,S){!(A.isUndefined(D)||D===null)&&a.append(o===!0?Pr([h],S,l):o===null?h:h+"[]",m(D))}),!1}return Ba(w)?!0:(a.append(Pr(E,h,l),m(w)),!1)}const d=[],p=Object.assign(wo,{defaultVisitor:u,convertValue:m,isVisitable:Ba});function b(w,h){if(!A.isUndefined(w)){if(d.indexOf(w)!==-1)throw Error("Circular reference detected in "+h.join("."));d.push(w),A.forEach(w,function(x,v){(!(A.isUndefined(x)||x===null)&&n.call(a,x,A.isString(v)?v.trim():v,h,p))===!0&&b(x,h?h.concat(v):[v])}),d.pop()}}if(!A.isObject(t))throw new TypeError("data must be an object");return b(t),a}function Ar(t){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return a[s]})}function ar(t,a){this._pairs=[],t&&ha(t,this,a)}const Os=ar.prototype;Os.append=function(a,r){this._pairs.push([a,r])};Os.toString=function(a){const r=a?function(s){return a.call(this,s,Ar)}:Ar;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function So(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ts(t,a,r){if(!a)return t;const s=r&&r.encode||So;A.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(a,r):l=A.isURLSearchParams(a)?a.toString():new ar(a,r).toString(s),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class Dr{constructor(){this.handlers=[]}use(a,r,s){return this.handlers.push({fulfilled:a,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){A.forEach(this.handlers,function(s){s!==null&&a(s)})}}const Is={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ko=typeof URLSearchParams<"u"?URLSearchParams:ar,Co=typeof FormData<"u"?FormData:null,Po=typeof Blob<"u"?Blob:null,Ao={isBrowser:!0,classes:{URLSearchParams:ko,FormData:Co,Blob:Po},protocols:["http","https","file","blob","url","data"]},rr=typeof window<"u"&&typeof document<"u",Ga=typeof navigator=="object"&&navigator||void 0,Do=rr&&(!Ga||["ReactNative","NativeScript","NS"].indexOf(Ga.product)<0),Ro=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Fo=rr&&window.location.href||"http://localhost",Oo=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:rr,hasStandardBrowserEnv:Do,hasStandardBrowserWebWorkerEnv:Ro,navigator:Ga,origin:Fo},Symbol.toStringTag,{value:"Module"})),pe={...Oo,...Ao};function To(t,a){return ha(t,new pe.classes.URLSearchParams,{visitor:function(r,s,n,l){return pe.isNode&&A.isBuffer(r)?(this.append(s,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...a})}function Io(t){return A.matchAll(/\w+|\[(\w*)]/g,t).map(a=>a[0]==="[]"?"":a[1]||a[0])}function _o(t){const a={},r=Object.keys(t);let s;const n=r.length;let l;for(s=0;s<n;s++)l=r[s],a[l]=t[l];return a}function _s(t){function a(r,s,n,l){let o=r[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),y=l>=r.length;return o=!o&&A.isArray(n)?n.length:o,y?(A.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!c):((!n[o]||!A.isObject(n[o]))&&(n[o]=[]),a(r,s,n[o],l)&&A.isArray(n[o])&&(n[o]=_o(n[o])),!c)}if(A.isFormData(t)&&A.isFunction(t.entries)){const r={};return A.forEachEntry(t,(s,n)=>{a(Io(s),n,r,0)}),r}return null}function Lo(t,a,r){if(A.isString(t))try{return(a||JSON.parse)(t),A.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(t)}const Ot={transitional:Is,adapter:["xhr","http","fetch"],transformRequest:[function(a,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,l=A.isObject(a);if(l&&A.isHTMLForm(a)&&(a=new FormData(a)),A.isFormData(a))return n?JSON.stringify(_s(a)):a;if(A.isArrayBuffer(a)||A.isBuffer(a)||A.isStream(a)||A.isFile(a)||A.isBlob(a)||A.isReadableStream(a))return a;if(A.isArrayBufferView(a))return a.buffer;if(A.isURLSearchParams(a))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let c;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return To(a,this.formSerializer).toString();if((c=A.isFileList(a))||s.indexOf("multipart/form-data")>-1){const y=this.env&&this.env.FormData;return ha(c?{"files[]":a}:a,y&&new y,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),Lo(a)):a}],transformResponse:[function(a){const r=this.transitional||Ot.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(A.isResponse(a)||A.isReadableStream(a))return a;if(a&&A.isString(a)&&(s&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(a)}catch(c){if(o)throw c.name==="SyntaxError"?G.from(c,G.ERR_BAD_RESPONSE,this,null,this.response):c}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pe.classes.FormData,Blob:pe.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};A.forEach(["delete","get","head","post","put","patch"],t=>{Ot.headers[t]={}});const Mo=A.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),jo=t=>{const a={};let r,s,n;return t&&t.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!r||a[r]&&Mo[r])&&(r==="set-cookie"?a[r]?a[r].push(s):a[r]=[s]:a[r]=a[r]?a[r]+", "+s:s)}),a},Rr=Symbol("internals");function Et(t){return t&&String(t).trim().toLowerCase()}function Bt(t){return t===!1||t==null?t:A.isArray(t)?t.map(Bt):String(t)}function Uo(t){const a=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(t);)a[s[1]]=s[2];return a}const qo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Oa(t,a,r,s,n){if(A.isFunction(s))return s.call(this,a,r);if(n&&(a=r),!!A.isString(a)){if(A.isString(s))return a.indexOf(s)!==-1;if(A.isRegExp(s))return s.test(a)}}function $o(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,r,s)=>r.toUpperCase()+s)}function Vo(t,a){const r=A.toCamelCase(" "+a);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+r,{value:function(n,l,o){return this[s].call(this,a,n,l,o)},configurable:!0})})}let ke=class{constructor(a){a&&this.set(a)}set(a,r,s){const n=this;function l(c,y,m){const u=Et(y);if(!u)throw new Error("header name must be a non-empty string");const d=A.findKey(n,u);(!d||n[d]===void 0||m===!0||m===void 0&&n[d]!==!1)&&(n[d||y]=Bt(c))}const o=(c,y)=>A.forEach(c,(m,u)=>l(m,u,y));if(A.isPlainObject(a)||a instanceof this.constructor)o(a,r);else if(A.isString(a)&&(a=a.trim())&&!qo(a))o(jo(a),r);else if(A.isObject(a)&&A.isIterable(a)){let c={},y,m;for(const u of a){if(!A.isArray(u))throw TypeError("Object iterator must return a key-value pair");c[m=u[0]]=(y=c[m])?A.isArray(y)?[...y,u[1]]:[y,u[1]]:u[1]}o(c,r)}else a!=null&&l(r,a,s);return this}get(a,r){if(a=Et(a),a){const s=A.findKey(this,a);if(s){const n=this[s];if(!r)return n;if(r===!0)return Uo(n);if(A.isFunction(r))return r.call(this,n,s);if(A.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,r){if(a=Et(a),a){const s=A.findKey(this,a);return!!(s&&this[s]!==void 0&&(!r||Oa(this,this[s],s,r)))}return!1}delete(a,r){const s=this;let n=!1;function l(o){if(o=Et(o),o){const c=A.findKey(s,o);c&&(!r||Oa(s,s[c],c,r))&&(delete s[c],n=!0)}}return A.isArray(a)?a.forEach(l):l(a),n}clear(a){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const l=r[s];(!a||Oa(this,this[l],l,a,!0))&&(delete this[l],n=!0)}return n}normalize(a){const r=this,s={};return A.forEach(this,(n,l)=>{const o=A.findKey(s,l);if(o){r[o]=Bt(n),delete r[l];return}const c=a?$o(l):String(l).trim();c!==l&&delete r[l],r[c]=Bt(n),s[c]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const r=Object.create(null);return A.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=a&&A.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,r])=>a+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...r){const s=new this(a);return r.forEach(n=>s.set(n)),s}static accessor(a){const s=(this[Rr]=this[Rr]={accessors:{}}).accessors,n=this.prototype;function l(o){const c=Et(o);s[c]||(Vo(n,o),s[c]=!0)}return A.isArray(a)?a.forEach(l):l(a),this}};ke.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);A.reduceDescriptors(ke.prototype,({value:t},a)=>{let r=a[0].toUpperCase()+a.slice(1);return{get:()=>t,set(s){this[r]=s}}});A.freezeMethods(ke);function Ta(t,a){const r=this||Ot,s=a||r,n=ke.from(s.headers);let l=s.data;return A.forEach(t,function(c){l=c.call(r,l,n.normalize(),a?a.status:void 0)}),n.normalize(),l}function Ls(t){return!!(t&&t.__CANCEL__)}function ft(t,a,r){G.call(this,t??"canceled",G.ERR_CANCELED,a,r),this.name="CanceledError"}A.inherits(ft,G,{__CANCEL__:!0});function Ms(t,a,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?t(r):a(new G("Request failed with status code "+r.status,[G.ERR_BAD_REQUEST,G.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Ko(t){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return a&&a[1]||""}function Bo(t,a){t=t||10;const r=new Array(t),s=new Array(t);let n=0,l=0,o;return a=a!==void 0?a:1e3,function(y){const m=Date.now(),u=s[l];o||(o=m),r[n]=y,s[n]=m;let d=l,p=0;for(;d!==n;)p+=r[d++],d=d%t;if(n=(n+1)%t,n===l&&(l=(l+1)%t),m-o<a)return;const b=u&&m-u;return b?Math.round(p*1e3/b):void 0}}function Go(t,a){let r=0,s=1e3/a,n,l;const o=(m,u=Date.now())=>{r=u,n=null,l&&(clearTimeout(l),l=null),t(...m)};return[(...m)=>{const u=Date.now(),d=u-r;d>=s?o(m,u):(n=m,l||(l=setTimeout(()=>{l=null,o(n)},s-d)))},()=>n&&o(n)]}const ta=(t,a,r=3)=>{let s=0;const n=Bo(50,250);return Go(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,y=o-s,m=n(y),u=o<=c;s=o;const d={loaded:o,total:c,progress:c?o/c:void 0,bytes:y,rate:m||void 0,estimated:m&&c&&u?(c-o)/m:void 0,event:l,lengthComputable:c!=null,[a?"download":"upload"]:!0};t(d)},r)},Fr=(t,a)=>{const r=t!=null;return[s=>a[0]({lengthComputable:r,total:t,loaded:s}),a[1]]},Or=t=>(...a)=>A.asap(()=>t(...a)),zo=pe.hasStandardBrowserEnv?((t,a)=>r=>(r=new URL(r,pe.origin),t.protocol===r.protocol&&t.host===r.host&&(a||t.port===r.port)))(new URL(pe.origin),pe.navigator&&/(msie|trident)/i.test(pe.navigator.userAgent)):()=>!0,Ho=pe.hasStandardBrowserEnv?{write(t,a,r,s,n,l){const o=[t+"="+encodeURIComponent(a)];A.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),A.isString(s)&&o.push("path="+s),A.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const a=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Wo(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Qo(t,a){return a?t.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):t}function js(t,a,r){let s=!Wo(a);return t&&(s||r==!1)?Qo(t,a):a}const Tr=t=>t instanceof ke?{...t}:t;function ct(t,a){a=a||{};const r={};function s(m,u,d,p){return A.isPlainObject(m)&&A.isPlainObject(u)?A.merge.call({caseless:p},m,u):A.isPlainObject(u)?A.merge({},u):A.isArray(u)?u.slice():u}function n(m,u,d,p){if(A.isUndefined(u)){if(!A.isUndefined(m))return s(void 0,m,d,p)}else return s(m,u,d,p)}function l(m,u){if(!A.isUndefined(u))return s(void 0,u)}function o(m,u){if(A.isUndefined(u)){if(!A.isUndefined(m))return s(void 0,m)}else return s(void 0,u)}function c(m,u,d){if(d in a)return s(m,u);if(d in t)return s(void 0,m)}const y={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(m,u,d)=>n(Tr(m),Tr(u),d,!0)};return A.forEach(Object.keys({...t,...a}),function(u){const d=y[u]||n,p=d(t[u],a[u],u);A.isUndefined(p)&&d!==c||(r[u]=p)}),r}const Us=t=>{const a=ct({},t);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:c}=a;a.headers=o=ke.from(o),a.url=Ts(js(a.baseURL,a.url,a.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let y;if(A.isFormData(r)){if(pe.hasStandardBrowserEnv||pe.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((y=o.getContentType())!==!1){const[m,...u]=y?y.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([m||"multipart/form-data",...u].join("; "))}}if(pe.hasStandardBrowserEnv&&(s&&A.isFunction(s)&&(s=s(a)),s||s!==!1&&zo(a.url))){const m=n&&l&&Ho.read(l);m&&o.set(n,m)}return a},Jo=typeof XMLHttpRequest<"u",Yo=Jo&&function(t){return new Promise(function(r,s){const n=Us(t);let l=n.data;const o=ke.from(n.headers).normalize();let{responseType:c,onUploadProgress:y,onDownloadProgress:m}=n,u,d,p,b,w;function h(){b&&b(),w&&w(),n.cancelToken&&n.cancelToken.unsubscribe(u),n.signal&&n.signal.removeEventListener("abort",u)}let E=new XMLHttpRequest;E.open(n.method.toUpperCase(),n.url,!0),E.timeout=n.timeout;function x(){if(!E)return;const D=ke.from("getAllResponseHeaders"in E&&E.getAllResponseHeaders()),R={data:!c||c==="text"||c==="json"?E.responseText:E.response,status:E.status,statusText:E.statusText,headers:D,config:t,request:E};Ms(function(j){r(j),h()},function(j){s(j),h()},R),E=null}"onloadend"in E?E.onloadend=x:E.onreadystatechange=function(){!E||E.readyState!==4||E.status===0&&!(E.responseURL&&E.responseURL.indexOf("file:")===0)||setTimeout(x)},E.onabort=function(){E&&(s(new G("Request aborted",G.ECONNABORTED,t,E)),E=null)},E.onerror=function(){s(new G("Network Error",G.ERR_NETWORK,t,E)),E=null},E.ontimeout=function(){let S=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const R=n.transitional||Is;n.timeoutErrorMessage&&(S=n.timeoutErrorMessage),s(new G(S,R.clarifyTimeoutError?G.ETIMEDOUT:G.ECONNABORTED,t,E)),E=null},l===void 0&&o.setContentType(null),"setRequestHeader"in E&&A.forEach(o.toJSON(),function(S,R){E.setRequestHeader(R,S)}),A.isUndefined(n.withCredentials)||(E.withCredentials=!!n.withCredentials),c&&c!=="json"&&(E.responseType=n.responseType),m&&([p,w]=ta(m,!0),E.addEventListener("progress",p)),y&&E.upload&&([d,b]=ta(y),E.upload.addEventListener("progress",d),E.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(u=D=>{E&&(s(!D||D.type?new ft(null,t,E):D),E.abort(),E=null)},n.cancelToken&&n.cancelToken.subscribe(u),n.signal&&(n.signal.aborted?u():n.signal.addEventListener("abort",u)));const v=Ko(n.url);if(v&&pe.protocols.indexOf(v)===-1){s(new G("Unsupported protocol "+v+":",G.ERR_BAD_REQUEST,t));return}E.send(l||null)})},Zo=(t,a)=>{const{length:r}=t=t?t.filter(Boolean):[];if(a||r){let s=new AbortController,n;const l=function(m){if(!n){n=!0,c();const u=m instanceof Error?m:this.reason;s.abort(u instanceof G?u:new ft(u instanceof Error?u.message:u))}};let o=a&&setTimeout(()=>{o=null,l(new G(`timeout ${a} of ms exceeded`,G.ETIMEDOUT))},a);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),t=null)};t.forEach(m=>m.addEventListener("abort",l));const{signal:y}=s;return y.unsubscribe=()=>A.asap(c),y}},Xo=function*(t,a){let r=t.byteLength;if(r<a){yield t;return}let s=0,n;for(;s<r;)n=s+a,yield t.slice(s,n),s=n},ec=async function*(t,a){for await(const r of tc(t))yield*Xo(r,a)},tc=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const a=t.getReader();try{for(;;){const{done:r,value:s}=await a.read();if(r)break;yield s}}finally{await a.cancel()}},Ir=(t,a,r,s)=>{const n=ec(t,a);let l=0,o,c=y=>{o||(o=!0,s&&s(y))};return new ReadableStream({async pull(y){try{const{done:m,value:u}=await n.next();if(m){c(),y.close();return}let d=u.byteLength;if(r){let p=l+=d;r(p)}y.enqueue(new Uint8Array(u))}catch(m){throw c(m),m}},cancel(y){return c(y),n.return()}},{highWaterMark:2})},ba=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",qs=ba&&typeof ReadableStream=="function",ac=ba&&(typeof TextEncoder=="function"?(t=>a=>t.encode(a))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),$s=(t,...a)=>{try{return!!t(...a)}catch{return!1}},rc=qs&&$s(()=>{let t=!1;const a=new Request(pe.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!a}),_r=64*1024,za=qs&&$s(()=>A.isReadableStream(new Response("").body)),aa={stream:za&&(t=>t.body)};ba&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(a=>{!aa[a]&&(aa[a]=A.isFunction(t[a])?r=>r[a]():(r,s)=>{throw new G(`Response type '${a}' is not supported`,G.ERR_NOT_SUPPORT,s)})})})(new Response);const sc=async t=>{if(t==null)return 0;if(A.isBlob(t))return t.size;if(A.isSpecCompliantForm(t))return(await new Request(pe.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(A.isArrayBufferView(t)||A.isArrayBuffer(t))return t.byteLength;if(A.isURLSearchParams(t)&&(t=t+""),A.isString(t))return(await ac(t)).byteLength},nc=async(t,a)=>{const r=A.toFiniteNumber(t.getContentLength());return r??sc(a)},lc=ba&&(async t=>{let{url:a,method:r,data:s,signal:n,cancelToken:l,timeout:o,onDownloadProgress:c,onUploadProgress:y,responseType:m,headers:u,withCredentials:d="same-origin",fetchOptions:p}=Us(t);m=m?(m+"").toLowerCase():"text";let b=Zo([n,l&&l.toAbortSignal()],o),w;const h=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let E;try{if(y&&rc&&r!=="get"&&r!=="head"&&(E=await nc(u,s))!==0){let R=new Request(a,{method:"POST",body:s,duplex:"half"}),O;if(A.isFormData(s)&&(O=R.headers.get("content-type"))&&u.setContentType(O),R.body){const[j,k]=Fr(E,ta(Or(y)));s=Ir(R.body,_r,j,k)}}A.isString(d)||(d=d?"include":"omit");const x="credentials"in Request.prototype;w=new Request(a,{...p,signal:b,method:r.toUpperCase(),headers:u.normalize().toJSON(),body:s,duplex:"half",credentials:x?d:void 0});let v=await fetch(w,p);const D=za&&(m==="stream"||m==="response");if(za&&(c||D&&h)){const R={};["status","statusText","headers"].forEach(L=>{R[L]=v[L]});const O=A.toFiniteNumber(v.headers.get("content-length")),[j,k]=c&&Fr(O,ta(Or(c),!0))||[];v=new Response(Ir(v.body,_r,j,()=>{k&&k(),h&&h()}),R)}m=m||"text";let S=await aa[A.findKey(aa,m)||"text"](v,t);return!D&&h&&h(),await new Promise((R,O)=>{Ms(R,O,{data:S,headers:ke.from(v.headers),status:v.status,statusText:v.statusText,config:t,request:w})})}catch(x){throw h&&h(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new G("Network Error",G.ERR_NETWORK,t,w),{cause:x.cause||x}):G.from(x,x&&x.code,t,w)}}),Ha={http:vo,xhr:Yo,fetch:lc};A.forEach(Ha,(t,a)=>{if(t){try{Object.defineProperty(t,"name",{value:a})}catch{}Object.defineProperty(t,"adapterName",{value:a})}});const Lr=t=>`- ${t}`,oc=t=>A.isFunction(t)||t===null||t===!1,Vs={getAdapter:t=>{t=A.isArray(t)?t:[t];const{length:a}=t;let r,s;const n={};for(let l=0;l<a;l++){r=t[l];let o;if(s=r,!oc(r)&&(s=Ha[(o=String(r)).toLowerCase()],s===void 0))throw new G(`Unknown adapter '${o}'`);if(s)break;n[o||"#"+l]=s}if(!s){const l=Object.entries(n).map(([c,y])=>`adapter ${c} `+(y===!1?"is not supported by the environment":"is not available in the build"));let o=a?l.length>1?`since :
`+l.map(Lr).join(`
`):" "+Lr(l[0]):"as no adapter specified";throw new G("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Ha};function Ia(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ft(null,t)}function Mr(t){return Ia(t),t.headers=ke.from(t.headers),t.data=Ta.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Vs.getAdapter(t.adapter||Ot.adapter)(t).then(function(s){return Ia(t),s.data=Ta.call(t,t.transformResponse,s),s.headers=ke.from(s.headers),s},function(s){return Ls(s)||(Ia(t),s&&s.response&&(s.response.data=Ta.call(t,t.transformResponse,s.response),s.response.headers=ke.from(s.response.headers))),Promise.reject(s)})}const Ks="1.11.0",Ea={};["object","boolean","number","function","string","symbol"].forEach((t,a)=>{Ea[t]=function(s){return typeof s===t||"a"+(a<1?"n ":" ")+t}});const jr={};Ea.transitional=function(a,r,s){function n(l,o){return"[Axios v"+Ks+"] Transitional option '"+l+"'"+o+(s?". "+s:"")}return(l,o,c)=>{if(a===!1)throw new G(n(o," has been removed"+(r?" in "+r:"")),G.ERR_DEPRECATED);return r&&!jr[o]&&(jr[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),a?a(l,o,c):!0}};Ea.spelling=function(a){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${a}`),!0)};function cc(t,a,r){if(typeof t!="object")throw new G("options must be an object",G.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let n=s.length;for(;n-- >0;){const l=s[n],o=a[l];if(o){const c=t[l],y=c===void 0||o(c,l,t);if(y!==!0)throw new G("option "+l+" must be "+y,G.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new G("Unknown option "+l,G.ERR_BAD_OPTION)}}const Gt={assertOptions:cc,validators:Ea},Me=Gt.validators;let nt=class{constructor(a){this.defaults=a||{},this.interceptors={request:new Dr,response:new Dr}}async request(a,r){try{return await this._request(a,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(a,r){typeof a=="string"?(r=r||{},r.url=a):r=a||{},r=ct(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:l}=r;s!==void 0&&Gt.assertOptions(s,{silentJSONParsing:Me.transitional(Me.boolean),forcedJSONParsing:Me.transitional(Me.boolean),clarifyTimeoutError:Me.transitional(Me.boolean)},!1),n!=null&&(A.isFunction(n)?r.paramsSerializer={serialize:n}:Gt.assertOptions(n,{encode:Me.function,serialize:Me.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Gt.assertOptions(r,{baseUrl:Me.spelling("baseURL"),withXsrfToken:Me.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&A.merge(l.common,l[r.method]);l&&A.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),r.headers=ke.concat(o,l);const c=[];let y=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(y=y&&h.synchronous,c.unshift(h.fulfilled,h.rejected))});const m=[];this.interceptors.response.forEach(function(h){m.push(h.fulfilled,h.rejected)});let u,d=0,p;if(!y){const w=[Mr.bind(this),void 0];for(w.unshift(...c),w.push(...m),p=w.length,u=Promise.resolve(r);d<p;)u=u.then(w[d++],w[d++]);return u}p=c.length;let b=r;for(d=0;d<p;){const w=c[d++],h=c[d++];try{b=w(b)}catch(E){h.call(this,E);break}}try{u=Mr.call(this,b)}catch(w){return Promise.reject(w)}for(d=0,p=m.length;d<p;)u=u.then(m[d++],m[d++]);return u}getUri(a){a=ct(this.defaults,a);const r=js(a.baseURL,a.url,a.allowAbsoluteUrls);return Ts(r,a.params,a.paramsSerializer)}};A.forEach(["delete","get","head","options"],function(a){nt.prototype[a]=function(r,s){return this.request(ct(s||{},{method:a,url:r,data:(s||{}).data}))}});A.forEach(["post","put","patch"],function(a){function r(s){return function(l,o,c){return this.request(ct(c||{},{method:a,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}nt.prototype[a]=r(),nt.prototype[a+"Form"]=r(!0)});let ic=class Bs{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const s=this;this.promise.then(n=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](n);s._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(c=>{s.subscribe(c),l=c}).then(n);return o.cancel=function(){s.unsubscribe(l)},o},a(function(l,o,c){s.reason||(s.reason=new ft(l,o,c),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const r=this._listeners.indexOf(a);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const a=new AbortController,r=s=>{a.abort(s)};return this.subscribe(r),a.signal.unsubscribe=()=>this.unsubscribe(r),a.signal}static source(){let a;return{token:new Bs(function(n){a=n}),cancel:a}}};function mc(t){return function(r){return t.apply(null,r)}}function dc(t){return A.isObject(t)&&t.isAxiosError===!0}const Wa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Wa).forEach(([t,a])=>{Wa[a]=t});function Gs(t){const a=new nt(t),r=vs(nt.prototype.request,a);return A.extend(r,nt.prototype,a,{allOwnKeys:!0}),A.extend(r,a,null,{allOwnKeys:!0}),r.create=function(n){return Gs(ct(t,n))},r}const V=Gs(Ot);V.Axios=nt;V.CanceledError=ft;V.CancelToken=ic;V.isCancel=Ls;V.VERSION=Ks;V.toFormData=ha;V.AxiosError=G;V.Cancel=V.CanceledError;V.all=function(a){return Promise.all(a)};V.spread=mc;V.isAxiosError=dc;V.mergeConfig=ct;V.AxiosHeaders=ke;V.formToJSON=t=>_s(A.isHTMLForm(t)?new FormData(t):t);V.getAdapter=Vs.getAdapter;V.HttpStatusCode=Wa;V.default=V;const{Axios:Ti,AxiosError:Ii,CanceledError:_i,isCancel:Li,CancelToken:Mi,VERSION:ji,all:Ui,Cancel:qi,isAxiosError:$i,spread:Vi,toFormData:Ki,AxiosHeaders:Bi,HttpStatusCode:Gi,formToJSON:zi,getAdapter:Hi,mergeConfig:Wi}=V,uc=!0,ra="/api";console.log("🔧 API Configuration:",{VITE_API_URL:"/api",API_BASE_URL:ra,MODE:"production",PROD:!0,isProduction:uc,hostname:window.location.hostname});const Ne=V.create({baseURL:ra,timeout:15e3,headers:{"Content-Type":"application/json"}});Ne.interceptors.request.use(t=>{const a=localStorage.getItem("authToken");return a&&(t.headers.Authorization=`Bearer ${a}`),t});Ne.interceptors.response.use(t=>t,t=>{const a=t.response?.status,r=t.response?.data;if(typeof r=="string"&&r.includes("<!DOCTYPE html>")){const n=r.match(/<pre>(.*?)<\/pre>/),l=n?n[1]:"Server endpoint not found";console.error(`API Error (${a}):`,l),t.friendlyMessage=l,t.isEndpointMissing=a===404,t.message=l}else if(typeof r=="object"&&r!==null){const n=r.message||r.error||"Unknown server error";console.error(`API Error (${a}):`,n),t.friendlyMessage=n,t.message=n}else{const n=r||t.message||"Network error";console.error(`API Error (${a}):`,n),t.friendlyMessage=n}return Promise.reject(t)});const de={login:async t=>(await Ne.post("/auth/login",t)).data,register:async t=>(await Ne.post("/auth/register",t)).data,getProducts:async t=>{const a=t?`/marketplace/products?${t}`:"/products";return(await Ne.get(a)).data},getProduct:async t=>(await Ne.get(`/marketplace/products/${t}`)).data,getCategories:async()=>(await Ne.get("/marketplace/categories")).data,getCounties:async()=>(await Ne.get("/marketplace/counties")).data,getHealth:async()=>(await Ne.get("/status")).data,get:async t=>(console.log(`🔍 API GET: ${ra}${t}`),await Ne.get(t)),post:async(t,a)=>(console.log(`🔍 API POST: ${ra}${t}`),await Ne.post(t,a)),put:async(t,a)=>await Ne.put(t,a),delete:async t=>await Ne.delete(t),patch:async(t,a)=>await Ne.patch(t,a)},X=Es()(xs((t,a)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:async(r,s)=>{try{t({isLoading:!0}),console.log("🔑 Login attempt:",{phone:r});const n=await de.login({phone:r,password:s});console.log("✅ Login success:",n);const{user:l,token:o}=n;localStorage.setItem("token",o),t({user:l,token:o,isAuthenticated:!0,isLoading:!1})}catch(n){console.error("❌ Login error:",n),console.error("❌ Error message:",n.message),console.error("❌ Error response data:",n.response?.data),console.error("❌ Error status:",n.response?.status),console.error("❌ Error status text:",n.response?.statusText),console.error("❌ Error URL:",n.config?.url),console.error("❌ Error code:",n.code),console.error("❌ Error name:",n.name),console.error("❌ Full error object:",JSON.stringify(n,null,2)),t({isLoading:!1});let l="Login failed";throw n.code==="ERR_NETWORK"||n.name==="AxiosError"&&!n.response?l="Cannot connect to server. Please check if the backend is running.":n.code==="ECONNREFUSED"?l="Connection refused. Server may be down.":n.response?.status===401?l="Invalid phone number or password":n.response?.status===400?l=n.response.data?.error||"Invalid request":n.response?.data?.error?l=n.response.data.error:n.response?.data?.message?l=n.response.data.message:n.message&&n.message!=="[object Object]"&&(l=n.message),console.error("❌ Final error message:",l),new Error(l)}},loginWithData:(r,s)=>{localStorage.setItem("token",s),t({user:r,token:s,isAuthenticated:!0})},logout:()=>{localStorage.removeItem("token"),t({user:null,token:null,isAuthenticated:!1})},updateUser:r=>{t({user:r})}}),{name:"auth-storage",partialize:t=>({user:t.user,token:t.token,isAuthenticated:t.isAuthenticated})}));class gc extends C.Component{state={hasError:!1};static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("Error caught by boundary:",a,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},e.createElement("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center"},e.createElement("div",{className:"text-red-500 text-6xl mb-4"},"⚠️"),e.createElement("h1",{className:"text-xl font-semibold text-gray-900 mb-2"},"Something went wrong"),e.createElement("p",{className:"text-gray-600 mb-4"},this.state.error?.message||"An unexpected error occurred"),e.createElement("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"},"Reload Page"))):this.props.children}}const fc=()=>{window.addEventListener("unhandledrejection",t=>{}),window.addEventListener("error",t=>{})},me=t=>{const a=Number(t);return isNaN(a)||!isFinite(a)?0:a},pc=Es()(xs((t,a)=>({items:[],totalItems:0,totalAmount:0,addToCart:(r,s)=>{const n=a(),l=me(s),o=me(r.pricePerUnit);if(l<=0)return;if(n.items.find(y=>y.productId===r.id)){const y=n.items.map(d=>d.productId===r.id?{...d,quantity:me(d.quantity)+l}:d),m=y.reduce((d,p)=>d+me(p.quantity),0),u=y.reduce((d,p)=>d+me(p.pricePerUnit)*me(p.quantity),0);t({items:y,totalItems:m,totalAmount:u})}else{const y={id:`cart-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,productId:r.id||`product-${Date.now()}`,name:r.name||"Unknown Product",pricePerUnit:o,quantity:l,images:Array.isArray(r.images)?r.images:[],unit:r.unit||"kg"},m=[...n.items,y],u=m.reduce((p,b)=>p+me(b.quantity),0),d=m.reduce((p,b)=>p+me(b.pricePerUnit)*me(b.quantity),0);t({items:m,totalItems:u,totalAmount:d})}},removeFromCart:r=>{const n=a().items.filter(c=>c.id!==r),l=n.reduce((c,y)=>c+me(y.quantity),0),o=n.reduce((c,y)=>c+me(y.pricePerUnit)*me(y.quantity),0);t({items:n,totalItems:l,totalAmount:o})},updateQuantity:(r,s)=>{const n=a(),l=me(s);if(l<=0){a().removeFromCart(r);return}const o=n.items.map(m=>m.id===r?{...m,quantity:l}:m),c=o.reduce((m,u)=>m+me(u.quantity),0),y=o.reduce((m,u)=>m+me(u.pricePerUnit)*me(u.quantity),0);t({items:o,totalItems:c,totalAmount:y})},clearCart:()=>{t({items:[],totalItems:0,totalAmount:0})},refreshCart:()=>{const r=a(),s=r.items.reduce((l,o)=>l+me(o.quantity),0),n=r.items.reduce((l,o)=>l+me(o.pricePerUnit)*me(o.quantity),0);t({totalItems:s,totalAmount:n})}}),{name:"cart-storage",partialize:t=>({items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount})})),pt=()=>{const t=pc();return{cart:{items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount},addToCart:t.addToCart,removeFromCart:t.removeFromCart,updateQuantity:t.updateQuantity,clearCart:t.clearCart,refreshCart:t.refreshCart,isLoading:!1}};function yc(){const{isAuthenticated:t,user:a,logout:r}=X(),{cart:s}=pt(),n=_e(),[l,o]=C.useState(!1),c=()=>{r(),n("/"),o(!1)},y=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/"}},m=()=>{o(!1)};return e.createElement("nav",{className:"bg-white shadow-sm border-b sticky top-0 z-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"flex justify-between h-16"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{to:"/",className:"flex items-center space-x-2",onClick:m},e.createElement("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center overflow-hidden"},e.createElement("img",{src:"https://cdn.builder.io/api/v1/image/assets%2Fd9c4872a6831464dbf1ea37e56217255%2F25be9c7c97144293ad2d62bc18c010f8?format=webp&width=800",alt:"Zuasoko Logo",className:"w-full h-full object-contain"})),e.createElement("span",{className:"text-lg sm:text-xl font-bold text-gray-900"},"Zuasoko"))),e.createElement("div",{className:"hidden md:flex items-center space-x-6"},e.createElement(H,{to:"/marketplace",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(H,{to:y(),className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Dashboard"),e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("span",{className:"text-sm text-gray-600"},a?.firstName),e.createElement("button",{onClick:c,className:"text-gray-700 hover:text-red-600 p-2 rounded-md transition-colors"},e.createElement(dr,{className:"w-4 h-4"})))):e.createElement("div",{className:"flex items-center space-x-3"},e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement(H,{to:"/login",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Login"),e.createElement(H,{to:"/register",className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors"},"Register"))),e.createElement("div",{className:"md:hidden flex items-center space-x-3"},e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors",onClick:m},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("button",{onClick:()=>o(!l),className:"text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},l?e.createElement(xe,{className:"w-5 h-5"}):e.createElement(Xr,{className:"w-5 h-5"}))))),l&&e.createElement("div",{className:"md:hidden bg-white border-t border-gray-200"},e.createElement("div",{className:"px-2 pt-2 pb-3 space-y-1"},e.createElement(H,{to:"/",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(es,{className:"w-5 h-5"}),"Home"),e.createElement(H,{to:"/marketplace",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(ts,{className:"w-5 h-5"}),"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(H,{to:y(),className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(dn,{className:"w-5 h-5"}),"Dashboard"),e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2"},e.createElement("div",{className:"flex items-center gap-3 mb-3"},e.createElement("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement(Re,{className:"w-4 h-4 text-primary-600"})),e.createElement("div",null,e.createElement("div",{className:"text-sm font-medium text-gray-900"},a?.firstName," ",a?.lastName),e.createElement("div",{className:"text-xs text-gray-500 capitalize"},a?.role?.toLowerCase()))),e.createElement("button",{onClick:c,className:"flex items-center gap-3 w-full px-3 py-2 text-base font-medium text-red-600 hover:bg-red-50 rounded-md transition-colors"},e.createElement(dr,{className:"w-5 h-5"}),"Logout"))):e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2 space-y-2"},e.createElement(H,{to:"/login",className:"block w-full text-center px-4 py-3 text-base font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",onClick:m},"Login"),e.createElement(H,{to:"/register",className:"block w-full text-center px-4 py-3 text-base font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors",onClick:m},"Register")))))}function hc(){const{isAuthenticated:t,user:a}=X(),{cart:r}=pt(),s=Zr(),l=(()=>{const c=[{path:"/",icon:es,label:"Home",show:!0},{path:"/marketplace",icon:ts,label:"Shop",show:!0}];if(!t)return[...c,{path:"/cart",icon:$e,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/login",icon:Re,label:"Login",show:!0}];switch(a?.role){case"CUSTOMER":return[...c,{path:"/cart",icon:$e,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/customer/dashboard",icon:Re,label:"Account",show:!0}];case"FARMER":return[...c,{path:"/farmer/consignments",icon:dt,label:"Consign",show:!0},{path:"/farmer/wallet",icon:Re,label:"Wallet",show:!0}];case"DRIVER":return[...c,{path:"/driver/assignments",icon:re,label:"Transport",show:!0},{path:"/driver/warehouse",icon:Re,label:"Warehouse",show:!0}];case"ADMIN":return[...c,{path:"/admin/consignments",icon:dt,label:"Consign",show:!0},{path:"/admin/analytics",icon:Ya,label:"Analytics",show:!0}];default:return c}})().filter(c=>c.show),o=c=>!!(c==="/"&&s.pathname==="/"||c!=="/"&&s.pathname.startsWith(c));return e.createElement("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50"},e.createElement("div",{className:"grid grid-cols-4 py-1"},l.map(c=>{const y=c.icon,m=o(c.path);return e.createElement(H,{key:c.path,to:c.path,className:`flex flex-col items-center justify-center py-2 px-1 text-xs font-medium transition-colors ${m?"text-primary-600":"text-gray-500 hover:text-gray-700"}`},e.createElement("div",{className:"relative"},e.createElement(y,{className:`w-5 h-5 ${m?"text-primary-600":"text-gray-500"}`}),"badge"in c&&c.badge&&c.badge>0&&e.createElement("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center min-w-[16px]"},c.badge>99?"99+":c.badge)),e.createElement("span",{className:`mt-1 ${m?"text-primary-600":"text-gray-500"}`},c.label))})),e.createElement("div",{className:"h-safe-bottom bg-white"}))}function bc(){const[t,a]=C.useState({connected:!1,database:"checking...",loading:!0,error:!1});if(C.useEffect(()=>{const l=async()=>{try{const y=await(await fetch("/api/status")).json(),m=y.status==="OK"&&y.database==="connected",u=y.database_type||y.database;a({connected:m,database:u,loading:!1,error:!1})}catch(c){console.warn("Status check failed:",c.message),a({connected:!1,database:"error",loading:!1,error:!0})}};l();const o=setInterval(l,6e4);return()=>clearInterval(o)},[]),t.loading)return null;const r=t.database==="neon_postgresql"||t.connected,s=t.error||t.database.includes("error"),n=t.database==="demo"||!r&&!s;return e.createElement("div",{className:"fixed bottom-4 right-4 z-50"},e.createElement("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium shadow-lg transition-all duration-300 ${s?"bg-red-100 text-red-800 border border-red-200":r?"bg-green-100 text-green-800 border border-green-200":n?"bg-blue-100 text-blue-800 border border-blue-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`},s?e.createElement(e.Fragment,null,e.createElement(Ke,{className:"w-4 h-4"}),e.createElement("span",null,"API Error"),e.createElement(ur,{className:"w-4 h-4"})):r?e.createElement(e.Fragment,null,e.createElement(gr,{className:"w-4 h-4"}),e.createElement("span",null,"Neon DB Live"),e.createElement(as,{className:"w-4 h-4"})):e.createElement(e.Fragment,null,e.createElement(gr,{className:"w-4 h-4"}),e.createElement("span",null,"Demo Mode"),e.createElement(ur,{className:"w-4 h-4"}))))}const Ec=()=>{const[t,a]=C.useState(!1),[r,s]=C.useState(null),[n,l]=C.useState(!0),o="/downloads/zuasoko-app.apk",c=async()=>{try{const u=(await fetch(o,{method:"HEAD"})).ok;if(u)try{const d=await fetch("/downloads/app-info.json");if(d.ok){const p=await d.json();s(p)}}catch{console.log("App info not available, using defaults")}return a(u),u}catch(m){return console.error("Error checking APK availability:",m),a(!1),!1}},y=()=>{if(t){const m=document.createElement("a");m.href=o,m.download="zuasoko-app.apk",m.target="_blank",document.body.appendChild(m),m.click(),document.body.removeChild(m),window.gtag&&window.gtag("event","app_download",{event_category:"engagement",event_label:"android_apk",value:1});const u=new CustomEvent("show-toast",{detail:{message:"APK download started! Check your downloads folder.",type:"success"}});window.dispatchEvent(u)}};return C.useEffect(()=>{(async()=>{l(!0),await c(),l(!1)})()},[]),{isAvailable:t,appInfo:r,loading:n,downloadUrl:o,checkAvailability:c,downloadApp:y}},xc=({isOpen:t,onClose:a,appInfo:r,onDownload:s})=>{if(!t)return null;const n=l=>l.toLowerCase().includes("internet")?e.createElement(as,{className:"w-4 h-4"}):l.toLowerCase().includes("location")?e.createElement(Ie,{className:"w-4 h-4"}):l.toLowerCase().includes("camera")?e.createElement(rs,{className:"w-4 h-4"}):l.toLowerCase().includes("storage")?e.createElement(fr,{className:"w-4 h-4"}):l.toLowerCase().includes("notification")?e.createElement(lt,{className:"w-4 h-4"}):e.createElement(Ve,{className:"w-4 h-4"});return e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl"},e.createElement("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-4"},e.createElement("div",{className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center shadow-lg"},e.createElement(La,{className:"w-8 h-8 text-white"})),e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Zuasoko Mobile App"),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-600"},e.createElement("span",null,"Version ",r.version),e.createElement("span",null,"•"),e.createElement("span",null,r.size),e.createElement("span",null,"•"),e.createElement("span",null,"Android ",r.minAndroidVersion,"+")))),e.createElement("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},e.createElement(xe,{className:"w-6 h-6 text-gray-600"})))),e.createElement("div",{className:"p-6 space-y-8"},e.createElement("div",{className:"text-center"},e.createElement("button",{onClick:()=>{s(),a()},className:"bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center gap-3 mx-auto"},e.createElement(Ht,{className:"w-6 h-6"}),"Download APK (",r.size,")"),e.createElement("p",{className:"text-sm text-gray-600 mt-3"},"Released on"," ",new Date(r.releaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},e.createElement(Pt,{className:"w-5 h-5 text-yellow-500"}),"What's New in v",r.version),e.createElement("div",{className:"space-y-2"},r.releaseNotes.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg"},e.createElement(ae,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"Key Features"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},r.features.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement(ae,{className:"w-4 h-4 text-primary-600 mt-1 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700 text-sm"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"System Requirements"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("div",{className:"p-4 bg-blue-50 rounded-lg text-center"},e.createElement(La,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Android Version"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.android)),e.createElement("div",{className:"p-4 bg-green-50 rounded-lg text-center"},e.createElement(fr,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Storage"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.storage)),e.createElement("div",{className:"p-4 bg-purple-50 rounded-lg text-center"},e.createElement(oe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"RAM"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.ram)))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"App Permissions"),e.createElement("div",{className:"space-y-3"},r.permissions.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg flex-shrink-0"},n(l)),e.createElement("div",null,e.createElement("div",{className:"font-medium text-gray-900"},l.split(" - ")[0]),l.includes(" - ")&&e.createElement("div",{className:"text-sm text-gray-600 mt-1"},l.split(" - ")[1])))))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start gap-3"},e.createElement(Ve,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-yellow-800 mb-2"},"Security Notice"),e.createElement("p",{className:"text-sm text-yellow-700"},'This APK is signed and verified by Zuasoko. Before installing, make sure to enable "Install from unknown sources" in your Android settings. Only download from this official source to ensure security and authenticity.')))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h4",{className:"font-semibold text-blue-800 mb-3"},"Installation Instructions"),e.createElement("ol",{className:"text-sm text-blue-700 space-y-2"},e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"1"),"Download the APK file by clicking the download button above"),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"2"),'Go to Settings → Security → Enable "Unknown Sources" or "Install unknown apps"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"3"),'Open the downloaded APK file and tap "Install"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"4"),"Open the Zuasoko app and log in with your account"))))))};function vc(){const{isAuthenticated:t,user:a}=X(),[r,s]=C.useState(!1),[n,l]=C.useState(!1),{isAvailable:o,appInfo:c,loading:y,downloadApp:m}=Ec(),u=[{icon:e.createElement(Qe,{className:"w-8 h-8 text-primary-600"}),title:"Fresh Produce",description:"Direct from farmers to your table, ensuring maximum freshness and quality."},{icon:e.createElement(Pe,{className:"w-8 h-8 text-primary-600"}),title:"Support Farmers",description:"Help local farmers get fair prices for their hard work and dedication."},{icon:e.createElement(re,{className:"w-8 h-8 text-primary-600"}),title:"Fast Delivery",description:"Quick and reliable delivery service to get your orders to you fresh."},{icon:e.createElement(Pt,{className:"w-8 h-8 text-primary-600"}),title:"Quality Assured",description:"All produce is quality-checked before delivery to ensure satisfaction."}],d=[{icon:e.createElement(lt,{className:"w-6 h-6 text-primary-600"}),title:"Push Notifications",description:"Stay updated on orders, deliveries, and fresh produce availability"},{icon:e.createElement(Ie,{className:"w-6 h-6 text-primary-600"}),title:"Live Tracking",description:"Track your deliveries in real-time from farm to your doorstep"},{icon:e.createElement(oe,{className:"w-6 h-6 text-primary-600"}),title:"Quick Orders",description:"Reorder your favorites with just one tap"},{icon:e.createElement(Fe,{className:"w-6 h-6 text-primary-600"}),title:"Mobile Payments",description:"Secure M-Pesa integration for seamless transactions"}],p=[{role:"Admin",phone:"+254712345678",description:"Manage users, approve farmers, view analytics",icon:e.createElement(Ve,{className:"w-5 h-5"}),color:"bg-red-100 text-red-800 border-red-200"},{role:"Farmer",phone:"+254734567890",description:"Create consignments, manage produce listings",icon:e.createElement(Qe,{className:"w-5 h-5"}),color:"bg-green-100 text-green-800 border-green-200"},{role:"Customer",phone:"+254756789012",description:"Browse marketplace, place orders, track deliveries",icon:e.createElement(Pe,{className:"w-5 h-5"}),color:"bg-blue-100 text-blue-800 border-blue-200"},{role:"Driver",phone:"+254778901234",description:"Manage deliveries, update delivery status",icon:e.createElement(re,{className:"w-5 h-5"}),color:"bg-purple-100 text-purple-800 border-purple-200"}],b=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/marketplace"}};return e.createElement("div",{className:"min-h-screen bg-white"},e.createElement("section",{className:"bg-gradient-to-br from-primary-50 to-primary-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6"},"Welcome to ",e.createElement("span",{className:"text-primary-600"},"Zuasoko")),e.createElement("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto"},"Connecting farmers and customers across Kenya. Fresh produce, fair prices, and sustainable agriculture for everyone."),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8"},t?e.createElement(H,{to:b(),className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Go to Dashboard"):e.createElement(e.Fragment,null,e.createElement(H,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Browse Marketplace"),e.createElement(H,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold border-2 border-primary-600 hover:bg-primary-50 transition-colors"},"Join Now"))),!t&&e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("button",{onClick:()=>s(!r),className:"flex items-center justify-center gap-2 mx-auto text-sm text-gray-600 hover:text-gray-800 transition-colors"},e.createElement(un,{className:"w-4 h-4"}),e.createElement("span",null,"View Demo Credentials"),r?e.createElement(gn,{className:"w-4 h-4"}):e.createElement(fn,{className:"w-4 h-4"})),r&&e.createElement("div",{className:"mt-4 p-4 bg-white rounded-lg border border-gray-200 shadow-sm"},e.createElement("h3",{className:"text-sm font-semibold text-gray-900 mb-3 text-center"},"Demo Account Access"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},p.map((w,h)=>e.createElement("div",{key:h,className:`p-3 rounded-lg border ${w.color} text-xs`},e.createElement("div",{className:"flex items-center gap-2 mb-1"},w.icon,e.createElement("span",{className:"font-semibold"},w.role)),e.createElement("div",{className:"font-mono text-xs mb-1"},w.phone),e.createElement("div",{className:"text-xs opacity-80"},w.description)))),e.createElement("div",{className:"text-center mt-3 text-xs text-gray-600"},"Password for all accounts:"," ",e.createElement("span",{className:"font-mono font-semibold"},"password123")),e.createElement("div",{className:"text-center mt-2"},e.createElement(H,{to:"/login",className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 font-medium"},e.createElement(Ve,{className:"w-3 h-3"}),"Login to any demo account"))))))),e.createElement("section",{className:"py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center mb-16"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Why Choose Zuasoko?"),e.createElement("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto"},"We're revolutionizing agriculture in Kenya by creating direct connections between farmers and customers.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},u.map((w,h)=>e.createElement("div",{key:h,className:"text-center p-6 rounded-lg border border-gray-200 hover:shadow-lg transition-shadow"},e.createElement("div",{className:"flex justify-center mb-4"},w.icon),e.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2"},w.title),e.createElement("p",{className:"text-gray-600"},w.description)))))),e.createElement("section",{className:"bg-gradient-to-br from-gray-50 to-gray-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"},e.createElement("div",{className:"space-y-8"},e.createElement("div",{className:"text-center lg:text-left"},e.createElement("div",{className:"inline-flex items-center gap-2 bg-primary-100 text-primary-700 px-4 py-2 rounded-full text-sm font-medium mb-4"},e.createElement(La,{className:"w-4 h-4"}),"Now Available on Mobile"),e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Take Zuasoko"," ",e.createElement("span",{className:"text-primary-600"},"Anywhere")),e.createElement("p",{className:"text-xl text-gray-600 mb-8"},"Access fresh produce, manage your farm, or track deliveries on the go. Our mobile app brings the complete Zuasoko experience to your smartphone.")),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start"},e.createElement("button",{onClick:()=>{o?m():alert(`Android app coming soon! 🚀

We're putting the finishing touches on our mobile app. Stay tuned for the official release!`)},disabled:y,className:`group px-6 py-3 rounded-xl flex items-center gap-3 transition-all duration-300 transform hover:scale-105 shadow-lg ${o?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-900 hover:bg-gray-800 text-white"} ${y?"opacity-50 cursor-not-allowed":""}`},e.createElement("div",{className:"bg-white p-1 rounded"},y?e.createElement("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"}):e.createElement(pn,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},o?"DOWNLOAD":"GET IT ON"),e.createElement("div",{className:"text-lg font-semibold"},o?"Direct APK":"Google Play"),o&&c&&e.createElement("div",{className:"text-xs text-gray-300"},"v",c.version," • ",c.size)),e.createElement(Ht,{className:"w-4 h-4 ml-2 group-hover:animate-bounce"}),o&&e.createElement("div",{className:"bg-green-400 text-green-900 px-2 py-1 rounded text-xs font-bold ml-2"},"READY")),e.createElement("a",{href:"#",className:"group bg-gray-900 text-white px-6 py-3 rounded-xl flex items-center gap-3 hover:bg-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg opacity-60 cursor-not-allowed",onClick:w=>{w.preventDefault(),alert(`iOS app coming soon! 🍎

We're working hard to bring Zuasoko to the App Store. Keep an eye out for updates!`)}},e.createElement("div",{className:"bg-white p-1 rounded"},e.createElement(yn,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},"Download on the"),e.createElement("div",{className:"text-lg font-semibold"},"App Store")),e.createElement("div",{className:"bg-yellow-500 text-yellow-900 px-2 py-1 rounded text-xs font-bold ml-2"},"SOON"))),o&&c&&e.createElement("div",{className:"text-center mt-6"},e.createElement("button",{onClick:()=>l(!0),className:"text-primary-600 hover:text-primary-700 font-medium text-sm border border-primary-300 hover:border-primary-500 px-4 py-2 rounded-lg transition-colors"},"View App Details & Permissions")),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4"},d.map((w,h)=>e.createElement("div",{key:h,className:"flex items-start gap-3 p-4 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex-shrink-0 p-2 bg-primary-50 rounded-lg"},w.icon),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},w.title),e.createElement("p",{className:"text-sm text-gray-600"},w.description)))))),e.createElement("div",{className:"relative"},e.createElement("div",{className:"relative mx-auto w-64 h-96 lg:w-80 lg:h-[480px]"},e.createElement("div",{className:"absolute inset-0 bg-gray-900 rounded-[2.5rem] shadow-2xl"},e.createElement("div",{className:"absolute inset-2 bg-white rounded-[2rem] overflow-hidden"},e.createElement("div",{className:"bg-primary-600 h-8 flex items-center justify-between px-4"},e.createElement("div",{className:"text-white text-xs font-medium"},"9:41"),e.createElement("div",{className:"flex items-center gap-1"},e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}))),e.createElement("div",{className:"p-4 space-y-4"},e.createElement("div",{className:"flex items-center gap-3 mb-6"},e.createElement("div",{className:"w-10 h-10 bg-primary-600 rounded-xl flex items-center justify-center"},e.createElement(Qe,{className:"w-6 h-6 text-white"})),e.createElement("div",null,e.createElement("div",{className:"font-bold text-gray-900"},"Zuasoko"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from farm"))),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-green-200 rounded-lg flex items-center justify-center"},e.createElement(Qe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Organic Tomatoes"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from Nakuru"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 120/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-orange-200 rounded-lg flex items-center justify-center"},e.createElement(Qe,{className:"w-6 h-6 text-orange-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Fresh Carrots"),e.createElement("div",{className:"text-xs text-gray-500"},"Direct from farm"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 80/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-purple-200 rounded-lg flex items-center justify-center"},e.createElement(Qe,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Spinach Bunch"),e.createElement("div",{className:"text-xs text-gray-500"},"Locally grown"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 50/bunch")))),e.createElement("div",{className:"absolute bottom-4 left-4 right-4 bg-white border border-gray-200 rounded-lg p-2"},e.createElement("div",{className:"flex justify-around"},e.createElement("div",{className:"p-2 bg-primary-600 rounded-lg"},e.createElement(Qe,{className:"w-4 h-4 text-white"})),e.createElement("div",{className:"p-2"},e.createElement(Ie,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(lt,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(Pe,{className:"w-4 h-4 text-gray-400"})))))))),e.createElement("div",{className:"mt-8 text-center"},e.createElement("div",{className:"inline-block p-4 bg-white rounded-xl shadow-lg border border-gray-200"},e.createElement("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center mb-3"},e.createElement(hn,{className:"w-12 h-12 text-gray-600"})),e.createElement("div",{className:"text-sm font-medium text-gray-900 mb-1"},"Scan to Download"),e.createElement("div",{className:"text-xs text-gray-500"},"Coming Soon"))),e.createElement("div",{className:"absolute -top-4 -left-4 w-8 h-8 bg-primary-200 rounded-full animate-pulse"}),e.createElement("div",{className:"absolute -bottom-8 -right-8 w-12 h-12 bg-green-200 rounded-full animate-pulse delay-300"}),e.createElement("div",{className:"absolute top-1/2 -right-6 w-6 h-6 bg-yellow-200 rounded-full animate-pulse delay-700"}))))),t&&a?.role==="ADMIN"&&e.createElement("section",{className:"bg-red-50 py-12"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"inline-flex items-center gap-2 mb-4"},e.createElement(Ve,{className:"w-6 h-6 text-red-600"}),e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Admin Dashboard")),e.createElement("p",{className:"text-gray-600 mb-6"},"Welcome back, Administrator. Manage your platform efficiently."),e.createElement("div",{className:"flex flex-wrap justify-center gap-4"},e.createElement(H,{to:"/admin/dashboard",className:"bg-red-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors"},"View Dashboard"),e.createElement(H,{to:"/admin/users",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"Manage Users"),e.createElement(H,{to:"/admin/analytics",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"View Analytics"))))),e.createElement("section",{className:"bg-primary-600 py-16"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4"},"Ready to Get Started?"),e.createElement("p",{className:"text-xl text-primary-100 mb-8 max-w-2xl mx-auto"},"Join thousands of farmers and customers who are already part of the Zuasoko community."),!t&&e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},e.createElement(H,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-colors"},"Register Now"),e.createElement(H,{to:"/login",className:"bg-transparent text-white px-8 py-3 rounded-lg text-lg font-semibold border-2 border-white hover:bg-white hover:text-primary-600 transition-colors"},"Login")))),n&&c&&e.createElement(xc,{isOpen:n,onClose:()=>l(!1),appInfo:c,onDownload:m}))}function Nc(){const[t,a]=C.useState([]),[r,s]=C.useState([]),[n,l]=C.useState([]),[o,c]=C.useState(!0),[y,m]=C.useState({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1}),[u,d]=C.useState(!1),[p,b]=C.useState({page:1,limit:12,total:0,totalPages:0}),{addToCart:w,isLoading:h}=pt(),{user:E,isAuthenticated:x}=X(),v=async(k=1)=>{try{c(!0),console.log("🔍 FETCHING PRODUCTS - Page:",k,"Filters:",y);const L=new URLSearchParams({page:k.toString(),limit:p.limit.toString(),...y.category&&{category:y.category},...y.county&&{county:y.county},...y.search&&{search:y.search},...y.minPrice&&{minPrice:y.minPrice},...y.maxPrice&&{maxPrice:y.maxPrice},...y.featured&&{featured:"true"}}),g=await de.getProducts(L);console.log("🔍 PRODUCTS RESPONSE:",g);const I=g.products||g||[];a(Array.isArray(I)?I:[]),g.pagination?b(M=>({...M,...g.pagination,page:k})):b(M=>({...M,page:k,total:g.products?.length||g.length||0,totalPages:1}))}catch(L){console.error("❌ FAILED TO FETCH PRODUCTS:",L),P.error("Failed to load products - using demo data"),a([]),b(g=>({...g,page:k,total:0,totalPages:1}))}finally{c(!1)}},D=async()=>{try{console.log("🔍 FETCHING METADATA from real database");const[k,L]=await Promise.all([de.getCategories(),de.getCounties()]);console.log("🔍 CATEGORIES RESPONSE:",k),console.log("🔍 COUNTIES RESPONSE:",L),s(k.categories||k||[]),l(L.counties||L||[])}catch(k){console.error("❌ FAILED TO FETCH METADATA:",k),P.error("Failed to load categories and counties from database")}};C.useEffect(()=>{D()},[]),C.useEffect(()=>{v(1)},[y]);const S=(k,L)=>{m(g=>({...g,[k]:L}))},R=k=>{try{w(k,1),P.success(`Added ${k.name} to cart`)}catch(L){console.error("Failed to add to cart:",L),P.error("Failed to add item to cart")}},O=()=>{m({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1})},j=k=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(k);return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Fresh Marketplace"),e.createElement("p",{className:"text-gray-600"},"Discover fresh produce directly from local farmers")),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:space-x-4 space-y-4 lg:space-y-0"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ca,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.createElement("input",{type:"text",placeholder:"Search products...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:y.search,onChange:k=>S("search",k.target.value)}))),e.createElement("div",{className:"flex flex-wrap gap-2"},e.createElement("button",{onClick:()=>S("featured",!y.featured),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${y.featured?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},e.createElement(Pt,{className:`w-4 h-4 inline mr-1 ${y.featured?"fill-current":""}`}),"Featured"),e.createElement("button",{onClick:()=>d(!u),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm font-medium transition-colors"},e.createElement(bn,{className:"w-4 h-4 inline mr-1"}),"Filters"))),u&&e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:y.category,onChange:k=>S("category",k.target.value)},e.createElement("option",{value:""},"All Categories"),r.map(k=>e.createElement("option",{key:k,value:k},k)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:y.county,onChange:k=>S("county",k.target.value)},e.createElement("option",{value:""},"All Counties"),n.map(k=>e.createElement("option",{key:k,value:k},k)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Min Price (KES)"),e.createElement("input",{type:"number",placeholder:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:y.minPrice,onChange:k=>S("minPrice",k.target.value)})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Max Price (KES)"),e.createElement("input",{type:"number",placeholder:"1000",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:y.maxPrice,onChange:k=>S("maxPrice",k.target.value)}))),e.createElement("div",{className:"mt-4 flex justify-end"},e.createElement("button",{onClick:O,className:"text-gray-600 hover:text-gray-900 text-sm font-medium"},"Clear All Filters")))),e.createElement("div",{className:"flex justify-between items-center mb-6"},e.createElement("p",{className:"text-gray-600"},o?"Loading...":`Showing ${t.length} of ${p.total} products`),p.totalPages>1&&e.createElement("div",{className:"text-sm text-gray-600"},"Page ",p.page," of ",p.totalPages)),o?e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},[...Array(8)].map((k,L)=>e.createElement("div",{key:L,className:"bg-white rounded-lg shadow-sm border overflow-hidden animate-pulse"},e.createElement("div",{className:"h-48 bg-gray-200"}),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-6 bg-gray-200 rounded"}))))):t.length===0?e.createElement("div",{className:"text-center py-16"},e.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🛒"),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-6"},"Try adjusting your search or filter criteria"),e.createElement("button",{onClick:O,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Clear Filters")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Array.isArray(t)&&t.map(k=>e.createElement("div",{key:k.id,className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"relative h-48 bg-gray-200"},k.images&&k.images.length>0?e.createElement("img",{src:k.images[0],alt:k.name,className:"w-full h-full object-cover",onError:L=>{L.currentTarget.src="/api/placeholder/300/200?text="+encodeURIComponent(k.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement(Be,{className:"w-8 h-8 mx-auto mb-2"}),e.createElement("span",{className:"text-sm"},k.name))),(k.isFeatured||k.is_featured)&&e.createElement("div",{className:"absolute top-2 left-2 bg-yellow-400 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},"⭐ Featured"),(k.stockQuantity||k.stock_quantity)<10&&(k.stockQuantity||k.stock_quantity)>0&&e.createElement("div",{className:"absolute top-2 right-2 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium"},"Low Stock"),(k.stockQuantity||k.stock_quantity)===0&&e.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},e.createElement("span",{className:"text-white font-medium"},"Out of Stock"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 text-sm line-clamp-2"},k.name),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors ml-2"},e.createElement(Za,{className:"w-4 h-4"}))),e.createElement("p",{className:"text-gray-600 text-xs mb-2 line-clamp-2"},k.description),e.createElement("div",{className:"flex items-center text-xs text-gray-500 mb-3"},e.createElement(Ie,{className:"w-3 h-3 mr-1"}),e.createElement("span",null,k.farmer?.county||k.farmer_county||"Unknown"),e.createElement("span",{className:"mx-2"},"•"),e.createElement("span",null,k.farmer?.user?.firstName||k.farmer_name||"Farmer"," ",k.farmer?.user?.lastName||"")),k.tags&&k.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},k.tags.slice(0,3).map(L=>e.createElement("span",{key:L,className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs"},L))),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("div",{className:"text-lg font-bold text-gray-900"},j(k.pricePerUnit||k.price_per_unit)),e.createElement("div",{className:"text-xs text-gray-500"},"per ",k.unit)),e.createElement("div",{className:"flex space-x-2"},e.createElement(H,{to:`/marketplace/product/${k.id}`,className:"bg-gray-100 text-gray-700 px-2 py-2 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium flex items-center"},e.createElement(Be,{className:"w-4 h-4"})),(k.stockQuantity||k.stock_quantity)>0?e.createElement("button",{onClick:()=>R(k),disabled:h,className:"bg-primary-600 text-white px-3 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors text-sm font-medium flex items-center space-x-1"},e.createElement($e,{className:"w-4 h-4"}),e.createElement("span",null,"Add to Cart")):e.createElement("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-3 py-2 rounded-lg text-sm font-medium flex items-center space-x-1 cursor-not-allowed"},e.createElement("span",null,"Out of Stock")))))))),p.totalPages>1&&e.createElement("div",{className:"mt-8 flex justify-center"},e.createElement("div",{className:"flex space-x-1"},e.createElement("button",{onClick:()=>v(p.page-1),disabled:p.page===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Previous"),[...Array(Math.min(5,p.totalPages))].map((k,L)=>{const g=Math.max(1,p.page-2)+L;return g>p.totalPages?null:e.createElement("button",{key:g,onClick:()=>v(g),className:`px-3 py-2 text-sm font-medium border rounded-md ${g===p.page?"bg-primary-600 text-white border-primary-600":"text-gray-500 bg-white border-gray-300 hover:bg-gray-50"}`},g)}),e.createElement("button",{onClick:()=>v(p.page+1),disabled:p.page===p.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Next"))))}function wc(){const{id:t}=on(),a=_e(),[r,s]=C.useState(null),[n,l]=C.useState([]),[o,c]=C.useState(!0),[y,m]=C.useState(0),[u,d]=C.useState(1),[p,b]=C.useState(!1),{addToCart:w,isLoading:h}=pt(),{user:E,isAuthenticated:x}=X();C.useEffect(()=>{t&&v()},[t]);const v=async()=>{try{c(!0);const g=await V.get(`/api/marketplace/products/${t}`),I=g.data.product||g.data;s(I),I&&D(I.category,I.farmer.county)}catch(g){console.error("Failed to fetch product:",g),g.response?.status===404?(P.error("Product not found"),a("/marketplace")):P.error("Failed to load product details")}finally{c(!1)}},D=async(g,I)=>{try{const M=await V.get(`/api/marketplace/products?category=${g}&county=${I}&limit=4`),U=M.data.products||M.data;l(U.filter(K=>K.id!==t))}catch(M){console.error("Failed to fetch related products:",M)}},S=async()=>{if(!x){P.error("Please login to add items to cart");return}if(E?.role!=="CUSTOMER"){P.error("Only customers can add items to cart");return}if(r)try{await w(r.id,u),d(1)}catch{}},R=async()=>{if(navigator.share)try{await navigator.share({title:r?.name,text:r?.description,url:window.location.href})}catch(g){console.log("Error sharing:",g)}else navigator.clipboard.writeText(window.location.href),P.success("Link copied to clipboard!")},O=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g),j=g=>new Date(g).toLocaleDateString("en-KE",{year:"numeric",month:"long",day:"numeric"}),k=()=>r?r.stockQuantity===0?{text:"Out of Stock",color:"text-red-600",bgColor:"bg-red-100"}:r.stockQuantity<=(r.minStockLevel||5)?{text:"Low Stock",color:"text-orange-600",bgColor:"bg-orange-100"}:{text:"In Stock",color:"text-green-600",bgColor:"bg-green-100"}:null;if(o)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-3/4"}),e.createElement("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.createElement("div",{className:"h-12 bg-gray-200 rounded w-1/3"}),e.createElement("div",{className:"h-32 bg-gray-200 rounded"})))));if(!r)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Product not found"),e.createElement(H,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 mt-4 inline-block"},"Back to Marketplace")));const L=k();return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-8"},e.createElement(H,{to:"/marketplace",className:"hover:text-gray-900"},"Marketplace"),e.createElement("span",null,"/"),e.createElement("span",{className:"text-gray-900"},r.name)),e.createElement("button",{onClick:()=>a(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Back"),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12"},e.createElement("div",null,e.createElement("div",{className:"aspect-square bg-gray-200 rounded-lg overflow-hidden mb-4"},r.images&&r.images.length>0?e.createElement("img",{src:r.images[y]||r.images[0],alt:r.name,className:"w-full h-full object-cover",onError:g=>{g.currentTarget.src="/api/placeholder/400/400?text="+encodeURIComponent(r.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-4xl mb-2"},"📦"),e.createElement("span",null,r.name)))),r.images&&r.images.length>1&&e.createElement("div",{className:"grid grid-cols-4 gap-2"},r.images.slice(0,4).map((g,I)=>e.createElement("button",{key:I,onClick:()=>m(I),className:`aspect-square bg-gray-200 rounded-lg overflow-hidden border-2 ${y===I?"border-primary-600":"border-transparent"}`},e.createElement("img",{src:g,alt:`${r.name} ${I+1}`,className:"w-full h-full object-cover",onError:M=>{M.currentTarget.src="/api/placeholder/100/100?text="+(I+1)}}))))),e.createElement("div",null,e.createElement("div",{className:"flex items-start justify-between mb-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},r.name),e.createElement("p",{className:"text-gray-600"},r.category)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:R,className:"p-2 text-gray-400 hover:text-gray-600 border border-gray-300 rounded-lg"},e.createElement(En,{className:"w-5 h-5"})),e.createElement("button",{className:"p-2 text-gray-400 hover:text-red-500 border border-gray-300 rounded-lg"},e.createElement(Za,{className:"w-5 h-5"})))),e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"text-3xl font-bold text-gray-900 mb-2"},O(r.pricePerUnit),e.createElement("span",{className:"text-lg font-normal text-gray-600 ml-2"},"per ",r.unit)),L&&e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${L.bgColor} ${L.color}`},L.text),e.createElement("span",{className:"text-gray-600 text-sm"},r.stockQuantity," ",r.unit," available"))),e.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},r.isFeatured&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium"},"⭐ Featured"),r.tags.map(g=>e.createElement("span",{key:g,className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm"},g))),e.createElement("div",{className:"mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Description"),e.createElement("p",{className:"text-gray-700 leading-relaxed"},r.description)),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg"},r.harvestDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Harvest Date"),e.createElement("p",{className:"text-gray-900"},j(r.harvestDate))),r.expiryDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Best Before"),e.createElement("p",{className:"text-gray-900"},j(r.expiryDate))),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Category"),e.createElement("p",{className:"text-gray-900"},r.category)),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Unit"),e.createElement("p",{className:"text-gray-900"},r.unit))),x&&E?.role==="CUSTOMER"&&r.stockQuantity>0&&e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"flex items-center space-x-4 mb-4"},e.createElement("label",{className:"text-sm font-medium text-gray-700"},"Quantity:"),e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>d(Math.max(1,u-1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"-"),e.createElement("input",{type:"number",min:"1",max:r.stockQuantity,value:u,onChange:g=>d(Math.max(1,parseInt(g.target.value)||1)),className:"w-16 px-2 py-2 text-center border-0 focus:ring-0"}),e.createElement("button",{onClick:()=>d(Math.min(r.stockQuantity,u+1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"+")),e.createElement("span",{className:"text-sm text-gray-600"},"Total: ",O(r.pricePerUnit*u))),e.createElement("button",{onClick:S,disabled:h,className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors font-medium flex items-center justify-center"},e.createElement($e,{className:"w-5 h-5 mr-2"}),"Add to Cart")),e.createElement("div",{className:"border-t border-gray-200 pt-6"},e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(re,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Free delivery over KES 1000")),e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Delivered within 24h")),e.createElement("div",{className:"flex items-center"},e.createElement(Ve,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Quality guaranteed")))))),e.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"About the Farmer"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("div",{className:"flex items-center mb-3"},e.createElement("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mr-4"},e.createElement("span",{className:"text-primary-600 font-semibold text-lg"},r.farmer.user.firstName[0],r.farmer.user.lastName[0])),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900"},r.farmer.user.firstName," ",r.farmer.user.lastName),r.farmer.farmName&&e.createElement("p",{className:"text-gray-600 text-sm"},r.farmer.farmName))),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},r.farmer.subCounty?`${r.farmer.subCounty}, `:"",r.farmer.county)),r.farmer.farmSize&&e.createElement("div",null,e.createElement("span",{className:"text-gray-600"},"Farm Size: ",r.farmer.farmSize," acres")))),e.createElement("div",null,e.createElement("button",{onClick:()=>b(!p),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium mb-4"},"Contact Farmer"),p&&e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(He,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`tel:${r.farmer.user.phone}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.phone)),r.farmer.user.email&&e.createElement("div",{className:"flex items-center"},e.createElement(ia,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`mailto:${r.farmer.user.email}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.email)))))),n.length>0&&e.createElement("div",null,e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-6"},"Related Products"),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},n.map(g=>e.createElement(H,{key:g.id,to:`/marketplace/product/${g.id}`,className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"aspect-square bg-gray-200"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src="/api/placeholder/200/200?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},"📦")),e.createElement("div",{className:"p-4"},e.createElement("h4",{className:"font-semibold text-gray-900 text-sm mb-1 line-clamp-2"},g.name),e.createElement("p",{className:"text-xs text-gray-600 mb-2"},g.farmer.county," •"," ",g.farmer.user.firstName," ",g.farmer.user.lastName),e.createElement("div",{className:"text-lg font-bold text-gray-900"},O(g.pricePerUnit),e.createElement("span",{className:"text-xs font-normal text-gray-600 ml-1"},"/",g.unit))))))))}function Sc(){const[t,a]=C.useState({phone:"",password:""}),[r,s]=C.useState(!1),{login:n,isLoading:l}=X(),o=_e(),y=Zr().state?.from?.pathname||"/",m=async d=>{d.preventDefault();try{const p=t.phone.trim(),b=t.password.trim();console.log("🔍 LoginPage - About to call login with:",{phone:p,password:b,formData:t}),await n(p,b),P.success("Login successful!");const{user:w}=X.getState();w?.role==="ADMIN"?o("/admin/dashboard",{replace:!0}):w?.role==="FARMER"?o("/farmer/dashboard",{replace:!0}):w?.role==="CUSTOMER"?o("/customer/dashboard",{replace:!0}):w?.role==="DRIVER"?o("/driver/dashboard",{replace:!0}):o(y,{replace:!0})}catch(p){P.error(p.message||"Login failed")}},u=d=>{a({...t,[d.target.name]:d.target.value})};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Sign in to your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(H,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500"},"create a new account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("form",{className:"space-y-6",onSubmit:m},e.createElement("div",null,e.createElement("label",{htmlFor:"phone",className:"form-label"},"Phone Number"),e.createElement("input",{id:"phone",name:"phone",type:"tel",required:!0,placeholder:"e.g., +254712345678 or 0712345678",className:"form-input",value:t.phone,onChange:u})),e.createElement("div",null,e.createElement("label",{htmlFor:"password",className:"form-label"},"Password"),e.createElement("div",{className:"relative"},e.createElement("input",{id:"password",name:"password",type:r?"text":"password",required:!0,className:"form-input pr-10",value:t.password,onChange:u}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!r)},r?e.createElement(Wt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Be,{className:"h-5 w-5 text-gray-400"})))),e.createElement("div",null,e.createElement("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},l?"Signing in...":"Sign in"))),e.createElement("div",{className:"mt-6"},e.createElement("button",{type:"button",onClick:()=>{a({phone:"+254712345678",password:"password123"}),m({preventDefault:()=>{}})},className:"w-full mb-4 bg-green-600 text-white py-2 px-4 rounded-md text-sm font-medium hover:bg-green-700"},"🧪 Test Admin Login (+254712345678 / password123)"),e.createElement("div",{className:"relative"},e.createElement("div",{className:"absolute inset-0 flex items-center"},e.createElement("div",{className:"w-full border-t border-gray-300"})),e.createElement("div",{className:"relative flex justify-center text-sm"},e.createElement("span",{className:"px-2 bg-white text-gray-500"},"Demo Accounts"))),e.createElement("div",{className:"mt-4 space-y-2 text-xs text-gray-600"},e.createElement("p",null,e.createElement("strong",null,"Admin:")," +254712345678 / password123"),e.createElement("p",null,e.createElement("strong",null,"Farmer:")," +254734567890 / password123"),e.createElement("p",null,e.createElement("strong",null,"Customer:")," +254756789012 / password123"),e.createElement("p",null,e.createElement("strong",null,"Driver:")," +254778901234 / password123"))))))}var Tt=t=>t.type==="checkbox",st=t=>t instanceof Date,be=t=>t==null;const zs=t=>typeof t=="object";var le=t=>!be(t)&&!Array.isArray(t)&&zs(t)&&!st(t),kc=t=>le(t)&&t.target?Tt(t.target)?t.target.checked:t.target.value:t,Cc=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Pc=(t,a)=>t.has(Cc(a)),Ac=t=>{const a=t.constructor&&t.constructor.prototype;return le(a)&&a.hasOwnProperty("isPrototypeOf")},sr=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ue(t){let a;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)a=new Date(t);else if(!(sr&&(t instanceof Blob||s))&&(r||le(t)))if(a=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!Ac(t))a=t;else for(const n in t)t.hasOwnProperty(n)&&(a[n]=ue(t[n]));else return t;return a}var xa=t=>/^\w*$/.test(t),ie=t=>t===void 0,nr=t=>Array.isArray(t)?t.filter(Boolean):[],lr=t=>nr(t.replace(/["|']|\]/g,"").split(/\.|\[/)),q=(t,a,r)=>{if(!a||!le(t))return r;const s=(xa(a)?[a]:lr(a)).reduce((n,l)=>be(n)?n:n[l],t);return ie(s)||s===t?ie(t[a])?r:t[a]:s},je=t=>typeof t=="boolean",te=(t,a,r)=>{let s=-1;const n=xa(a)?[a]:lr(a),l=n.length,o=l-1;for(;++s<l;){const c=n[s];let y=r;if(s!==o){const m=t[c];y=le(m)||Array.isArray(m)?m:isNaN(+n[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=y,t=t[c]}};const Ur={BLUR:"blur",FOCUS_OUT:"focusout"},Oe={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ze={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Dc=e.createContext(null);Dc.displayName="HookFormContext";var Rc=(t,a,r,s=!0)=>{const n={defaultValues:a._defaultValues};for(const l in t)Object.defineProperty(n,l,{get:()=>{const o=l;return a._proxyFormState[o]!==Oe.all&&(a._proxyFormState[o]=!s||Oe.all),t[o]}});return n};const Fc=typeof window<"u"?e.useLayoutEffect:e.useEffect;var qe=t=>typeof t=="string",Oc=(t,a,r,s,n)=>qe(t)?(s&&a.watch.add(t),q(r,t,n)):Array.isArray(t)?t.map(l=>(s&&a.watch.add(l),q(r,l))):(s&&(a.watchAll=!0),r),Qa=t=>be(t)||!zs(t);function Ze(t,a,r=new WeakSet){if(Qa(t)||Qa(a))return t===a;if(st(t)&&st(a))return t.getTime()===a.getTime();const s=Object.keys(t),n=Object.keys(a);if(s.length!==n.length)return!1;if(r.has(t)||r.has(a))return!0;r.add(t),r.add(a);for(const l of s){const o=t[l];if(!n.includes(l))return!1;if(l!=="ref"){const c=a[l];if(st(o)&&st(c)||le(o)&&le(c)||Array.isArray(o)&&Array.isArray(c)?!Ze(o,c,r):o!==c)return!1}}return!0}var Tc=(t,a,r,s,n)=>a?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:n||!0}}:{},Nt=t=>Array.isArray(t)?t:[t],qr=()=>{let t=[];return{get observers(){return t},next:n=>{for(const l of t)l.next&&l.next(n)},subscribe:n=>(t.push(n),{unsubscribe:()=>{t=t.filter(l=>l!==n)}}),unsubscribe:()=>{t=[]}}},we=t=>le(t)&&!Object.keys(t).length,or=t=>t.type==="file",Te=t=>typeof t=="function",sa=t=>{if(!sr)return!1;const a=t?t.ownerDocument:0;return t instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},Hs=t=>t.type==="select-multiple",cr=t=>t.type==="radio",Ic=t=>cr(t)||Tt(t),_a=t=>sa(t)&&t.isConnected;function _c(t,a){const r=a.slice(0,-1).length;let s=0;for(;s<r;)t=ie(t)?s++:t[a[s++]];return t}function Lc(t){for(const a in t)if(t.hasOwnProperty(a)&&!ie(t[a]))return!1;return!0}function ce(t,a){const r=Array.isArray(a)?a:xa(a)?[a]:lr(a),s=r.length===1?t:_c(t,r),n=r.length-1,l=r[n];return s&&delete s[l],n!==0&&(le(s)&&we(s)||Array.isArray(s)&&Lc(s))&&ce(t,r.slice(0,-1)),t}var Ws=t=>{for(const a in t)if(Te(t[a]))return!0;return!1};function na(t,a={}){const r=Array.isArray(t);if(le(t)||r)for(const s in t)Array.isArray(t[s])||le(t[s])&&!Ws(t[s])?(a[s]=Array.isArray(t[s])?[]:{},na(t[s],a[s])):be(t[s])||(a[s]=!0);return a}function Qs(t,a,r){const s=Array.isArray(t);if(le(t)||s)for(const n in t)Array.isArray(t[n])||le(t[n])&&!Ws(t[n])?ie(a)||Qa(r[n])?r[n]=Array.isArray(t[n])?na(t[n],[]):{...na(t[n])}:Qs(t[n],be(a)?{}:a[n],r[n]):r[n]=!Ze(t[n],a[n]);return r}var xt=(t,a)=>Qs(t,a,na(a));const $r={value:!1,isValid:!1},Vr={value:!0,isValid:!0};var Js=t=>{if(Array.isArray(t)){if(t.length>1){const a=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:a,isValid:!!a.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ie(t[0].attributes.value)?ie(t[0].value)||t[0].value===""?Vr:{value:t[0].value,isValid:!0}:Vr:$r}return $r},Ys=(t,{valueAsNumber:a,valueAsDate:r,setValueAs:s})=>ie(t)?t:a?t===""?NaN:t&&+t:r&&qe(t)?new Date(t):s?s(t):t;const Kr={isValid:!1,value:null};var Zs=t=>Array.isArray(t)?t.reduce((a,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:a,Kr):Kr;function Br(t){const a=t.ref;return or(a)?a.files:cr(a)?Zs(t.refs).value:Hs(a)?[...a.selectedOptions].map(({value:r})=>r):Tt(a)?Js(t.refs).value:Ys(ie(a.value)?t.ref.value:a.value,t)}var Mc=(t,a,r,s)=>{const n={};for(const l of t){const o=q(a,l);o&&te(n,l,o._f)}return{criteriaMode:r,names:[...t],fields:n,shouldUseNativeValidation:s}},la=t=>t instanceof RegExp,vt=t=>ie(t)?t:la(t)?t.source:le(t)?la(t.value)?t.value.source:t.value:t,Gr=t=>({isOnSubmit:!t||t===Oe.onSubmit,isOnBlur:t===Oe.onBlur,isOnChange:t===Oe.onChange,isOnAll:t===Oe.all,isOnTouch:t===Oe.onTouched});const zr="AsyncFunction";var jc=t=>!!t&&!!t.validate&&!!(Te(t.validate)&&t.validate.constructor.name===zr||le(t.validate)&&Object.values(t.validate).find(a=>a.constructor.name===zr)),Uc=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Hr=(t,a,r)=>!r&&(a.watchAll||a.watch.has(t)||[...a.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const wt=(t,a,r,s)=>{for(const n of r||Object.keys(t)){const l=q(t,n);if(l){const{_f:o,...c}=l;if(o){if(o.refs&&o.refs[0]&&a(o.refs[0],n)&&!s)return!0;if(o.ref&&a(o.ref,o.name)&&!s)return!0;if(wt(c,a))break}else if(le(c)&&wt(c,a))break}}};function Wr(t,a,r){const s=q(t,r);if(s||xa(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const l=n.join("."),o=q(a,l),c=q(t,l);if(o&&!Array.isArray(o)&&r!==l)return{name:r};if(c&&c.type)return{name:l,error:c};if(c&&c.root&&c.root.type)return{name:`${l}.root`,error:c.root};n.pop()}return{name:r}}var qc=(t,a,r,s)=>{r(t);const{name:n,...l}=t;return we(l)||Object.keys(l).length>=Object.keys(a).length||Object.keys(l).find(o=>a[o]===(!s||Oe.all))},$c=(t,a,r)=>!t||!a||t===a||Nt(t).some(s=>s&&(r?s===a:s.startsWith(a)||a.startsWith(s))),Vc=(t,a,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(a||t):(r?s.isOnBlur:n.isOnBlur)?!t:(r?s.isOnChange:n.isOnChange)?t:!0,Kc=(t,a)=>!nr(q(t,a)).length&&ce(t,a),Bc=(t,a,r)=>{const s=Nt(q(t,r));return te(s,"root",a[r]),te(t,r,s),t},zt=t=>qe(t);function Qr(t,a,r="validate"){if(zt(t)||Array.isArray(t)&&t.every(zt)||je(t)&&!t)return{type:r,message:zt(t)?t:"",ref:a}}var mt=t=>le(t)&&!la(t)?t:{value:t,message:""},Jr=async(t,a,r,s,n,l)=>{const{ref:o,refs:c,required:y,maxLength:m,minLength:u,min:d,max:p,pattern:b,validate:w,name:h,valueAsNumber:E,mount:x}=t._f,v=q(r,h);if(!x||a.has(h))return{};const D=c?c[0]:o,S=M=>{n&&D.reportValidity&&(D.setCustomValidity(je(M)?"":M||""),D.reportValidity())},R={},O=cr(o),j=Tt(o),k=O||j,L=(E||or(o))&&ie(o.value)&&ie(v)||sa(o)&&o.value===""||v===""||Array.isArray(v)&&!v.length,g=Tc.bind(null,h,s,R),I=(M,U,K,z=ze.maxLength,W=ze.minLength)=>{const ee=M?U:K;R[h]={type:M?z:W,message:ee,ref:o,...g(M?z:W,ee)}};if(l?!Array.isArray(v)||!v.length:y&&(!k&&(L||be(v))||je(v)&&!v||j&&!Js(c).isValid||O&&!Zs(c).isValid)){const{value:M,message:U}=zt(y)?{value:!!y,message:y}:mt(y);if(M&&(R[h]={type:ze.required,message:U,ref:D,...g(ze.required,U)},!s))return S(U),R}if(!L&&(!be(d)||!be(p))){let M,U;const K=mt(p),z=mt(d);if(!be(v)&&!isNaN(v)){const W=o.valueAsNumber||v&&+v;be(K.value)||(M=W>K.value),be(z.value)||(U=W<z.value)}else{const W=o.valueAsDate||new Date(v),ee=fe=>new Date(new Date().toDateString()+" "+fe),se=o.type=="time",ne=o.type=="week";qe(K.value)&&v&&(M=se?ee(v)>ee(K.value):ne?v>K.value:W>new Date(K.value)),qe(z.value)&&v&&(U=se?ee(v)<ee(z.value):ne?v<z.value:W<new Date(z.value))}if((M||U)&&(I(!!M,K.message,z.message,ze.max,ze.min),!s))return S(R[h].message),R}if((m||u)&&!L&&(qe(v)||l&&Array.isArray(v))){const M=mt(m),U=mt(u),K=!be(M.value)&&v.length>+M.value,z=!be(U.value)&&v.length<+U.value;if((K||z)&&(I(K,M.message,U.message),!s))return S(R[h].message),R}if(b&&!L&&qe(v)){const{value:M,message:U}=mt(b);if(la(M)&&!v.match(M)&&(R[h]={type:ze.pattern,message:U,ref:o,...g(ze.pattern,U)},!s))return S(U),R}if(w){if(Te(w)){const M=await w(v,r),U=Qr(M,D);if(U&&(R[h]={...U,...g(ze.validate,U.message)},!s))return S(U.message),R}else if(le(w)){let M={};for(const U in w){if(!we(M)&&!s)break;const K=Qr(await w[U](v,r),D,U);K&&(M={...K,...g(U,K.message)},S(K.message),s&&(R[h]=M))}if(!we(M)&&(R[h]={ref:D,...M},!s))return R}}return S(!0),R};const Gc={mode:Oe.onSubmit,reValidateMode:Oe.onChange,shouldFocusError:!0};function zc(t={}){let a={...Gc,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Te(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},s={},n=le(a.defaultValues)||le(a.values)?ue(a.defaultValues||a.values)||{}:{},l=a.shouldUnregister?{}:ue(n),o={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},y,m=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const p={array:qr(),state:qr()},b=a.criteriaMode===Oe.all,w=i=>f=>{clearTimeout(m),m=setTimeout(i,f)},h=async i=>{if(!a.disabled&&(u.isValid||d.isValid||i)){const f=a.resolver?we((await j()).errors):await L(s,!0);f!==r.isValid&&p.state.next({isValid:f})}},E=(i,f)=>{!a.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((i||Array.from(c.mount)).forEach(N=>{N&&(f?te(r.validatingFields,N,f):ce(r.validatingFields,N))}),p.state.next({validatingFields:r.validatingFields,isValidating:!we(r.validatingFields)}))},x=(i,f=[],N,F,T=!0,_=!0)=>{if(F&&N&&!a.disabled){if(o.action=!0,_&&Array.isArray(q(s,i))){const $=N(q(s,i),F.argA,F.argB);T&&te(s,i,$)}if(_&&Array.isArray(q(r.errors,i))){const $=N(q(r.errors,i),F.argA,F.argB);T&&te(r.errors,i,$),Kc(r.errors,i)}if((u.touchedFields||d.touchedFields)&&_&&Array.isArray(q(r.touchedFields,i))){const $=N(q(r.touchedFields,i),F.argA,F.argB);T&&te(r.touchedFields,i,$)}(u.dirtyFields||d.dirtyFields)&&(r.dirtyFields=xt(n,l)),p.state.next({name:i,isDirty:I(i,f),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else te(l,i,f)},v=(i,f)=>{te(r.errors,i,f),p.state.next({errors:r.errors})},D=i=>{r.errors=i,p.state.next({errors:r.errors,isValid:!1})},S=(i,f,N,F)=>{const T=q(s,i);if(T){const _=q(l,i,ie(N)?q(n,i):N);ie(_)||F&&F.defaultChecked||f?te(l,i,f?_:Br(T._f)):K(i,_),o.mount&&h()}},R=(i,f,N,F,T)=>{let _=!1,$=!1;const Q={name:i};if(!a.disabled){if(!N||F){(u.isDirty||d.isDirty)&&($=r.isDirty,r.isDirty=Q.isDirty=I(),_=$!==Q.isDirty);const Y=Ze(q(n,i),f);$=!!q(r.dirtyFields,i),Y?ce(r.dirtyFields,i):te(r.dirtyFields,i,!0),Q.dirtyFields=r.dirtyFields,_=_||(u.dirtyFields||d.dirtyFields)&&$!==!Y}if(N){const Y=q(r.touchedFields,i);Y||(te(r.touchedFields,i,N),Q.touchedFields=r.touchedFields,_=_||(u.touchedFields||d.touchedFields)&&Y!==N)}_&&T&&p.state.next(Q)}return _?Q:{}},O=(i,f,N,F)=>{const T=q(r.errors,i),_=(u.isValid||d.isValid)&&je(f)&&r.isValid!==f;if(a.delayError&&N?(y=w(()=>v(i,N)),y(a.delayError)):(clearTimeout(m),y=null,N?te(r.errors,i,N):ce(r.errors,i)),(N?!Ze(T,N):T)||!we(F)||_){const $={...F,..._&&je(f)?{isValid:f}:{},errors:r.errors,name:i};r={...r,...$},p.state.next($)}},j=async i=>{E(i,!0);const f=await a.resolver(l,a.context,Mc(i||c.mount,s,a.criteriaMode,a.shouldUseNativeValidation));return E(i),f},k=async i=>{const{errors:f}=await j(i);if(i)for(const N of i){const F=q(f,N);F?te(r.errors,N,F):ce(r.errors,N)}else r.errors=f;return f},L=async(i,f,N={valid:!0})=>{for(const F in i){const T=i[F];if(T){const{_f:_,...$}=T;if(_){const Q=c.array.has(_.name),Y=T._f&&jc(T._f);Y&&u.validatingFields&&E([F],!0);const De=await Jr(T,c.disabled,l,b,a.shouldUseNativeValidation&&!f,Q);if(Y&&u.validatingFields&&E([F]),De[_.name]&&(N.valid=!1,f))break;!f&&(q(De,_.name)?Q?Bc(r.errors,De,_.name):te(r.errors,_.name,De[_.name]):ce(r.errors,_.name))}!we($)&&await L($,f,N)}}return N.valid},g=()=>{for(const i of c.unMount){const f=q(s,i);f&&(f._f.refs?f._f.refs.every(N=>!_a(N)):!_a(f._f.ref))&&yt(i)}c.unMount=new Set},I=(i,f)=>!a.disabled&&(i&&f&&te(l,i,f),!Ze(fe(),n)),M=(i,f,N)=>Oc(i,c,{...o.mount?l:ie(f)?n:qe(i)?{[i]:f}:f},N,f),U=i=>nr(q(o.mount?l:n,i,a.shouldUnregister?q(n,i,[]):[])),K=(i,f,N={})=>{const F=q(s,i);let T=f;if(F){const _=F._f;_&&(!_.disabled&&te(l,i,Ys(f,_)),T=sa(_.ref)&&be(f)?"":f,Hs(_.ref)?[..._.ref.options].forEach($=>$.selected=T.includes($.value)):_.refs?Tt(_.ref)?_.refs.forEach($=>{(!$.defaultChecked||!$.disabled)&&(Array.isArray(T)?$.checked=!!T.find(Q=>Q===$.value):$.checked=T===$.value||!!T)}):_.refs.forEach($=>$.checked=$.value===T):or(_.ref)?_.ref.value="":(_.ref.value=T,_.ref.type||p.state.next({name:i,values:ue(l)})))}(N.shouldDirty||N.shouldTouch)&&R(i,T,N.shouldTouch,N.shouldDirty,!0),N.shouldValidate&&ne(i)},z=(i,f,N)=>{for(const F in f){if(!f.hasOwnProperty(F))return;const T=f[F],_=i+"."+F,$=q(s,_);(c.array.has(i)||le(T)||$&&!$._f)&&!st(T)?z(_,T,N):K(_,T,N)}},W=(i,f,N={})=>{const F=q(s,i),T=c.array.has(i),_=ue(f);te(l,i,_),T?(p.array.next({name:i,values:ue(l)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&N.shouldDirty&&p.state.next({name:i,dirtyFields:xt(n,l),isDirty:I(i,_)})):F&&!F._f&&!be(_)?z(i,_,N):K(i,_,N),Hr(i,c)&&p.state.next({...r,name:i}),p.state.next({name:o.mount?i:void 0,values:ue(l)})},ee=async i=>{o.mount=!0;const f=i.target;let N=f.name,F=!0;const T=q(s,N),_=Y=>{F=Number.isNaN(Y)||st(Y)&&isNaN(Y.getTime())||Ze(Y,q(l,N,Y))},$=Gr(a.mode),Q=Gr(a.reValidateMode);if(T){let Y,De;const qt=f.type?Br(T._f):kc(i),We=i.type===Ur.BLUR||i.type===Ur.FOCUS_OUT,tn=!Uc(T._f)&&!a.resolver&&!q(r.errors,N)&&!T._f.deps||Vc(We,q(r.touchedFields,N),r.isSubmitted,Q,$),Ca=Hr(N,c,We);te(l,N,qt),We?(!f||!f.readOnly)&&(T._f.onBlur&&T._f.onBlur(i),y&&y(0)):T._f.onChange&&T._f.onChange(i);const Pa=R(N,qt,We),an=!we(Pa)||Ca;if(!We&&p.state.next({name:N,type:i.type,values:ue(l)}),tn)return(u.isValid||d.isValid)&&(a.mode==="onBlur"?We&&h():We||h()),an&&p.state.next({name:N,...Ca?{}:Pa});if(!We&&Ca&&p.state.next({...r}),a.resolver){const{errors:ir}=await j([N]);if(_(qt),F){const rn=Wr(r.errors,s,N),mr=Wr(ir,s,rn.name||N);Y=mr.error,N=mr.name,De=we(ir)}}else E([N],!0),Y=(await Jr(T,c.disabled,l,b,a.shouldUseNativeValidation))[N],E([N]),_(qt),F&&(Y?De=!1:(u.isValid||d.isValid)&&(De=await L(s,!0)));F&&(T._f.deps&&ne(T._f.deps),O(N,De,Y,Pa))}},se=(i,f)=>{if(q(r.errors,f)&&i.focus)return i.focus(),1},ne=async(i,f={})=>{let N,F;const T=Nt(i);if(a.resolver){const _=await k(ie(i)?i:T);N=we(_),F=i?!T.some($=>q(_,$)):N}else i?(F=(await Promise.all(T.map(async _=>{const $=q(s,_);return await L($&&$._f?{[_]:$}:$)}))).every(Boolean),!(!F&&!r.isValid)&&h()):F=N=await L(s);return p.state.next({...!qe(i)||(u.isValid||d.isValid)&&N!==r.isValid?{}:{name:i},...a.resolver||!i?{isValid:N}:{},errors:r.errors}),f.shouldFocus&&!F&&wt(s,se,i?T:c.mount),F},fe=i=>{const f={...o.mount?l:n};return ie(i)?f:qe(i)?q(f,i):i.map(N=>q(f,N))},ye=(i,f)=>({invalid:!!q((f||r).errors,i),isDirty:!!q((f||r).dirtyFields,i),error:q((f||r).errors,i),isValidating:!!q(r.validatingFields,i),isTouched:!!q((f||r).touchedFields,i)}),Ce=i=>{i&&Nt(i).forEach(f=>ce(r.errors,f)),p.state.next({errors:i?r.errors:{}})},tt=(i,f,N)=>{const F=(q(s,i,{_f:{}})._f||{}).ref,T=q(r.errors,i)||{},{ref:_,message:$,type:Q,...Y}=T;te(r.errors,i,{...Y,...f,ref:F}),p.state.next({name:i,errors:r.errors,isValid:!1}),N&&N.shouldFocus&&F&&F.focus&&F.focus()},it=(i,f)=>Te(i)?p.state.subscribe({next:N=>"values"in N&&i(M(void 0,f),N)}):M(i,f,!0),It=i=>p.state.subscribe({next:f=>{$c(i.name,f.name,i.exact)&&qc(f,i.formState||u,jt,i.reRenderRoot)&&i.callback({values:{...l},...r,...f,defaultValues:n})}}).unsubscribe,va=i=>(o.mount=!0,d={...d,...i.formState},It({...i,formState:d})),yt=(i,f={})=>{for(const N of i?Nt(i):c.mount)c.mount.delete(N),c.array.delete(N),f.keepValue||(ce(s,N),ce(l,N)),!f.keepError&&ce(r.errors,N),!f.keepDirty&&ce(r.dirtyFields,N),!f.keepTouched&&ce(r.touchedFields,N),!f.keepIsValidating&&ce(r.validatingFields,N),!a.shouldUnregister&&!f.keepDefaultValue&&ce(n,N);p.state.next({values:ue(l)}),p.state.next({...r,...f.keepDirty?{isDirty:I()}:{}}),!f.keepIsValid&&h()},_t=({disabled:i,name:f})=>{(je(i)&&o.mount||i||c.disabled.has(f))&&(i?c.disabled.add(f):c.disabled.delete(f))},ht=(i,f={})=>{let N=q(s,i);const F=je(f.disabled)||je(a.disabled);return te(s,i,{...N||{},_f:{...N&&N._f?N._f:{ref:{name:i}},name:i,mount:!0,...f}}),c.mount.add(i),N?_t({disabled:je(f.disabled)?f.disabled:a.disabled,name:i}):S(i,!0,f.value),{...F?{disabled:f.disabled||a.disabled}:{},...a.progressive?{required:!!f.required,min:vt(f.min),max:vt(f.max),minLength:vt(f.minLength),maxLength:vt(f.maxLength),pattern:vt(f.pattern)}:{},name:i,onChange:ee,onBlur:ee,ref:T=>{if(T){ht(i,f),N=q(s,i);const _=ie(T.value)&&T.querySelectorAll&&T.querySelectorAll("input,select,textarea")[0]||T,$=Ic(_),Q=N._f.refs||[];if($?Q.find(Y=>Y===_):_===N._f.ref)return;te(s,i,{_f:{...N._f,...$?{refs:[...Q.filter(_a),_,...Array.isArray(q(n,i))?[{}]:[]],ref:{type:_.type,name:i}}:{ref:_}}}),S(i,!1,void 0,_)}else N=q(s,i,{}),N._f&&(N._f.mount=!1),(a.shouldUnregister||f.shouldUnregister)&&!(Pc(c.array,i)&&o.action)&&c.unMount.add(i)}}},Ge=()=>a.shouldFocusError&&wt(s,se,c.mount),Na=i=>{je(i)&&(p.state.next({disabled:i}),wt(s,(f,N)=>{const F=q(s,N);F&&(f.disabled=F._f.disabled||i,Array.isArray(F._f.refs)&&F._f.refs.forEach(T=>{T.disabled=F._f.disabled||i}))},0,!1))},Lt=(i,f)=>async N=>{let F;N&&(N.preventDefault&&N.preventDefault(),N.persist&&N.persist());let T=ue(l);if(p.state.next({isSubmitting:!0}),a.resolver){const{errors:_,values:$}=await j();r.errors=_,T=ue($)}else await L(s);if(c.disabled.size)for(const _ of c.disabled)ce(T,_);if(ce(r.errors,"root"),we(r.errors)){p.state.next({errors:{}});try{await i(T,N)}catch(_){F=_}}else f&&await f({...r.errors},N),Ge(),setTimeout(Ge);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:we(r.errors)&&!F,submitCount:r.submitCount+1,errors:r.errors}),F)throw F},wa=(i,f={})=>{q(s,i)&&(ie(f.defaultValue)?W(i,ue(q(n,i))):(W(i,f.defaultValue),te(n,i,ue(f.defaultValue))),f.keepTouched||ce(r.touchedFields,i),f.keepDirty||(ce(r.dirtyFields,i),r.isDirty=f.defaultValue?I(i,ue(q(n,i))):I()),f.keepError||(ce(r.errors,i),u.isValid&&h()),p.state.next({...r}))},bt=(i,f={})=>{const N=i?ue(i):n,F=ue(N),T=we(i),_=T?n:F;if(f.keepDefaultValues||(n=N),!f.keepValues){if(f.keepDirtyValues){const $=new Set([...c.mount,...Object.keys(xt(n,l))]);for(const Q of Array.from($))q(r.dirtyFields,Q)?te(_,Q,q(l,Q)):W(Q,q(_,Q))}else{if(sr&&ie(i))for(const $ of c.mount){const Q=q(s,$);if(Q&&Q._f){const Y=Array.isArray(Q._f.refs)?Q._f.refs[0]:Q._f.ref;if(sa(Y)){const De=Y.closest("form");if(De){De.reset();break}}}}if(f.keepFieldsRef)for(const $ of c.mount)W($,q(_,$));else s={}}l=a.shouldUnregister?f.keepDefaultValues?ue(n):{}:ue(_),p.array.next({values:{..._}}),p.state.next({values:{..._}})}c={mount:f.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!u.isValid||!!f.keepIsValid||!!f.keepDirtyValues,o.watch=!!a.shouldUnregister,p.state.next({submitCount:f.keepSubmitCount?r.submitCount:0,isDirty:T?!1:f.keepDirty?r.isDirty:!!(f.keepDefaultValues&&!Ze(i,n)),isSubmitted:f.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:T?{}:f.keepDirtyValues?f.keepDefaultValues&&l?xt(n,l):r.dirtyFields:f.keepDefaultValues&&i?xt(n,i):f.keepDirty?r.dirtyFields:{},touchedFields:f.keepTouched?r.touchedFields:{},errors:f.keepErrors?r.errors:{},isSubmitSuccessful:f.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},Mt=(i,f)=>bt(Te(i)?i(l):i,f),Sa=(i,f={})=>{const N=q(s,i),F=N&&N._f;if(F){const T=F.refs?F.refs[0]:F.ref;T.focus&&(T.focus(),f.shouldSelect&&Te(T.select)&&T.select())}},jt=i=>{r={...r,...i}},Ut={control:{register:ht,unregister:yt,getFieldState:ye,handleSubmit:Lt,setError:tt,_subscribe:It,_runSchema:j,_focusError:Ge,_getWatch:M,_getDirty:I,_setValid:h,_setFieldArray:x,_setDisabledField:_t,_setErrors:D,_getFieldArray:U,_reset:bt,_resetDefaultValues:()=>Te(a.defaultValues)&&a.defaultValues().then(i=>{Mt(i,a.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:g,_disableForm:Na,_subjects:p,_proxyFormState:u,get _fields(){return s},get _formValues(){return l},get _state(){return o},set _state(i){o=i},get _defaultValues(){return n},get _names(){return c},set _names(i){c=i},get _formState(){return r},get _options(){return a},set _options(i){a={...a,...i}}},subscribe:va,trigger:ne,register:ht,handleSubmit:Lt,watch:it,setValue:W,getValues:fe,reset:Mt,resetField:wa,clearErrors:Ce,unregister:yt,setError:tt,setFocus:Sa,getFieldState:ye};return{...Ut,formControl:Ut}}function Xs(t={}){const a=e.useRef(void 0),r=e.useRef(void 0),[s,n]=e.useState({isDirty:!1,isValidating:!1,isLoading:Te(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Te(t.defaultValues)?void 0:t.defaultValues});if(!a.current)if(t.formControl)a.current={...t.formControl,formState:s},t.defaultValues&&!Te(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...c}=zc(t);a.current={...c,formState:s}}const l=a.current.control;return l._options=t,Fc(()=>{const o=l._subscribe({formState:l._proxyFormState,callback:()=>n({...l._formState}),reRenderRoot:!0});return n(c=>({...c,isReady:!0})),l._formState.isReady=!0,o},[l]),e.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),e.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),e.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),e.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),e.useEffect(()=>{if(l._proxyFormState.isDirty){const o=l._getDirty();o!==s.isDirty&&l._subjects.state.next({isDirty:o})}},[l,s.isDirty]),e.useEffect(()=>{t.values&&!Ze(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),r.current=t.values,n(o=>({...o}))):l._resetDefaultValues()},[l,t.values]),e.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),a.current.formState=Rc(s,l),a.current}const Yr=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"],Hc=["Motorcycle","Three-wheeler","Pickup Truck","Van","Small Truck","Large Truck"],Wc=[{value:"CUSTOMER",label:"Customer",description:"Shop for fresh produce from local farmers",icon:e.createElement(Re,{className:"w-8 h-8"}),color:"bg-blue-500"},{value:"FARMER",label:"Farmer",description:"Sell your produce directly to customers",icon:e.createElement(Qe,{className:"w-8 h-8"}),color:"bg-green-500"},{value:"DRIVER",label:"Driver",description:"Deliver products and earn money",icon:e.createElement(re,{className:"w-8 h-8"}),color:"bg-orange-500"},{value:"FARMER_AGENT",label:"Farmer Agent",description:"Help farmers join the platform",icon:e.createElement(Pe,{className:"w-8 h-8"}),color:"bg-purple-500"}];function Qc(){const t=_e(),[a,r]=C.useState(1),[s,n]=C.useState(!1),[l,o]=C.useState(!1),[c,y]=C.useState(!1),{register:m,handleSubmit:u,watch:d,setValue:p,formState:{errors:b}}=Xs(),w=d("role"),h=d("password"),E=async S=>{if(S.password!==S.confirmPassword){P.error("Passwords do not match");return}y(!0);try{const R={firstName:S.firstName,lastName:S.lastName,phone:S.phone,email:S.email,password:S.password,role:S.role,county:S.county};S.role==="FARMER"?(S.farmName&&(R.farmName=S.farmName),S.farmSize&&(R.farmSize=S.farmSize),S.kraPin&&(R.kraPin=S.kraPin),S.subCounty&&(R.subCounty=S.subCounty)):S.role==="DRIVER"?(R.licenseNumber=S.licenseNumber,R.vehicleType=S.vehicleType,R.vehicleRegNo=S.vehicleRegNo,R.idNumber=S.idNumber):S.role==="FARMER_AGENT"&&(R.assignedCounty=S.assignedCounty);const O=await V.post("/api/auth/register",R);P.success("Registration successful! Please login to continue."),O.data.requiresPayment&&P("You will need to pay the activation fee after login",{icon:"ℹ️"}),O.data.requiresApproval&&P("Your application will be reviewed by our team",{icon:"ℹ️"}),t("/login")}catch(R){console.error("Registration error:",R);const O=R.response?.data?.error||"Registration failed";P.error(O)}finally{y(!1)}},x=()=>{a<3&&r(a+1)},v=()=>{a>1&&r(a-1)},D=S=>{p("role",S),x()};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Create your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(H,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500"},"sign in to your existing account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex items-center justify-between"},[1,2,3].map(S=>e.createElement("div",{key:S,className:`flex items-center ${a>=S?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${a>=S?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},a>S?e.createElement(Qt,{className:"w-4 h-4"}):S),S<3&&e.createElement("div",{className:`w-16 h-0.5 mx-2 ${a>S?"bg-primary-600":"bg-gray-200"}`})))),e.createElement("div",{className:"flex justify-between mt-2 text-xs text-gray-600"},e.createElement("span",null,"Role"),e.createElement("span",null,"Info"),e.createElement("span",null,"Details"))),e.createElement("form",{onSubmit:u(E)},a===1&&e.createElement("div",{className:"space-y-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Choose your role"),e.createElement("div",{className:"space-y-3"},Wc.map(S=>e.createElement("button",{key:S.value,type:"button",onClick:()=>D(S.value),className:"w-full p-4 border border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-left"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${S.color} text-white p-2 rounded-lg mr-4`},S.icon),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},S.label),e.createElement("p",{className:"text-sm text-gray-600"},S.description))))))),a===2&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:v,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(St,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Basic Information")),e.createElement("div",{className:"grid grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...m("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...m("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.lastName.message))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...m("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678 or 0712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...m("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.email.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...m("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Yr.map(S=>e.createElement("option",{key:S,value:S},S))),b.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...m("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:s?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!s)},s?e.createElement(Wt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Be,{className:"h-5 w-5 text-gray-400"}))),b.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.password.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirm Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...m("confirmPassword",{required:"Please confirm your password",validate:S=>S===h||"Passwords do not match"}),type:l?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>o(!l)},l?e.createElement(Wt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Be,{className:"h-5 w-5 text-gray-400"}))),b.confirmPassword&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.confirmPassword.message)),e.createElement("button",{type:"button",onClick:x,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center justify-center"},"Next",e.createElement(Ee,{className:"w-5 h-5 ml-2"}))),a===3&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:v,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(St,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},w==="FARMER"&&"Farm Details",w==="DRIVER"&&"Driver Information",w==="FARMER_AGENT"&&"Agent Information",w==="CUSTOMER"&&"Almost Done!")),w==="FARMER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Name"),e.createElement("input",{...m("farmName"),placeholder:"e.g., Green Valley Farm",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County"),e.createElement("input",{...m("subCounty"),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Size (acres)"),e.createElement("input",{...m("farmSize"),type:"number",step:"0.1",placeholder:"e.g., 5.5",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"KRA PIN"),e.createElement("input",{...m("kraPin"),placeholder:"e.g., A123456789K",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Activation Fee Required"),e.createElement("div",{className:"mt-2 text-sm text-yellow-700"},e.createElement("p",null,"Farmers need to pay a one-time activation fee of KES 300 after registration.")))))),w==="DRIVER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Driving License Number *"),e.createElement("input",{...m("licenseNumber",{required:"License number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.licenseNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.licenseNumber.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Type *"),e.createElement("select",{...m("vehicleType",{required:"Vehicle type is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select Vehicle Type"),Hc.map(S=>e.createElement("option",{key:S,value:S},S))),b.vehicleType&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.vehicleType.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Registration Number *"),e.createElement("input",{...m("vehicleRegNo",{required:"Vehicle registration number is required for drivers"}),placeholder:"e.g., KCA 123X",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.vehicleRegNo&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.vehicleRegNo.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"National ID Number *"),e.createElement("input",{...m("idNumber",{required:"ID number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.idNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.idNumber.message)),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-blue-800"},"Approval Required"),e.createElement("div",{className:"mt-2 text-sm text-blue-700"},e.createElement("p",null,"Driver applications require verification and approval by our team.")))))),w==="FARMER_AGENT"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Assigned County *"),e.createElement("select",{...m("assignedCounty",{required:"Assigned county is required for agents"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Yr.map(S=>e.createElement("option",{key:S,value:S},S))),b.assignedCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.assignedCounty.message)),e.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-purple-800"},"Agent Responsibilities"),e.createElement("div",{className:"mt-2 text-sm text-purple-700"},e.createElement("p",null,"As an agent, you'll help onboard farmers in your assigned county and earn commissions.")))))),w==="CUSTOMER"&&e.createElement("div",{className:"text-center py-8"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(Qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"You're all set!"),e.createElement("p",{className:"text-gray-600"},"Complete your registration to start shopping for fresh produce.")),e.createElement("button",{type:"submit",disabled:c,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},c?"Creating Account...":"Create Account"))))))}function Jc(){const{user:t}=X(),[a,r]=C.useState(!1),[s,n]=C.useState("overview"),[l,o]=C.useState([]),[c,y]=C.useState(null),[m,u]=C.useState([]),[d,p]=C.useState(!0),[b,w]=C.useState({totalConsignments:0,pendingConsignments:0,completedConsignments:0,totalEarnings:0}),[h,E]=C.useState(!1),[x,v]=C.useState(""),[D,S]=C.useState(!1);C.useEffect(()=>{R()},[]);const R=async()=>{try{p(!0);const I=localStorage.getItem("token"),[M,U,K]=await Promise.all([V.get("/api/consignments",{headers:{Authorization:`Bearer ${I}`}}),V.get("/api/wallet",{headers:{Authorization:`Bearer ${I}`}}),V.get("/api/notifications",{headers:{Authorization:`Bearer ${I}`}})]),z=Array.isArray(M.data.consignments)?M.data.consignments:[],W=U.data.wallet||U.data,ee=Array.isArray(K.data.notifications)?K.data.notifications:[];o(z),y(W),u(ee);const se=z.length,ne=z.filter(Ce=>Ce.status==="PENDING").length,fe=z.filter(Ce=>Ce.status==="COMPLETED").length,ye=(W.balance||0)+(Array.isArray(W.transactions)?W.transactions.filter(Ce=>Ce.type==="DEBIT").reduce((Ce,tt)=>Ce+tt.amount,0):0);w({totalConsignments:se,pendingConsignments:ne,completedConsignments:fe,totalEarnings:ye})}catch(I){console.error("Failed to fetch dashboard data:",I),P.error("Failed to load dashboard data")}finally{p(!1)}},O=async(I,M)=>{try{const U=localStorage.getItem("token"),K=await V.post("/api/wallet/withdraw",{amount:I,phoneNumber:M},{headers:{Authorization:`Bearer ${U}`}});P.success("Withdrawal initiated! Check your phone for M-Pesa prompt."),R()}catch(U){P.error(U.response?.data?.error||"Withdrawal failed")}},j=async()=>{if(!x.trim()){P.error("Please enter your phone number");return}if(!/^(\+254|254|0)[17]\d{8}$/.test(x.replace(/\s/g,""))){P.error("Please enter a valid Kenyan phone number");return}S(!0);try{const M=localStorage.getItem("token"),U=await V.post("/api/admin/registration-fees/stk-push",{farmer_id:t?.id,phone_number:x,amount:300},{headers:{Authorization:`Bearer ${M}`}});U.data.success?(P.success("Registration fee payment initiated! Check your phone for M-Pesa prompt."),E(!1),v("")):P.error(U.data.message||"Failed to initiate payment")}catch(M){console.error("Payment error:",M),P.error(M.response?.data?.message||"Failed to initiate payment. Please try again.")}finally{S(!1)}},k=[{id:"overview",label:"Overview",icon:Ye},{id:"consignments",label:"Consignments",icon:B},{id:"wallet",label:"Wallet",icon:Aa},{id:"notifications",label:"Notifications",icon:lt},{id:"profile",label:"Profile",icon:dt}],L=I=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PRICE_SUGGESTED:"bg-blue-100 text-blue-800",DRIVER_ASSIGNED:"bg-indigo-100 text-indigo-800",IN_TRANSIT:"bg-purple-100 text-purple-800",DELIVERED:"bg-cyan-100 text-cyan-800",COMPLETED:"bg-green-100 text-green-800"})[I]||"bg-gray-100 text-gray-800",g=I=>{const U={PENDING:oe,APPROVED:ae,REJECTED:xe,PRICE_SUGGESTED:Ae,DRIVER_ASSIGNED:re,IN_TRANSIT:re,DELIVERED:ae,COMPLETED:ae}[I]||Ke;return e.createElement(U,{className:"w-4 h-4"})};return d?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50 flex"},e.createElement("div",{className:`${a?"translate-x-0":"-translate-x-full"} fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`},e.createElement("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Farmer Dashboard"),e.createElement("button",{onClick:()=>r(!1),className:"lg:hidden text-gray-500 hover:text-gray-700"},e.createElement(xe,{className:"w-6 h-6"}))),e.createElement("nav",{className:"mt-6"},k.map(I=>{const M=I.icon;return e.createElement("button",{key:I.id,onClick:()=>{n(I.id),r(!1)},className:`w-full flex items-center px-6 py-3 text-left hover:bg-gray-50 transition-colors ${s===I.id?"bg-green-50 text-green-600 border-r-2 border-green-600":"text-gray-600"}`},e.createElement(M,{className:"w-5 h-5 mr-3"}),I.label)})),e.createElement("div",{className:"absolute bottom-0 left-0 right-0 p-6 border-t border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center text-white font-semibold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"text-sm font-medium text-gray-800"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-xs text-gray-500"},t?.county))))),e.createElement("div",{className:"flex-1 flex flex-col overflow-hidden"},e.createElement("div",{className:"bg-white shadow-sm border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between h-16 px-6"},e.createElement("div",{className:"flex items-center"},e.createElement("button",{onClick:()=>r(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 mr-3"},e.createElement(Xr,{className:"w-6 h-6"})),e.createElement("h1",{className:"text-xl font-semibold text-gray-800 capitalize"},s)),!t?.registrationFeePaid&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg px-4 py-2"},e.createElement("div",{className:"flex items-center"},e.createElement(Ke,{className:"w-4 h-4 text-red-600 mr-2"}),e.createElement("span",{className:"text-sm text-red-800"},"Registration fee required"),e.createElement("button",{onClick:()=>E(!0),className:"ml-3 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"},"Pay KES 300"))))),e.createElement("div",{className:"flex-1 overflow-auto p-6"},s==="overview"&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Consignments"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},b.totalConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},b.pendingConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(ae,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},b.completedConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Aa,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Wallet Balance"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES ",c?.balance?.toLocaleString()||0))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>n("consignments"),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",disabled:!t?.registrationFeePaid},e.createElement(At,{className:"w-5 h-5 mr-2"}),"Submit Consignment"),e.createElement("button",{onClick:()=>n("wallet"),className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(Aa,{className:"w-5 h-5 mr-2"}),"Manage Wallet"),e.createElement("button",{onClick:()=>n("consignments"),className:"flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Be,{className:"w-5 h-5 mr-2"}),"View Consignments"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Consignments")),e.createElement("div",{className:"p-6"},(Array.isArray(l)?l:[]).slice(0,5).map(I=>e.createElement("div",{key:I.id,className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:Array.isArray(I.images)&&I.images.length>0&&I.images[0]&&I.images[0].trim()!==""?I.images[0]:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop",alt:I.title,className:"w-12 h-12 rounded-lg object-cover",onError:M=>{const U=M.target;U.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop"}}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},I.title),e.createElement("p",{className:"text-sm text-gray-500"},I.quantity," ",I.unit))),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${L(I.status)}`},g(I.status),e.createElement("span",{className:"ml-1"},I.status.replace("_"," "))),e.createElement("span",{className:"text-sm font-medium text-gray-900"},"KES"," ",I.finalPricePerUnit||I.bidPricePerUnit,"/kg"))))))),s==="consignments"&&e.createElement(Yc,{consignments:l,onRefresh:R,canSubmit:t?.registrationFeePaid||!1,showPaymentModal:h,setShowPaymentModal:E}),s==="wallet"&&e.createElement(Zc,{wallet:c,onWithdraw:O,onRefresh:R}),s==="notifications"&&e.createElement(Xc,{notifications:m,onRefresh:R}),s==="profile"&&e.createElement(ei,{user:t}))),h&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-sm w-full max-h-[80vh] flex flex-col"},e.createElement("div",{className:"px-4 py-3 border-b border-gray-200 flex-shrink-0"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},e.createElement(Fe,{className:"w-4 h-4 text-green-600"})),e.createElement("div",null,e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Pay Registration Fee"),e.createElement("p",{className:"text-xs text-gray-600"},"KES 300.00"))),e.createElement("button",{onClick:()=>{E(!1),v("")},className:"text-gray-400 hover:text-gray-600"},e.createElement(xe,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex-1 overflow-y-auto px-4 py-4"},e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},e.createElement("div",{className:"flex items-start space-x-2"},e.createElement(He,{className:"w-4 h-4 text-blue-600 mt-0.5"}),e.createElement("div",null,e.createElement("h4",{className:"text-sm font-medium text-blue-800"},"M-Pesa Payment"),e.createElement("p",{className:"text-xs text-blue-700 mt-1"},"Enter your M-Pesa phone number for STK push.")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Phone Number *"),e.createElement("div",{className:"relative"},e.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},e.createElement(He,{className:"w-4 h-4 text-gray-400"})),e.createElement("input",{type:"tel",value:x,onChange:I=>v(I.target.value),placeholder:"+254712345678",className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",disabled:D})),e.createElement("p",{className:"text-xs text-gray-600 mt-1"},"M-Pesa registered number")),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3"},e.createElement("h5",{className:"text-sm font-medium text-gray-900 mb-2"},"Payment Summary"),e.createElement("div",{className:"space-y-1 text-xs"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Registration Fee:"),e.createElement("span",{className:"font-medium"},"KES 300.00")),e.createElement("div",{className:"flex justify-between border-t border-gray-200 pt-1"},e.createElement("span",{className:"font-medium text-gray-900"},"Total:"),e.createElement("span",{className:"font-semibold text-green-600"},"KES 300.00")))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},e.createElement("p",{className:"text-xs text-yellow-800"},e.createElement("strong",null,"Note:")," After payment, you can submit consignments. STK push appears within 30 seconds.")))),e.createElement("div",{className:"px-4 py-3 border-t border-gray-200 flex-shrink-0"},e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:()=>{E(!1),v("")},disabled:D,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50"},"Cancel"),e.createElement("button",{onClick:j,disabled:D||!x.trim(),className:"flex-1 bg-green-600 text-white px-3 py-2 text-sm rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-1"},D?e.createElement(e.Fragment,null,e.createElement("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.createElement("span",null,"Processing...")):e.createElement(e.Fragment,null,e.createElement(Fe,{className:"w-3 h-3"}),e.createElement("span",null,"Pay KES 300"))))))))}function Yc({consignments:t,onRefresh:a,canSubmit:r,showPaymentModal:s,setShowPaymentModal:n}){const[l,o]=C.useState(!1),[c,y]=C.useState({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[""]}),m=async p=>{if(p.preventDefault(),!r){P.error("Please pay the registration fee first");return}try{const b=localStorage.getItem("token");await V.post("/api/consignments",{...c,quantity:parseFloat(c.quantity),bidPricePerUnit:parseFloat(c.bidPricePerUnit)},{headers:{Authorization:`Bearer ${b}`}}),P.success("Consignment submitted successfully!"),o(!1),y({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[""]}),a()}catch(b){P.error(b.response?.data?.error||"Failed to submit consignment")}},u=p=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PRICE_SUGGESTED:"bg-blue-100 text-blue-800",DRIVER_ASSIGNED:"bg-indigo-100 text-indigo-800",IN_TRANSIT:"bg-purple-100 text-purple-800",DELIVERED:"bg-cyan-100 text-cyan-800",COMPLETED:"bg-green-100 text-green-800"})[p]||"bg-gray-100 text-gray-800",d=p=>{const w={PENDING:oe,APPROVED:ae,REJECTED:xe,PRICE_SUGGESTED:Ae,DRIVER_ASSIGNED:re,IN_TRANSIT:re,DELIVERED:ae,COMPLETED:ae}[p]||Ke;return e.createElement(w,{className:"w-4 h-4"})};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"My Consignments"),e.createElement("button",{onClick:()=>o(!0),disabled:!r,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center"},e.createElement(At,{className:"w-5 h-5 mr-2"}),"Submit New Consignment")),!r&&e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Ke,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-yellow-800"},"You must pay the KES 300 registration fee before submitting consignments.")),e.createElement("button",{onClick:()=>n(!0),className:"ml-3 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Pay Now"))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Submit New Consignment"),e.createElement("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(xe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:m,className:"p-6 space-y-4"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Title"),e.createElement("input",{type:"text",required:!0,value:c.title,onChange:p=>y(b=>({...b,title:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Fresh Tomatoes"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Category"),e.createElement("select",{value:c.category,onChange:p=>y(b=>({...b,category:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"Vegetables"},"Vegetables"),e.createElement("option",{value:"Fruits"},"Fruits"),e.createElement("option",{value:"Grains"},"Grains"),e.createElement("option",{value:"Legumes"},"Legumes"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Quantity"),e.createElement("input",{type:"number",required:!0,value:c.quantity,onChange:p=>y(b=>({...b,quantity:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Unit"),e.createElement("select",{value:c.unit,onChange:p=>y(b=>({...b,unit:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"kg"},"Kilograms (kg)"),e.createElement("option",{value:"tonnes"},"Tonnes"),e.createElement("option",{value:"bags"},"Bags"),e.createElement("option",{value:"pieces"},"Pieces"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Bid Price per Unit (KES)"),e.createElement("input",{type:"number",required:!0,value:c.bidPricePerUnit,onChange:p=>y(b=>({...b,bidPricePerUnit:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 80"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Location"),e.createElement("input",{type:"text",required:!0,value:c.location,onChange:p=>y(b=>({...b,location:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Nakuru"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Harvest Date"),e.createElement("input",{type:"date",required:!0,value:c.harvestDate,onChange:p=>y(b=>({...b,harvestDate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Expiry Date"),e.createElement("input",{type:"date",required:!0,value:c.expiryDate,onChange:p=>y(b=>({...b,expiryDate:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Description"),e.createElement("textarea",{required:!0,value:c.description,onChange:p=>y(b=>({...b,description:p.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:3,placeholder:"Describe your produce quality, farming methods, etc."})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Image URL"),e.createElement("input",{type:"url",value:Array.isArray(c.images)&&c.images.length>0?c.images[0]:"",onChange:p=>y(b=>({...b,images:[p.target.value]})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://example.com/image.jpg"})),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300"},"Cancel"),e.createElement("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Submit Consignment"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"All Consignments (",(Array.isArray(t)?t:[]).length,")")),e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t)?t:[]).map(p=>e.createElement("div",{key:p.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:Array.isArray(p.images)&&p.images.length>0&&p.images[0]&&p.images[0].trim()!==""?p.images[0]:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop",alt:p.title,className:"w-16 h-16 rounded-lg object-cover",onError:b=>{const w=b.target;w.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop"}}),e.createElement("div",{className:"ml-4"},e.createElement("h4",{className:"text-lg font-medium text-gray-900"},p.title),e.createElement("p",{className:"text-sm text-gray-500"},p.description),e.createElement("div",{className:"flex items-center space-x-4 mt-2"},e.createElement("span",{className:"text-sm text-gray-600"},p.quantity," ",p.unit),e.createElement("span",{className:"text-sm text-gray-600"},"KES ",p.bidPricePerUnit,"/",p.unit),e.createElement("span",{className:"text-sm text-gray-600"},p.location)))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${u(p.status)}`},d(p.status),e.createElement("span",{className:"ml-1"},p.status.replace("_"," "))),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},new Date(p.createdAt).toLocaleDateString()))),p.adminNotes&&e.createElement("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg"},e.createElement("p",{className:"text-sm text-gray-700"},e.createElement("strong",null,"Admin Notes:")," ",p.adminNotes)))))))}function Zc({wallet:t,onWithdraw:a,onRefresh:r}){const[s,n]=C.useState(!1),[l,o]=C.useState(""),[c,y]=C.useState(""),m=async u=>{u.preventDefault();const d=parseFloat(l);if(d<10){P.error("Minimum withdrawal amount is KES 10");return}if(d>t.balance){P.error("Insufficient balance");return}await a(d,c),n(!1),o(""),y("")};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Wallet"),e.createElement("button",{onClick:()=>n(!0),disabled:!t?.balance||t.balance<10,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},"Withdraw Funds")),e.createElement("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white"},e.createElement("h3",{className:"text-lg font-medium mb-2"},"Available Balance"),e.createElement("p",{className:"text-3xl font-bold"},"KES ",t?.balance?.toLocaleString()||0))),s&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Withdraw Funds"),e.createElement("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(xe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:m,className:"p-6 space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Amount (KES)"),e.createElement("input",{type:"number",min:"10",max:t?.balance||0,required:!0,value:l,onChange:u=>o(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter amount"}),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Minimum: KES 10 | Available: KES"," ",t?.balance?.toLocaleString()||0)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"M-Pesa Phone Number"),e.createElement("input",{type:"tel",required:!0,value:c,onChange:u=>y(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"+254712345678"})),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300"},"Cancel"),e.createElement("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Withdraw"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Transaction History")),e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t?.transactions)?t.transactions:[]).map(u=>e.createElement("div",{key:u.id,className:"p-6 flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${u.type==="CREDIT"?"bg-green-100":"bg-red-100"}`},u.type==="CREDIT"?e.createElement(Ye,{className:"w-5 h-5 text-green-600"}):e.createElement(Ye,{className:"w-5 h-5 text-red-600 transform rotate-180"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},u.description),e.createElement("p",{className:"text-sm text-gray-500"},new Date(u.createdAt).toLocaleDateString()," at"," ",new Date(u.createdAt).toLocaleTimeString()))),e.createElement("div",{className:"text-right"},e.createElement("p",{className:`font-semibold ${u.type==="CREDIT"?"text-green-600":"text-red-600"}`},u.type==="CREDIT"?"+":"-","KES"," ",u.amount.toLocaleString())))),(!t?.transactions||t.transactions.length===0)&&e.createElement("div",{className:"p-6 text-center text-gray-500"},"No transactions yet"))))}function Xc({notifications:t,onRefresh:a}){const r=async s=>{try{const n=localStorage.getItem("token");await V.put(`/api/notifications/${s}/read`,{},{headers:{Authorization:`Bearer ${n}`}}),a()}catch(n){console.error("Failed to mark notification as read:",n),P.error("Failed to mark notification as read")}};return e.createElement("div",{className:"space-y-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Notifications"),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t)?t:[]).map(s=>e.createElement("div",{key:s.id,className:`p-6 ${s.isRead?"bg-white":"bg-blue-50"}`},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center"},e.createElement("h4",{className:"text-lg font-medium text-gray-900"},s.title),!s.isRead&&e.createElement("span",{className:"ml-2 w-2 h-2 bg-blue-600 rounded-full"})),e.createElement("p",{className:"text-gray-700 mt-1"},s.message),e.createElement("p",{className:"text-sm text-gray-500 mt-2"},new Date(s.createdAt).toLocaleDateString()," at"," ",new Date(s.createdAt).toLocaleTimeString())),!s.isRead&&e.createElement("button",{onClick:()=>r(s.id),className:"ml-4 text-blue-600 hover:text-blue-800 text-sm font-medium"},"Mark as read")))),(Array.isArray(t)?t:[]).length===0&&e.createElement("div",{className:"p-6 text-center text-gray-500"},"No notifications yet"))))}function ei({user:t}){return e.createElement("div",{className:"space-y-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Profile"),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center text-white text-2xl font-bold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-gray-600"},t?.email),e.createElement("p",{className:"text-gray-600"},t?.phone))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Role"),e.createElement("p",{className:"text-gray-900 capitalize"},t?.role)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"County"),e.createElement("p",{className:"text-gray-900"},t?.county)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Registration Status"),e.createElement("div",{className:"flex items-center"},t?.registrationFeePaid?e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},e.createElement(ae,{className:"w-4 h-4 mr-1"}),"Paid"):e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},e.createElement(Ke,{className:"w-4 h-4 mr-1"}),"Fee Required"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Verification Status"),e.createElement("div",{className:"flex items-center"},t?.verified?e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},e.createElement(ae,{className:"w-4 h-4 mr-1"}),"Verified"):e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},e.createElement(oe,{className:"w-4 h-4 mr-1"}),"Pending"))))))}function ti(){const{user:t}=X(),a=_e(),[r,s]=C.useState([]),[n,l]=C.useState(!0),[o,c]=C.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0});C.useEffect(()=>{a("/customer/profile",{replace:!0})},[a]),C.useEffect(()=>{y()},[]);const y=async()=>{try{l(!0);const d=localStorage.getItem("token"),p=await V.get("/api/orders",{headers:{Authorization:`Bearer ${d}`}}),b=p.data.orders||p.data;s(b);const w=b.length,h=b.filter(v=>v.status==="DELIVERED").length,E=b.filter(v=>v.paymentStatus==="COMPLETED").reduce((v,D)=>v+D.totalAmount,0),x=b.filter(v=>v.status==="PENDING").length;c({totalOrders:w,completedOrders:h,totalSpent:E,pendingOrders:x})}catch(d){if(console.error("Failed to fetch orders:",d),d.response?.status===404){console.log("🛒 Using fallback demo orders (endpoint not found)");const p=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",deliveryPhone:"+254712345678",orderDate:new Date(Date.now()-864e5).toISOString(),estimatedDelivery:new Date(Date.now()-432e5).toISOString(),notes:"Please deliver in the morning",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_1",quantity:5,pricePerUnit:120,totalPrice:600,product:{id:"prod_1",name:"Organic Tomatoes",images:[]}}]},{id:"order_2",orderNumber:"ORD-2024-002",totalAmount:1800,paymentStatus:"PENDING",paymentMethod:"M-PESA",status:"PROCESSING",deliveryAddress:"456 Oak Avenue, Nakuru",deliveryPhone:"+254723456789",orderDate:new Date(Date.now()-36e5).toISOString(),estimatedDelivery:new Date(Date.now()+864e5).toISOString(),notes:"Call before delivery",createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_3",quantity:2,pricePerUnit:900,totalPrice:1800,product:{id:"prod_2",name:"Premium Maize",images:[]}}]}];s(p),c({totalOrders:2,completedOrders:1,totalSpent:2500,pendingOrders:1}),P.success("Using demo data - backend deployment needed")}else P.error("Failed to load orders")}finally{l(!1)}},m=d=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[d]||"bg-gray-100 text-gray-800",u=d=>{const b={PENDING:oe,CONFIRMED:B,PROCESSING:B,SHIPPED:re,DELIVERED:B,CANCELLED:B}[d]||B;return e.createElement(b,{className:"w-4 h-4"})};return n?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your profile and view your order history")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Xe,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.totalOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.pendingOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.completedOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Fe,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES ",o.totalSpent.toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>a("/marketplace"),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(Xe,{className:"w-5 h-5 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(B,{className:"w-5 h-5 mr-2"}),"View Orders"),e.createElement("button",{onClick:()=>a("/customer/profile"),className:"flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Re,{className:"w-5 h-5 mr-2"}),"Edit Profile"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All"))),e.createElement("div",{className:"p-6"},r.slice(0,3).map(d=>e.createElement("div",{key:d.id,className:"flex items-center justify-between py-4 border-b border-gray-100 last:border-b-0"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},d.items[0]?.product?.images?.[0]?e.createElement("img",{src:d.items[0].product.images[0],alt:d.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(B,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},"Order #",d.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},d.items.length," item",d.items.length>1?"s":""," • KES"," ",d.totalAmount.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-500"},new Date(d.orderDate).toLocaleDateString()))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m(d.status)}`},u(d.status),e.createElement("span",{className:"ml-1"},d.status)),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},d.paymentMethod)))),r.length===0&&e.createElement("div",{className:"text-center py-8"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("p",{className:"text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>a("/marketplace"),className:"mt-3 text-blue-600 hover:text-blue-800 font-medium"},"Start Shopping"))))))}function ai(){const{user:t,updateUser:a}=X(),r=_e(),[s,n]=C.useState(!1),[l,o]=C.useState(!1),[c,y]=C.useState([]),[m,u]=C.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0}),[d,p]=C.useState({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""});C.useEffect(()=>{b()},[]);const b=async()=>{try{const x=localStorage.getItem("token"),v=await V.get("/api/orders",{headers:{Authorization:`Bearer ${x}`}}),D=v.data.orders||v.data;y(D);const S=D.length,R=D.filter(k=>k.status==="DELIVERED").length,O=D.filter(k=>k.paymentStatus==="COMPLETED").reduce((k,L)=>k+L.totalAmount,0),j=D.filter(k=>k.status==="PENDING").length;u({totalOrders:S,completedOrders:R,totalSpent:O,pendingOrders:j})}catch(x){if(console.error("Failed to fetch orders:",x),x.response?.status===404){console.log("🛒 Using fallback demo orders (endpoint not found)");const v=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",orderDate:new Date(Date.now()-864e5).toISOString(),createdAt:new Date(Date.now()-864e5).toISOString(),items:[{quantity:5,product:{name:"Organic Tomatoes",images:[]}}]}];y(v),u({totalOrders:1,completedOrders:1,totalSpent:2500,pendingOrders:0})}}},w=async()=>{try{o(!0);const x=localStorage.getItem("token"),v=await V.put("/api/profile",d,{headers:{Authorization:`Bearer ${x}`}});a(v.data.user),n(!1),P.success("Profile updated successfully!")}catch(x){P.error(x.response?.data?.error||"Failed to update profile")}finally{o(!1)}},h=()=>{p({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""}),n(!1)},E=x=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[x]||"bg-gray-100 text-gray-800";return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Profile"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your personal information and preferences")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Personal Information"),s?e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:w,disabled:l,className:"flex items-center text-green-600 hover:text-green-800 disabled:opacity-50"},e.createElement(Xa,{className:"w-4 h-4 mr-1"}),"Save"),e.createElement("button",{onClick:h,className:"flex items-center text-red-600 hover:text-red-800"},e.createElement(xe,{className:"w-4 h-4 mr-1"}),"Cancel")):e.createElement("button",{onClick:()=>n(!0),className:"flex items-center text-blue-600 hover:text-blue-800"},e.createElement(xn,{className:"w-4 h-4 mr-1"}),"Edit"))),e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center text-white text-2xl font-bold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-gray-600"},t?.role),e.createElement("div",{className:"flex items-center mt-1"},e.createElement(Ve,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm text-green-600"},"Verified Account")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Re,{className:"w-4 h-4 inline mr-1"}),"First Name"),s?e.createElement("input",{type:"text",value:d.firstName,onChange:x=>p(v=>({...v,firstName:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.firstName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Re,{className:"w-4 h-4 inline mr-1"}),"Last Name"),s?e.createElement("input",{type:"text",value:d.lastName,onChange:x=>p(v=>({...v,lastName:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.lastName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(ia,{className:"w-4 h-4 inline mr-1"}),"Email Address"),s?e.createElement("input",{type:"email",value:d.email,onChange:x=>p(v=>({...v,email:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.email)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(He,{className:"w-4 h-4 inline mr-1"}),"Phone Number"),e.createElement("p",{className:"text-gray-900 py-2"},t?.phone),e.createElement("p",{className:"text-sm text-gray-500"},"Phone number cannot be changed")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Ie,{className:"w-4 h-4 inline mr-1"}),"County"),s?e.createElement("select",{value:d.county,onChange:x=>p(v=>({...v,county:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select County"),e.createElement("option",{value:"Nairobi"},"Nairobi"),e.createElement("option",{value:"Kiambu"},"Kiambu"),e.createElement("option",{value:"Nakuru"},"Nakuru"),e.createElement("option",{value:"Mombasa"},"Mombasa"),e.createElement("option",{value:"Kisumu"},"Kisumu"),e.createElement("option",{value:"Eldoret"},"Eldoret"),e.createElement("option",{value:"Thika"},"Thika"),e.createElement("option",{value:"Nyeri"},"Nyeri")):e.createElement("p",{className:"text-gray-900 py-2"},t?.county)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(ot,{className:"w-4 h-4 inline mr-1"}),"Member Since"),e.createElement("p",{className:"text-gray-900 py-2"},new Date(t?.createdAt||new Date).toLocaleDateString())))))),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Account Summary"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Xe,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Orders")),e.createElement("span",{className:"font-semibold text-gray-900"},m.totalOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Pending")),e.createElement("span",{className:"font-semibold text-gray-900"},m.pendingOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Completed")),e.createElement("span",{className:"font-semibold text-gray-900"},m.completedOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Fe,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Spent")),e.createElement("span",{className:"font-semibold text-gray-900"},"KES ",m.totalSpent.toLocaleString())))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>r("/marketplace"),className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(Xe,{className:"w-4 h-4 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(B,{className:"w-4 h-4 mr-2"}),"View Order History"),e.createElement("button",{onClick:()=>r("/cart"),className:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Xe,{className:"w-4 h-4 mr-2"}),"View Cart"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All")),e.createElement("div",{className:"space-y-3"},c.slice(0,3).map(x=>e.createElement("div",{key:x.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},"Order #",x.id.slice(-6)),e.createElement("p",{className:"text-xs text-gray-500"},new Date(x.orderDate).toLocaleDateString())),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${E(x.status)}`},x.status),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"KES ",x.totalAmount.toLocaleString())))),c.length===0&&e.createElement("div",{className:"text-center py-4"},e.createElement(B,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-sm text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>r("/marketplace"),className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium"},"Start Shopping"))))))))}function ri(){const{user:t}=X(),[a,r]=C.useState([]),[s,n]=C.useState(!0),[l,o]=C.useState(null);C.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const d=localStorage.getItem("token"),p=await V.get("/api/orders",{headers:{Authorization:`Bearer ${d}`}});r(p.data)}catch(d){console.error("Failed to fetch orders:",d),P.error("Failed to load orders")}finally{n(!1)}},y=d=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[d]||"bg-gray-100 text-gray-800",m=d=>{const b={PENDING:oe,CONFIRMED:B,PROCESSING:B,SHIPPED:re,DELIVERED:ae,CANCELLED:xe}[d]||B;return e.createElement(b,{className:"w-4 h-4"})},u=d=>({PENDING:"bg-yellow-100 text-yellow-800",COMPLETED:"bg-green-100 text-green-800",FAILED:"bg-red-100 text-red-800",CANCELLED:"bg-gray-100 text-gray-800"})[d]||"bg-gray-100 text-gray-800";return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Order History"),e.createElement("p",{className:"text-gray-600 mt-2"},"Track and manage your orders")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(d=>d.status==="PENDING").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(ae,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Delivered"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(d=>d.status==="DELIVERED").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Fe,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES"," ",a.filter(d=>d.paymentStatus==="COMPLETED").reduce((d,p)=>d+p.totalAmount,0).toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"All Orders")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders yet"),e.createElement("p",{className:"text-gray-500 mb-6"},"Start shopping to see your orders here"),e.createElement("button",{onClick:()=>window.location.href="/marketplace",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"},"Browse Marketplace")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(d=>e.createElement("div",{key:d.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},d.items[0]?.product?.images?.[0]?e.createElement("img",{src:d.items[0].product.images[0],alt:d.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(B,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Order #",d.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},d.items.length," item",d.items.length>1?"s":""," • KES"," ",d.totalAmount.toLocaleString()))),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y(d.status)}`},m(d.status),e.createElement("span",{className:"ml-1"},d.status)),e.createElement("button",{onClick:()=>o(d),className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center"},e.createElement(Be,{className:"w-4 h-4 mr-1"}),"View Details"))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(ot,{className:"w-4 h-4 mr-2"}),"Ordered: ",new Date(d.orderDate).toLocaleDateString()),e.createElement("div",{className:"flex items-center"},e.createElement(Fe,{className:"w-4 h-4 mr-2"}),"Payment:"," ",e.createElement("span",{className:`ml-1 px-2 py-0.5 rounded text-xs ${u(d.paymentStatus)}`},d.paymentStatus)),e.createElement("div",{className:"flex items-center"},e.createElement(re,{className:"w-4 h-4 mr-2"}),"Method: ",d.paymentMethod)),d.status==="SHIPPED"||d.status==="DELIVERED"?e.createElement("div",{className:"mt-4 p-3 bg-green-50 rounded-lg"},e.createElement("p",{className:"text-sm text-green-800"},d.status==="DELIVERED"?"Order delivered successfully!":"Your order is on the way!")):null)))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Order Details #",l.id.slice(-8)),e.createElement("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700"},e.createElement(xe,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Order Status"),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${y(l.status)}`},m(l.status),e.createElement("span",{className:"ml-1"},l.status)),e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${u(l.paymentStatus)}`},l.paymentStatus))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Items Ordered"),e.createElement("div",{className:"space-y-3"},l.items.map(d=>e.createElement("div",{key:d.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:d.product.images[0]||"/placeholder.jpg",alt:d.product.name,className:"w-12 h-12 rounded-lg object-cover"}),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"font-medium text-gray-900"},d.product.name),e.createElement("p",{className:"text-sm text-gray-500"},d.quantity," ",d.product.unit," × KES"," ",d.pricePerUnit))),e.createElement("p",{className:"font-medium text-gray-900"},"KES ",d.totalPrice.toLocaleString()))))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Delivery Information"),e.createElement("div",{className:"space-y-2 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-4 h-4 mr-2"}),l.deliveryAddress),e.createElement("div",{className:"flex items-center"},e.createElement(He,{className:"w-4 h-4 mr-2"}),l.deliveryPhone),e.createElement("div",{className:"flex items-center"},e.createElement(ot,{className:"w-4 h-4 mr-2"}),"Expected:"," ",new Date(l.estimatedDelivery).toLocaleDateString()))),e.createElement("div",{className:"border-t pt-4"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("span",{className:"text-lg font-medium text-gray-900"},"Total Amount"),e.createElement("span",{className:"text-lg font-bold text-gray-900"},"KES ",l.totalAmount.toLocaleString())),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Payment via ",l.paymentMethod)))))))}function si(){const{cart:t,updateQuantity:a,removeFromCart:r,clearCart:s,refreshCart:n}=pt(),{user:l,isAuthenticated:o}=X();_e();const[c,y]=C.useState(null),[m,u]=C.useState(""),[d,p]=C.useState(null);C.useEffect(()=>{n()},[n]);const b=async(g,I)=>{if(!(I<0)){y(g);try{I===0?r(g):a(g,I)}catch{}finally{y(null)}}},w=async g=>{if(window.confirm("Are you sure you want to remove this item from your cart?"))try{r(g)}catch{}},h=async()=>{if(window.confirm("Are you sure you want to clear your entire cart?"))try{await s()}catch{}},E=()=>{m.toLowerCase()==="first10"?(p({code:"FIRST10",discount:10,type:"percentage"}),P.success("Coupon applied successfully!"),u("")):m.toLowerCase()==="save100"?(p({code:"SAVE100",discount:100,type:"fixed"}),P.success("Coupon applied successfully!"),u("")):P.error("Invalid coupon code")},x=()=>{p(null),P.success("Coupon removed")},v=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g),D=g=>d?d.type==="percentage"?g*d.discount/100:Math.min(d.discount,g):0,S=g=>g>=1e3?0:150;if(!t||t.items.length===0)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center py-16"},e.createElement(Xe,{className:"w-24 h-24 text-gray-300 mx-auto mb-6"}),e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-4"},"Your cart is empty"),e.createElement("p",{className:"text-gray-600 mb-8"},"Looks like you haven't added any items to your cart yet."),e.createElement(H,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center"},e.createElement(Xe,{className:"w-5 h-5 mr-2"}),"Start Shopping")));const R=t.totalAmount,O=D(R),j=R-O,k=S(j),L=j+k;return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"flex items-center justify-between mb-8"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Shopping Cart"),e.createElement("p",{className:"text-gray-600 mt-2"},t.totalItems," ",t.totalItems===1?"item":"items"," in your cart")),t.items.length>0&&e.createElement("button",{onClick:h,className:"text-red-600 hover:text-red-700 text-sm font-medium"},"Clear Cart")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"space-y-6"},t.items.map(g=>e.createElement("div",{key:g.id,className:"flex items-start space-x-4 pb-6 border-b border-gray-200 last:border-b-0 last:pb-0"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src="/api/placeholder/80/80?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},"📦"))),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},e.createElement(H,{to:`/marketplace/product/${g.productId}`,className:"hover:text-primary-600 transition-colors"},g.name)),e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement("span",null,"Fresh Produce")),e.createElement("div",{className:"flex items-center space-x-4 mb-3"},e.createElement("span",{className:"text-lg font-semibold text-gray-900"},v(g.pricePerUnit)," / ",g.unit))),e.createElement("div",{className:"flex flex-col items-end space-y-2 ml-4"},e.createElement("button",{onClick:()=>w(g.id),className:"text-gray-400 hover:text-red-500 transition-colors",title:"Remove item"},e.createElement(ss,{className:"w-5 h-5"})),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors"},e.createElement(Za,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex items-center justify-between mt-4"},e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>b(g.id,g.quantity-1),disabled:c===g.id||g.quantity<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(vn,{className:"w-4 h-4"})),e.createElement("input",{type:"number",min:"1",max:999,value:g.quantity,onChange:I=>{const M=parseInt(I.target.value)||1;M!==g.quantity&&b(g.id,M)},className:"w-16 px-2 py-2 text-center border-0 focus:ring-0",disabled:c===g.id}),e.createElement("button",{onClick:()=>b(g.id,g.quantity+1),disabled:c===g.id,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(At,{className:"w-4 h-4"}))),e.createElement("div",{className:"text-right"},e.createElement("div",{className:"text-lg font-bold text-gray-900"},v((g.pricePerUnit||0)*(g.quantity||0))),g.quantity>1&&e.createElement("div",{className:"text-sm text-gray-600"},g.quantity," ×"," ",v(g.pricePerUnit||0)))),c===g.id&&e.createElement("div",{className:"mt-2 text-sm text-primary-600"},"Updating..."))))))),e.createElement("div",{className:"mt-6"},e.createElement(H,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 font-medium inline-flex items-center"},"← Continue Shopping"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",t.totalItems," items)"),e.createElement("span",null,v(R))),d&&e.createElement("div",{className:"flex justify-between text-green-600"},e.createElement("span",{className:"flex items-center"},e.createElement(ns,{className:"w-4 h-4 mr-1"}),d.code,e.createElement("button",{onClick:x,className:"ml-2 text-red-500 hover:text-red-700"},"×")),e.createElement("span",null,"-",v(O))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",k===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,v(k))),e.createElement("div",{className:"border-t border-gray-200 pt-3"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,v(L))))),e.createElement("div",{className:"mb-6"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Coupon Code"),e.createElement("div",{className:"flex space-x-2"},e.createElement("input",{type:"text",placeholder:"Enter coupon code",value:m,onChange:g=>u(g.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{onClick:E,disabled:!m.trim(),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},"Apply")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Try: FIRST10 (10% off) or SAVE100 (KES 100 off)")),e.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(oe,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},k===0?"🎉 You qualify for free delivery!":`Spend ${v(1e3-j)} more for free delivery`)),e.createElement(H,{to:"/checkout",className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center justify-center"},"Proceed to Checkout",e.createElement(Ee,{className:"w-5 h-5 ml-2"})),e.createElement("div",{className:"mt-4 text-center"},e.createElement("div",{className:"text-xs text-gray-500"},"🔒 Secure checkout powered by M-Pesa"))))))}const oa=t=>{const a=t.replace(/[\s\-\(\)]/g,"");return a.startsWith("+254")?a.substring(1):a.startsWith("254")?a:a.startsWith("0")?"254"+a.substring(1):a.length===9&&(a.startsWith("7")||a.startsWith("1"))?"254"+a:a},Ja=t=>{const a=oa(t);return/^254[71]\d{8}$/.test(a)},ni=async(t,a=30,r=2e3)=>{for(let s=0;s<a;s++)try{const l=await(await fetch(`/api/payments/status/${t}`)).json();if(l.status==="COMPLETED")return{success:!0,status:"COMPLETED",data:l};if(l.status==="FAILED"||l.status==="CANCELLED")return{success:!1,status:l.status,data:l};await new Promise(o=>setTimeout(o,r))}catch(n){console.error("Error polling payment status:",n)}return{success:!1,status:"TIMEOUT"}},li=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"];function oi(){const t=_e(),{cart:a,clearCart:r}=pt(),{user:s,isAuthenticated:n,loginWithData:l}=X(),[o,c]=C.useState(null),[y,m]=C.useState(!0),[u,d]=C.useState(!1),[p,b]=C.useState(1),[w,h]=C.useState(null),{register:E,handleSubmit:x,watch:v,setValue:D,formState:{errors:S}}=Xs({defaultValues:{firstName:s?.firstName||"",lastName:s?.lastName||"",phone:s?.phone||"",email:s?.email||"",paymentMethod:"MPESA",mpesaPhone:s?.phone||"",createAccount:!n,password:""}}),R=v("paymentMethod");v("county");const O=v("createAccount");C.useEffect(()=>{j()},[]);const j=async()=>{try{m(!0);const g=a.totalAmount>2e3?0:300,I={items:a.items,totalItems:a.totalItems,totalAmount:a.totalAmount,isReadyForCheckout:a.items.length>0,deliveryFee:g,subtotal:a.totalAmount,total:a.totalAmount+g,grandTotal:a.totalAmount+g,unavailableItems:[]};if(c(I),a.totalItems===0){P.error("Your cart is empty"),t("/marketplace");return}}catch(g){console.error("Failed to load cart summary:",g),P.error("Failed to load cart summary"),t("/cart")}finally{m(!1)}},k=async g=>{if(o){d(!0);try{const I={items:o.items.map(U=>({productId:U.productId,quantity:U.quantity,price:U.pricePerUnit})),customerInfo:{firstName:g.firstName,lastName:g.lastName,phone:g.phone,email:g.email,address:`${g.street}, ${g.ward}, ${g.subCounty}, ${g.county}`,county:g.county,buildingName:g.buildingName,deliveryInstructions:g.deliveryInstructions},paymentMethod:g.paymentMethod,mpesaPhone:g.paymentMethod==="MPESA"?g.mpesaPhone:void 0,deliveryFee:o.deliveryFee,totalAmount:o.grandTotal},M=await V.post("/api/orders",I);if(h(M.data),g.paymentMethod==="MPESA"&&g.mpesaPhone)try{const U=oa(g.mpesaPhone);if(!Ja(U)){P.error("Please enter a valid Kenyan phone number");return}P("Initiating M-Pesa payment...",{icon:"ℹ️"});const K=await V.post("/api/payments/stk-push",{phone:U,amount:o.grandTotal,orderId:M.data.orderId,accountReference:`Order-${M.data.orderId}`,transactionDesc:`Payment for order ${M.data.orderId}`});if(K.data.success){P.success("M-Pesa payment request sent! Please check your phone.");try{P("Waiting for payment confirmation...",{icon:"ℹ️"});const z=await ni(K.data.transactionId);z.success?P.success("Payment completed successfully!"):P.error(`Payment ${z.status.toLowerCase()}. Please try again.`)}catch(z){console.error("Payment polling error:",z),P("Payment initiated. Status will be updated shortly.",{icon:"⚠️"})}}else P.error("Failed to initiate M-Pesa payment")}catch(U){console.error("M-Pesa STK push error:",U),P.error("Failed to process M-Pesa payment")}if(!n&&g.createAccount&&g.password)try{const U={firstName:g.firstName,lastName:g.lastName,phone:g.phone,email:g.email,password:g.password,county:g.county,role:"CUSTOMER"},K=await V.post("/api/auth/register",U);if(K.data.success){const{user:z,token:W}=K.data;l(z,W),P.success("Account created and logged in successfully!")}}catch(U){console.error("Failed to create account:",U),P.error("Order placed successfully, but failed to create account. You can register later.")}await r(),b(4),P.success("Order placed successfully!")}catch(I){console.error("Failed to create order:",I);const M=I.response?.data?.error||"Failed to place order";P.error(M)}finally{d(!1)}}},L=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g);return y?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-32 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"h-48 bg-gray-200 rounded-lg"})),e.createElement("div",{className:"h-64 bg-gray-200 rounded-lg"})))):!o||o.totalItems===0?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement(Xe,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-2"},"No items to checkout"),e.createElement("p",{className:"text-gray-600 mb-6"},"Your cart is empty or items are unavailable"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Continue Shopping"))):e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("button",{onClick:()=>t("/cart"),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Back to Cart"),e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Checkout"),e.createElement("div",{className:"mt-6"},e.createElement("div",{className:"flex items-center"},[{step:1,title:"Information"},{step:2,title:"Review"},{step:3,title:"Payment"},{step:4,title:"Confirmation"}].map((g,I)=>e.createElement(e.Fragment,{key:g.step},e.createElement("div",{className:`flex items-center ${p>=g.step?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${p>=g.step?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},p>g.step?e.createElement(Qt,{className:"w-4 h-4"}):g.step),e.createElement("span",{className:"ml-2 text-sm font-medium"},g.title)),I<3&&e.createElement("div",{className:`flex-1 h-0.5 mx-4 ${p>g.step?"bg-primary-600":"bg-gray-200"}`})))))),p===4?e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-8 text-center"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(Qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Order Placed Successfully!"),w&&e.createElement("div",{className:"mb-6"},e.createElement("p",{className:"text-gray-600 mb-2"},"Order Number:"),e.createElement("p",{className:"text-lg font-semibold text-gray-900 mb-4"},w.order?.orderNumber||w.order?.id),e.createElement("p",{className:"text-gray-600 mb-2"},"Total Amount:"),e.createElement("p",{className:"text-2xl font-bold text-primary-600 mb-6"},L(o.grandTotal)),e.createElement("div",{className:"bg-blue-50 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center text-blue-700 mb-2"},e.createElement(oe,{className:"w-5 h-5 mr-2"}),e.createElement("span",{className:"font-medium"},"Estimated Delivery")),e.createElement("p",{className:"text-blue-600"},"1-2 business days"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>t("/customer/dashboard"),className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium"},"View Order Status"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Continue Shopping")))):e.createElement("form",{onSubmit:x(k)},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2 space-y-8"},p>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Re,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Customer Information")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...E("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...E("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.lastName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...E("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...E("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.email.message)))),p>=1&&!n&&e.createElement("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement(Nn,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Create Account (Optional)")),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{...E("createAccount"),type:"checkbox",className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-700"},"Create an account to track your orders and save delivery addresses"))),O&&e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("input",{...E("password",{required:O?"Password is required":!1,minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter password for your new account",disabled:p>1}),S.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.password.message))),p>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Ie,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Delivery Address")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...E("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1},e.createElement("option",{value:""},"Select County"),li.map(g=>e.createElement("option",{key:g,value:g},g))),S.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County *"),e.createElement("input",{...E("subCounty",{required:"Sub-county is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.subCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.subCounty.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ward *"),e.createElement("input",{...E("ward",{required:"Ward is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.ward&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.ward.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Street/Road *"),e.createElement("input",{...E("street",{required:"Street is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1}),S.street&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.street.message)),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Building/House Name"),e.createElement("input",{...E("buildingName"),placeholder:"Optional: Building name, house number, apartment, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1})),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Delivery Instructions"),e.createElement("textarea",{...E("deliveryInstructions"),rows:3,placeholder:"Optional: Special delivery instructions, landmarks, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>1})))),p>=2&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Fe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Payment Method")),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center"},e.createElement("input",{...E("paymentMethod"),type:"radio",value:"MPESA",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:p>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"M-Pesa STK Push")),R==="MPESA"&&e.createElement("div",{className:"ml-7"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"M-Pesa Phone Number *"),e.createElement("input",{...E("mpesaPhone",{required:R==="MPESA"?"M-Pesa phone number is required":!1,pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full max-w-md border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:p>2}),S.mpesaPhone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},S.mpesaPhone.message)),e.createElement("div",{className:"flex items-center"},e.createElement("input",{...E("paymentMethod"),type:"radio",value:"COD",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:p>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"Cash on Delivery")))),e.createElement("div",{className:"flex justify-between"},p>1&&p<4&&e.createElement("button",{type:"button",onClick:()=>b(p-1),className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Previous"),p<3&&e.createElement("button",{type:"button",onClick:()=>b(p+1),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium ml-auto"},"Next"),p===3&&e.createElement("button",{type:"submit",disabled:u,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium ml-auto"},u?"Placing Order...":"Place Order"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto"},o.items.map(g=>e.createElement("div",{key:g.id,className:"flex items-center space-x-3"},e.createElement("div",{className:"w-12 h-12 bg-gray-200 rounded overflow-hidden flex-shrink-0"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src="/api/placeholder/48/48?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},"📦")),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},g.name),e.createElement("p",{className:"text-xs text-gray-600"},g.quantity," × ",L(g.pricePerUnit))),e.createElement("p",{className:"text-sm font-medium text-gray-900"},L((g.pricePerUnit||0)*(g.quantity||0)))))),e.createElement("div",{className:"space-y-2 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",o.totalItems," items)"),e.createElement("span",null,L(o.totalAmount))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",o.deliveryFee===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,L(o.deliveryFee))),e.createElement("div",{className:"border-t border-gray-200 pt-2"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,L(o.grandTotal))))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(re,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},"Orders placed before 3 PM are processed the same day")))))))}function ci(){const{user:t,token:a}=X(),r=_e(),s=E=>{r("/admin/consignments")},n=async E=>{try{await new Promise(x=>setTimeout(x,500)),P.success(`User ${E} approved successfully`),y(x=>({...x,recentUsers:x.recentUsers.map(v=>v.id===E?{...v,status:"ACTIVE"}:v),pendingApprovals:Math.max(0,x.pendingApprovals-1)}))}catch(x){console.error("Error approving user:",x),P.error("Failed to approve user")}},l=async()=>{try{console.log("👥 Fetching users from real database");const x=(await de.get("/admin/users")).data,v=x.users||x;console.log("👥 Users data received:",v);const D=Array.isArray(v)?v:[];y(S=>({...S,totalUsers:D.length,pendingApprovals:D.filter(R=>!R.verified).length,recentUsers:D.slice(0,5).map(R=>({id:R.id,name:`${R.first_name||R.firstName} ${R.last_name||R.lastName}`,email:R.email,role:R.role,status:R.verified?"ACTIVE":"PENDING",joinedAt:new Date(R.created_at||R.createdAt).toLocaleDateString()}))}))}catch(E){console.error("Error fetching users:",E),y(x=>({...x,totalUsers:5,pendingApprovals:2,recentUsers:[{id:1,name:"Admin User",email:"admin@zuasoko.com",role:"ADMIN",status:"ACTIVE",joinedAt:new Date().toLocaleDateString()},{id:2,name:"John Kimani",email:"john@example.com",role:"FARMER",status:"ACTIVE",joinedAt:new Date().toLocaleDateString()}]})),P.error("Using demo user data - API unavailable")}},o=async()=>{try{console.log("🔄 Fetching recent activity from database");const E=await de.get("/admin/activity");if(E.data.success){const x=E.data.activities.map(v=>({id:v.id,type:v.type,message:v.description,time:new Date(v.timestamp).toLocaleString(),status:v.status}));y(v=>({...v,recentActivities:x})),console.log("✅ Recent activity loaded:",x)}}catch(E){console.error("❌ Error fetching recent activity:",E),y(x=>({...x,recentActivities:[{id:1,type:"user",message:"New farmer registration: John Kimani",time:"5 minutes ago",status:"pending"},{id:2,type:"consignment",message:"Consignment submitted by Jane Wanjiku",time:"15 minutes ago",status:"pending"}]}))}},[c,y]=C.useState({totalUsers:0,pendingApprovals:0,activeConsignments:0,monthlyRevenue:0,recentActivities:[],pendingConsignments:[],recentUsers:[]}),[m,u]=C.useState(!0),d=async()=>{try{console.log("📊 Fetching analytics stats from database");const E=await de.get("/admin/analytics/stats");if(E.data.success){const x=E.data.stats;console.log("📊 Analytics stats received:",x),y(v=>({...v,totalUsers:x.totalUsers||0,pendingApprovals:x.pendingApprovals||0,activeConsignments:x.totalConsignments||0,monthlyRevenue:x.totalRevenue||0}))}}catch(E){console.error("❌ Error fetching analytics stats:",E),y(x=>({...x,totalUsers:5,pendingApprovals:2,activeConsignments:8,monthlyRevenue:45e3})),P.error("Using demo analytics data - API unavailable")}};C.useEffect(()=>{(async()=>{u(!0),await Promise.all([l(),d(),o()]),y(x=>({...x,pendingConsignments:[{id:1,title:"Organic Tomatoes - 100kg",farmer:"Jane Wanjiku",value:13e3,submittedAt:"2 hours ago"},{id:2,title:"Premium Maize - 200kg",farmer:"Peter Kamau",value:12e3,submittedAt:"5 hours ago"},{id:3,title:"Fresh Spinach - 50 bunches",farmer:"Grace Muthoni",value:2500,submittedAt:"1 day ago"}]})),u(!1)})()},[]);const p=[{title:"Manage Users",description:"View and manage platform users",icon:Pe,color:"bg-blue-500",link:"/admin/users",count:c.totalUsers},{title:"Review Consignments",description:"Approve pending consignments",icon:B,color:"bg-green-500",link:"/admin/consignments",count:c.pendingApprovals},{title:"Marketplace Management",description:"Manage products and orders",icon:Ae,color:"bg-orange-500",link:"/admin/marketplace",count:null},{title:"Registration Fees",description:"Manage farmer registration fees",icon:Fe,color:"bg-red-500",link:"/admin/registration-fees",count:null},{title:"View Analytics",description:"Platform insights and metrics",icon:Ya,color:"bg-purple-500",link:"/admin/analytics",count:null},{title:"System Settings",description:"Configure platform settings",icon:dt,color:"bg-gray-500",link:"/admin/settings",count:null}],b=E=>{switch(E){case"user":return e.createElement(Pe,{className:"w-4 h-4"});case"consignment":return e.createElement(B,{className:"w-4 h-4"});case"order":return e.createElement(Ae,{className:"w-4 h-4"});case"driver":return e.createElement(re,{className:"w-4 h-4"});default:return e.createElement(Jt,{className:"w-4 h-4"})}},w=E=>{switch(E){case"pending":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},h=E=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(E);return m?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading dashboard..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-1"},"Here's what's happening on your platform today.")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(Jt,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>r("/admin/users"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},c.totalUsers),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/users?filter=pending"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(Ke,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},c.pendingApprovals),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approvals"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/consignments"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(B,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},c.activeConsignments),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Consignments"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/analytics"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-purple-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors"},e.createElement(Ae,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-purple-600 transition-colors"},h(c.monthlyRevenue)),e.createElement("p",{className:"text-gray-600 text-sm"},"Monthly Revenue"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-purple-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-6"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},p.map((E,x)=>e.createElement(H,{key:x,to:E.link,className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200 group"},e.createElement("div",{className:"flex items-start justify-between mb-3"},e.createElement("div",{className:`p-2 rounded-lg ${E.color}`},e.createElement(E.icon,{className:"w-5 h-5 text-white"})),E.count!==null&&e.createElement("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-xs font-medium"},E.count)),e.createElement("h3",{className:"font-medium text-gray-900 group-hover:text-primary-600 transition-colors"},E.title),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},E.description),e.createElement("div",{className:"flex items-center mt-3 text-primary-600 group-hover:text-primary-700"},e.createElement("span",{className:"text-sm font-medium"},"Manage"),e.createElement(Ee,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement(lt,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.recentActivities.map(E=>e.createElement("div",{key:E.id,className:"p-6"},e.createElement("div",{className:"flex items-start"},e.createElement("div",{className:`p-2 rounded-lg ${w(E.status)} mr-4`},b(E.type)),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},E.message),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},E.time)),E.status==="pending"&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},"Action Required"))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/notifications",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all activities →"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Pending Consignments"),e.createElement(B,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.pendingConsignments.map(E=>e.createElement("div",{key:E.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h4",{className:"text-sm font-medium text-gray-900"},E.title),e.createElement("p",{className:"text-sm text-gray-500"},"by ",E.farmer),e.createElement("p",{className:"text-sm text-gray-500"},E.submittedAt)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},h(E.value)),e.createElement("button",{onClick:()=>s(E.id),className:"mt-2 bg-primary-600 text-white px-3 py-1 rounded text-xs hover:bg-primary-700"},"Review")))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/consignments",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all consignments →")))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Users"),e.createElement(Ma,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Action"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.recentUsers.map(E=>e.createElement("tr",{key:E.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},E.name)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800"},E.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${E.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},E.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},E.joinedAt),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},E.status==="PENDING"?e.createElement("button",{onClick:()=>n(E.id),className:"text-green-600 hover:text-green-900"},"Approve"):e.createElement("button",{onClick:()=>r("/admin/users"),className:"text-primary-600 hover:text-primary-900"},"View"))))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/users",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all users →")))))}const ii={ADMIN:"bg-red-100 text-red-800",FARMER:"bg-green-100 text-green-800",CUSTOMER:"bg-blue-100 text-blue-800",DRIVER:"bg-purple-100 text-purple-800",AGENT:"bg-yellow-100 text-yellow-800"},mi={ACTIVE:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",SUSPENDED:"bg-orange-100 text-orange-800",BLOCKED:"bg-red-100 text-red-800"};function di(){const{token:t}=X(),[a,r]=C.useState([]),[s,n]=C.useState(!0),[l,o]=C.useState(""),[c,y]=C.useState("ALL"),[m,u]=C.useState("ALL"),[d,p]=C.useState(null),[b,w]=C.useState(!1),[h,E]=C.useState("activate");C.useEffect(()=>{x()},[]);const x=async()=>{try{const k=[{id:"1",phone:"+254712345678",email:"admin@zuasoko.com",firstName:"Admin",lastName:"User",role:"ADMIN",status:"ACTIVE",createdAt:new Date().toISOString()},{id:"2",phone:"+254734567890",email:"farmer@zuasoko.com",firstName:"Jane",lastName:"Wanjiku",role:"FARMER",status:"ACTIVE",profile:{farmName:"Green Valley Farm",county:"Kiambu"},createdAt:new Date(Date.now()-6048e5).toISOString()},{id:"3",phone:"+254756789012",email:"customer@zuasoko.com",firstName:"Mary",lastName:"Wangari",role:"CUSTOMER",status:"ACTIVE",profile:{county:"Nairobi"},createdAt:new Date(Date.now()-12096e5).toISOString()},{id:"4",phone:"+254778901234",email:"driver@zuasoko.com",firstName:"Michael",lastName:"Kiprotich",role:"DRIVER",status:"ACTIVE",profile:{vehicleType:"Pickup Truck",licenseNumber:"DL123456789"},createdAt:new Date(Date.now()-18144e5).toISOString()},{id:"5",phone:"+254790123456",email:"pending.farmer@zuasoko.com",firstName:"John",lastName:"Kimani",role:"FARMER",status:"PENDING",profile:{farmName:"Highlands Farm",county:"Nyeri"},createdAt:new Date(Date.now()-1728e5).toISOString()}];r(k)}catch(k){console.error("Error fetching users:",k),P.error("Failed to fetch users")}finally{n(!1)}},v=(k,L)=>{p(k),E(L),w(!0)},D=async()=>{if(d)try{let k=d.status,L="";switch(h){case"activate":k="ACTIVE",L="User activated successfully";break;case"suspend":k="SUSPENDED",L="User suspended successfully";break;case"block":k="BLOCKED",L="User blocked successfully";break;case"delete":r(a.filter(g=>g.id!==d.id)),P.success("User deleted successfully"),w(!1);return}r(a.map(g=>g.id===d.id?{...g,status:k}:g)),P.success(L),w(!1)}catch{P.error("Failed to update user")}},S=Array.isArray(a)?a:[],R=S.filter(k=>{const L=k.firstName.toLowerCase().includes(l.toLowerCase())||k.lastName.toLowerCase().includes(l.toLowerCase())||k.email?.toLowerCase().includes(l.toLowerCase())||k.phone.includes(l),g=c==="ALL"||k.role===c,I=m==="ALL"||k.status===m;return L&&g&&I}),j=(()=>{const k=S.length,L=S.filter(M=>M.status==="ACTIVE").length,g=S.filter(M=>M.status==="PENDING").length,I=S.filter(M=>M.status==="BLOCKED"||M.status==="SUSPENDED").length;return{total:k,active:L,pending:g,blocked:I}})();return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading users..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"User Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage platform users and their permissions")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(Ve,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Panel")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>{y("ALL"),u("ALL"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},j.total),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{y("ALL"),u("ACTIVE"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(Ma,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},j.active),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Users"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{y("ALL"),u("PENDING"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(Ma,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},j.pending),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approval"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{y("ALL"),u("SUSPENDED"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-red-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg group-hover:bg-red-200 transition-colors"},e.createElement(wn,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-red-600 transition-colors"},j.blocked),e.createElement("p",{className:"text-gray-600 text-sm"},"Blocked/Suspended"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-red-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.createElement("input",{type:"text",placeholder:"Search users...",value:l,onChange:k=>o(k.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:c,onChange:k=>y(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Roles"),e.createElement("option",{value:"ADMIN"},"Admin"),e.createElement("option",{value:"FARMER"},"Farmer"),e.createElement("option",{value:"CUSTOMER"},"Customer"),e.createElement("option",{value:"DRIVER"},"Driver"),e.createElement("option",{value:"AGENT"},"Agent")),e.createElement("select",{value:m,onChange:k=>u(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Status"),e.createElement("option",{value:"ACTIVE"},"Active"),e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"SUSPENDED"},"Suspended"),e.createElement("option",{value:"BLOCKED"},"Blocked"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Users (",R.length,")")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contact"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},R.map(k=>e.createElement("tr",{key:k.id,className:"hover:bg-gray-50"},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement("span",{className:"text-primary-600 font-medium"},k.firstName[0],k.lastName[0])),e.createElement("div",{className:"ml-4"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},k.firstName," ",k.lastName),k.profile?.farmName&&e.createElement("div",{className:"text-sm text-gray-500"},k.profile.farmName)))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm text-gray-900"},e.createElement("div",{className:"flex items-center gap-1 mb-1"},e.createElement(He,{className:"w-3 h-3"}),k.phone),k.email&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(ia,{className:"w-3 h-3"}),k.email))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ii[k.role]||"bg-gray-100 text-gray-800"}`},k.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${mi[k.status]||"bg-gray-100 text-gray-800"}`},k.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},new Date(k.createdAt).toLocaleDateString()),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},e.createElement("div",{className:"flex items-center gap-2"},k.status==="PENDING"&&e.createElement("button",{onClick:()=>v(k,"activate"),className:"text-green-600 hover:text-green-900"},"Activate"),k.status==="ACTIVE"&&e.createElement("button",{onClick:()=>v(k,"suspend"),className:"text-yellow-600 hover:text-yellow-900"},"Suspend"),k.status!=="BLOCKED"&&e.createElement("button",{onClick:()=>v(k,"block"),className:"text-red-600 hover:text-red-900"},"Block"))))))))),b&&d&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Confirm Action")),e.createElement("div",{className:"p-6"},e.createElement("p",{className:"text-gray-600 mb-4"},"Are you sure you want to ",h,' user "',d.firstName," ",d.lastName,'"?'),h==="delete"&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},e.createElement("p",{className:"text-red-700 text-sm"},e.createElement("strong",null,"Warning:")," This action cannot be undone. All user data will be permanently deleted.")),e.createElement("div",{className:"flex gap-4"},e.createElement("button",{type:"button",onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:D,className:`flex-1 px-4 py-2 rounded-lg transition-colors ${h==="delete"?"bg-red-600 text-white hover:bg-red-700":"bg-primary-600 text-white hover:bg-primary-700"}`},"Confirm ",h)))))))}const ui={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:oe,label:"Pending Review"},APPROVED:{color:"bg-green-100 text-green-800",icon:ae,label:"Approved"},REJECTED:{color:"bg-red-100 text-red-800",icon:Sn,label:"Rejected"},PRICE_SUGGESTED:{color:"bg-blue-100 text-blue-800",icon:Ae,label:"Price Suggested"},DRIVER_ASSIGNED:{color:"bg-purple-100 text-purple-800",icon:re,label:"Driver Assigned"},IN_TRANSIT:{color:"bg-indigo-100 text-indigo-800",icon:re,label:"In Transit"},DELIVERED:{color:"bg-teal-100 text-teal-800",icon:B,label:"Delivered"},COMPLETED:{color:"bg-gray-100 text-gray-800",icon:ae,label:"Completed"}};function gi(){const{token:t}=X(),[a,r]=C.useState([]),[s,n]=C.useState([]),[l,o]=C.useState(!0),[c,y]=C.useState("ALL"),[m,u]=C.useState(null),[d,p]=C.useState(!1),[b,w]=C.useState("approve"),[h,E]=C.useState(""),[x,v]=C.useState("");C.useEffect(()=>{D(),S()},[]);const D=async()=>{try{console.log("📦 Fetching consignments from live database");const g=await V.get("/api/admin/consignments",{headers:{Authorization:`Bearer ${t}`}});console.log("📦 Consignments response:",g.data);const I=Array.isArray(g.data)?g.data:g.data.consignments||[];console.log("📦 Setting consignments array:",I),r(Array.isArray(I)?I:[])}catch(g){console.error("❌ Error fetching consignments:",g),P.error("Failed to fetch consignments from database"),r([])}finally{o(!1)}},S=async()=>{try{console.log("🚛 Fetching drivers from live database");const g=await V.get("/api/admin/drivers",{headers:{Authorization:`Bearer ${t}`}});console.log("🚛 Drivers response:",g.data);const I=Array.isArray(g.data)?g.data:g.data.drivers||[];console.log("🚛 Setting drivers array:",I),n(Array.isArray(I)?I:[])}catch(g){console.error("❌ Error fetching drivers:",g),P.error("Failed to fetch drivers from database"),n([])}},R=async(g,I)=>{if(u(g),w(I),p(!0),I==="suggest_price"){const M=g.proposedPricePerUnit||g.price_per_unit||0;E(M.toString())}},O=async()=>{if(m)try{let g={};switch(b){case"approve":g={status:"APPROVED"};break;case"reject":g={status:"REJECTED"};break;case"suggest_price":if(!h||Number(h)<=0){P.error("Please enter a valid price");return}g={status:"PRICE_SUGGESTED",suggestedPrice:Number(h)};break;case"assign_driver":if(!x){P.error("Please select a driver");return}g={status:"DRIVER_ASSIGNED",driverId:x};break}await V.patch(`/api/admin/consignments/${m.id}`,g,{headers:{Authorization:`Bearer ${t}`}}),P.success("Consignment updated successfully!"),p(!1),D(),E(""),v("")}catch(g){console.error("Error updating consignment:",g),P.error("Failed to update consignment")}},j=Array.isArray(a)?a:[],k=c==="ALL"?j:j.filter(g=>g.status===c),L=g=>{switch(g.status){case"PENDING":return e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>R(g,"approve"),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Approve"),e.createElement("button",{onClick:()=>R(g,"suggest_price"),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},"Suggest Price"),e.createElement("button",{onClick:()=>R(g,"reject"),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"},"Reject"));case"APPROVED":return e.createElement("button",{onClick:()=>R(g,"assign_driver"),className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700"},"Assign Driver");default:return null}};return l?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading consignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Consignment Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Review and manage farmer consignments")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},j.filter(g=>g.status==="PENDING").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Review")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(ae,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},j.filter(g=>g.status==="APPROVED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Approved")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(re,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},j.filter(g=>g.status==="DRIVER_ASSIGNED"||g.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},j.filter(g=>g.status==="DELIVERED"||g.status==="COMPLETED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-wrap gap-2"},["ALL","PENDING","APPROVED","DRIVER_ASSIGNED","IN_TRANSIT","DELIVERED"].map(g=>e.createElement("button",{key:g,onClick:()=>y(g),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c===g?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},g.replace("_"," "))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Consignments (",k.length,")")),k.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No consignments found"),e.createElement("p",{className:"text-gray-600"},c==="ALL"?"No consignments have been submitted yet":`No ${c.toLowerCase()} consignments`)):e.createElement("div",{className:"divide-y divide-gray-200"},k.map(g=>{const I=ui[g.status],M=I?.icon||B,K=(g.finalPricePerUnit||g.proposedPricePerUnit||g.price_per_unit||0)*(g.quantity||0);return e.createElement("div",{key:g.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},g.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},g.description),g.farmer&&e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Re,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(He,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.phone)),g.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ie,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.profile.county))),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,g.quantity," ",g.unit),e.createElement("span",null,"•"),e.createElement("span",null,"KSh ",g.proposedPricePerUnit||g.price_per_unit||0," per"," ",g.unit),e.createElement("span",null,"•"),e.createElement("span",null,g.category),e.createElement("span",null,"•"),e.createElement("span",null,"Total: KSh ",K.toLocaleString())),g.status==="PRICE_SUGGESTED"&&g.adminSuggestedPrice&&e.createElement("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("p",{className:"text-sm text-blue-700"},e.createElement("strong",null,"Price suggested:")," KSh"," ",g.adminSuggestedPrice," per"," ",g.unit,e.createElement("span",{className:"ml-2 text-blue-600"},"(Total: KSh"," ",(g.adminSuggestedPrice*g.quantity).toLocaleString(),")")))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${I?.color||"bg-gray-100 text-gray-800"}`},e.createElement(M,{className:"w-4 h-4"}),I?.label||g.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(ot,{className:"w-3 h-3"}),new Date(g.createdAt).toLocaleDateString()),L(g))))}))),d&&m&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},b==="approve"&&"Approve Consignment",b==="reject"&&"Reject Consignment",b==="suggest_price"&&"Suggest New Price",b==="assign_driver"&&"Assign Driver"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},m.title)),e.createElement("div",{className:"p-6"},b==="suggest_price"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Current proposed price: KSh"," ",m.proposedPricePerUnit||m.price_per_unit||0," per"," ",m.unit),e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Your suggested price (KSh per ",m.unit,")"),e.createElement("input",{type:"number",value:h,onChange:g=>E(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter suggested price",min:"1",required:!0}))),b==="assign_driver"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Select Driver"),e.createElement("select",{value:x,onChange:g=>v(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0},e.createElement("option",{value:""},"Choose a driver"),Array.isArray(s)?s.filter(g=>g.status==="ACTIVE"&&g.verified).map(g=>e.createElement("option",{key:g.id,value:g.id},g.first_name," ",g.last_name," - ",g.vehicle_type," (",g.vehicle_registration,") - Rating:"," ",g.rating,"⭐")):[]))),(b==="approve"||b==="reject")&&e.createElement("p",{className:"text-gray-600"},"Are you sure you want to ",b," this consignment?"),e.createElement("div",{className:"flex gap-4 mt-6"},e.createElement("button",{type:"button",onClick:()=>p(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:O,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors"},"Confirm")))))))}function fi(){const{token:t}=X(),a=_e(),[r,s]=C.useState(!0),[n,l]=C.useState("30"),[o,c]=C.useState({totalUsers:0,totalConsignments:0,totalOrders:0,totalRevenue:0,activeDrivers:0,pendingApprovals:0,userGrowth:0,revenueGrowth:0}),[y,m]=C.useState([]);C.useEffect(()=>{u()},[]);const u=async()=>{try{s(!0),console.log("📊 Fetching analytics data from database");const h=await de.get("/admin/analytics/stats");h.data.success&&(c(h.data.stats),console.log("✅ Analytics stats loaded:",h.data.stats)),m([{month:"Jan",revenue:42e3,orders:156,users:89},{month:"Feb",revenue:38e3,orders:142,users:112},{month:"Mar",revenue:45e3,orders:168,users:95},{month:"Apr",revenue:52e3,orders:195,users:134},{month:"May",revenue:48e3,orders:178,users:108},{month:"Jun",revenue:55e3,orders:205,users:167}]),console.log("✅ Monthly chart data set (fallback data)")}catch(h){console.error("❌ Error fetching analytics:",h),P.error("Failed to fetch analytics data"),c({totalUsers:1247,totalConsignments:856,totalOrders:2341,totalRevenue:4567890,activeDrivers:23,pendingApprovals:12,userGrowth:12.5,revenueGrowth:8.2}),m([{name:"Jan",value:32e4},{name:"Feb",value:28e4},{name:"Mar",value:45e4},{name:"Apr",value:38e4},{name:"May",value:52e4},{name:"Jun",value:49e4},{name:"Jul",value:64e4},{name:"Aug",value:58e4},{name:"Sep",value:72e4},{name:"Oct",value:68e4},{name:"Nov",value:75e4},{name:"Dec",value:82e4}])}finally{s(!1)}},[d]=C.useState([{name:"Vegetables",value:45},{name:"Fruits",value:25},{name:"Grains",value:15},{name:"Leafy Greens",value:10},{name:"Others",value:5}]),[p]=C.useState([{id:1,type:"order",message:"New order placed by Mary Wangari",amount:"KSh 2,450",time:"5 minutes ago"},{id:2,type:"consignment",message:"Consignment approved for Jane Wanjiku",amount:"KSh 15,000",time:"12 minutes ago"},{id:3,type:"user",message:"New farmer registered: Peter Kamau",amount:"",time:"25 minutes ago"},{id:4,type:"delivery",message:"Delivery completed by Michael Kiprotich",amount:"KSh 3,200",time:"1 hour ago"},{id:5,type:"payment",message:"Payment processed for Grace Muthoni",amount:"KSh 8,750",time:"2 hours ago"}]);C.useEffect(()=>{setTimeout(()=>s(!1),1e3)},[n]);const b=h=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(h||0),w=h=>{switch(h){case"order":return e.createElement(B,{className:"w-4 h-4 text-blue-600"});case"consignment":return e.createElement(Ye,{className:"w-4 h-4 text-green-600"});case"user":return e.createElement(Pe,{className:"w-4 h-4 text-purple-600"});case"delivery":return e.createElement(re,{className:"w-4 h-4 text-orange-600"});case"payment":return e.createElement(Ae,{className:"w-4 h-4 text-emerald-600"});default:return e.createElement(Jt,{className:"w-4 h-4 text-gray-600"})}};return r?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading analytics..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Analytics Dashboard"),e.createElement("p",{className:"text-gray-600 mt-1"},"Platform insights and performance metrics")),e.createElement("div",{className:"flex items-center gap-4"},e.createElement("button",{onClick:u,disabled:r,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},e.createElement(et,{className:`w-4 h-4 ${r?"animate-spin":""}`}),e.createElement("span",null,"Refresh")),e.createElement("select",{value:n,onChange:h=>l(h.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"7"},"Last 7 days"),e.createElement("option",{value:"30"},"Last 30 days"),e.createElement("option",{value:"90"},"Last 3 months"),e.createElement("option",{value:"365"},"Last year")),e.createElement("button",{className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(Ht,{className:"w-4 h-4"}),"Export")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Revenue"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},b(o.totalRevenue))),e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(Ae,{className:"w-6 h-6 text-green-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Ye,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",o.revenueGrowth||0,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Users"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},(o.totalUsers||0).toLocaleString())),e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Ye,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",o.userGrowth||0,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},(o.totalOrders||0).toLocaleString())),e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-purple-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Ye,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+15.3%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Active Drivers"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.activeDrivers||0)),e.createElement("div",{className:"p-3 bg-orange-100 rounded-lg"},e.createElement(re,{className:"w-6 h-6 text-orange-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Ye,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+2"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Monthly Revenue"),e.createElement(Ya,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"h-64 flex items-end justify-between gap-2"},y.map((h,E)=>e.createElement("div",{key:E,className:"flex flex-col items-center flex-1"},e.createElement("div",{className:"bg-primary-600 rounded-t w-full transition-all duration-300 hover:bg-primary-700",style:{height:`${h.value/Math.max(...y.map(x=>x.value))*100}%`,minHeight:"4px"}}),e.createElement("span",{className:"text-xs text-gray-500 mt-2"},h.name))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Product Categories"),e.createElement(kn,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"space-y-4"},d.map((h,E)=>e.createElement("div",{key:E,className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-4 h-4 rounded mr-3",style:{backgroundColor:`hsl(${E*72}, 70%, 50%)`}}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},h.name)),e.createElement("span",{className:"text-sm text-gray-500"},h.value,"%")))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement(Jt,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},p.map(h=>e.createElement("div",{key:h.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg mr-4"},w(h.type)),e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},h.message),e.createElement("p",{className:"text-sm text-gray-500"},h.time))),h.amount&&e.createElement("div",{className:"text-sm font-medium text-gray-900"},h.amount)))))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>a("/admin/users"),className:"p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors text-left group"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-blue-700"},"Manage Users"),e.createElement("p",{className:"text-sm text-gray-500"},"View and manage platform users")),e.createElement("button",{onClick:()=>a("/admin/consignments"),className:"p-4 border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300 transition-colors text-left group"},e.createElement(B,{className:"w-6 h-6 text-green-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-green-700"},"Review Consignments"),e.createElement("p",{className:"text-sm text-gray-500"},"Approve pending consignments")),e.createElement("button",{onClick:()=>a("/admin/registration-fees"),className:"p-4 border border-gray-200 rounded-lg hover:bg-purple-50 hover:border-purple-300 transition-colors text-left group"},e.createElement(Ht,{className:"w-6 h-6 text-purple-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-purple-700"},"Registration Fees"),e.createElement("p",{className:"text-sm text-gray-500"},"Manage farmer registration fees"))))))}function pi(){const{token:t}=X(),[a,r]=C.useState(!0),[s,n]=C.useState(!1),[l,o]=C.useState("platform"),[c,y]=C.useState(!1),[m,u]=C.useState({platform:{name:"Zuasoko Agricultural Platform",description:"Connecting farmers directly with customers and managing agricultural supply chains",supportEmail:"support@zuasoko.com",supportPhone:"+254700000000"},fees:{farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7},payments:{mpesaEnabled:!0,mpesaShortcode:"174379",mpesaPasskey:"",bankTransferEnabled:!0,commissionRate:5},notifications:{emailEnabled:!0,smsEnabled:!0,pushEnabled:!0,adminNotifications:!0},security:{passwordMinLength:8,sessionTimeout:24,twoFactorRequired:!1,maxLoginAttempts:5},features:{consignmentApprovalRequired:!0,autoDriverAssignment:!1,inventoryTracking:!0,priceModeration:!0}});C.useEffect(()=>{d()},[]);const d=async()=>{try{const h=await V.get("/api/admin/settings",{headers:{Authorization:`Bearer ${t}`}});h.data.settings&&u(h.data.settings)}catch{console.log("Using default settings - API endpoint not available")}finally{r(!1)}},p=async()=>{n(!0);try{await V.put("/api/admin/settings",m,{headers:{Authorization:`Bearer ${t}`}}),P.success("Settings saved successfully")}catch(h){console.error("Error saving settings:",h),P.success("Settings saved locally (demo mode)")}finally{n(!1)}},b=(h,E,x)=>{u(v=>({...v,[h]:{...v[h],[E]:x}}))},w=[{id:"platform",label:"Platform",icon:pr},{id:"payments",label:"Payments",icon:Fe},{id:"fees",label:"Registration Fees",icon:Ae},{id:"notifications",label:"Notifications",icon:lt},{id:"security",label:"Security",icon:Ve},{id:"features",label:"Features",icon:dt}];return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(et,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading settings..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"System Settings"),e.createElement("p",{className:"text-gray-600 mt-1"},"Configure platform settings and system behavior")),e.createElement("button",{onClick:p,disabled:s,className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},s?e.createElement(et,{className:"w-4 h-4 animate-spin"}):e.createElement(Xa,{className:"w-4 h-4"}),e.createElement("span",null,s?"Saving...":"Save Changes")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8"},e.createElement("div",{className:"lg:col-span-1"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Settings Categories")),e.createElement("nav",{className:"p-2"},w.map(h=>e.createElement("button",{key:h.id,onClick:()=>o(h.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${l===h.id?"bg-green-50 text-green-700 border border-green-200":"text-gray-600 hover:bg-gray-50"}`},e.createElement(h.icon,{className:"w-5 h-5"}),e.createElement("span",null,h.label)))))),e.createElement("div",{className:"lg:col-span-3"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},l==="platform"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(pr,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Name"),e.createElement("input",{type:"text",value:m.platform?.name||"",onChange:h=>b("platform","name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Description"),e.createElement("textarea",{value:m.platform?.description||"",onChange:h=>b("platform","description",h.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Email"),e.createElement("input",{type:"email",value:m.platform?.supportEmail||"",onChange:h=>b("platform","supportEmail",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Phone"),e.createElement("input",{type:"tel",value:m.platform?.supportPhone||"",onChange:h=>b("platform","supportPhone",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))))),l==="payments"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Fe,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Payment Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"M-Pesa Integration"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable M-Pesa payments")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.payments?.mpesaEnabled||!1,onChange:h=>b("payments","mpesaEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Bank Transfer"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable bank transfers")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.payments?.bankTransferEnabled||!1,onChange:h=>b("payments","bankTransferEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))),m.payments.mpesaEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"M-Pesa Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Business Shortcode"),e.createElement("input",{type:"text",value:m.payments.mpesaShortcode,onChange:h=>b("payments","mpesaShortcode",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Passkey"),e.createElement("div",{className:"relative"},e.createElement("input",{type:c?"text":"password",value:m.payments.mpesaPasskey,onChange:h=>b("payments","mpesaPasskey",h.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter M-Pesa passkey"}),e.createElement("button",{type:"button",onClick:()=>y(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center"},c?e.createElement(Wt,{className:"w-4 h-4 text-gray-400"}):e.createElement(Be,{className:"w-4 h-4 text-gray-400"})))))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Commission Rate (%)"),e.createElement("input",{type:"number",min:"0",max:"20",step:"0.1",value:m.payments.commissionRate,onChange:h=>b("payments","commissionRate",parseFloat(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Platform commission charged on transactions")))),l==="notifications"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(lt,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Notification Settings")),e.createElement("div",{className:"space-y-4"},[{key:"emailEnabled",label:"Email Notifications",desc:"Send notifications via email"},{key:"smsEnabled",label:"SMS Notifications",desc:"Send notifications via SMS"},{key:"pushEnabled",label:"Push Notifications",desc:"Send push notifications to mobile apps"},{key:"adminNotifications",label:"Admin Notifications",desc:"Receive admin-specific notifications"}].map(h=>e.createElement("div",{key:h.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},h.label),e.createElement("p",{className:"text-sm text-gray-600"},h.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.notifications?.[h.key]||!1,onChange:E=>b("notifications",h.key,E.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))),l==="fees"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Ae,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Registration Fee Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(Cn,{className:"w-5 h-5 text-yellow-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-yellow-800"},"Important"),e.createElement("p",{className:"text-sm text-yellow-700 mt-1"},"Farmers must pay the registration fee before they can register consignments. This helps maintain platform quality and covers operational costs.")))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Enable Registration Fee"),e.createElement("p",{className:"text-sm text-gray-600"},"Require farmers to pay registration fee before consignment submission")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.fees.registrationFeeEnabled,onChange:h=>b("fees","registrationFeeEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),m.fees.registrationFeeEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"Registration Fee Settings"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Registration Fee Amount (KES)"),e.createElement("input",{type:"number",min:"0",step:"1",value:m.fees.farmerRegistrationFee,onChange:h=>b("fees","farmerRegistrationFee",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Amount farmers must pay to register on the platform")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Grace Period (Days)"),e.createElement("input",{type:"number",min:"0",max:"30",value:m.fees.gracePeriodDays,onChange:h=>b("fees","gracePeriodDays",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Days to allow farmers to submit consignments before payment"))),e.createElement("div",{className:"bg-white p-4 rounded border border-green-300"},e.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Payment Process"),e.createElement("ol",{className:"text-sm text-gray-700 space-y-1 list-decimal list-inside"},e.createElement("li",null,"Farmer registers on the platform"),e.createElement("li",null,"Admin sends STK push for registration fee payment"),e.createElement("li",null,"Upon successful payment, farmer can submit consignments"),e.createElement("li",null,"Unpaid farmers have"," ",m.fees.gracePeriodDays," days grace period")))))),l==="security"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Ve,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Security Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Minimum Password Length"),e.createElement("input",{type:"number",min:"6",max:"20",value:m.security.passwordMinLength,onChange:h=>b("security","passwordMinLength",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Session Timeout (hours)"),e.createElement("input",{type:"number",min:"1",max:"168",value:m.security.sessionTimeout,onChange:h=>b("security","sessionTimeout",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Maximum Login Attempts"),e.createElement("input",{type:"number",min:"3",max:"10",value:m.security.maxLoginAttempts,onChange:h=>b("security","maxLoginAttempts",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Two-Factor Authentication"),e.createElement("p",{className:"text-sm text-gray-600"},"Require 2FA for admin accounts")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.security.twoFactorRequired,onChange:h=>b("security","twoFactorRequired",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))))),l==="features"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(dt,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Features")),e.createElement("div",{className:"space-y-4"},[{key:"consignmentApprovalRequired",label:"Require Consignment Approval",desc:"Admin approval required for all consignments"},{key:"autoDriverAssignment",label:"Auto Driver Assignment",desc:"Automatically assign drivers to deliveries"},{key:"inventoryTracking",label:"Inventory Tracking",desc:"Track product inventory levels"},{key:"priceModeration",label:"Price Moderation",desc:"Review and moderate product prices"}].map(h=>e.createElement("div",{key:h.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},h.label),e.createElement("p",{className:"text-sm text-gray-600"},h.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.features?.[h.key]||!1,onChange:E=>b("features",h.key,E.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))))))))}function yi(){const{token:t}=X(),[a,r]=C.useState("products"),[s,n]=C.useState(!0),[l,o]=C.useState([]),[c,y]=C.useState([]),[m,u]=C.useState([]),[d,p]=C.useState([]),[b,w]=C.useState(""),[h,E]=C.useState("all"),[x,v]=C.useState("all"),[D,S]=C.useState(!1),[R,O]=C.useState(null),[j,k]=C.useState(null),[L,g]=C.useState({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]}),[I,M]=C.useState([]),[U,K]=C.useState([]),[z,W]=C.useState({createProduct:null,updateProduct:null,deleteProduct:null,bulkActivate:null}),ee=i=>{const f=i.response?.status,N=i.response?.data,F=typeof N=="string"&&N.includes("<!DOCTYPE html>"),T=f===404&&(N?.error==="API endpoint not found"||i.friendlyMessage?.includes("API endpoint not found")||i.message?.includes("API endpoint not found"));return console.log("🔍 Checking if endpoint missing:",{status:f,isHtmlError:F,isApiNotFoundError:T,errorMessage:i.message,friendlyMessage:i.friendlyMessage,responseData:N}),f===404||F||i.isEndpointMissing||T},se=i=>{W(f=>({...f,[i]:!1}))},ne=i=>{W(f=>({...f,[i]:!0}))},[fe,ye]=C.useState({totalProducts:0,activeProducts:0,totalOrders:0,pendingOrders:0,totalRevenue:0,unpaidOrders:0}),Ce=async()=>{console.log("🧪 Testing endpoint availability...");const i=[{name:"admin-products",url:"/admin/products",method:"GET"},{name:"admin-refresh",url:"/admin/refresh-products",method:"POST"},{name:"products",url:"/products",method:"GET"},{name:"marketplace-products",url:"/marketplace/products",method:"GET"}];for(const f of i)try{if(f.method==="GET"){const N=await de.get(f.url);console.log(`✅ ${f.name}: Available`)}else if(f.method==="POST"&&f.name==="admin-refresh")continue}catch(N){ee(N)?console.log(`❌ ${f.name}: Not available (404)`):console.log(`⚠️ ${f.name}: Error but endpoint exists:`,N.message)}};C.useEffect(()=>{Ce(),tt()},[a]),C.useEffect(()=>{va()},[b,h,x,l,c]);const tt=async()=>{n(!0);try{a==="products"?await it():a==="orders"&&await It()}finally{n(!1)}},it=async()=>{try{console.log("🛍️ Fetching admin products (including inactive)");try{const f=await de.get("/admin/products");if(f.data.success){const N=f.data.products;console.log("📦 Setting admin product data:",N),o(N),ye(F=>({...F,totalProducts:N.length,activeProducts:N.filter(T=>T.is_active).length})),console.log("✅ Admin products state updated successfully");return}}catch(f){console.log("⚠️ Admin endpoint failed:",f.message||f),console.log("🔄 Trying marketplace endpoint as fallback")}const i=await de.get("/marketplace/products");if(i.data.success){const f=i.data.products;console.log("📦 Setting marketplace product data:",f),o(f),ye(N=>({...N,totalProducts:f.length,activeProducts:f.filter(F=>F.is_active).length})),console.log("✅ Marketplace products state updated successfully")}}catch(i){console.error("❌ Error fetching products:",i),o([]),ye(N=>({...N,totalProducts:0,activeProducts:0}));let f="Failed to fetch products from database";i.friendlyMessage?f=`Failed to fetch products: ${i.friendlyMessage}`:i.response?.data?.message?f=i.response.data.message:i.message&&i.message!=="[object Object]"&&(f=`Failed to fetch products: ${i.message}`),P.error(f)}},It=async()=>{try{console.log("📋 Fetching orders (using fallback data - admin endpoint not available)");const f=[{id:1,customer_name:"John Kimani",customer_phone:"+254712345678",customer_email:"john@example.com",total_amount:2500,status:"PENDING",payment_status:"UNPAID",created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),items:[{name:"Fresh Tomatoes",quantity:5,price:130},{name:"Spinach",quantity:10,price:50}]},{id:2,customer_name:"Mary Wanjiku",customer_phone:"+254723456789",customer_email:"mary@example.com",total_amount:1800,status:"COMPLETED",payment_status:"PAID",created_at:new Date(Date.now()-5*24*60*60*1e3).toISOString(),items:[{name:"Sweet Potatoes",quantity:3,price:80}]},{id:3,customer_name:"Peter Mwangi",customer_phone:"+254734567890",customer_email:"peter@example.com",total_amount:3200,status:"PROCESSING",payment_status:"PAID",created_at:new Date(Date.now()-1*24*60*60*1e3).toISOString(),items:[{name:"Fresh Tomatoes",quantity:8,price:130},{name:"Spinach",quantity:20,price:50}]}];y(f);const N=f.filter(F=>F.payment_status==="PAID").reduce((F,T)=>F+T.total_amount,0);ye(F=>({...F,totalOrders:f.length,pendingOrders:f.filter(T=>T.status==="PENDING").length,totalRevenue:N,unpaidOrders:f.filter(T=>T.payment_status==="UNPAID").length})),console.log("✅ Orders loaded (mock data):",f)}catch(i){console.error("❌ Error setting up mock orders:",i),P.error("Failed to load orders")}},va=()=>{if(a==="products"){let i=l.filter(f=>{const N=f.name.toLowerCase().includes(b.toLowerCase())||f.description.toLowerCase().includes(b.toLowerCase()),F=h==="all"||h==="active"&&f.is_active||h==="inactive"&&!f.is_active,T=x==="all"||f.category===x;return N&&F&&T});u(i)}else if(a==="orders"){let i=c.filter(f=>{const N=f.first_name?.toLowerCase().includes(b.toLowerCase())||f.last_name?.toLowerCase().includes(b.toLowerCase())||f.customer_phone.includes(b)||f.customer_email?.toLowerCase().includes(b.toLowerCase()),F=h==="all"||f.status===h;return N&&F});p(i)}},yt=async i=>{if(i.preventDefault(),!L.name||!L.category||!L.price_per_unit){P.error("Please fill in all required fields");return}try{let f=L.images;I.length>0&&(console.log("📷 Uploading images..."),f=await wa(I));const N={...L,price_per_unit:parseFloat(L.price_per_unit),stock_quantity:parseInt(L.stock_quantity)||0,images:f,is_active:!0,is_featured:L.is_featured};console.log("📝 Saving product data:",N);let F;try{if(R)if(console.log("🔄 Updating product:",R.id),z.updateProduct===!1)console.log("⚠️ PUT /products/:id endpoint known to be unavailable, using local update"),o(T=>T.map(_=>_.id===R.id?{..._,...N,updated_at:new Date().toISOString()}:_)),P.success("Product updated locally (server endpoint not available)"),F={data:{success:!0}};else try{F=await de.put(`/products/${R.id}`,N),F.data.success&&(ne("updateProduct"),o(T=>T.map(_=>_.id===R.id?F.data.product:_)),P.success("Product updated successfully in database!"))}catch(T){ee(T)?(console.log("⚠️ PUT /products/:id endpoint not available, marking as unavailable"),se("updateProduct")):(console.log("⚠️ API error during product update, using local fallback"),console.error("Update error:",T)),o(_=>_.map($=>$.id===R.id?{...$,...N,updated_at:new Date().toISOString()}:$)),P.success("Product updated locally (server endpoint not available)"),F={data:{success:!0}}}else if(console.log("➕ Creating new product"),z.createProduct===!1){console.log("⚠️ POST /products endpoint known to be unavailable, using local creation");const T={id:Date.now(),...N,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};o(_=>[..._,T]),P.success("Product created locally (server endpoint not available)"),F={data:{success:!0}}}else try{F=await de.post("/products",N),F.data.success&&(ne("createProduct"),o(T=>[...T,F.data.product]),P.success("Product created successfully in database!"))}catch(T){ee(T)?(console.log("⚠️ POST /products endpoint not available, marking as unavailable"),se("createProduct")):(console.log("⚠️ API error during product creation, using local fallback"),console.error("Creation error:",T));const _={id:Date.now(),...N,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};o($=>[...$,_]),P.success("Product created locally (server endpoint not available)"),F={data:{success:!0}}}}catch(T){throw T}F.data.success?(console.log("✅ Product update response:",F.data),S(!1),O(null),Ge(),await it()):(console.error("❌ Product update failed:",F.data),P.error(F.data.message||"Failed to save product"))}catch(f){console.error("❌ Error saving product:",f);let N="Failed to save product";f.friendlyMessage?N=f.friendlyMessage:f.response?.data?.message?N=f.response.data.message:f.message&&f.message!=="[object Object]"&&(N=f.message),P.error(N)}},_t=async i=>{if(confirm("Are you sure you want to delete this product?"))try{if(console.log("🗑️ Deleting product:",i),z.deleteProduct===!1)console.log("⚠️ DELETE /products/:id endpoint known to be unavailable, using local delete"),o(f=>f.filter(N=>N.id!==i)),P.success("Product removed locally (server endpoint not available)");else try{const f=await de.delete(`/products/${i}`);if(f.data.success)ne("deleteProduct"),o(N=>N.filter(F=>F.id!==i)),P.success("Product deleted successfully from database!");else throw new Error(f.data.message||"Failed to delete product")}catch(f){ee(f)?(console.log("⚠️ DELETE /products/:id endpoint not available, marking as unavailable"),se("deleteProduct")):(console.log("⚠️ API error during product deletion, using local fallback"),console.error("Deletion error:",f)),o(N=>N.filter(F=>F.id!==i)),P.success("Product removed locally (server endpoint not available)")}}catch(f){console.error("❌ Error deleting product:",f);let N="Failed to delete product";f.friendlyMessage?N=f.friendlyMessage:f.response?.data?.message?N=f.response.data.message:f.message&&f.message!=="[object Object]"&&(N=f.message),P.error(N)}},ht=i=>{console.log("✏️ Editing product:",i),O(i),g({name:i.name,category:i.category,price_per_unit:i.price_per_unit.toString(),unit:i.unit,description:i.description||"",stock_quantity:i.stock_quantity.toString(),is_featured:i.is_featured||!1,farmer_name:i.farmer_name||"Admin",farmer_county:i.farmer_county||"Central",images:i.images||[]}),S(!0)},Ge=()=>{g({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]}),M([]),K([])},Na=i=>{const f=Array.from(i.target.files||[]);if(f.length===0)return;const N=f.slice(0,5);M(N);const F=N.map(T=>URL.createObjectURL(T));K(F),console.log("📷 Selected images:",N.map(T=>T.name))},Lt=i=>{const f=I.filter((F,T)=>T!==i),N=U.filter((F,T)=>T!==i);M(f),K(N)},wa=async i=>{const f=i.map(N=>new Promise((F,T)=>{const _=new FileReader;_.onload=()=>F(_.result),_.onerror=T,_.readAsDataURL(N)}));try{const N=await Promise.all(f);return console.log("📤 Images converted to base64 (simulated upload)"),N}catch(N){throw console.error("❌ Error uploading images:",N),N}},bt=async i=>{try{console.log("💳 Simulating STK push (admin endpoint not available):",{orderId:i.id,phone:i.customer_phone,amount:i.total_amount}),P.success("STK push initiated successfully (simulated)")}catch(f){console.error("❌ Error initiating STK push:",f),P.error("Failed to initiate STK push")}},Mt=async()=>{try{console.log("🔄 Refreshing database with sample products"),n(!0);const i=await de.post("/admin/refresh-products",{});i.data.success?(P.success(`Database refreshed with ${i.data.count} premium products with images!`),await it()):P.error(i.data.message||"Failed to refresh database")}catch(i){console.error("❌ Error refreshing database:",i);let f="Failed to refresh database with sample products";i.friendlyMessage?f=i.friendlyMessage:i.response?.data?.message?f=i.response.data.message:i.message&&i.message!=="[object Object]"&&(f=i.message),P.error(f)}finally{n(!1)}},Sa=async()=>{try{if(console.log("🔄 Activating all products"),z.bulkActivate===!1)console.log("⚠️ PATCH /products/bulk-activate endpoint known to be unavailable, using local activation"),o(i=>i.map(f=>({...f,is_active:!0}))),ye(i=>({...i,activeProducts:l.length})),P.success("Products activated locally (server endpoint not available)");else try{const i=await de.patch("/products/bulk-activate",{});if(i.data.success)ne("bulkActivate"),P.success(`${i.data.activated_products?.length||0} products activated!`),await it();else throw new Error(i.data.message||"Failed to activate products")}catch(i){ee(i)?(console.log("⚠️ PATCH /products/bulk-activate endpoint not available, marking as unavailable"),se("bulkActivate")):(console.log("⚠️ API error during product activation, using local fallback"),console.error("Activation error:",i)),o(f=>f.map(N=>({...N,is_active:!0}))),ye(f=>({...f,activeProducts:l.length})),P.success("Products activated locally (server endpoint not available)")}}catch(i){console.error("❌ Error activating products:",i);let f="Failed to activate products";i.friendlyMessage?f=i.friendlyMessage:i.response?.data?.message?f=i.response.data.message:i.message&&i.message!=="[object Object]"&&(f=i.message),P.error(f)}},jt=async i=>{try{console.log("🧾 Generating mock invoice (admin endpoint not available):",i.id);const f={invoice_number:`INV-${i.id}-${Date.now()}`,order_id:i.id,created_at:new Date().toISOString(),due_date:new Date(Date.now()+30*24*60*60*1e3).toISOString(),payment_status:"Pending",customer:{name:i.customer_name||"Customer",phone:i.customer_phone||"+254000000000",email:i.customer_email||"customer@example.com",county:"Kenya"}},N=window.open("","_blank");N&&(N.document.write(`
            <html>
              <head>
                <title>Invoice ${f.invoice_number}</title>
                <style>
                  body { font-family: Arial, sans-serif; margin: 20px; }
                  .header { text-align: center; margin-bottom: 30px; }
                  .invoice-details { margin-bottom: 20px; }
                  .customer-info { margin-bottom: 20px; }
                  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                  th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                  th { background-color: #f2f2f2; }
                  .total { font-weight: bold; font-size: 18px; }
                  .footer { margin-top: 30px; text-align: center; color: #666; }
                </style>
              </head>
              <body>
                <div class="header">
                  <h1>Zuasoko Agricultural Platform</h1>
                  <h2>Invoice ${f.invoice_number}</h2>
                </div>
                
                <div class="invoice-details">
                  <p><strong>Order ID:</strong> ${f.order_id}</p>
                  <p><strong>Date:</strong> ${new Date(f.created_at).toLocaleDateString()}</p>
                  <p><strong>Due Date:</strong> ${new Date(f.due_date).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${f.payment_status}</p>
                </div>
                
                <div class="customer-info">
                  <h3>Customer Information</h3>
                  <p><strong>Name:</strong> ${f.customer.name}</p>
                  <p><strong>Phone:</strong> ${f.customer.phone}</p>
                  <p><strong>Email:</strong> ${f.customer.email}</p>
                  <p><strong>County:</strong> ${f.customer.county}</p>
                </div>
                
                <table>
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Quantity</th>
                      <th>Unit Price</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${f.items.map(F=>`
                      <tr>
                        <td>${F.product_name}</td>
                        <td>${F.quantity}</td>
                        <td>KSh ${F.unit_price?.toLocaleString()}</td>
                        <td>KSh ${(F.total||F.quantity*F.unit_price)?.toLocaleString()}</td>
                      </tr>
                    `).join("")}
                  </tbody>
                  <tfoot>
                    <tr class="total">
                      <td colspan="3"><strong>Total Amount</strong></td>
                      <td><strong>KSh ${f.total_amount.toLocaleString()}</strong></td>
                    </tr>
                  </tfoot>
                </table>
                
                <div class="footer">
                  <p>Thank you for your business!</p>
                  <p>For any inquiries, contact us at support@zuasoko.com</p>
                </div>
              </body>
            </html>
          `),N.document.close(),N.print()),P.success("Invoice generated successfully")}catch(f){console.error("❌ Error generating invoice:",f),P.error("Failed to generate invoice")}},ka=["Vegetables","Fruits","Grains","Leafy Greens","Root Vegetables","Herbs"],Ut=["kg","pieces","bunches","bags","boxes"];return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(et,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading marketplace data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Marketplace Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage products, orders, and marketplace operations")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:tt,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(et,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),a==="products"&&e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:Mt,className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 flex items-center space-x-2"},e.createElement(et,{className:"w-4 h-4"}),e.createElement("span",null,"Add Sample Items")),e.createElement("button",{onClick:Sa,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 flex items-center space-x-2"},e.createElement(ae,{className:"w-4 h-4"}),e.createElement("span",null,"Activate All")),e.createElement("button",{onClick:()=>{Ge(),O(null),S(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(At,{className:"w-4 h-4"}),e.createElement("span",null,"Add Product")))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>{r("products"),E("all"),v("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},fe.totalProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Products"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("products"),E("active"),v("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(ae,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},fe.activeProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Products"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("orders"),E("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-purple-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors"},e.createElement($e,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-purple-600 transition-colors"},fe.totalOrders),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Orders"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-purple-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("orders"),E("completed"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(Ae,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},"KSh ",fe.totalRevenue.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Revenue"))),e.createElement(Ee,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"border-b border-gray-200"},e.createElement("nav",{className:"flex"},[{id:"products",label:"Products",icon:B},{id:"orders",label:"Orders",icon:$e}].map(i=>e.createElement("button",{key:i.id,onClick:()=>r(i.id),className:`flex items-center space-x-2 px-6 py-4 border-b-2 font-medium text-sm ${a===i.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},e.createElement(i.icon,{className:"w-5 h-5"}),e.createElement("span",null,i.label))))),e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:a==="products"?"Search products...":"Search orders...",value:b,onChange:i=>w(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:h,onChange:i=>E(i.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Status"),a==="products"?e.createElement(e.Fragment,null,e.createElement("option",{value:"active"},"Active"),e.createElement("option",{value:"inactive"},"Inactive")):e.createElement(e.Fragment,null,e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"COMPLETED"},"Completed"),e.createElement("option",{value:"CANCELLED"},"Cancelled"))),a==="products"&&e.createElement("select",{value:x,onChange:i=>v(i.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Categories"),ka.map(i=>e.createElement("option",{key:i,value:i},i)))))),a==="products"&&e.createElement("div",{className:"p-6"},m.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-4"},b||h!=="all"||x!=="all"?"Try adjusting your search or filters":"Get started by adding your first product"),e.createElement("button",{onClick:()=>{Ge(),O(null),S(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700"},"Add Product")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},m.map(i=>e.createElement("div",{key:i.id,className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"h-48 bg-gray-100 flex items-center justify-center relative"},i.images&&i.images.length>0&&i.images[0]?e.createElement(e.Fragment,null,e.createElement("img",{src:i.images[0],alt:i.name,className:"w-full h-full object-cover",onError:f=>{console.log("Image failed to load for product:",i.name),f.currentTarget.style.display="none";const N=f.currentTarget.nextElementSibling;N&&(N.style.display="flex")}}),e.createElement("div",{className:"hidden absolute inset-0 items-center justify-center text-center"},e.createElement("div",null,e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500 text-sm"},"Image unavailable")))):e.createElement("div",{className:"text-center"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500 text-sm"},"No image"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 line-clamp-2"},i.name),i.is_featured&&e.createElement(Pt,{className:"w-4 h-4 text-yellow-500 fill-current flex-shrink-0 ml-2"})),e.createElement("p",{className:"text-sm text-gray-600 mb-2"},i.category),e.createElement("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2"},i.description),e.createElement("div",{className:"flex items-center justify-between mb-3"},e.createElement("span",{className:"text-lg font-semibold text-green-600"},"KSh ",i.price_per_unit.toLocaleString(),"/",i.unit),e.createElement("span",{className:"text-sm text-gray-600"},"Stock: ",i.stock_quantity)),e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},i.is_active?"Active":"Inactive"),e.createElement("span",{className:"text-xs text-gray-500"},i.farmer_name)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:()=>ht(i),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 flex items-center justify-center space-x-1"},e.createElement(Pn,{className:"w-4 h-4"}),e.createElement("span",null,"Edit")),e.createElement("button",{onClick:()=>_t(i.id),className:"flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 flex items-center justify-center space-x-1"},e.createElement(ss,{className:"w-4 h-4"}),e.createElement("span",null,"Delete")))))))),a==="orders"&&e.createElement("div",{className:"p-6"},d.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement($e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders found"),e.createElement("p",{className:"text-gray-600"},b||h!=="all"?"Try adjusting your search or filters":"Orders will appear here once customers start placing them")):e.createElement("div",{className:"space-y-4"},d.map(i=>e.createElement("div",{key:i.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Order #",i.id),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="COMPLETED"?"bg-green-100 text-green-800":i.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},i.status),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.payment_status==="PAID"?"bg-green-100 text-green-800":i.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},i.payment_status)),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Customer:")," ",i.first_name," ",i.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",i.customer_phone)),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Email:")," ",i.customer_email),e.createElement("p",null,e.createElement("strong",null,"Amount:")," KSh"," ",i.total_amount.toLocaleString())),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(i.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Items:")," ",i.items?.length||0," products")))),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("button",{onClick:()=>k(i),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 flex items-center space-x-1"},e.createElement(Be,{className:"w-4 h-4"}),e.createElement("span",null,"Details")),e.createElement("button",{onClick:()=>jt(i),className:"bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700 flex items-center space-x-1"},e.createElement(yr,{className:"w-4 h-4"}),e.createElement("span",null,"Invoice")),i.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>bt(i),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Yt,{className:"w-4 h-4"}),e.createElement("span",null,"STK Push")))))))))),D&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},R?"Edit Product":"Add New Product"),e.createElement("button",{onClick:()=>{S(!1),O(null),Ge()},className:"text-gray-400 hover:text-gray-600"},e.createElement(xe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:yt,className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Name *"),e.createElement("input",{type:"text",required:!0,value:L.name,onChange:i=>g({...L,name:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product name"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category *"),e.createElement("select",{required:!0,value:L.category,onChange:i=>g({...L,category:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select category"),ka.map(i=>e.createElement("option",{key:i,value:i},i)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Price per Unit *"),e.createElement("input",{type:"number",required:!0,min:"0",step:"0.01",value:L.price_per_unit,onChange:i=>g({...L,price_per_unit:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Unit"),e.createElement("select",{value:L.unit,onChange:i=>g({...L,unit:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},Ut.map(i=>e.createElement("option",{key:i,value:i},i)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Stock Quantity"),e.createElement("input",{type:"number",min:"0",value:L.stock_quantity,onChange:i=>g({...L,stock_quantity:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farmer County"),e.createElement("input",{type:"text",value:L.farmer_county,onChange:i=>g({...L,farmer_county:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"County"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),e.createElement("textarea",{rows:4,value:L.description,onChange:i=>g({...L,description:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product description"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-center w-full"},e.createElement("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},e.createElement("div",{className:"flex flex-col items-center justify-center pt-5 pb-6"},e.createElement(ja,{className:"w-8 h-8 mb-4 text-gray-500"}),e.createElement("p",{className:"mb-2 text-sm text-gray-500"},e.createElement("span",{className:"font-semibold"},"Click to upload")," product images"),e.createElement("p",{className:"text-xs text-gray-500"},"PNG, JPG or JPEG (MAX. 5 images)")),e.createElement("input",{type:"file",className:"hidden",multiple:!0,accept:"image/*",onChange:Na}))),U.length>0&&e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4"},U.map((i,f)=>e.createElement("div",{key:f,className:"relative group"},e.createElement("img",{src:i,alt:`Preview ${f+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{type:"button",onClick:()=>Lt(f),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e.createElement(xe,{className:"w-3 h-3"}))))),R&&L.images.length>0&&U.length===0&&e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600 mb-2"},"Current Images:"),e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4"},L.images.map((i,f)=>e.createElement("div",{key:f,className:"relative group"},e.createElement("img",{src:i,alt:`Current ${f+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{type:"button",onClick:()=>{const N=L.images.filter((F,T)=>T!==f);g({...L,images:N})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e.createElement(xe,{className:"w-3 h-3"})))))))),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"checkbox",checked:L.is_featured,onChange:i=>g({...L,is_featured:i.target.checked}),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Featured Product"))),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{type:"button",onClick:()=>{S(!1),O(null),Ge()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},"Cancel"),e.createElement("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Xa,{className:"w-4 h-4"}),e.createElement("span",null,R?"Update":"Create"," Product")))))),j&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Order #",j.id," Details"),e.createElement("button",{onClick:()=>k(null),className:"text-gray-400 hover:text-gray-600"},e.createElement(xe,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Customer Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Name:")," ",j.first_name," ",j.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",j.customer_phone),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",j.customer_email))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Status:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${j.status==="COMPLETED"?"bg-green-100 text-green-800":j.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},j.status)),e.createElement("p",null,e.createElement("strong",null,"Payment:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${j.payment_status==="PAID"?"bg-green-100 text-green-800":j.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},j.payment_status)),e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(j.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Total:")," KSh"," ",j.total_amount.toLocaleString())))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Items"),j.items&&j.items.length>0?e.createElement("div",{className:"space-y-2"},j.items.map((i,f)=>e.createElement("div",{key:f,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"font-medium"},i.product_name),e.createElement("p",{className:"text-sm text-gray-600"},"Quantity: ",i.quantity)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"font-medium"},"KSh"," ",(i.unit_price*i.quantity).toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"@ KSh ",i.unit_price,"/unit"))))):e.createElement("p",{className:"text-gray-600"},"No items available")),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{onClick:()=>jt(j),className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(yr,{className:"w-4 h-4"}),e.createElement("span",null,"Generate Invoice")),j.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>{bt(j),k(null)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Yt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))}function hi(){const{token:t}=X(),[a,r]=C.useState(!0),[s,n]=C.useState([]),[l,o]=C.useState([]),[c,y]=C.useState(""),[m,u]=C.useState("all"),[d,p]=C.useState({farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7}),[b,w]=C.useState({totalUnpaid:0,withinGracePeriod:0,overdue:0,totalOutstanding:0});C.useEffect(()=>{h()},[]),C.useEffect(()=>{E()},[c,m,s]);const h=async()=>{r(!0);try{console.log("💰 Fetching unpaid farmers data");const D=await de.get("/admin/settings");D.data.success&&D.data.settings.fees&&p(D.data.settings.fees);const S=await de.get("/admin/registration-fees/unpaid");if(S.data.success){const R=S.data.farmers;n(R);const O=R.length,j=R.filter(g=>g.gracePeriodRemaining>0).length,k=R.filter(g=>g.gracePeriodRemaining<=0).length,L=R.length*d.farmerRegistrationFee;w({totalUnpaid:O,withinGracePeriod:j,overdue:k,totalOutstanding:L}),console.log("✅ Unpaid farmers loaded:",R)}}catch(D){console.error("❌ Error fetching unpaid farmers:",D);const S=[{id:"farmer-001",firstName:"John",lastName:"Kimani",email:"john@example.com",phone:"+254712345678",county:"Nakuru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-5*24*60*60*1e3).toISOString(),daysSinceRegistration:5,gracePeriodRemaining:2,consignmentCount:0},{id:"farmer-002",firstName:"Mary",lastName:"Wanjiku",email:"mary@example.com",phone:"+254723456789",county:"Meru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-10*24*60*60*1e3).toISOString(),daysSinceRegistration:10,gracePeriodRemaining:-3,consignmentCount:2},{id:"farmer-003",firstName:"Peter",lastName:"Mwangi",email:"peter@example.com",phone:"+254734567890",county:"Kiambu",registrationFeePaid:!1,registeredAt:new Date(Date.now()-3*24*60*60*1e3).toISOString(),daysSinceRegistration:3,gracePeriodRemaining:4,consignmentCount:1}];n(S),w({totalUnpaid:3,withinGracePeriod:2,overdue:1,totalOutstanding:900}),P.error("Failed to fetch data, showing demo")}finally{r(!1)}},E=()=>{let D=s.filter(S=>{const R=S.firstName.toLowerCase().includes(c.toLowerCase())||S.lastName.toLowerCase().includes(c.toLowerCase())||S.phone.includes(c)||S.email.toLowerCase().includes(c.toLowerCase()),O=m==="all"||m==="grace"&&S.gracePeriodRemaining>0||m==="overdue"&&S.gracePeriodRemaining<=0;return R&&O});o(D)},x=async D=>{try{console.log(`💳 Initiating STK push for farmer ${D.id}`);const S=await de.post("/admin/registration-fees/stk-push",{farmer_id:D.id,phone_number:D.phone,amount:d.farmerRegistrationFee});S.data.success?(P.success(`STK push sent to ${D.firstName} ${D.lastName}`),n(R=>R.map(O=>O.id===D.id?{...O,lastPaymentAttempt:new Date().toISOString()}:O))):P.error(S.data.message||"Failed to send STK push")}catch(S){console.error("❌ STK push error:",S),P.error(S.response?.data?.message||"Failed to send STK push")}},v=async()=>{if(confirm(`Send STK push to all ${l.length} farmers?`))try{const D=l.map(S=>x(S));await Promise.all(D),P.success(`STK push sent to ${l.length} farmers`)}catch{P.error("Some STK pushes failed")}};return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(et,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading registration fees data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Registration Fees Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage farmer registration fees and payment collection")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:h,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(et,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),l.length>0&&e.createElement("button",{onClick:v,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Yt,{className:"w-4 h-4"}),e.createElement("span",null,"Bulk STK Push"))))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(Fe,{className:"w-5 h-5 text-blue-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-blue-800"},"Current Fee Settings"),e.createElement("p",{className:"text-sm text-blue-700 mt-1"},"Registration Fee:"," ",e.createElement("strong",null,"KSh ",d.farmerRegistrationFee.toLocaleString())," ","• Grace Period:"," ",e.createElement("strong",null,d.gracePeriodDays," days")," • Status:"," ",e.createElement("strong",null,d.registrationFeeEnabled?"Enabled":"Disabled"))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.totalUnpaid),e.createElement("p",{className:"text-gray-600 text-sm"},"Unpaid Farmers")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.withinGracePeriod),e.createElement("p",{className:"text-gray-600 text-sm"},"Within Grace Period")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(Ke,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.overdue),e.createElement("p",{className:"text-gray-600 text-sm"},"Overdue")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(Ae,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"KSh ",b.totalOutstanding.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Outstanding"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ca,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:"Search farmers by name, phone, or email...",value:c,onChange:D=>y(D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("select",{value:m,onChange:D=>u(D.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Farmers"),e.createElement("option",{value:"grace"},"Within Grace Period"),e.createElement("option",{value:"overdue"},"Overdue"))))),e.createElement("div",{className:"p-6"},l.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(Pe,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No unpaid farmers found"),e.createElement("p",{className:"text-gray-600"},c||m!=="all"?"Try adjusting your search or filters":"All farmers have paid their registration fees")):e.createElement("div",{className:"space-y-4"},l.map(D=>e.createElement("div",{key:D.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},D.firstName," ",D.lastName),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${D.gracePeriodRemaining>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},D.gracePeriodRemaining>0?`${D.gracePeriodRemaining} days remaining`:`${Math.abs(D.gracePeriodRemaining)} days overdue`),D.consignmentCount>0&&e.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs"},D.consignmentCount," consignments")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(He,{className:"w-4 h-4"}),e.createElement("span",null,D.phone)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(ia,{className:"w-4 h-4"}),e.createElement("span",null,D.email)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(ot,{className:"w-4 h-4"}),e.createElement("span",null,"Registered ",D.daysSinceRegistration," days ago"))),D.lastPaymentAttempt&&e.createElement("div",{className:"mt-2 text-sm text-gray-500"},"Last STK push:"," ",new Date(D.lastPaymentAttempt).toLocaleDateString())),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("div",{className:"text-right mb-2 sm:mb-0 sm:mr-4"},e.createElement("p",{className:"font-semibold text-gray-900"},"KSh"," ",d.farmerRegistrationFee.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"Registration Fee")),e.createElement("button",{onClick:()=>x(D),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Yt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))))))}function bi(){const{user:t,token:a}=X(),[r,s]=C.useState([]),[n,l]=C.useState(!0);C.useEffect(()=>{o()},[]);const o=async()=>{try{const x=await V.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${a}`}});s(x.data.assignments||x.data)}catch(x){console.error("Error fetching assignments:",x),x.response?.status===404?(console.log("🚛 Using fallback demo assignments (endpoint not found)"),s([{id:"assign_1",consignmentId:"cons_1",title:"Organic Tomatoes Delivery",farmerName:"Jane Wanjiku",farmerPhone:"+254712345678",pickupLocation:"Nakuru, Rift Valley",deliveryLocation:"Nairobi Central Market",quantity:"100 kg",status:"DRIVER_ASSIGNED",estimatedValue:13e3,distance:"180 km",estimatedTime:"3 hours"},{id:"assign_2",consignmentId:"cons_2",title:"Fresh Spinach Delivery",farmerName:"Peter Kamau",farmerPhone:"+254723456789",pickupLocation:"Kiambu, Central Kenya",deliveryLocation:"Westlands Market",quantity:"50 bunches",status:"IN_TRANSIT",estimatedValue:2500,distance:"45 km",estimatedTime:"1.5 hours"}]),P.success("Using demo data - backend deployment needed")):P.error("Failed to fetch assignments")}finally{l(!1)}},c=async x=>{try{await V.put(`/api/driver/assignments/${x}/status`,{status:"IN_TRANSIT",notes:"Pickup started"},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Started pickup for delivery ${x}`),o()}catch(v){console.error("Error updating delivery status:",v),v.response?.status===404?(P.success("Demo mode: Status update simulated"),o()):P.error("Failed to start pickup")}},y=async x=>{try{await V.put(`/api/driver/assignments/${x}/status`,{status:"DELIVERED",notes:"Delivery completed"},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Marked delivery ${x} as completed`),o()}catch(v){console.error("Error updating delivery status:",v),v.response?.status===404?(P.success("Demo mode: Delivery marked as completed"),o()):P.error("Failed to mark as delivered")}},m=async()=>{try{if(!navigator.geolocation){P.error("Geolocation is not supported by this browser");return}P("Getting your location...",{icon:"ℹ️"}),navigator.geolocation.getCurrentPosition(async x=>{const{latitude:v,longitude:D}=x.coords;try{await V.put("/api/driver/location",{latitude:v,longitude:D,timestamp:new Date().toISOString()},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Location updated: ${v.toFixed(6)}, ${D.toFixed(6)}`)}catch(S){console.error("Error updating location on server:",S),P.success(`Location obtained: ${v.toFixed(6)}, ${D.toFixed(6)}`),P("Could not sync with server - using local GPS",{icon:"⚠️"})}},x=>{console.error("Geolocation error:",x),P.error("Failed to get location. Please enable GPS and try again.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(x){console.error("Location update error:",x),P.error("Failed to update location")}},u=()=>{P.success("Looking for new deliveries...")},d=()=>{P("Issue reporting form would open here",{icon:"ℹ️"})},p=()=>{P("Earnings details would be shown here",{icon:"ℹ️"})},b=[{title:"Deliveries Today",value:"8",icon:e.createElement(re,{className:"w-6 h-6"}),color:"bg-blue-500"},{title:"Total Earnings",value:"KES 12,500",icon:e.createElement(Ae,{className:"w-6 h-6"}),color:"bg-green-500"},{title:"Average Rating",value:"4.8",icon:e.createElement(ae,{className:"w-6 h-6"}),color:"bg-yellow-500"},{title:"Pending Pickups",value:"3",icon:e.createElement(Ke,{className:"w-6 h-6"}),color:"bg-red-500"}],w=r.map(x=>({id:x.id,customer:`${x.farmer?.user?.firstName||"Unknown"} ${x.farmer?.user?.lastName||"Farmer"}`,location:x.location||"Unknown location",status:x.status==="DRIVER_ASSIGNED"?"pending":x.status==="IN_TRANSIT"?"in_transit":x.status==="DELIVERED"?"delivered":"unknown",time:new Date(x.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:`KES ${((x.finalPricePerUnit||x.bidPricePerUnit)*x.quantity).toLocaleString()}`})),h=x=>{switch(x){case"pending":return"bg-yellow-100 text-yellow-800";case"in_transit":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},E=x=>{switch(x){case"pending":return"Pending Pickup";case"in_transit":return"In Transit";case"delivered":return"Delivered";default:return x}};return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Here's your delivery schedule for today.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},b.map((x,v)=>e.createElement("div",{key:v,className:"bg-white rounded-lg shadow p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${x.color} text-white p-3 rounded-lg`},x.icon),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-600"},x.title),e.createElement("p",{className:"text-2xl font-semibold text-gray-900"},x.value)))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Driver Status"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Status"),e.createElement("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},"Available")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Vehicle"),e.createElement("span",{className:"text-gray-900 font-medium"},"Pickup Truck - KCA123X")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Current Location"),e.createElement("span",{className:"text-gray-900 font-medium"},"Nairobi CBD")),e.createElement("button",{onClick:m,className:"w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors"},"Update Location"))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:u,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Accept New Delivery"),e.createElement("div",{className:"text-sm text-gray-600"},"Find deliveries near you")),e.createElement("button",{onClick:d,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Report Issue"),e.createElement("div",{className:"text-sm text-gray-600"},"Report delivery problems")),e.createElement("button",{onClick:p,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"View Earnings"),e.createElement("div",{className:"text-sm text-gray-600"},"Check payment history")))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Today's Summary"),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Completed"),e.createElement("span",{className:"font-semibold text-green-600"},"5 deliveries")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"In Progress"),e.createElement("span",{className:"font-semibold text-blue-600"},"1 delivery")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Pending"),e.createElement("span",{className:"font-semibold text-orange-600"},"2 deliveries")),e.createElement("div",{className:"border-t pt-3 mt-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Total Earnings"),e.createElement("span",{className:"font-semibold text-gray-900"},"KES 2,400")))))),e.createElement("div",{className:"bg-white rounded-lg shadow"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Today's Deliveries")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"w-full"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Order ID"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Customer"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Location"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Time"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Value"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},n?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"Loading deliveries...")):w.length===0?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"No deliveries assigned")):w.map(x=>e.createElement("tr",{key:x.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},x.id),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.customer),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-4 h-4 text-gray-400 mr-1"}),x.location)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-4 h-4 text-gray-400 mr-1"}),x.time)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.value),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${h(x.status)}`},E(x.status))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},x.status==="pending"&&e.createElement("button",{onClick:()=>c(x.id),className:"text-primary-600 hover:text-primary-700 font-medium"},"Start Pickup"),x.status==="in_transit"&&e.createElement("button",{onClick:()=>y(x.id),className:"text-green-600 hover:text-green-700 font-medium"},"Mark Delivered"),x.status==="delivered"&&e.createElement("span",{className:"text-gray-400"},"Completed")))))))))}const Ei={DRIVER_ASSIGNED:{color:"bg-yellow-100 text-yellow-800",icon:oe,label:"Ready for Pickup",action:"Start Transport"},IN_TRANSIT:{color:"bg-blue-100 text-blue-800",icon:Ua,label:"In Transit",action:"Mark as Delivered"},DELIVERED:{color:"bg-green-100 text-green-800",icon:ae,label:"Delivered",action:null}};function xi(){const{token:t}=X(),[a,r]=C.useState([]),[s,n]=C.useState(!0),[l,o]=C.useState(null);C.useEffect(()=>{c()},[]);const c=async()=>{try{const u=await V.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${t}`}});r(u.data.assignments)}catch(u){console.error("Error fetching assignments:",u),P.error("Failed to fetch assignments")}finally{n(!1)}},y=async(u,d)=>{o(u);try{await V.patch(`/api/driver/assignments/${u}/status`,{status:d},{headers:{Authorization:`Bearer ${t}`}}),P.success("Assignment status updated successfully!"),c()}catch(p){console.error("Error updating assignment status:",p),P.error("Failed to update assignment status")}finally{o(null)}},m=u=>{u.status==="DRIVER_ASSIGNED"?y(u.id,"IN_TRANSIT"):u.status==="IN_TRANSIT"&&y(u.id,"DELIVERED")};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading assignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Assignments"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage your transport assignments and deliveries")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(re,{className:"w-4 h-4"}),e.createElement("span",null,"Driver Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(u=>u.status==="DRIVER_ASSIGNED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Ready for Pickup")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Ua,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(u=>u.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(ae,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(u=>u.status==="DELIVERED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Active Assignments")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(re,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No assignments yet"),e.createElement("p",{className:"text-gray-600"},"You'll see your transport assignments here when they are assigned to you")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(u=>{const d=Ei[u.status],p=d?.icon||B,b=u.finalPricePerUnit*u.quantity;return e.createElement("div",{key:u.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},u.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},u.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,u.quantity," ",u.unit),e.createElement("span",null,"•"),e.createElement("span",null,u.category),e.createElement("span",null,"•"),e.createElement("span",null,"Value: KSh ",b.toLocaleString())),u.farmer&&e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3"},e.createElement("h4",{className:"text-sm font-medium text-blue-900 mb-2"},"Farmer Contact"),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-blue-700"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Re,{className:"w-4 h-4"}),e.createElement("span",null,u.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(He,{className:"w-4 h-4"}),e.createElement("a",{href:`tel:${u.farmer.phone}`,className:"hover:underline"},u.farmer.phone)),u.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ie,{className:"w-4 h-4"}),e.createElement("span",null,u.farmer.profile.county)))),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(ot,{className:"w-4 h-4"}),e.createElement("span",null,"Expected:"," ",new Date(u.expectedDeliveryDate).toLocaleDateString())))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${d?.color||"bg-gray-100 text-gray-800"}`},e.createElement(p,{className:"w-4 h-4"}),d?.label||u.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(ot,{className:"w-3 h-3"}),"Assigned:"," ",new Date(u.createdAt).toLocaleDateString()),d?.action&&e.createElement("button",{onClick:()=>m(u),disabled:l===u.id,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${u.status==="DRIVER_ASSIGNED"?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`},l===u.id?e.createElement(e.Fragment,null,e.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."):e.createElement(e.Fragment,null,u.status==="DRIVER_ASSIGNED"?e.createElement(An,{className:"w-4 h-4"}):e.createElement(Dn,{className:"w-4 h-4"}),d.action)),u.status==="DELIVERED"&&e.createElement("div",{className:"text-xs text-green-600 font-medium"},"✓ Ready for warehouse processing"))),u.status==="DRIVER_ASSIGNED"&&e.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(Ke,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-yellow-700"},e.createElement("p",{className:"font-medium mb-1"},"Transport Instructions:"),e.createElement("ul",{className:"text-xs space-y-1"},e.createElement("li",null,"• Contact farmer to arrange pickup time"),e.createElement("li",null,"• Verify produce quality and quantity"),e.createElement("li",null,"• Handle with care during transport"),e.createElement("li",null,"• Deliver to Main Warehouse, Nairobi Industrial Area"))))),u.status==="IN_TRANSIT"&&e.createElement("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(Ua,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-blue-700"},e.createElement("p",{className:"font-medium mb-1"},"En Route to Warehouse"),e.createElement("p",{className:"text-xs"},"Mark as delivered once you arrive at the warehouse and unload the produce.")))))})))))}function vi(){const{token:t}=X(),[a,r]=C.useState([]),[s,n]=C.useState(!0),[l,o]=C.useState(!1),[c,y]=C.useState(null),[m,u]=C.useState({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]}),[d,p]=C.useState(""),[b,w]=C.useState(!1);C.useEffect(()=>{h()},[]);const h=async()=>{try{const O=await V.get("/api/warehouse/inventory",{headers:{Authorization:`Bearer ${t}`}});r(O.data.inventory)}catch(O){console.error("Error fetching inventory:",O),P.error("Failed to fetch warehouse inventory")}finally{n(!1)}},E=O=>{y(O),u({marketPrice:O.finalPricePerUnit.toString(),description:O.description,images:O.images,isFeatured:!1,tags:[]}),o(!0)},x=()=>{d.trim()&&!m.tags.includes(d.trim())&&(u({...m,tags:[...m.tags,d.trim()]}),p(""))},v=O=>{u({...m,tags:m.tags.filter(j=>j!==O)})},D=()=>{const O=prompt("Enter image URL:");O&&O.trim()&&u({...m,images:[...m.images,O.trim()]})},S=O=>{u({...m,images:m.images.filter((j,k)=>k!==O)})},R=async()=>{if(c){if(!m.marketPrice||Number(m.marketPrice)<=0){P.error("Please enter a valid market price");return}w(!0);try{await V.post("/api/warehouse/add-to-marketplace",{consignmentId:c.id,marketPrice:Number(m.marketPrice),description:m.description,images:m.images,isFeatured:m.isFeatured,tags:m.tags},{headers:{Authorization:`Bearer ${t}`}}),P.success("Product added to marketplace successfully!"),o(!1),h(),u({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]})}catch(O){console.error("Error adding to marketplace:",O),P.error("Failed to add product to marketplace")}finally{w(!1)}}};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading warehouse inventory..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Warehouse Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage delivered produce and add items to marketplace")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(B,{className:"w-4 h-4"}),e.createElement("span",null,"Inventory Manager")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.length),e.createElement("p",{className:"text-gray-600 text-sm"},"Items in Warehouse")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(ae,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(O=>O.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Added to Marketplace")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(ja,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(O=>!O.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Upload"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Warehouse Inventory")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No inventory items"),e.createElement("p",{className:"text-gray-600"},"Delivered produce will appear here for marketplace processing")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(O=>e.createElement("div",{key:O.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},O.images.length>0?e.createElement("img",{src:O.images[0],alt:O.title,className:"w-full h-full object-cover rounded-lg"}):e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},O.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},O.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("span",null,O.quantity," ",O.unit),e.createElement("span",null,"•"),e.createElement("span",null,"KSh ",O.finalPricePerUnit," per ",O.unit),e.createElement("span",null,"•"),e.createElement("span",null,O.category)),e.createElement("div",{className:"text-sm"},e.createElement("span",{className:"text-gray-500"},"Total Value: "),e.createElement("span",{className:"font-semibold text-gray-900"},"KSh"," ",(O.finalPricePerUnit*O.quantity).toLocaleString()))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},O.marketplaceProductId?e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},e.createElement(ae,{className:"w-4 h-4"}),"On Marketplace"):e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium"},e.createElement(ja,{className:"w-4 h-4"}),"Ready to Upload"),O.marketplaceProductId?e.createElement("button",{className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center gap-2",disabled:!0},e.createElement(Be,{className:"w-4 h-4"}),"View on Marketplace"):e.createElement("button",{onClick:()=>E(O),className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(At,{className:"w-4 h-4"}),"Add to Marketplace"))))))),l&&c&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Add to Marketplace"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},c.title)),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Price (KSh per ",c.unit,") *"),e.createElement("input",{type:"number",value:m.marketPrice,onChange:O=>u({...m,marketPrice:O.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter market price",min:"1",required:!0}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Farmer price: KSh ",c.finalPricePerUnit," per"," ",c.unit)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Description"),e.createElement("textarea",{value:m.description,onChange:O=>u({...m,description:O.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enhance the product description for customers"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images"),e.createElement("div",{className:"space-y-3"},m.images.length>0&&e.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3"},m.images.map((O,j)=>e.createElement("div",{key:j,className:"relative"},e.createElement("img",{src:O,alt:`Product ${j+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{onClick:()=>S(j),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"},"×")))),e.createElement("button",{onClick:D,className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors"},e.createElement(rs,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Add Image URL")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Tags"),e.createElement("div",{className:"space-y-3"},m.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-2"},m.tags.map((O,j)=>e.createElement("span",{key:j,className:"inline-flex items-center gap-1 bg-primary-100 text-primary-800 px-2 py-1 rounded text-sm"},O,e.createElement("button",{onClick:()=>v(O),className:"text-primary-600 hover:text-primary-800"},"×")))),e.createElement("div",{className:"flex gap-2"},e.createElement("input",{type:"text",value:d,onChange:O=>p(O.target.value),onKeyPress:O=>O.key==="Enter"&&x(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Add a tag (e.g., organic, fresh)"}),e.createElement("button",{onClick:x,className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors"},e.createElement(ns,{className:"w-4 h-4"}))))),e.createElement("div",null,e.createElement("label",{className:"flex items-center gap-2"},e.createElement("input",{type:"checkbox",checked:m.isFeatured,onChange:O=>u({...m,isFeatured:O.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},"Mark as Featured Product")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Featured products appear prominently on the marketplace")),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:b},"Cancel"),e.createElement("button",{onClick:R,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:b},b?"Adding...":"Add to Marketplace")))))))}function Ni({title:t="Coming Soon",description:a="This feature is currently under development and will be available soon.",features:r=[]}){const s=_e();return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center py-12 px-4"},e.createElement("div",{className:"max-w-md w-full"},e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center"},e.createElement("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(Rn,{className:"w-10 h-10 text-primary-600"})),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4"},t),e.createElement("p",{className:"text-gray-600 mb-6"},a),r.length>0&&e.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left"},e.createElement("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center"},e.createElement(Pt,{className:"w-4 h-4 text-yellow-500 mr-2"}),"Coming Features:"),e.createElement("ul",{className:"space-y-2"},r.map((n,l)=>e.createElement("li",{key:l,className:"text-sm text-gray-600 flex items-center"},e.createElement("div",{className:"w-1.5 h-1.5 bg-primary-600 rounded-full mr-2"}),n)))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center justify-center text-blue-700"},e.createElement(oe,{className:"w-4 h-4 mr-2"}),e.createElement("span",{className:"text-sm font-medium"},"Expected Launch: Coming Soon"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>s(-1),className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors flex items-center justify-center"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Go Back"),e.createElement(H,{to:"/",className:"block w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors"},"Return to Homepage")),e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("p",{className:"text-xs text-gray-500"},"We're working hard to bring you the best experience.",e.createElement("br",null),"Thank you for your patience!")))))}function wi(){const[t,a]=C.useState("0712345678"),[r,s]=C.useState(100),[n,l]=C.useState(!1),o=()=>localStorage.getItem("token"),c=async()=>{l(!0);try{const d=o();if(!d){P.error("Please login first");return}const p=await V.post("/api/payments/registration-fee",{phoneNumber:t},{headers:{Authorization:`Bearer ${d}`}});P.success("Registration fee payment initiated!"),console.log("Registration fee response:",p.data)}catch(d){P.error(d.response?.data?.error||"Payment failed"),console.error("Registration fee error:",d)}finally{l(!1)}},y=async()=>{l(!0);try{const d=o();if(!d){P.error("Please login first");return}const p=await V.post("/api/wallet/withdraw",{amount:r,phoneNumber:t},{headers:{Authorization:`Bearer ${d}`}});P.success("Wallet withdrawal initiated!"),console.log("Withdrawal response:",p.data)}catch(d){P.error(d.response?.data?.error||"Withdrawal failed"),console.error("Withdrawal error:",d)}finally{l(!1)}},m=async()=>{l(!0);try{const d=oa(t);if(!Ja(d)){P.error("Please enter a valid Kenyan phone number");return}const p=await V.post("/api/payments/stk-push",{phone:d,amount:r,orderId:"test-order-"+Date.now(),accountReference:"Test Payment",transactionDesc:"Test STK Push"});p.data.success?(P.success("M-Pesa payment request sent!"),console.log("STK Push response:",p.data)):P.error("Failed to initiate payment")}catch(d){P.error(d.response?.data?.error||"STK Push failed"),console.error("STK Push error:",d)}finally{l(!1)}},u=()=>{const d=oa(t),p=Ja(t);P(`Phone: ${t} → ${d} (Valid: ${p})`,{icon:"ℹ️"}),console.log("Phone validation:",{original:t,formatted:d,isValid:p})};return e.createElement("div",{className:"max-w-4xl mx-auto p-6"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-8"},"M-Pesa Integration Test"),e.createElement("div",{className:"bg-white rounded-lg shadow p-6 mb-6"},e.createElement("h2",{className:"text-xl font-semibold mb-4"},"Test Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number"),e.createElement("input",{type:"tel",value:t,onChange:d=>a(d.target.value),placeholder:"0712345678",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Amount (KES)"),e.createElement("input",{type:"number",value:r,onChange:d=>s(Number(d.target.value)),min:"1",max:"150000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("button",{onClick:u,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},"Validate Phone"),e.createElement("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},"Test Registration Fee"),e.createElement("button",{onClick:y,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},"Test Withdrawal"),e.createElement("button",{onClick:m,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50"},"Test STK Push"))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-yellow-800 mb-2"},"Demo Configuration"),e.createElement("div",{className:"text-sm text-yellow-700 space-y-1"},e.createElement("p",null,e.createElement("strong",null,"Environment:")," Sandbox"),e.createElement("p",null,e.createElement("strong",null,"Business Short Code:")," 174379"),e.createElement("p",null,e.createElement("strong",null,"Test Phone:")," 0712345678 (or any valid Kenyan number)"),e.createElement("p",null,e.createElement("strong",null,"Demo Credentials:")," Configured for development"))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h3",{className:"text-lg font-semibold text-blue-800 mb-2"},"How to Test"),e.createElement("div",{className:"text-sm text-blue-700 space-y-2"},e.createElement("p",null,"1. ",e.createElement("strong",null,"Login:")," Use demo credentials to login as farmer/customer"),e.createElement("p",null,"2. ",e.createElement("strong",null,"Registration Fee:")," Test farmer activation payment (KES 300)"),e.createElement("p",null,"3. ",e.createElement("strong",null,"Wallet Withdrawal:")," Test farmer wallet withdrawal"),e.createElement("p",null,"4. ",e.createElement("strong",null,"STK Push:")," Test direct M-Pesa payment request"),e.createElement("p",null,"5. ",e.createElement("strong",null,"Checkout:")," Go to marketplace, add items, and checkout with M-Pesa"))))}const ve=({children:t,allowedRoles:a})=>{const{user:r,isAuthenticated:s}=X();return s?a&&r&&!a.includes(r.role)?e.createElement(Ue,{to:"/",replace:!0}):e.createElement(e.Fragment,null,t):e.createElement(Ue,{to:"/login",replace:!0})},Si=()=>{const{user:t}=X();if(!t)return e.createElement(Ue,{to:"/login",replace:!0});switch(t.role){case"FARMER":return e.createElement(Ue,{to:"/farmer/dashboard",replace:!0});case"CUSTOMER":return e.createElement(Ue,{to:"/customer/profile",replace:!0});case"ADMIN":return e.createElement(Ue,{to:"/admin/dashboard",replace:!0});case"DRIVER":return e.createElement(Ue,{to:"/driver/dashboard",replace:!0});default:return e.createElement(Ue,{to:"/",replace:!0})}};function ki(){const{isAuthenticated:t,user:a}=X();return C.useEffect(()=>{fc()},[]),e.createElement(gc,null,e.createElement(cn,null,e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement(yc,null),e.createElement("main",{className:"pb-16 lg:pb-0"},e.createElement(mn,null,e.createElement(Z,{path:"/",element:e.createElement(vc,null)}),e.createElement(Z,{path:"/marketplace",element:e.createElement(Nc,null)}),e.createElement(Z,{path:"/marketplace/product/:id",element:e.createElement(wc,null)}),e.createElement(Z,{path:"/login",element:e.createElement(Sc,null)}),e.createElement(Z,{path:"/register",element:e.createElement(Qc,null)}),e.createElement(Z,{path:"/dashboard",element:e.createElement(Si,null)}),e.createElement(Z,{path:"/farmer/dashboard",element:e.createElement(ve,{allowedRoles:["FARMER"]},e.createElement(Jc,null))}),e.createElement(Z,{path:"/customer/dashboard",element:e.createElement(ve,{allowedRoles:["CUSTOMER"]},e.createElement(ti,null))}),e.createElement(Z,{path:"/customer/profile",element:e.createElement(ve,{allowedRoles:["CUSTOMER"]},e.createElement(ai,null))}),e.createElement(Z,{path:"/customer/orders",element:e.createElement(ve,{allowedRoles:["CUSTOMER"]},e.createElement(ri,null))}),e.createElement(Z,{path:"/cart",element:e.createElement(si,null)}),e.createElement(Z,{path:"/checkout",element:e.createElement(oi,null)}),e.createElement(Z,{path:"/admin/dashboard",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(ci,null))}),e.createElement(Z,{path:"/admin/users",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(di,null))}),e.createElement(Z,{path:"/admin/consignments",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(gi,null))}),e.createElement(Z,{path:"/admin/analytics",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(fi,null))}),e.createElement(Z,{path:"/admin/settings",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(pi,null))}),e.createElement(Z,{path:"/admin/marketplace",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(yi,null))}),e.createElement(Z,{path:"/admin/registration-fees",element:e.createElement(ve,{allowedRoles:["ADMIN"]},e.createElement(hi,null))}),e.createElement(Z,{path:"/driver/dashboard",element:e.createElement(ve,{allowedRoles:["DRIVER"]},e.createElement(bi,null))}),e.createElement(Z,{path:"/driver/assignments",element:e.createElement(ve,{allowedRoles:["DRIVER"]},e.createElement(xi,null))}),e.createElement(Z,{path:"/driver/warehouse",element:e.createElement(ve,{allowedRoles:["DRIVER"]},e.createElement(vi,null))}),e.createElement(Z,{path:"/farmer/consignments",element:e.createElement(Ue,{to:"/farmer/dashboard",replace:!0})}),e.createElement(Z,{path:"/farmer/wallet",element:e.createElement(Ue,{to:"/farmer/dashboard",replace:!0})}),e.createElement(Z,{path:"/test-mpesa",element:e.createElement(wi,null)}),e.createElement(Z,{path:"*",element:e.createElement(Ni,null)}))),t&&a&&e.createElement(hc,null),e.createElement(bc,null),e.createElement(Fn,{position:"top-right"}))))}window.addEventListener("error",t=>{t.error&&t.error.message&&t.error.message.includes("filter is not a function")&&(console.error("🔴 ARRAY OPERATION ERROR DETECTED:",t.error.message),console.error("This error has been caught and handled gracefully."),t.preventDefault())});window.addEventListener("unhandledrejection",t=>{t.reason&&typeof t.reason=="string"&&t.reason.includes("filter")&&(console.error("🔴 PROMISE REJECTION WITH ARRAY ERROR:",t.reason),t.preventDefault())});const Ci=new Yn({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:2,staleTime:10*60*1e3,cacheTime:15*60*1e3},mutations:{retry:1}}}),en=document.getElementById("root");if(!en)throw new Error("Root element not found");const Pi=qa.createRoot(en);Pi.render(e.createElement(al,{client:Ci},e.createElement(ki)));
