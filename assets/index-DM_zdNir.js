import{a as tn,b as an,c as e,r as S,g as rn}from"./vendor-9bZoipD1.js";import{u as He,L as W,a as Gr,b as sn,B as nn,R as ln,c as te,N as $e}from"./router-BAAhKjlc.js";import{S as Ke,L as rr,X as Ae,M as zr,H as Hr,a as Wr,C as on,U as Fe,b as ut,B as ja,T as ne,A as Ge,W as sr,D as nr,c as Qr,d as Sa,e as jt,f as kt,g as se,h as lr,i as oe,j as Be,k as Me,l as Jr,m as ot,K as cn,n as mn,o as dn,P as un,p as gn,q as Ze,r as Pe,Q as fn,s as Oe,t as Yt,F as pn,E as ze,u as Ua,V as P,v as wt,w as yn,x as Qe,y as Xt,z as Ut,G as qt,I as qa,J as Xe,N as H,O as ya,R as At,Y as De,Z as tt,_ as hn,$ as $a,a0 as ct,a1 as Zr,a2 as xn,a3 as Yr,a4 as En,a5 as $t,a6 as Ca,a7 as bn,a8 as Nn,a9 as it,aa as vn,ab as or,ac as wn,ad as Sn,ae as Cn,af as cr,ag as Vt,ah as ka,ai as kn,aj as An,ak as ir,al as Pn,am as Dn}from"./ui-XO5pIlGB.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var Aa={},mr=tn;Aa.createRoot=mr.createRoot,Aa.hydrateRoot=mr.hydrateRoot;function Pa(t,a){return Pa=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Pa(t,a)}function ea(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,Pa(t,a)}var ta=function(){function t(){this.listeners=[]}var a=t.prototype;return a.subscribe=function(s){var n=this,l=s||function(){};return this.listeners.push(l),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(o){return o!==l}),n.onUnsubscribe()}},a.hasListeners=function(){return this.listeners.length>0},a.onSubscribe=function(){},a.onUnsubscribe=function(){},t}();function X(){return X=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},X.apply(null,arguments)}var Xr=typeof window>"u";function be(){}function Rn(t,a){return typeof t=="function"?t(a):t}function Fn(t){return typeof t=="number"&&t>=0&&t!==1/0}function Kt(t){return Array.isArray(t)?t:[t]}function On(t,a){return Math.max(t+(a||0)-Date.now(),0)}function ha(t,a,r){return aa(t)?typeof a=="function"?X({},r,{queryKey:t,queryFn:a}):X({},a,{queryKey:t}):t}function Ye(t,a,r){return aa(t)?[X({},a,{queryKey:t}),r]:[t||{},a]}function Tn(t,a){if(t===!0&&a===!0||t==null&&a==null)return"all";if(t===!1&&a===!1)return"none";var r=t??!a;return r?"active":"inactive"}function dr(t,a){var r=t.active,s=t.exact,n=t.fetching,l=t.inactive,o=t.predicate,c=t.queryKey,f=t.stale;if(aa(c)){if(s){if(a.queryHash!==Va(c,a.options))return!1}else if(!Bt(a.queryKey,c))return!1}var i=Tn(r,l);if(i==="none")return!1;if(i!=="all"){var d=a.isActive();if(i==="active"&&!d||i==="inactive"&&d)return!1}return!(typeof f=="boolean"&&a.isStale()!==f||typeof n=="boolean"&&a.isFetching()!==n||o&&!o(a))}function ur(t,a){var r=t.exact,s=t.fetching,n=t.predicate,l=t.mutationKey;if(aa(l)){if(!a.options.mutationKey)return!1;if(r){if(rt(a.options.mutationKey)!==rt(l))return!1}else if(!Bt(a.options.mutationKey,l))return!1}return!(typeof s=="boolean"&&a.state.status==="loading"!==s||n&&!n(a))}function Va(t,a){var r=a?.queryKeyHashFn||rt;return r(t)}function rt(t){var a=Kt(t);return In(a)}function In(t){return JSON.stringify(t,function(a,r){return Da(r)?Object.keys(r).sort().reduce(function(s,n){return s[n]=r[n],s},{}):r})}function Bt(t,a){return es(Kt(t),Kt(a))}function es(t,a){return t===a?!0:typeof t!=typeof a?!1:t&&a&&typeof t=="object"&&typeof a=="object"?!Object.keys(a).some(function(r){return!es(t[r],a[r])}):!1}function ts(t,a){if(t===a)return t;var r=Array.isArray(t)&&Array.isArray(a);if(r||Da(t)&&Da(a)){for(var s=r?t.length:Object.keys(t).length,n=r?a:Object.keys(a),l=n.length,o=r?[]:{},c=0,f=0;f<l;f++){var i=r?f:n[f];o[i]=ts(t[i],a[i]),o[i]===t[i]&&c++}return s===l&&c===s?t:o}return a}function Da(t){if(!gr(t))return!1;var a=t.constructor;if(typeof a>"u")return!0;var r=a.prototype;return!(!gr(r)||!r.hasOwnProperty("isPrototypeOf"))}function gr(t){return Object.prototype.toString.call(t)==="[object Object]"}function aa(t){return typeof t=="string"||Array.isArray(t)}function _n(t){return new Promise(function(a){setTimeout(a,t)})}function fr(t){Promise.resolve().then(t).catch(function(a){return setTimeout(function(){throw a})})}function as(){if(typeof AbortController=="function")return new AbortController}var Ln=function(t){ea(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!Xr&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setFocused(c):o.onFocus()})},r.setFocused=function(n){this.focused=n,n&&this.onFocus()},r.onFocus=function(){this.listeners.forEach(function(n){n()})},r.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},a}(ta),Ot=new Ln,Mn=function(t){ea(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!Xr&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setOnline(c):o.onOnline()})},r.setOnline=function(n){this.online=n,n&&this.onOnline()},r.onOnline=function(){this.listeners.forEach(function(n){n()})},r.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},a}(ta),Tt=new Mn;function jn(t){return Math.min(1e3*Math.pow(2,t),3e4)}function Gt(t){return typeof t?.cancel=="function"}var rs=function(a){this.revert=a?.revert,this.silent=a?.silent};function xa(t){return t instanceof rs}var ss=function(a){var r=this,s=!1,n,l,o,c;this.abort=a.abort,this.cancel=function(u){return n?.(u)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return l?.()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(u,p){o=u,c=p});var f=function(p){r.isResolved||(r.isResolved=!0,a.onSuccess==null||a.onSuccess(p),l?.(),o(p))},i=function(p){r.isResolved||(r.isResolved=!0,a.onError==null||a.onError(p),l?.(),c(p))},d=function(){return new Promise(function(p){l=p,r.isPaused=!0,a.onPause==null||a.onPause()}).then(function(){l=void 0,r.isPaused=!1,a.onContinue==null||a.onContinue()})},m=function u(){if(!r.isResolved){var p;try{p=a.fn()}catch(N){p=Promise.reject(N)}n=function(y){if(!r.isResolved&&(i(new rs(y)),r.abort==null||r.abort(),Gt(p)))try{p.cancel()}catch{}},r.isTransportCancelable=Gt(p),Promise.resolve(p).then(f).catch(function(N){var y,h;if(!r.isResolved){var E=(y=a.retry)!=null?y:3,b=(h=a.retryDelay)!=null?h:jn,A=typeof b=="function"?b(r.failureCount,N):b,v=E===!0||typeof E=="number"&&r.failureCount<E||typeof E=="function"&&E(r.failureCount,N);if(s||!v){i(N);return}r.failureCount++,a.onFail==null||a.onFail(r.failureCount,N),_n(A).then(function(){if(!Ot.isFocused()||!Tt.isOnline())return d()}).then(function(){s?i(N):u()})}})}};m()},Un=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(r){r()},this.batchNotifyFn=function(r){r()}}var a=t.prototype;return a.batch=function(s){var n;this.transactions++;try{n=s()}finally{this.transactions--,this.transactions||this.flush()}return n},a.schedule=function(s){var n=this;this.transactions?this.queue.push(s):fr(function(){n.notifyFn(s)})},a.batchCalls=function(s){var n=this;return function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];n.schedule(function(){s.apply(void 0,o)})}},a.flush=function(){var s=this,n=this.queue;this.queue=[],n.length&&fr(function(){s.batchNotifyFn(function(){n.forEach(function(l){s.notifyFn(l)})})})},a.setNotifyFunction=function(s){this.notifyFn=s},a.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},t}(),xe=new Un,ns=console;function ls(){return ns}function qn(t){ns=t}var $n=function(){function t(r){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.cache=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.initialState=r.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=r.meta,this.scheduleGc()}var a=t.prototype;return a.setOptions=function(s){var n;this.options=X({},this.defaultOptions,s),this.meta=s?.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},a.setDefaultOptions=function(s){this.defaultOptions=s},a.scheduleGc=function(){var s=this;this.clearGcTimeout(),Fn(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},a.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},a.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},a.setData=function(s,n){var l,o,c=this.state.data,f=Rn(s,c);return(l=(o=this.options).isDataEqual)!=null&&l.call(o,c,f)?f=c:this.options.structuralSharing!==!1&&(f=ts(c,f)),this.dispatch({data:f,type:"success",dataUpdatedAt:n?.updatedAt}),f},a.setState=function(s,n){this.dispatch({type:"setState",state:s,setStateOptions:n})},a.cancel=function(s){var n,l=this.promise;return(n=this.retryer)==null||n.cancel(s),l?l.then(be).catch(be):Promise.resolve()},a.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},a.reset=function(){this.destroy(),this.setState(this.initialState)},a.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},a.isFetching=function(){return this.state.isFetching},a.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},a.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!On(this.state.dataUpdatedAt,s)},a.onFocus=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnWindowFocus()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.onOnline=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnReconnect()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},a.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(n){return n!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},a.getObserversCount=function(){return this.observers.length},a.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},a.fetch=function(s,n){var l=this,o,c,f;if(this.state.isFetching){if(this.state.dataUpdatedAt&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var i;return(i=this.retryer)==null||i.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var d=this.observers.find(function(b){return b.options.queryFn});d&&this.setOptions(d.options)}var m=Kt(this.queryKey),u=as(),p={queryKey:m,pageParam:void 0,meta:this.meta};Object.defineProperty(p,"signal",{enumerable:!0,get:function(){if(u)return l.abortSignalConsumed=!0,u.signal}});var N=function(){return l.options.queryFn?(l.abortSignalConsumed=!1,l.options.queryFn(p)):Promise.reject("Missing queryFn")},y={fetchOptions:n,options:this.options,queryKey:m,state:this.state,fetchFn:N,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var h;(h=this.options.behavior)==null||h.onFetch(y)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((c=y.fetchOptions)==null?void 0:c.meta)){var E;this.dispatch({type:"fetch",meta:(E=y.fetchOptions)==null?void 0:E.meta})}return this.retryer=new ss({fn:y.fetchFn,abort:u==null||(f=u.abort)==null?void 0:f.bind(u),onSuccess:function(A){l.setData(A),l.cache.config.onSuccess==null||l.cache.config.onSuccess(A,l),l.cacheTime===0&&l.optionalRemove()},onError:function(A){xa(A)&&A.silent||l.dispatch({type:"error",error:A}),xa(A)||(l.cache.config.onError==null||l.cache.config.onError(A,l),ls().error(A)),l.cacheTime===0&&l.optionalRemove()},onFail:function(){l.dispatch({type:"failed"})},onPause:function(){l.dispatch({type:"pause"})},onContinue:function(){l.dispatch({type:"continue"})},retry:y.options.retry,retryDelay:y.options.retryDelay}),this.promise=this.retryer.promise,this.promise},a.dispatch=function(s){var n=this;this.state=this.reducer(this.state,s),xe.batch(function(){n.observers.forEach(function(l){l.onQueryUpdate(s)}),n.cache.notify({query:n,type:"queryUpdated",action:s})})},a.getDefaultState=function(s){var n=typeof s.initialData=="function"?s.initialData():s.initialData,l=typeof s.initialData<"u",o=l?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,c=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:c?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:c?"success":"idle"}},a.reducer=function(s,n){var l,o;switch(n.type){case"failed":return X({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return X({},s,{isPaused:!0});case"continue":return X({},s,{isPaused:!1});case"fetch":return X({},s,{fetchFailureCount:0,fetchMeta:(l=n.meta)!=null?l:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return X({},s,{data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=n.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var c=n.error;return xa(c)&&c.revert&&this.revertState?X({},this.revertState):X({},s,{error:c,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return X({},s,{isInvalidated:!0});case"setState":return X({},s,n.state);default:return s}},t}(),Vn=function(t){ea(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.queries=[],n.queriesMap={},n}var r=a.prototype;return r.build=function(n,l,o){var c,f=l.queryKey,i=(c=l.queryHash)!=null?c:Va(f,l),d=this.get(i);return d||(d=new $n({cache:this,queryKey:f,queryHash:i,options:n.defaultQueryOptions(l),state:o,defaultOptions:n.getQueryDefaults(f),meta:l.meta}),this.add(d)),d},r.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},r.remove=function(n){var l=this.queriesMap[n.queryHash];l&&(n.destroy(),this.queries=this.queries.filter(function(o){return o!==n}),l===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},r.clear=function(){var n=this;xe.batch(function(){n.queries.forEach(function(l){n.remove(l)})})},r.get=function(n){return this.queriesMap[n]},r.getAll=function(){return this.queries},r.find=function(n,l){var o=Ye(n,l),c=o[0];return typeof c.exact>"u"&&(c.exact=!0),this.queries.find(function(f){return dr(c,f)})},r.findAll=function(n,l){var o=Ye(n,l),c=o[0];return Object.keys(c).length>0?this.queries.filter(function(f){return dr(c,f)}):this.queries},r.notify=function(n){var l=this;xe.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){var n=this;xe.batch(function(){n.queries.forEach(function(l){l.onFocus()})})},r.onOnline=function(){var n=this;xe.batch(function(){n.queries.forEach(function(l){l.onOnline()})})},a}(ta),Kn=function(){function t(r){this.options=X({},r.defaultOptions,r.options),this.mutationId=r.mutationId,this.mutationCache=r.mutationCache,this.observers=[],this.state=r.state||Bn(),this.meta=r.meta}var a=t.prototype;return a.setState=function(s){this.dispatch({type:"setState",state:s})},a.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},a.removeObserver=function(s){this.observers=this.observers.filter(function(n){return n!==s})},a.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(be).catch(be)):Promise.resolve()},a.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},a.execute=function(){var s=this,n,l=this.state.status==="loading",o=Promise.resolve();return l||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(c){c!==s.state.context&&s.dispatch({type:"loading",context:c,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(c){n=c,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(n,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(n,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(n,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:n}),n}).catch(function(c){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(c,s.state.variables,s.state.context,s),ls().error(c),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(c,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,c,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:c}),c})})},a.executeMutation=function(){var s=this,n;return this.retryer=new ss({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},a.dispatch=function(s){var n=this;this.state=Gn(this.state,s),xe.batch(function(){n.observers.forEach(function(l){l.onMutationUpdate(s)}),n.mutationCache.notify(n)})},t}();function Bn(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Gn(t,a){switch(a.type){case"failed":return X({},t,{failureCount:t.failureCount+1});case"pause":return X({},t,{isPaused:!0});case"continue":return X({},t,{isPaused:!1});case"loading":return X({},t,{context:a.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:a.variables});case"success":return X({},t,{data:a.data,error:null,status:"success",isPaused:!1});case"error":return X({},t,{data:void 0,error:a.error,failureCount:t.failureCount+1,isPaused:!1,status:"error"});case"setState":return X({},t,a.state);default:return t}}var zn=function(t){ea(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.mutations=[],n.mutationId=0,n}var r=a.prototype;return r.build=function(n,l,o){var c=new Kn({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(l),state:o,defaultOptions:l.mutationKey?n.getMutationDefaults(l.mutationKey):void 0,meta:l.meta});return this.add(c),c},r.add=function(n){this.mutations.push(n),this.notify(n)},r.remove=function(n){this.mutations=this.mutations.filter(function(l){return l!==n}),n.cancel(),this.notify(n)},r.clear=function(){var n=this;xe.batch(function(){n.mutations.forEach(function(l){n.remove(l)})})},r.getAll=function(){return this.mutations},r.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(l){return ur(n,l)})},r.findAll=function(n){return this.mutations.filter(function(l){return ur(n,l)})},r.notify=function(n){var l=this;xe.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){this.resumePausedMutations()},r.onOnline=function(){this.resumePausedMutations()},r.resumePausedMutations=function(){var n=this.mutations.filter(function(l){return l.state.isPaused});return xe.batch(function(){return n.reduce(function(l,o){return l.then(function(){return o.continue().catch(be)})},Promise.resolve())})},a}(ta);function Hn(){return{onFetch:function(a){a.fetchFn=function(){var r,s,n,l,o,c,f=(r=a.fetchOptions)==null||(s=r.meta)==null?void 0:s.refetchPage,i=(n=a.fetchOptions)==null||(l=n.meta)==null?void 0:l.fetchMore,d=i?.pageParam,m=i?.direction==="forward",u=i?.direction==="backward",p=((o=a.state.data)==null?void 0:o.pages)||[],N=((c=a.state.data)==null?void 0:c.pageParams)||[],y=as(),h=y?.signal,E=N,b=!1,A=a.options.queryFn||function(){return Promise.reject("Missing queryFn")},v=function(B,Q,J,ce){return E=ce?[Q].concat(E):[].concat(E,[Q]),ce?[J].concat(B):[].concat(B,[J])},O=function(B,Q,J,ce){if(b)return Promise.reject("Cancelled");if(typeof J>"u"&&!Q&&B.length)return Promise.resolve(B);var ge={queryKey:a.queryKey,signal:h,pageParam:J,meta:a.meta},fe=A(ge),he=Promise.resolve(fe).then(function(ve){return v(B,J,ve,ce)});if(Gt(fe)){var Te=he;Te.cancel=fe.cancel}return he},R;if(!p.length)R=O([]);else if(m){var M=typeof d<"u",w=M?d:pr(a.options,p);R=O(p,M,w)}else if(u){var I=typeof d<"u",g=I?d:Wn(a.options,p);R=O(p,I,g,!0)}else(function(){E=[];var U=typeof a.options.getNextPageParam>"u",B=f&&p[0]?f(p[0],0,p):!0;R=B?O([],U,N[0]):Promise.resolve(v([],N[0],p[0]));for(var Q=function(ge){R=R.then(function(fe){var he=f&&p[ge]?f(p[ge],ge,p):!0;if(he){var Te=U?N[ge]:pr(a.options,fe);return O(fe,U,Te)}return Promise.resolve(v(fe,N[ge],p[ge]))})},J=1;J<p.length;J++)Q(J)})();var T=R.then(function(U){return{pages:U,pageParams:E}}),_=T;return _.cancel=function(){b=!0,y?.abort(),Gt(R)&&R.cancel()},T}}}}function pr(t,a){return t.getNextPageParam==null?void 0:t.getNextPageParam(a[a.length-1],a)}function Wn(t,a){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(a[0],a)}var Qn=function(){function t(r){r===void 0&&(r={}),this.queryCache=r.queryCache||new Vn,this.mutationCache=r.mutationCache||new zn,this.defaultOptions=r.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var a=t.prototype;return a.mount=function(){var s=this;this.unsubscribeFocus=Ot.subscribe(function(){Ot.isFocused()&&Tt.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Tt.subscribe(function(){Ot.isFocused()&&Tt.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},a.unmount=function(){var s,n;(s=this.unsubscribeFocus)==null||s.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},a.isFetching=function(s,n){var l=Ye(s,n),o=l[0];return o.fetching=!0,this.queryCache.findAll(o).length},a.isMutating=function(s){return this.mutationCache.findAll(X({},s,{fetching:!0})).length},a.getQueryData=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state.data},a.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(n){var l=n.queryKey,o=n.state,c=o.data;return[l,c]})},a.setQueryData=function(s,n,l){var o=ha(s),c=this.defaultQueryOptions(o);return this.queryCache.build(this,c).setData(n,l)},a.setQueriesData=function(s,n,l){var o=this;return xe.batch(function(){return o.getQueryCache().findAll(s).map(function(c){var f=c.queryKey;return[f,o.setQueryData(f,n,l)]})})},a.getQueryState=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state},a.removeQueries=function(s,n){var l=Ye(s,n),o=l[0],c=this.queryCache;xe.batch(function(){c.findAll(o).forEach(function(f){c.remove(f)})})},a.resetQueries=function(s,n,l){var o=this,c=Ye(s,n,l),f=c[0],i=c[1],d=this.queryCache,m=X({},f,{active:!0});return xe.batch(function(){return d.findAll(f).forEach(function(u){u.reset()}),o.refetchQueries(m,i)})},a.cancelQueries=function(s,n,l){var o=this,c=Ye(s,n,l),f=c[0],i=c[1],d=i===void 0?{}:i;typeof d.revert>"u"&&(d.revert=!0);var m=xe.batch(function(){return o.queryCache.findAll(f).map(function(u){return u.cancel(d)})});return Promise.all(m).then(be).catch(be)},a.invalidateQueries=function(s,n,l){var o,c,f,i=this,d=Ye(s,n,l),m=d[0],u=d[1],p=X({},m,{active:(o=(c=m.refetchActive)!=null?c:m.active)!=null?o:!0,inactive:(f=m.refetchInactive)!=null?f:!1});return xe.batch(function(){return i.queryCache.findAll(m).forEach(function(N){N.invalidate()}),i.refetchQueries(p,u)})},a.refetchQueries=function(s,n,l){var o=this,c=Ye(s,n,l),f=c[0],i=c[1],d=xe.batch(function(){return o.queryCache.findAll(f).map(function(u){return u.fetch(void 0,X({},i,{meta:{refetchPage:f?.refetchPage}}))})}),m=Promise.all(d).then(be);return i?.throwOnError||(m=m.catch(be)),m},a.fetchQuery=function(s,n,l){var o=ha(s,n,l),c=this.defaultQueryOptions(o);typeof c.retry>"u"&&(c.retry=!1);var f=this.queryCache.build(this,c);return f.isStaleByTime(c.staleTime)?f.fetch(c):Promise.resolve(f.state.data)},a.prefetchQuery=function(s,n,l){return this.fetchQuery(s,n,l).then(be).catch(be)},a.fetchInfiniteQuery=function(s,n,l){var o=ha(s,n,l);return o.behavior=Hn(),this.fetchQuery(o)},a.prefetchInfiniteQuery=function(s,n,l){return this.fetchInfiniteQuery(s,n,l).then(be).catch(be)},a.cancelMutations=function(){var s=this,n=xe.batch(function(){return s.mutationCache.getAll().map(function(l){return l.cancel()})});return Promise.all(n).then(be).catch(be)},a.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},a.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},a.getQueryCache=function(){return this.queryCache},a.getMutationCache=function(){return this.mutationCache},a.getDefaultOptions=function(){return this.defaultOptions},a.setDefaultOptions=function(s){this.defaultOptions=s},a.setQueryDefaults=function(s,n){var l=this.queryDefaults.find(function(o){return rt(s)===rt(o.queryKey)});l?l.defaultOptions=n:this.queryDefaults.push({queryKey:s,defaultOptions:n})},a.getQueryDefaults=function(s){var n;return s?(n=this.queryDefaults.find(function(l){return Bt(s,l.queryKey)}))==null?void 0:n.defaultOptions:void 0},a.setMutationDefaults=function(s,n){var l=this.mutationDefaults.find(function(o){return rt(s)===rt(o.mutationKey)});l?l.defaultOptions=n:this.mutationDefaults.push({mutationKey:s,defaultOptions:n})},a.getMutationDefaults=function(s){var n;return s?(n=this.mutationDefaults.find(function(l){return Bt(s,l.mutationKey)}))==null?void 0:n.defaultOptions:void 0},a.defaultQueryOptions=function(s){if(s?._defaulted)return s;var n=X({},this.defaultOptions.queries,this.getQueryDefaults(s?.queryKey),s,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=Va(n.queryKey,n)),n},a.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},a.defaultMutationOptions=function(s){return s?._defaulted?s:X({},this.defaultOptions.mutations,this.getMutationDefaults(s?.mutationKey),s,{_defaulted:!0})},a.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},t}(),Jn=an.unstable_batchedUpdates;xe.setBatchNotifyFunction(Jn);var Zn=console;qn(Zn);var yr=e.createContext(void 0),Yn=e.createContext(!1);function Xn(t){return t&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=yr),window.ReactQueryClientContext):yr}var el=function(a){var r=a.client,s=a.contextSharing,n=s===void 0?!1:s,l=a.children;e.useEffect(function(){return r.mount(),function(){r.unmount()}},[r]);var o=Xn(n);return e.createElement(Yn.Provider,{value:n},e.createElement(o.Provider,{value:r},l))};const tl={},hr=t=>{let a;const r=new Set,s=(d,m)=>{const u=typeof d=="function"?d(a):d;if(!Object.is(u,a)){const p=a;a=m??(typeof u!="object"||u===null)?u:Object.assign({},a,u),r.forEach(N=>N(a,p))}},n=()=>a,f={setState:s,getState:n,getInitialState:()=>i,subscribe:d=>(r.add(d),()=>r.delete(d)),destroy:()=>{(tl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},i=a=t(s,n,f);return f},al=t=>t?hr(t):hr;var os={exports:{}},cs={},is={exports:{}},ms={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gt=S;function rl(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var sl=typeof Object.is=="function"?Object.is:rl,nl=gt.useState,ll=gt.useEffect,ol=gt.useLayoutEffect,cl=gt.useDebugValue;function il(t,a){var r=a(),s=nl({inst:{value:r,getSnapshot:a}}),n=s[0].inst,l=s[1];return ol(function(){n.value=r,n.getSnapshot=a,Ea(n)&&l({inst:n})},[t,r,a]),ll(function(){return Ea(n)&&l({inst:n}),t(function(){Ea(n)&&l({inst:n})})},[t]),cl(r),r}function Ea(t){var a=t.getSnapshot;t=t.value;try{var r=a();return!sl(t,r)}catch{return!0}}function ml(t,a){return a()}var dl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ml:il;ms.useSyncExternalStore=gt.useSyncExternalStore!==void 0?gt.useSyncExternalStore:dl;is.exports=ms;var ul=is.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ra=S,gl=ul;function fl(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var pl=typeof Object.is=="function"?Object.is:fl,yl=gl.useSyncExternalStore,hl=ra.useRef,xl=ra.useEffect,El=ra.useMemo,bl=ra.useDebugValue;cs.useSyncExternalStoreWithSelector=function(t,a,r,s,n){var l=hl(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=El(function(){function f(p){if(!i){if(i=!0,d=p,p=s(p),n!==void 0&&o.hasValue){var N=o.value;if(n(N,p))return m=N}return m=p}if(N=m,pl(d,p))return N;var y=s(p);return n!==void 0&&n(N,y)?(d=p,N):(d=p,m=y)}var i=!1,d,m,u=r===void 0?null:r;return[function(){return f(a())},u===null?void 0:function(){return f(u())}]},[a,r,s,n]);var c=yl(t,l[0],l[1]);return xl(function(){o.hasValue=!0,o.value=c},[c]),bl(c),c};os.exports=cs;var Nl=os.exports;const vl=rn(Nl),ds={},{useDebugValue:wl}=e,{useSyncExternalStoreWithSelector:Sl}=vl;let xr=!1;const Cl=t=>t;function kl(t,a=Cl,r){(ds?"production":void 0)!=="production"&&r&&!xr&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),xr=!0);const s=Sl(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,r);return wl(s),s}const Al=t=>{(ds?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof t=="function"?al(t):t,r=(s,n)=>kl(a,s,n);return Object.assign(r,a),r},us=t=>Al,Pl={};function Dl(t,a){let r;try{r=t()}catch{return}return{getItem:n=>{var l;const o=f=>f===null?null:JSON.parse(f,void 0),c=(l=r.getItem(n))!=null?l:null;return c instanceof Promise?c.then(o):o(c)},setItem:(n,l)=>r.setItem(n,JSON.stringify(l,void 0)),removeItem:n=>r.removeItem(n)}}const St=t=>a=>{try{const r=t(a);return r instanceof Promise?r:{then(s){return St(s)(r)},catch(s){return this}}}catch(r){return{then(s){return this},catch(s){return St(s)(r)}}}},Rl=(t,a)=>(r,s,n)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:h=>h,version:0,merge:(h,E)=>({...E,...h}),...a},o=!1;const c=new Set,f=new Set;let i;try{i=l.getStorage()}catch{}if(!i)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...h)},s,n);const d=St(l.serialize),m=()=>{const h=l.partialize({...s()});let E;const b=d({state:h,version:l.version}).then(A=>i.setItem(l.name,A)).catch(A=>{E=A});if(E)throw E;return b},u=n.setState;n.setState=(h,E)=>{u(h,E),m()};const p=t((...h)=>{r(...h),m()},s,n);let N;const y=()=>{var h;if(!i)return;o=!1,c.forEach(b=>b(s()));const E=((h=l.onRehydrateStorage)==null?void 0:h.call(l,s()))||void 0;return St(i.getItem.bind(i))(l.name).then(b=>{if(b)return l.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==l.version){if(l.migrate)return l.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var A;return N=l.merge(b,(A=s())!=null?A:p),r(N,!0),m()}).then(()=>{E?.(N,void 0),o=!0,f.forEach(b=>b(N))}).catch(b=>{E?.(void 0,b)})};return n.persist={setOptions:h=>{l={...l,...h},h.getStorage&&(i=h.getStorage())},clearStorage:()=>{i?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>y(),hasHydrated:()=>o,onHydrate:h=>(c.add(h),()=>{c.delete(h)}),onFinishHydration:h=>(f.add(h),()=>{f.delete(h)})},y(),N||p},Fl=(t,a)=>(r,s,n)=>{let l={storage:Dl(()=>localStorage),partialize:y=>y,version:0,merge:(y,h)=>({...h,...y}),...a},o=!1;const c=new Set,f=new Set;let i=l.storage;if(!i)return t((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...y)},s,n);const d=()=>{const y=l.partialize({...s()});return i.setItem(l.name,{state:y,version:l.version})},m=n.setState;n.setState=(y,h)=>{m(y,h),d()};const u=t((...y)=>{r(...y),d()},s,n);n.getInitialState=()=>u;let p;const N=()=>{var y,h;if(!i)return;o=!1,c.forEach(b=>{var A;return b((A=s())!=null?A:u)});const E=((h=l.onRehydrateStorage)==null?void 0:h.call(l,(y=s())!=null?y:u))||void 0;return St(i.getItem.bind(i))(l.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==l.version){if(l.migrate)return[!0,l.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var A;const[v,O]=b;if(p=l.merge(O,(A=s())!=null?A:u),r(p,!0),v)return d()}).then(()=>{E?.(p,void 0),p=s(),o=!0,f.forEach(b=>b(p))}).catch(b=>{E?.(void 0,b)})};return n.persist={setOptions:y=>{l={...l,...y},y.storage&&(i=y.storage)},clearStorage:()=>{i?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>N(),hasHydrated:()=>o,onHydrate:y=>(c.add(y),()=>{c.delete(y)}),onFinishHydration:y=>(f.add(y),()=>{f.delete(y)})},l.skipHydration||N(),p||u},Ol=(t,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?((Pl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Rl(t,a)):Fl(t,a),gs=Ol;function fs(t,a){return function(){return t.apply(a,arguments)}}const{toString:Tl}=Object.prototype,{getPrototypeOf:Ka}=Object,{iterator:sa,toStringTag:ps}=Symbol,na=(t=>a=>{const r=Tl.call(a);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),je=t=>(t=t.toLowerCase(),a=>na(a)===t),la=t=>a=>typeof a===t,{isArray:ft}=Array,Ct=la("undefined");function Il(t){return t!==null&&!Ct(t)&&t.constructor!==null&&!Ct(t.constructor)&&Ce(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ys=je("ArrayBuffer");function _l(t){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(t):a=t&&t.buffer&&ys(t.buffer),a}const Ll=la("string"),Ce=la("function"),hs=la("number"),oa=t=>t!==null&&typeof t=="object",Ml=t=>t===!0||t===!1,It=t=>{if(na(t)!=="object")return!1;const a=Ka(t);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(ps in t)&&!(sa in t)},jl=je("Date"),Ul=je("File"),ql=je("Blob"),$l=je("FileList"),Vl=t=>oa(t)&&Ce(t.pipe),Kl=t=>{let a;return t&&(typeof FormData=="function"&&t instanceof FormData||Ce(t.append)&&((a=na(t))==="formdata"||a==="object"&&Ce(t.toString)&&t.toString()==="[object FormData]"))},Bl=je("URLSearchParams"),[Gl,zl,Hl,Wl]=["ReadableStream","Request","Response","Headers"].map(je),Ql=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pt(t,a,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let s,n;if(typeof t!="object"&&(t=[t]),ft(t))for(s=0,n=t.length;s<n;s++)a.call(null,t[s],s,t);else{const l=r?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(s=0;s<o;s++)c=l[s],a.call(null,t[c],c,t)}}function xs(t,a){a=a.toLowerCase();const r=Object.keys(t);let s=r.length,n;for(;s-- >0;)if(n=r[s],a===n.toLowerCase())return n;return null}const st=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Es=t=>!Ct(t)&&t!==st;function Ra(){const{caseless:t}=Es(this)&&this||{},a={},r=(s,n)=>{const l=t&&xs(a,n)||n;It(a[l])&&It(s)?a[l]=Ra(a[l],s):It(s)?a[l]=Ra({},s):ft(s)?a[l]=s.slice():a[l]=s};for(let s=0,n=arguments.length;s<n;s++)arguments[s]&&Pt(arguments[s],r);return a}const Jl=(t,a,r,{allOwnKeys:s}={})=>(Pt(a,(n,l)=>{r&&Ce(n)?t[l]=fs(n,r):t[l]=n},{allOwnKeys:s}),t),Zl=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Yl=(t,a,r,s)=>{t.prototype=Object.create(a.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:a.prototype}),r&&Object.assign(t.prototype,r)},Xl=(t,a,r,s)=>{let n,l,o;const c={};if(a=a||{},t==null)return a;do{for(n=Object.getOwnPropertyNames(t),l=n.length;l-- >0;)o=n[l],(!s||s(o,t,a))&&!c[o]&&(a[o]=t[o],c[o]=!0);t=r!==!1&&Ka(t)}while(t&&(!r||r(t,a))&&t!==Object.prototype);return a},eo=(t,a,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=a.length;const s=t.indexOf(a,r);return s!==-1&&s===r},to=t=>{if(!t)return null;if(ft(t))return t;let a=t.length;if(!hs(a))return null;const r=new Array(a);for(;a-- >0;)r[a]=t[a];return r},ao=(t=>a=>t&&a instanceof t)(typeof Uint8Array<"u"&&Ka(Uint8Array)),ro=(t,a)=>{const s=(t&&t[sa]).call(t);let n;for(;(n=s.next())&&!n.done;){const l=n.value;a.call(t,l[0],l[1])}},so=(t,a)=>{let r;const s=[];for(;(r=t.exec(a))!==null;)s.push(r);return s},no=je("HTMLFormElement"),lo=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),Er=(({hasOwnProperty:t})=>(a,r)=>t.call(a,r))(Object.prototype),oo=je("RegExp"),bs=(t,a)=>{const r=Object.getOwnPropertyDescriptors(t),s={};Pt(r,(n,l)=>{let o;(o=a(n,l,t))!==!1&&(s[l]=o||n)}),Object.defineProperties(t,s)},co=t=>{bs(t,(a,r)=>{if(Ce(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=t[r];if(Ce(s)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},io=(t,a)=>{const r={},s=n=>{n.forEach(l=>{r[l]=!0})};return ft(t)?s(t):s(String(t).split(a)),r},mo=()=>{},uo=(t,a)=>t!=null&&Number.isFinite(t=+t)?t:a;function go(t){return!!(t&&Ce(t.append)&&t[ps]==="FormData"&&t[sa])}const fo=t=>{const a=new Array(10),r=(s,n)=>{if(oa(s)){if(a.indexOf(s)>=0)return;if(!("toJSON"in s)){a[n]=s;const l=ft(s)?[]:{};return Pt(s,(o,c)=>{const f=r(o,n+1);!Ct(f)&&(l[c]=f)}),a[n]=void 0,l}}return s};return r(t,0)},po=je("AsyncFunction"),yo=t=>t&&(oa(t)||Ce(t))&&Ce(t.then)&&Ce(t.catch),Ns=((t,a)=>t?setImmediate:a?((r,s)=>(st.addEventListener("message",({source:n,data:l})=>{n===st&&l===r&&s.length&&s.shift()()},!1),n=>{s.push(n),st.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ce(st.postMessage)),ho=typeof queueMicrotask<"u"?queueMicrotask.bind(st):typeof process<"u"&&process.nextTick||Ns,xo=t=>t!=null&&Ce(t[sa]),k={isArray:ft,isArrayBuffer:ys,isBuffer:Il,isFormData:Kl,isArrayBufferView:_l,isString:Ll,isNumber:hs,isBoolean:Ml,isObject:oa,isPlainObject:It,isReadableStream:Gl,isRequest:zl,isResponse:Hl,isHeaders:Wl,isUndefined:Ct,isDate:jl,isFile:Ul,isBlob:ql,isRegExp:oo,isFunction:Ce,isStream:Vl,isURLSearchParams:Bl,isTypedArray:ao,isFileList:$l,forEach:Pt,merge:Ra,extend:Jl,trim:Ql,stripBOM:Zl,inherits:Yl,toFlatObject:Xl,kindOf:na,kindOfTest:je,endsWith:eo,toArray:to,forEachEntry:ro,matchAll:so,isHTMLForm:no,hasOwnProperty:Er,hasOwnProp:Er,reduceDescriptors:bs,freezeMethods:co,toObjectSet:io,toCamelCase:lo,noop:mo,toFiniteNumber:uo,findKey:xs,global:st,isContextDefined:Es,isSpecCompliantForm:go,toJSONObject:fo,isAsyncFn:po,isThenable:yo,setImmediate:Ns,asap:ho,isIterable:xo};function z(t,a,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",a&&(this.code=a),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}k.inherits(z,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:k.toJSONObject(this.config),code:this.code,status:this.status}}});const vs=z.prototype,ws={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{ws[t]={value:t}});Object.defineProperties(z,ws);Object.defineProperty(vs,"isAxiosError",{value:!0});z.from=(t,a,r,s,n,l)=>{const o=Object.create(vs);return k.toFlatObject(t,o,function(f){return f!==Error.prototype},c=>c!=="isAxiosError"),z.call(o,t.message,a,r,s,n),o.cause=t,o.name=t.name,l&&Object.assign(o,l),o};const Eo=null;function Fa(t){return k.isPlainObject(t)||k.isArray(t)}function Ss(t){return k.endsWith(t,"[]")?t.slice(0,-2):t}function br(t,a,r){return t?t.concat(a).map(function(n,l){return n=Ss(n),!r&&l?"["+n+"]":n}).join(r?".":""):a}function bo(t){return k.isArray(t)&&!t.some(Fa)}const No=k.toFlatObject(k,{},null,function(a){return/^is[A-Z]/.test(a)});function ca(t,a,r){if(!k.isObject(t))throw new TypeError("target must be an object");a=a||new FormData,r=k.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,h){return!k.isUndefined(h[y])});const s=r.metaTokens,n=r.visitor||d,l=r.dots,o=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&k.isSpecCompliantForm(a);if(!k.isFunction(n))throw new TypeError("visitor must be a function");function i(N){if(N===null)return"";if(k.isDate(N))return N.toISOString();if(k.isBoolean(N))return N.toString();if(!f&&k.isBlob(N))throw new z("Blob is not supported. Use a Buffer instead.");return k.isArrayBuffer(N)||k.isTypedArray(N)?f&&typeof Blob=="function"?new Blob([N]):Buffer.from(N):N}function d(N,y,h){let E=N;if(N&&!h&&typeof N=="object"){if(k.endsWith(y,"{}"))y=s?y:y.slice(0,-2),N=JSON.stringify(N);else if(k.isArray(N)&&bo(N)||(k.isFileList(N)||k.endsWith(y,"[]"))&&(E=k.toArray(N)))return y=Ss(y),E.forEach(function(A,v){!(k.isUndefined(A)||A===null)&&a.append(o===!0?br([y],v,l):o===null?y:y+"[]",i(A))}),!1}return Fa(N)?!0:(a.append(br(h,y,l),i(N)),!1)}const m=[],u=Object.assign(No,{defaultVisitor:d,convertValue:i,isVisitable:Fa});function p(N,y){if(!k.isUndefined(N)){if(m.indexOf(N)!==-1)throw Error("Circular reference detected in "+y.join("."));m.push(N),k.forEach(N,function(E,b){(!(k.isUndefined(E)||E===null)&&n.call(a,E,k.isString(b)?b.trim():b,y,u))===!0&&p(E,y?y.concat(b):[b])}),m.pop()}}if(!k.isObject(t))throw new TypeError("data must be an object");return p(t),a}function Nr(t){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return a[s]})}function Ba(t,a){this._pairs=[],t&&ca(t,this,a)}const Cs=Ba.prototype;Cs.append=function(a,r){this._pairs.push([a,r])};Cs.toString=function(a){const r=a?function(s){return a.call(this,s,Nr)}:Nr;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function vo(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ks(t,a,r){if(!a)return t;const s=r&&r.encode||vo;k.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(a,r):l=k.isURLSearchParams(a)?a.toString():new Ba(a,r).toString(s),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class vr{constructor(){this.handlers=[]}use(a,r,s){return this.handlers.push({fulfilled:a,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){k.forEach(this.handlers,function(s){s!==null&&a(s)})}}const As={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wo=typeof URLSearchParams<"u"?URLSearchParams:Ba,So=typeof FormData<"u"?FormData:null,Co=typeof Blob<"u"?Blob:null,ko={isBrowser:!0,classes:{URLSearchParams:wo,FormData:So,Blob:Co},protocols:["http","https","file","blob","url","data"]},Ga=typeof window<"u"&&typeof document<"u",Oa=typeof navigator=="object"&&navigator||void 0,Ao=Ga&&(!Oa||["ReactNative","NativeScript","NS"].indexOf(Oa.product)<0),Po=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Do=Ga&&window.location.href||"http://localhost",Ro=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ga,hasStandardBrowserEnv:Ao,hasStandardBrowserWebWorkerEnv:Po,navigator:Oa,origin:Do},Symbol.toStringTag,{value:"Module"})),Ee={...Ro,...ko};function Fo(t,a){return ca(t,new Ee.classes.URLSearchParams,Object.assign({visitor:function(r,s,n,l){return Ee.isNode&&k.isBuffer(r)?(this.append(s,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)}},a))}function Oo(t){return k.matchAll(/\w+|\[(\w*)]/g,t).map(a=>a[0]==="[]"?"":a[1]||a[0])}function To(t){const a={},r=Object.keys(t);let s;const n=r.length;let l;for(s=0;s<n;s++)l=r[s],a[l]=t[l];return a}function Ps(t){function a(r,s,n,l){let o=r[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),f=l>=r.length;return o=!o&&k.isArray(n)?n.length:o,f?(k.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!c):((!n[o]||!k.isObject(n[o]))&&(n[o]=[]),a(r,s,n[o],l)&&k.isArray(n[o])&&(n[o]=To(n[o])),!c)}if(k.isFormData(t)&&k.isFunction(t.entries)){const r={};return k.forEachEntry(t,(s,n)=>{a(Oo(s),n,r,0)}),r}return null}function Io(t,a,r){if(k.isString(t))try{return(a||JSON.parse)(t),k.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(t)}const Dt={transitional:As,adapter:["xhr","http","fetch"],transformRequest:[function(a,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,l=k.isObject(a);if(l&&k.isHTMLForm(a)&&(a=new FormData(a)),k.isFormData(a))return n?JSON.stringify(Ps(a)):a;if(k.isArrayBuffer(a)||k.isBuffer(a)||k.isStream(a)||k.isFile(a)||k.isBlob(a)||k.isReadableStream(a))return a;if(k.isArrayBufferView(a))return a.buffer;if(k.isURLSearchParams(a))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let c;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return Fo(a,this.formSerializer).toString();if((c=k.isFileList(a))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return ca(c?{"files[]":a}:a,f&&new f,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),Io(a)):a}],transformResponse:[function(a){const r=this.transitional||Dt.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(k.isResponse(a)||k.isReadableStream(a))return a;if(a&&k.isString(a)&&(s&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(a)}catch(c){if(o)throw c.name==="SyntaxError"?z.from(c,z.ERR_BAD_RESPONSE,this,null,this.response):c}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ee.classes.FormData,Blob:Ee.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};k.forEach(["delete","get","head","post","put","patch"],t=>{Dt.headers[t]={}});const _o=k.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lo=t=>{const a={};let r,s,n;return t&&t.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!r||a[r]&&_o[r])&&(r==="set-cookie"?a[r]?a[r].push(s):a[r]=[s]:a[r]=a[r]?a[r]+", "+s:s)}),a},wr=Symbol("internals");function ht(t){return t&&String(t).trim().toLowerCase()}function _t(t){return t===!1||t==null?t:k.isArray(t)?t.map(_t):String(t)}function Mo(t){const a=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(t);)a[s[1]]=s[2];return a}const jo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function ba(t,a,r,s,n){if(k.isFunction(s))return s.call(this,a,r);if(n&&(a=r),!!k.isString(a)){if(k.isString(s))return a.indexOf(s)!==-1;if(k.isRegExp(s))return s.test(a)}}function Uo(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,r,s)=>r.toUpperCase()+s)}function qo(t,a){const r=k.toCamelCase(" "+a);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+r,{value:function(n,l,o){return this[s].call(this,a,n,l,o)},configurable:!0})})}let ke=class{constructor(a){a&&this.set(a)}set(a,r,s){const n=this;function l(c,f,i){const d=ht(f);if(!d)throw new Error("header name must be a non-empty string");const m=k.findKey(n,d);(!m||n[m]===void 0||i===!0||i===void 0&&n[m]!==!1)&&(n[m||f]=_t(c))}const o=(c,f)=>k.forEach(c,(i,d)=>l(i,d,f));if(k.isPlainObject(a)||a instanceof this.constructor)o(a,r);else if(k.isString(a)&&(a=a.trim())&&!jo(a))o(Lo(a),r);else if(k.isObject(a)&&k.isIterable(a)){let c={},f,i;for(const d of a){if(!k.isArray(d))throw TypeError("Object iterator must return a key-value pair");c[i=d[0]]=(f=c[i])?k.isArray(f)?[...f,d[1]]:[f,d[1]]:d[1]}o(c,r)}else a!=null&&l(r,a,s);return this}get(a,r){if(a=ht(a),a){const s=k.findKey(this,a);if(s){const n=this[s];if(!r)return n;if(r===!0)return Mo(n);if(k.isFunction(r))return r.call(this,n,s);if(k.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,r){if(a=ht(a),a){const s=k.findKey(this,a);return!!(s&&this[s]!==void 0&&(!r||ba(this,this[s],s,r)))}return!1}delete(a,r){const s=this;let n=!1;function l(o){if(o=ht(o),o){const c=k.findKey(s,o);c&&(!r||ba(s,s[c],c,r))&&(delete s[c],n=!0)}}return k.isArray(a)?a.forEach(l):l(a),n}clear(a){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const l=r[s];(!a||ba(this,this[l],l,a,!0))&&(delete this[l],n=!0)}return n}normalize(a){const r=this,s={};return k.forEach(this,(n,l)=>{const o=k.findKey(s,l);if(o){r[o]=_t(n),delete r[l];return}const c=a?Uo(l):String(l).trim();c!==l&&delete r[l],r[c]=_t(n),s[c]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const r=Object.create(null);return k.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=a&&k.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,r])=>a+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...r){const s=new this(a);return r.forEach(n=>s.set(n)),s}static accessor(a){const s=(this[wr]=this[wr]={accessors:{}}).accessors,n=this.prototype;function l(o){const c=ht(o);s[c]||(qo(n,o),s[c]=!0)}return k.isArray(a)?a.forEach(l):l(a),this}};ke.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);k.reduceDescriptors(ke.prototype,({value:t},a)=>{let r=a[0].toUpperCase()+a.slice(1);return{get:()=>t,set(s){this[r]=s}}});k.freezeMethods(ke);function Na(t,a){const r=this||Dt,s=a||r,n=ke.from(s.headers);let l=s.data;return k.forEach(t,function(c){l=c.call(r,l,n.normalize(),a?a.status:void 0)}),n.normalize(),l}function Ds(t){return!!(t&&t.__CANCEL__)}function pt(t,a,r){z.call(this,t??"canceled",z.ERR_CANCELED,a,r),this.name="CanceledError"}k.inherits(pt,z,{__CANCEL__:!0});function Rs(t,a,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?t(r):a(new z("Request failed with status code "+r.status,[z.ERR_BAD_REQUEST,z.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function $o(t){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return a&&a[1]||""}function Vo(t,a){t=t||10;const r=new Array(t),s=new Array(t);let n=0,l=0,o;return a=a!==void 0?a:1e3,function(f){const i=Date.now(),d=s[l];o||(o=i),r[n]=f,s[n]=i;let m=l,u=0;for(;m!==n;)u+=r[m++],m=m%t;if(n=(n+1)%t,n===l&&(l=(l+1)%t),i-o<a)return;const p=d&&i-d;return p?Math.round(u*1e3/p):void 0}}function Ko(t,a){let r=0,s=1e3/a,n,l;const o=(i,d=Date.now())=>{r=d,n=null,l&&(clearTimeout(l),l=null),t.apply(null,i)};return[(...i)=>{const d=Date.now(),m=d-r;m>=s?o(i,d):(n=i,l||(l=setTimeout(()=>{l=null,o(n)},s-m)))},()=>n&&o(n)]}const zt=(t,a,r=3)=>{let s=0;const n=Vo(50,250);return Ko(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,f=o-s,i=n(f),d=o<=c;s=o;const m={loaded:o,total:c,progress:c?o/c:void 0,bytes:f,rate:i||void 0,estimated:i&&c&&d?(c-o)/i:void 0,event:l,lengthComputable:c!=null,[a?"download":"upload"]:!0};t(m)},r)},Sr=(t,a)=>{const r=t!=null;return[s=>a[0]({lengthComputable:r,total:t,loaded:s}),a[1]]},Cr=t=>(...a)=>k.asap(()=>t(...a)),Bo=Ee.hasStandardBrowserEnv?((t,a)=>r=>(r=new URL(r,Ee.origin),t.protocol===r.protocol&&t.host===r.host&&(a||t.port===r.port)))(new URL(Ee.origin),Ee.navigator&&/(msie|trident)/i.test(Ee.navigator.userAgent)):()=>!0,Go=Ee.hasStandardBrowserEnv?{write(t,a,r,s,n,l){const o=[t+"="+encodeURIComponent(a)];k.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),k.isString(s)&&o.push("path="+s),k.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const a=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function zo(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Ho(t,a){return a?t.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):t}function Fs(t,a,r){let s=!zo(a);return t&&(s||r==!1)?Ho(t,a):a}const kr=t=>t instanceof ke?{...t}:t;function mt(t,a){a=a||{};const r={};function s(i,d,m,u){return k.isPlainObject(i)&&k.isPlainObject(d)?k.merge.call({caseless:u},i,d):k.isPlainObject(d)?k.merge({},d):k.isArray(d)?d.slice():d}function n(i,d,m,u){if(k.isUndefined(d)){if(!k.isUndefined(i))return s(void 0,i,m,u)}else return s(i,d,m,u)}function l(i,d){if(!k.isUndefined(d))return s(void 0,d)}function o(i,d){if(k.isUndefined(d)){if(!k.isUndefined(i))return s(void 0,i)}else return s(void 0,d)}function c(i,d,m){if(m in a)return s(i,d);if(m in t)return s(void 0,i)}const f={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(i,d,m)=>n(kr(i),kr(d),m,!0)};return k.forEach(Object.keys(Object.assign({},t,a)),function(d){const m=f[d]||n,u=m(t[d],a[d],d);k.isUndefined(u)&&m!==c||(r[d]=u)}),r}const Os=t=>{const a=mt({},t);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:c}=a;a.headers=o=ke.from(o),a.url=ks(Fs(a.baseURL,a.url,a.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let f;if(k.isFormData(r)){if(Ee.hasStandardBrowserEnv||Ee.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((f=o.getContentType())!==!1){const[i,...d]=f?f.split(";").map(m=>m.trim()).filter(Boolean):[];o.setContentType([i||"multipart/form-data",...d].join("; "))}}if(Ee.hasStandardBrowserEnv&&(s&&k.isFunction(s)&&(s=s(a)),s||s!==!1&&Bo(a.url))){const i=n&&l&&Go.read(l);i&&o.set(n,i)}return a},Wo=typeof XMLHttpRequest<"u",Qo=Wo&&function(t){return new Promise(function(r,s){const n=Os(t);let l=n.data;const o=ke.from(n.headers).normalize();let{responseType:c,onUploadProgress:f,onDownloadProgress:i}=n,d,m,u,p,N;function y(){p&&p(),N&&N(),n.cancelToken&&n.cancelToken.unsubscribe(d),n.signal&&n.signal.removeEventListener("abort",d)}let h=new XMLHttpRequest;h.open(n.method.toUpperCase(),n.url,!0),h.timeout=n.timeout;function E(){if(!h)return;const A=ke.from("getAllResponseHeaders"in h&&h.getAllResponseHeaders()),O={data:!c||c==="text"||c==="json"?h.responseText:h.response,status:h.status,statusText:h.statusText,headers:A,config:t,request:h};Rs(function(M){r(M),y()},function(M){s(M),y()},O),h=null}"onloadend"in h?h.onloadend=E:h.onreadystatechange=function(){!h||h.readyState!==4||h.status===0&&!(h.responseURL&&h.responseURL.indexOf("file:")===0)||setTimeout(E)},h.onabort=function(){h&&(s(new z("Request aborted",z.ECONNABORTED,t,h)),h=null)},h.onerror=function(){s(new z("Network Error",z.ERR_NETWORK,t,h)),h=null},h.ontimeout=function(){let v=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const O=n.transitional||As;n.timeoutErrorMessage&&(v=n.timeoutErrorMessage),s(new z(v,O.clarifyTimeoutError?z.ETIMEDOUT:z.ECONNABORTED,t,h)),h=null},l===void 0&&o.setContentType(null),"setRequestHeader"in h&&k.forEach(o.toJSON(),function(v,O){h.setRequestHeader(O,v)}),k.isUndefined(n.withCredentials)||(h.withCredentials=!!n.withCredentials),c&&c!=="json"&&(h.responseType=n.responseType),i&&([u,N]=zt(i,!0),h.addEventListener("progress",u)),f&&h.upload&&([m,p]=zt(f),h.upload.addEventListener("progress",m),h.upload.addEventListener("loadend",p)),(n.cancelToken||n.signal)&&(d=A=>{h&&(s(!A||A.type?new pt(null,t,h):A),h.abort(),h=null)},n.cancelToken&&n.cancelToken.subscribe(d),n.signal&&(n.signal.aborted?d():n.signal.addEventListener("abort",d)));const b=$o(n.url);if(b&&Ee.protocols.indexOf(b)===-1){s(new z("Unsupported protocol "+b+":",z.ERR_BAD_REQUEST,t));return}h.send(l||null)})},Jo=(t,a)=>{const{length:r}=t=t?t.filter(Boolean):[];if(a||r){let s=new AbortController,n;const l=function(i){if(!n){n=!0,c();const d=i instanceof Error?i:this.reason;s.abort(d instanceof z?d:new pt(d instanceof Error?d.message:d))}};let o=a&&setTimeout(()=>{o=null,l(new z(`timeout ${a} of ms exceeded`,z.ETIMEDOUT))},a);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(i=>{i.unsubscribe?i.unsubscribe(l):i.removeEventListener("abort",l)}),t=null)};t.forEach(i=>i.addEventListener("abort",l));const{signal:f}=s;return f.unsubscribe=()=>k.asap(c),f}},Zo=function*(t,a){let r=t.byteLength;if(r<a){yield t;return}let s=0,n;for(;s<r;)n=s+a,yield t.slice(s,n),s=n},Yo=async function*(t,a){for await(const r of Xo(t))yield*Zo(r,a)},Xo=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const a=t.getReader();try{for(;;){const{done:r,value:s}=await a.read();if(r)break;yield s}}finally{await a.cancel()}},Ar=(t,a,r,s)=>{const n=Yo(t,a);let l=0,o,c=f=>{o||(o=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:i,value:d}=await n.next();if(i){c(),f.close();return}let m=d.byteLength;if(r){let u=l+=m;r(u)}f.enqueue(new Uint8Array(d))}catch(i){throw c(i),i}},cancel(f){return c(f),n.return()}},{highWaterMark:2})},ia=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ts=ia&&typeof ReadableStream=="function",ec=ia&&(typeof TextEncoder=="function"?(t=>a=>t.encode(a))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Is=(t,...a)=>{try{return!!t(...a)}catch{return!1}},tc=Ts&&Is(()=>{let t=!1;const a=new Request(Ee.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!a}),Pr=64*1024,Ta=Ts&&Is(()=>k.isReadableStream(new Response("").body)),Ht={stream:Ta&&(t=>t.body)};ia&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(a=>{!Ht[a]&&(Ht[a]=k.isFunction(t[a])?r=>r[a]():(r,s)=>{throw new z(`Response type '${a}' is not supported`,z.ERR_NOT_SUPPORT,s)})})})(new Response);const ac=async t=>{if(t==null)return 0;if(k.isBlob(t))return t.size;if(k.isSpecCompliantForm(t))return(await new Request(Ee.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(k.isArrayBufferView(t)||k.isArrayBuffer(t))return t.byteLength;if(k.isURLSearchParams(t)&&(t=t+""),k.isString(t))return(await ec(t)).byteLength},rc=async(t,a)=>{const r=k.toFiniteNumber(t.getContentLength());return r??ac(a)},sc=ia&&(async t=>{let{url:a,method:r,data:s,signal:n,cancelToken:l,timeout:o,onDownloadProgress:c,onUploadProgress:f,responseType:i,headers:d,withCredentials:m="same-origin",fetchOptions:u}=Os(t);i=i?(i+"").toLowerCase():"text";let p=Jo([n,l&&l.toAbortSignal()],o),N;const y=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let h;try{if(f&&tc&&r!=="get"&&r!=="head"&&(h=await rc(d,s))!==0){let O=new Request(a,{method:"POST",body:s,duplex:"half"}),R;if(k.isFormData(s)&&(R=O.headers.get("content-type"))&&d.setContentType(R),O.body){const[M,w]=Sr(h,zt(Cr(f)));s=Ar(O.body,Pr,M,w)}}k.isString(m)||(m=m?"include":"omit");const E="credentials"in Request.prototype;N=new Request(a,{...u,signal:p,method:r.toUpperCase(),headers:d.normalize().toJSON(),body:s,duplex:"half",credentials:E?m:void 0});let b=await fetch(N,u);const A=Ta&&(i==="stream"||i==="response");if(Ta&&(c||A&&y)){const O={};["status","statusText","headers"].forEach(I=>{O[I]=b[I]});const R=k.toFiniteNumber(b.headers.get("content-length")),[M,w]=c&&Sr(R,zt(Cr(c),!0))||[];b=new Response(Ar(b.body,Pr,M,()=>{w&&w(),y&&y()}),O)}i=i||"text";let v=await Ht[k.findKey(Ht,i)||"text"](b,t);return!A&&y&&y(),await new Promise((O,R)=>{Rs(O,R,{data:v,headers:ke.from(b.headers),status:b.status,statusText:b.statusText,config:t,request:N})})}catch(E){throw y&&y(),E&&E.name==="TypeError"&&/Load failed|fetch/i.test(E.message)?Object.assign(new z("Network Error",z.ERR_NETWORK,t,N),{cause:E.cause||E}):z.from(E,E&&E.code,t,N)}}),Ia={http:Eo,xhr:Qo,fetch:sc};k.forEach(Ia,(t,a)=>{if(t){try{Object.defineProperty(t,"name",{value:a})}catch{}Object.defineProperty(t,"adapterName",{value:a})}});const Dr=t=>`- ${t}`,nc=t=>k.isFunction(t)||t===null||t===!1,_s={getAdapter:t=>{t=k.isArray(t)?t:[t];const{length:a}=t;let r,s;const n={};for(let l=0;l<a;l++){r=t[l];let o;if(s=r,!nc(r)&&(s=Ia[(o=String(r)).toLowerCase()],s===void 0))throw new z(`Unknown adapter '${o}'`);if(s)break;n[o||"#"+l]=s}if(!s){const l=Object.entries(n).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=a?l.length>1?`since :
`+l.map(Dr).join(`
`):" "+Dr(l[0]):"as no adapter specified";throw new z("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Ia};function va(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new pt(null,t)}function Rr(t){return va(t),t.headers=ke.from(t.headers),t.data=Na.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),_s.getAdapter(t.adapter||Dt.adapter)(t).then(function(s){return va(t),s.data=Na.call(t,t.transformResponse,s),s.headers=ke.from(s.headers),s},function(s){return Ds(s)||(va(t),s&&s.response&&(s.response.data=Na.call(t,t.transformResponse,s.response),s.response.headers=ke.from(s.response.headers))),Promise.reject(s)})}const Ls="1.10.0",ma={};["object","boolean","number","function","string","symbol"].forEach((t,a)=>{ma[t]=function(s){return typeof s===t||"a"+(a<1?"n ":" ")+t}});const Fr={};ma.transitional=function(a,r,s){function n(l,o){return"[Axios v"+Ls+"] Transitional option '"+l+"'"+o+(s?". "+s:"")}return(l,o,c)=>{if(a===!1)throw new z(n(o," has been removed"+(r?" in "+r:"")),z.ERR_DEPRECATED);return r&&!Fr[o]&&(Fr[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),a?a(l,o,c):!0}};ma.spelling=function(a){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${a}`),!0)};function lc(t,a,r){if(typeof t!="object")throw new z("options must be an object",z.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let n=s.length;for(;n-- >0;){const l=s[n],o=a[l];if(o){const c=t[l],f=c===void 0||o(c,l,t);if(f!==!0)throw new z("option "+l+" must be "+f,z.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new z("Unknown option "+l,z.ERR_BAD_OPTION)}}const Lt={assertOptions:lc,validators:ma},Ue=Lt.validators;let lt=class{constructor(a){this.defaults=a||{},this.interceptors={request:new vr,response:new vr}}async request(a,r){try{return await this._request(a,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(a,r){typeof a=="string"?(r=r||{},r.url=a):r=a||{},r=mt(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:l}=r;s!==void 0&&Lt.assertOptions(s,{silentJSONParsing:Ue.transitional(Ue.boolean),forcedJSONParsing:Ue.transitional(Ue.boolean),clarifyTimeoutError:Ue.transitional(Ue.boolean)},!1),n!=null&&(k.isFunction(n)?r.paramsSerializer={serialize:n}:Lt.assertOptions(n,{encode:Ue.function,serialize:Ue.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Lt.assertOptions(r,{baseUrl:Ue.spelling("baseURL"),withXsrfToken:Ue.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&k.merge(l.common,l[r.method]);l&&k.forEach(["delete","get","head","post","put","patch","common"],N=>{delete l[N]}),r.headers=ke.concat(o,l);const c=[];let f=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(f=f&&y.synchronous,c.unshift(y.fulfilled,y.rejected))});const i=[];this.interceptors.response.forEach(function(y){i.push(y.fulfilled,y.rejected)});let d,m=0,u;if(!f){const N=[Rr.bind(this),void 0];for(N.unshift.apply(N,c),N.push.apply(N,i),u=N.length,d=Promise.resolve(r);m<u;)d=d.then(N[m++],N[m++]);return d}u=c.length;let p=r;for(m=0;m<u;){const N=c[m++],y=c[m++];try{p=N(p)}catch(h){y.call(this,h);break}}try{d=Rr.call(this,p)}catch(N){return Promise.reject(N)}for(m=0,u=i.length;m<u;)d=d.then(i[m++],i[m++]);return d}getUri(a){a=mt(this.defaults,a);const r=Fs(a.baseURL,a.url,a.allowAbsoluteUrls);return ks(r,a.params,a.paramsSerializer)}};k.forEach(["delete","get","head","options"],function(a){lt.prototype[a]=function(r,s){return this.request(mt(s||{},{method:a,url:r,data:(s||{}).data}))}});k.forEach(["post","put","patch"],function(a){function r(s){return function(l,o,c){return this.request(mt(c||{},{method:a,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}lt.prototype[a]=r(),lt.prototype[a+"Form"]=r(!0)});let oc=class Ms{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const s=this;this.promise.then(n=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](n);s._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(c=>{s.subscribe(c),l=c}).then(n);return o.cancel=function(){s.unsubscribe(l)},o},a(function(l,o,c){s.reason||(s.reason=new pt(l,o,c),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const r=this._listeners.indexOf(a);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const a=new AbortController,r=s=>{a.abort(s)};return this.subscribe(r),a.signal.unsubscribe=()=>this.unsubscribe(r),a.signal}static source(){let a;return{token:new Ms(function(n){a=n}),cancel:a}}};function cc(t){return function(r){return t.apply(null,r)}}function ic(t){return k.isObject(t)&&t.isAxiosError===!0}const _a={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(_a).forEach(([t,a])=>{_a[a]=t});function js(t){const a=new lt(t),r=fs(lt.prototype.request,a);return k.extend(r,lt.prototype,a,{allOwnKeys:!0}),k.extend(r,a,null,{allOwnKeys:!0}),r.create=function(n){return js(mt(t,n))},r}const $=js(Dt);$.Axios=lt;$.CanceledError=pt;$.CancelToken=oc;$.isCancel=Ds;$.VERSION=Ls;$.toFormData=ca;$.AxiosError=z;$.Cancel=$.CanceledError;$.all=function(a){return Promise.all(a)};$.spread=cc;$.isAxiosError=ic;$.mergeConfig=mt;$.AxiosHeaders=ke;$.formToJSON=t=>Ps(k.isHTMLForm(t)?new FormData(t):t);$.getAdapter=_s.getAdapter;$.HttpStatusCode=_a;$.default=$;const{Axios:Oi,AxiosError:Ti,CanceledError:Ii,isCancel:_i,CancelToken:Li,VERSION:Mi,all:ji,Cancel:Ui,isAxiosError:qi,spread:$i,toFormData:Vi,AxiosHeaders:Ki,HttpStatusCode:Bi,formToJSON:Gi,getAdapter:zi,mergeConfig:Hi}=$;$.interceptors.request.use(t=>(console.log("🌐 Axios Request:",{url:t.url,method:t.method,headers:t.headers,data:t.data,baseURL:t.baseURL}),t),t=>(console.error("🌐 Axios Request Error:",t),Promise.reject(t)));$.interceptors.response.use(t=>(console.log("🌐 Axios Response:",{status:t.status,statusText:t.statusText,headers:t.headers,data:t.data}),t),t=>(console.error("🌐 Axios Response Error:"),console.error("  Status:",t.response?.status),console.error("  Status Text:",t.response?.statusText),console.error("  Headers:",t.response?.headers),console.error("  Data:",t.response?.data),console.error("  Message:",t.message),console.error("  Config URL:",t.config?.url),console.error("  Full Error:",t),Promise.reject(t)));const ae=us()(gs((t,a)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:async(r,s)=>{try{t({isLoading:!0}),console.log("🔑 Login attempt:",{phone:r,apiUrl:"/api",fullUrl:"/api/auth/login"}),console.log("📤 Request payload:",JSON.stringify({phone:r,password:s})),console.log("🔥 FORCING REAL DATABASE CALLS - All bypasses disabled");const n=await $.post("/api/auth/login",{phone:r,password:s},{headers:{"Content-Type":"application/json"},timeout:1e4});console.log("📥 Response status:",n.status),console.log("📥 Response headers:",n.headers),console.log("✅ Login success:",n.data);const{user:l,token:o}=n.data;localStorage.setItem("token",o),t({user:l,token:o,isAuthenticated:!0,isLoading:!1})}catch(n){console.error("❌ Login error:",n),console.error("❌ Error message:",n.message),console.error("❌ Error response data:",n.response?.data),console.error("❌ Error status:",n.response?.status),console.error("❌ Error status text:",n.response?.statusText),console.error("❌ Error URL:",n.config?.url),console.error("❌ Error code:",n.code),console.error("❌ Error name:",n.name),console.error("❌ Full error object:",JSON.stringify(n,null,2)),t({isLoading:!1});let l="Login failed";throw n.code==="ERR_NETWORK"||n.name==="AxiosError"&&!n.response?l="Cannot connect to server. Please check if the backend is running.":n.code==="ECONNREFUSED"?l="Connection refused. Server may be down.":n.response?.status===401?l="Invalid phone number or password":n.response?.status===400?l=n.response.data?.error||"Invalid request":n.response?.data?.error?l=n.response.data.error:n.response?.data?.message?l=n.response.data.message:n.message&&n.message!=="[object Object]"&&(l=n.message),console.error("❌ Final error message:",l),new Error(l)}},loginWithData:(r,s)=>{localStorage.setItem("token",s),t({user:r,token:s,isAuthenticated:!0})},logout:()=>{localStorage.removeItem("token"),t({user:null,token:null,isAuthenticated:!1})},updateUser:r=>{t({user:r})}}),{name:"auth-storage",partialize:t=>({user:t.user,token:t.token,isAuthenticated:t.isAuthenticated})}));class mc extends S.Component{state={hasError:!1};static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("Error caught by boundary:",a,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},e.createElement("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center"},e.createElement("div",{className:"text-red-500 text-6xl mb-4"},"⚠️"),e.createElement("h1",{className:"text-xl font-semibold text-gray-900 mb-2"},"Something went wrong"),e.createElement("p",{className:"text-gray-600 mb-4"},this.state.error?.message||"An unexpected error occurred"),e.createElement("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"},"Reload Page"))):this.props.children}}const dc=()=>{window.addEventListener("unhandledrejection",t=>{}),window.addEventListener("error",t=>{})},ue=t=>{const a=Number(t);return isNaN(a)||!isFinite(a)?0:a},uc=us()(gs((t,a)=>({items:[],totalItems:0,totalAmount:0,addToCart:(r,s)=>{const n=a(),l=ue(s),o=ue(r.pricePerUnit);if(l<=0)return;if(n.items.find(f=>f.productId===r.id)){const f=n.items.map(m=>m.productId===r.id?{...m,quantity:ue(m.quantity)+l}:m),i=f.reduce((m,u)=>m+ue(u.quantity),0),d=f.reduce((m,u)=>m+ue(u.pricePerUnit)*ue(u.quantity),0);t({items:f,totalItems:i,totalAmount:d})}else{const f={id:`cart-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,productId:r.id||`product-${Date.now()}`,name:r.name||"Unknown Product",pricePerUnit:o,quantity:l,images:Array.isArray(r.images)?r.images:[],unit:r.unit||"kg"},i=[...n.items,f],d=i.reduce((u,p)=>u+ue(p.quantity),0),m=i.reduce((u,p)=>u+ue(p.pricePerUnit)*ue(p.quantity),0);t({items:i,totalItems:d,totalAmount:m})}},removeFromCart:r=>{const n=a().items.filter(c=>c.id!==r),l=n.reduce((c,f)=>c+ue(f.quantity),0),o=n.reduce((c,f)=>c+ue(f.pricePerUnit)*ue(f.quantity),0);t({items:n,totalItems:l,totalAmount:o})},updateQuantity:(r,s)=>{const n=a(),l=ue(s);if(l<=0){a().removeFromCart(r);return}const o=n.items.map(i=>i.id===r?{...i,quantity:l}:i),c=o.reduce((i,d)=>i+ue(d.quantity),0),f=o.reduce((i,d)=>i+ue(d.pricePerUnit)*ue(d.quantity),0);t({items:o,totalItems:c,totalAmount:f})},clearCart:()=>{t({items:[],totalItems:0,totalAmount:0})},refreshCart:()=>{const r=a(),s=r.items.reduce((l,o)=>l+ue(o.quantity),0),n=r.items.reduce((l,o)=>l+ue(o.pricePerUnit)*ue(o.quantity),0);t({totalItems:s,totalAmount:n})}}),{name:"cart-storage",partialize:t=>({items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount})})),yt=()=>{const t=uc();return{cart:{items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount},addToCart:t.addToCart,removeFromCart:t.removeFromCart,updateQuantity:t.updateQuantity,clearCart:t.clearCart,refreshCart:t.refreshCart,isLoading:!1}};function gc(){const{isAuthenticated:t,user:a,logout:r}=ae(),{cart:s}=yt(),n=He(),[l,o]=S.useState(!1),c=()=>{r(),n("/"),o(!1)},f=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/"}},i=()=>{o(!1)};return e.createElement("nav",{className:"bg-white shadow-sm border-b sticky top-0 z-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"flex justify-between h-16"},e.createElement("div",{className:"flex items-center"},e.createElement(W,{to:"/",className:"flex items-center space-x-2",onClick:i},e.createElement("div",{className:"w-8 h-8 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-sm"},"Z")),e.createElement("span",{className:"text-lg sm:text-xl font-bold text-gray-900"},"Zuasoko"))),e.createElement("div",{className:"hidden md:flex items-center space-x-6"},e.createElement(W,{to:"/marketplace",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(W,{to:f(),className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Dashboard"),e.createElement(W,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement(Ke,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("span",{className:"text-sm text-gray-600"},a?.firstName),e.createElement("button",{onClick:c,className:"text-gray-700 hover:text-red-600 p-2 rounded-md transition-colors"},e.createElement(rr,{className:"w-4 h-4"})))):e.createElement("div",{className:"flex items-center space-x-3"},e.createElement(W,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement(Ke,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement(W,{to:"/login",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Login"),e.createElement(W,{to:"/register",className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors"},"Register"))),e.createElement("div",{className:"md:hidden flex items-center space-x-3"},e.createElement(W,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors",onClick:i},e.createElement(Ke,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("button",{onClick:()=>o(!l),className:"text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},l?e.createElement(Ae,{className:"w-5 h-5"}):e.createElement(zr,{className:"w-5 h-5"}))))),l&&e.createElement("div",{className:"md:hidden bg-white border-t border-gray-200"},e.createElement("div",{className:"px-2 pt-2 pb-3 space-y-1"},e.createElement(W,{to:"/",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:i},e.createElement(Hr,{className:"w-5 h-5"}),"Home"),e.createElement(W,{to:"/marketplace",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:i},e.createElement(Wr,{className:"w-5 h-5"}),"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(W,{to:f(),className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:i},e.createElement(on,{className:"w-5 h-5"}),"Dashboard"),e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2"},e.createElement("div",{className:"flex items-center gap-3 mb-3"},e.createElement("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement(Fe,{className:"w-4 h-4 text-primary-600"})),e.createElement("div",null,e.createElement("div",{className:"text-sm font-medium text-gray-900"},a?.firstName," ",a?.lastName),e.createElement("div",{className:"text-xs text-gray-500 capitalize"},a?.role?.toLowerCase()))),e.createElement("button",{onClick:c,className:"flex items-center gap-3 w-full px-3 py-2 text-base font-medium text-red-600 hover:bg-red-50 rounded-md transition-colors"},e.createElement(rr,{className:"w-5 h-5"}),"Logout"))):e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2 space-y-2"},e.createElement(W,{to:"/login",className:"block w-full text-center px-4 py-3 text-base font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",onClick:i},"Login"),e.createElement(W,{to:"/register",className:"block w-full text-center px-4 py-3 text-base font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors",onClick:i},"Register")))))}function fc(){const{isAuthenticated:t,user:a}=ae(),{cart:r}=yt(),s=Gr(),l=(()=>{const c=[{path:"/",icon:Hr,label:"Home",show:!0},{path:"/marketplace",icon:Wr,label:"Shop",show:!0}];if(!t)return[...c,{path:"/cart",icon:Ke,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/login",icon:Fe,label:"Login",show:!0}];switch(a?.role){case"CUSTOMER":return[...c,{path:"/cart",icon:Ke,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/customer/dashboard",icon:Fe,label:"Account",show:!0}];case"FARMER":return[...c,{path:"/farmer/consignments",icon:ut,label:"Consign",show:!0},{path:"/farmer/wallet",icon:Fe,label:"Wallet",show:!0}];case"DRIVER":return[...c,{path:"/driver/assignments",icon:ne,label:"Transport",show:!0},{path:"/driver/warehouse",icon:Fe,label:"Warehouse",show:!0}];case"ADMIN":return[...c,{path:"/admin/consignments",icon:ut,label:"Consign",show:!0},{path:"/admin/analytics",icon:ja,label:"Analytics",show:!0}];default:return c}})().filter(c=>c.show),o=c=>!!(c==="/"&&s.pathname==="/"||c!=="/"&&s.pathname.startsWith(c));return e.createElement("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50"},e.createElement("div",{className:"grid grid-cols-4 py-1"},l.map(c=>{const f=c.icon,i=o(c.path);return e.createElement(W,{key:c.path,to:c.path,className:`flex flex-col items-center justify-center py-2 px-1 text-xs font-medium transition-colors ${i?"text-primary-600":"text-gray-500 hover:text-gray-700"}`},e.createElement("div",{className:"relative"},e.createElement(f,{className:`w-5 h-5 ${i?"text-primary-600":"text-gray-500"}`}),"badge"in c&&c.badge&&c.badge>0&&e.createElement("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center min-w-[16px]"},c.badge>99?"99+":c.badge)),e.createElement("span",{className:`mt-1 ${i?"text-primary-600":"text-gray-500"}`},c.label))})),e.createElement("div",{className:"h-safe-bottom bg-white"}))}function pc(){const[t,a]=S.useState({connected:!1,database:"checking...",loading:!0,error:!1});if(S.useEffect(()=>{const l=async()=>{try{const f=await(await fetch("/api/status")).json(),i=f.status==="OK"&&f.database==="connected",d=f.database_type||f.database;a({connected:i,database:d,loading:!1,error:!1})}catch(c){console.warn("Status check failed:",c.message),a({connected:!1,database:"error",loading:!1,error:!0})}};l();const o=setInterval(l,6e4);return()=>clearInterval(o)},[]),t.loading)return null;const r=t.database==="neon_postgresql"||t.connected,s=t.error||t.database.includes("error"),n=t.database==="demo"||!r&&!s;return e.createElement("div",{className:"fixed bottom-4 right-4 z-50"},e.createElement("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium shadow-lg transition-all duration-300 ${s?"bg-red-100 text-red-800 border border-red-200":r?"bg-green-100 text-green-800 border border-green-200":n?"bg-blue-100 text-blue-800 border border-blue-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`},s?e.createElement(e.Fragment,null,e.createElement(Ge,{className:"w-4 h-4"}),e.createElement("span",null,"API Error"),e.createElement(sr,{className:"w-4 h-4"})):r?e.createElement(e.Fragment,null,e.createElement(nr,{className:"w-4 h-4"}),e.createElement("span",null,"Neon DB Live"),e.createElement(Qr,{className:"w-4 h-4"})):e.createElement(e.Fragment,null,e.createElement(nr,{className:"w-4 h-4"}),e.createElement("span",null,"Demo Mode"),e.createElement(sr,{className:"w-4 h-4"}))))}const yc=()=>{const[t,a]=S.useState(!1),[r,s]=S.useState(null),[n,l]=S.useState(!0),o="/downloads/zuasoko-app.apk",c=async()=>{try{const d=(await fetch(o,{method:"HEAD"})).ok;if(d)try{const m=await fetch("/downloads/app-info.json");if(m.ok){const u=await m.json();s(u)}}catch{console.log("App info not available, using defaults")}return a(d),d}catch(i){return console.error("Error checking APK availability:",i),a(!1),!1}},f=()=>{if(t){const i=document.createElement("a");i.href=o,i.download="zuasoko-app.apk",i.target="_blank",document.body.appendChild(i),i.click(),document.body.removeChild(i),window.gtag&&window.gtag("event","app_download",{event_category:"engagement",event_label:"android_apk",value:1});const d=new CustomEvent("show-toast",{detail:{message:"APK download started! Check your downloads folder.",type:"success"}});window.dispatchEvent(d)}};return S.useEffect(()=>{(async()=>{l(!0),await c(),l(!1)})()},[]),{isAvailable:t,appInfo:r,loading:n,downloadUrl:o,checkAvailability:c,downloadApp:f}},hc=({isOpen:t,onClose:a,appInfo:r,onDownload:s})=>{if(!t)return null;const n=l=>l.toLowerCase().includes("internet")?e.createElement(Qr,{className:"w-4 h-4"}):l.toLowerCase().includes("location")?e.createElement(Me,{className:"w-4 h-4"}):l.toLowerCase().includes("camera")?e.createElement(Jr,{className:"w-4 h-4"}):l.toLowerCase().includes("storage")?e.createElement(lr,{className:"w-4 h-4"}):l.toLowerCase().includes("notification")?e.createElement(ot,{className:"w-4 h-4"}):e.createElement(Be,{className:"w-4 h-4"});return e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl"},e.createElement("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-4"},e.createElement("div",{className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center shadow-lg"},e.createElement(Sa,{className:"w-8 h-8 text-white"})),e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Zuasoko Mobile App"),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-600"},e.createElement("span",null,"Version ",r.version),e.createElement("span",null,"•"),e.createElement("span",null,r.size),e.createElement("span",null,"•"),e.createElement("span",null,"Android ",r.minAndroidVersion,"+")))),e.createElement("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},e.createElement(Ae,{className:"w-6 h-6 text-gray-600"})))),e.createElement("div",{className:"p-6 space-y-8"},e.createElement("div",{className:"text-center"},e.createElement("button",{onClick:()=>{s(),a()},className:"bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center gap-3 mx-auto"},e.createElement(jt,{className:"w-6 h-6"}),"Download APK (",r.size,")"),e.createElement("p",{className:"text-sm text-gray-600 mt-3"},"Released on"," ",new Date(r.releaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},e.createElement(kt,{className:"w-5 h-5 text-yellow-500"}),"What's New in v",r.version),e.createElement("div",{className:"space-y-2"},r.releaseNotes.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg"},e.createElement(se,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"Key Features"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},r.features.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement(se,{className:"w-4 h-4 text-primary-600 mt-1 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700 text-sm"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"System Requirements"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("div",{className:"p-4 bg-blue-50 rounded-lg text-center"},e.createElement(Sa,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Android Version"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.android)),e.createElement("div",{className:"p-4 bg-green-50 rounded-lg text-center"},e.createElement(lr,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Storage"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.storage)),e.createElement("div",{className:"p-4 bg-purple-50 rounded-lg text-center"},e.createElement(oe,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"RAM"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.ram)))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"App Permissions"),e.createElement("div",{className:"space-y-3"},r.permissions.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg flex-shrink-0"},n(l)),e.createElement("div",null,e.createElement("div",{className:"font-medium text-gray-900"},l.split(" - ")[0]),l.includes(" - ")&&e.createElement("div",{className:"text-sm text-gray-600 mt-1"},l.split(" - ")[1])))))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start gap-3"},e.createElement(Be,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-yellow-800 mb-2"},"Security Notice"),e.createElement("p",{className:"text-sm text-yellow-700"},'This APK is signed and verified by Zuasoko. Before installing, make sure to enable "Install from unknown sources" in your Android settings. Only download from this official source to ensure security and authenticity.')))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h4",{className:"font-semibold text-blue-800 mb-3"},"Installation Instructions"),e.createElement("ol",{className:"text-sm text-blue-700 space-y-2"},e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"1"),"Download the APK file by clicking the download button above"),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"2"),'Go to Settings → Security → Enable "Unknown Sources" or "Install unknown apps"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"3"),'Open the downloaded APK file and tap "Install"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"4"),"Open the Zuasoko app and log in with your account"))))))};function xc(){const{isAuthenticated:t,user:a}=ae(),[r,s]=S.useState(!1),[n,l]=S.useState(!1),{isAvailable:o,appInfo:c,loading:f,downloadApp:i}=yc(),d=[{icon:e.createElement(Ze,{className:"w-8 h-8 text-primary-600"}),title:"Fresh Produce",description:"Direct from farmers to your table, ensuring maximum freshness and quality."},{icon:e.createElement(Pe,{className:"w-8 h-8 text-primary-600"}),title:"Support Farmers",description:"Help local farmers get fair prices for their hard work and dedication."},{icon:e.createElement(ne,{className:"w-8 h-8 text-primary-600"}),title:"Fast Delivery",description:"Quick and reliable delivery service to get your orders to you fresh."},{icon:e.createElement(kt,{className:"w-8 h-8 text-primary-600"}),title:"Quality Assured",description:"All produce is quality-checked before delivery to ensure satisfaction."}],m=[{icon:e.createElement(ot,{className:"w-6 h-6 text-primary-600"}),title:"Push Notifications",description:"Stay updated on orders, deliveries, and fresh produce availability"},{icon:e.createElement(Me,{className:"w-6 h-6 text-primary-600"}),title:"Live Tracking",description:"Track your deliveries in real-time from farm to your doorstep"},{icon:e.createElement(oe,{className:"w-6 h-6 text-primary-600"}),title:"Quick Orders",description:"Reorder your favorites with just one tap"},{icon:e.createElement(Oe,{className:"w-6 h-6 text-primary-600"}),title:"Mobile Payments",description:"Secure M-Pesa integration for seamless transactions"}],u=[{role:"Admin",phone:"+254712345678",description:"Manage users, approve farmers, view analytics",icon:e.createElement(Be,{className:"w-5 h-5"}),color:"bg-red-100 text-red-800 border-red-200"},{role:"Farmer",phone:"+254734567890",description:"Create consignments, manage produce listings",icon:e.createElement(Ze,{className:"w-5 h-5"}),color:"bg-green-100 text-green-800 border-green-200"},{role:"Customer",phone:"+254756789012",description:"Browse marketplace, place orders, track deliveries",icon:e.createElement(Pe,{className:"w-5 h-5"}),color:"bg-blue-100 text-blue-800 border-blue-200"},{role:"Driver",phone:"+254778901234",description:"Manage deliveries, update delivery status",icon:e.createElement(ne,{className:"w-5 h-5"}),color:"bg-purple-100 text-purple-800 border-purple-200"}],p=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/marketplace"}};return e.createElement("div",{className:"min-h-screen bg-white"},e.createElement("section",{className:"bg-gradient-to-br from-primary-50 to-primary-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6"},"Welcome to ",e.createElement("span",{className:"text-primary-600"},"Zuasoko")),e.createElement("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto"},"Connecting farmers and customers across Kenya. Fresh produce, fair prices, and sustainable agriculture for everyone."),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8"},t?e.createElement(W,{to:p(),className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Go to Dashboard"):e.createElement(e.Fragment,null,e.createElement(W,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Browse Marketplace"),e.createElement(W,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold border-2 border-primary-600 hover:bg-primary-50 transition-colors"},"Join Now"))),!t&&e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("button",{onClick:()=>s(!r),className:"flex items-center justify-center gap-2 mx-auto text-sm text-gray-600 hover:text-gray-800 transition-colors"},e.createElement(cn,{className:"w-4 h-4"}),e.createElement("span",null,"View Demo Credentials"),r?e.createElement(mn,{className:"w-4 h-4"}):e.createElement(dn,{className:"w-4 h-4"})),r&&e.createElement("div",{className:"mt-4 p-4 bg-white rounded-lg border border-gray-200 shadow-sm"},e.createElement("h3",{className:"text-sm font-semibold text-gray-900 mb-3 text-center"},"Demo Account Access"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},u.map((N,y)=>e.createElement("div",{key:y,className:`p-3 rounded-lg border ${N.color} text-xs`},e.createElement("div",{className:"flex items-center gap-2 mb-1"},N.icon,e.createElement("span",{className:"font-semibold"},N.role)),e.createElement("div",{className:"font-mono text-xs mb-1"},N.phone),e.createElement("div",{className:"text-xs opacity-80"},N.description)))),e.createElement("div",{className:"text-center mt-3 text-xs text-gray-600"},"Password for all accounts:"," ",e.createElement("span",{className:"font-mono font-semibold"},"password123")),e.createElement("div",{className:"text-center mt-2"},e.createElement(W,{to:"/login",className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 font-medium"},e.createElement(Be,{className:"w-3 h-3"}),"Login to any demo account"))))))),e.createElement("section",{className:"py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center mb-16"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Why Choose Zuasoko?"),e.createElement("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto"},"We're revolutionizing agriculture in Kenya by creating direct connections between farmers and customers.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},d.map((N,y)=>e.createElement("div",{key:y,className:"text-center p-6 rounded-lg border border-gray-200 hover:shadow-lg transition-shadow"},e.createElement("div",{className:"flex justify-center mb-4"},N.icon),e.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2"},N.title),e.createElement("p",{className:"text-gray-600"},N.description)))))),e.createElement("section",{className:"bg-gradient-to-br from-gray-50 to-gray-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"},e.createElement("div",{className:"space-y-8"},e.createElement("div",{className:"text-center lg:text-left"},e.createElement("div",{className:"inline-flex items-center gap-2 bg-primary-100 text-primary-700 px-4 py-2 rounded-full text-sm font-medium mb-4"},e.createElement(Sa,{className:"w-4 h-4"}),"Now Available on Mobile"),e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Take Zuasoko"," ",e.createElement("span",{className:"text-primary-600"},"Anywhere")),e.createElement("p",{className:"text-xl text-gray-600 mb-8"},"Access fresh produce, manage your farm, or track deliveries on the go. Our mobile app brings the complete Zuasoko experience to your smartphone.")),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start"},e.createElement("button",{onClick:()=>{o?i():alert(`Android app coming soon! 🚀

We're putting the finishing touches on our mobile app. Stay tuned for the official release!`)},disabled:f,className:`group px-6 py-3 rounded-xl flex items-center gap-3 transition-all duration-300 transform hover:scale-105 shadow-lg ${o?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-900 hover:bg-gray-800 text-white"} ${f?"opacity-50 cursor-not-allowed":""}`},e.createElement("div",{className:"bg-white p-1 rounded"},f?e.createElement("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"}):e.createElement(un,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},o?"DOWNLOAD":"GET IT ON"),e.createElement("div",{className:"text-lg font-semibold"},o?"Direct APK":"Google Play"),o&&c&&e.createElement("div",{className:"text-xs text-gray-300"},"v",c.version," • ",c.size)),e.createElement(jt,{className:"w-4 h-4 ml-2 group-hover:animate-bounce"}),o&&e.createElement("div",{className:"bg-green-400 text-green-900 px-2 py-1 rounded text-xs font-bold ml-2"},"READY")),e.createElement("a",{href:"#",className:"group bg-gray-900 text-white px-6 py-3 rounded-xl flex items-center gap-3 hover:bg-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg opacity-60 cursor-not-allowed",onClick:N=>{N.preventDefault(),alert(`iOS app coming soon! 🍎

We're working hard to bring Zuasoko to the App Store. Keep an eye out for updates!`)}},e.createElement("div",{className:"bg-white p-1 rounded"},e.createElement(gn,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},"Download on the"),e.createElement("div",{className:"text-lg font-semibold"},"App Store")),e.createElement("div",{className:"bg-yellow-500 text-yellow-900 px-2 py-1 rounded text-xs font-bold ml-2"},"SOON"))),o&&c&&e.createElement("div",{className:"text-center mt-6"},e.createElement("button",{onClick:()=>l(!0),className:"text-primary-600 hover:text-primary-700 font-medium text-sm border border-primary-300 hover:border-primary-500 px-4 py-2 rounded-lg transition-colors"},"View App Details & Permissions")),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4"},m.map((N,y)=>e.createElement("div",{key:y,className:"flex items-start gap-3 p-4 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex-shrink-0 p-2 bg-primary-50 rounded-lg"},N.icon),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},N.title),e.createElement("p",{className:"text-sm text-gray-600"},N.description)))))),e.createElement("div",{className:"relative"},e.createElement("div",{className:"relative mx-auto w-64 h-96 lg:w-80 lg:h-[480px]"},e.createElement("div",{className:"absolute inset-0 bg-gray-900 rounded-[2.5rem] shadow-2xl"},e.createElement("div",{className:"absolute inset-2 bg-white rounded-[2rem] overflow-hidden"},e.createElement("div",{className:"bg-primary-600 h-8 flex items-center justify-between px-4"},e.createElement("div",{className:"text-white text-xs font-medium"},"9:41"),e.createElement("div",{className:"flex items-center gap-1"},e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}))),e.createElement("div",{className:"p-4 space-y-4"},e.createElement("div",{className:"flex items-center gap-3 mb-6"},e.createElement("div",{className:"w-10 h-10 bg-primary-600 rounded-xl flex items-center justify-center"},e.createElement(Ze,{className:"w-6 h-6 text-white"})),e.createElement("div",null,e.createElement("div",{className:"font-bold text-gray-900"},"Zuasoko"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from farm"))),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-green-200 rounded-lg flex items-center justify-center"},e.createElement(Ze,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Organic Tomatoes"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from Nakuru"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 120/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-orange-200 rounded-lg flex items-center justify-center"},e.createElement(Ze,{className:"w-6 h-6 text-orange-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Fresh Carrots"),e.createElement("div",{className:"text-xs text-gray-500"},"Direct from farm"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 80/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-purple-200 rounded-lg flex items-center justify-center"},e.createElement(Ze,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Spinach Bunch"),e.createElement("div",{className:"text-xs text-gray-500"},"Locally grown"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 50/bunch")))),e.createElement("div",{className:"absolute bottom-4 left-4 right-4 bg-white border border-gray-200 rounded-lg p-2"},e.createElement("div",{className:"flex justify-around"},e.createElement("div",{className:"p-2 bg-primary-600 rounded-lg"},e.createElement(Ze,{className:"w-4 h-4 text-white"})),e.createElement("div",{className:"p-2"},e.createElement(Me,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(ot,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(Pe,{className:"w-4 h-4 text-gray-400"})))))))),e.createElement("div",{className:"mt-8 text-center"},e.createElement("div",{className:"inline-block p-4 bg-white rounded-xl shadow-lg border border-gray-200"},e.createElement("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center mb-3"},e.createElement(fn,{className:"w-12 h-12 text-gray-600"})),e.createElement("div",{className:"text-sm font-medium text-gray-900 mb-1"},"Scan to Download"),e.createElement("div",{className:"text-xs text-gray-500"},"Coming Soon"))),e.createElement("div",{className:"absolute -top-4 -left-4 w-8 h-8 bg-primary-200 rounded-full animate-pulse"}),e.createElement("div",{className:"absolute -bottom-8 -right-8 w-12 h-12 bg-green-200 rounded-full animate-pulse delay-300"}),e.createElement("div",{className:"absolute top-1/2 -right-6 w-6 h-6 bg-yellow-200 rounded-full animate-pulse delay-700"}))))),t&&a?.role==="ADMIN"&&e.createElement("section",{className:"bg-red-50 py-12"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"inline-flex items-center gap-2 mb-4"},e.createElement(Be,{className:"w-6 h-6 text-red-600"}),e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Admin Dashboard")),e.createElement("p",{className:"text-gray-600 mb-6"},"Welcome back, Administrator. Manage your platform efficiently."),e.createElement("div",{className:"flex flex-wrap justify-center gap-4"},e.createElement(W,{to:"/admin/dashboard",className:"bg-red-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors"},"View Dashboard"),e.createElement(W,{to:"/admin/users",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"Manage Users"),e.createElement(W,{to:"/admin/analytics",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"View Analytics"))))),e.createElement("section",{className:"bg-primary-600 py-16"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4"},"Ready to Get Started?"),e.createElement("p",{className:"text-xl text-primary-100 mb-8 max-w-2xl mx-auto"},"Join thousands of farmers and customers who are already part of the Zuasoko community."),!t&&e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},e.createElement(W,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-colors"},"Register Now"),e.createElement(W,{to:"/login",className:"bg-transparent text-white px-8 py-3 rounded-lg text-lg font-semibold border-2 border-white hover:bg-white hover:text-primary-600 transition-colors"},"Login")))),n&&c&&e.createElement(hc,{isOpen:n,onClose:()=>l(!1),appInfo:c,onDownload:i}))}const Ec="/api",Ie=$.create({baseURL:Ec,timeout:15e3,headers:{"Content-Type":"application/json"}});Ie.interceptors.request.use(t=>{const a=localStorage.getItem("authToken");return a&&(t.headers.Authorization=`Bearer ${a}`),t});Ie.interceptors.response.use(t=>t,t=>(console.error("API Error:",t.response?.data||t.message),Promise.reject(t)));const bt={login:async t=>(await Ie.post("/auth/login",t)).data,register:async t=>(await Ie.post("/auth/register",t)).data,getProducts:async t=>{const a=t?`/marketplace/products?${t}`:"/products";return(await Ie.get(a)).data},getProduct:async t=>(await Ie.get(`/marketplace/products/${t}`)).data,getCategories:async()=>(await Ie.get("/marketplace/categories")).data,getCounties:async()=>(await Ie.get("/marketplace/counties")).data,getHealth:async()=>(await Ie.get("/status")).data,get:async t=>await Ie.get(t),post:async(t,a)=>await Ie.post(t,a)};function bc(){const[t,a]=S.useState([]),[r,s]=S.useState([]),[n,l]=S.useState([]),[o,c]=S.useState(!0),[f,i]=S.useState({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1}),[d,m]=S.useState(!1),[u,p]=S.useState({page:1,limit:12,total:0,totalPages:0}),{addToCart:N,isLoading:y}=yt(),{user:h,isAuthenticated:E}=ae(),b=async(w=1)=>{try{c(!0),console.log("🔍 FETCHING PRODUCTS - Page:",w,"Filters:",f);const I=new URLSearchParams({page:w.toString(),limit:u.limit.toString(),...f.category&&{category:f.category},...f.county&&{county:f.county},...f.search&&{search:f.search},...f.minPrice&&{minPrice:f.minPrice},...f.maxPrice&&{maxPrice:f.maxPrice},...f.featured&&{featured:"true"}}),g=await bt.getProducts(I);console.log("🔍 PRODUCTS RESPONSE:",g);const T=g.products||g||[];a(Array.isArray(T)?T:[]),g.pagination?p(_=>({..._,...g.pagination,page:w})):p(_=>({..._,page:w,total:g.products?.length||g.length||0,totalPages:1}))}catch(I){console.error("❌ FAILED TO FETCH PRODUCTS:",I),P.error("Failed to load products - using demo data"),a([]),p(g=>({...g,page:w,total:0,totalPages:1}))}finally{c(!1)}},A=async()=>{try{console.log("🔍 FETCHING METADATA from real database");const[w,I]=await Promise.all([bt.getCategories(),bt.getCounties()]);console.log("🔍 CATEGORIES RESPONSE:",w),console.log("🔍 COUNTIES RESPONSE:",I),s(w.categories||w||[]),l(I.counties||I||[])}catch(w){console.error("❌ FAILED TO FETCH METADATA:",w),P.error("Failed to load categories and counties from database")}};S.useEffect(()=>{A()},[]),S.useEffect(()=>{b(1)},[f]);const v=(w,I)=>{i(g=>({...g,[w]:I}))},O=w=>{try{N(w,1),P.success(`Added ${w.name} to cart`)}catch(I){console.error("Failed to add to cart:",I),P.error("Failed to add item to cart")}},R=()=>{i({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1})},M=w=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(w);return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Fresh Marketplace"),e.createElement("p",{className:"text-gray-600"},"Discover fresh produce directly from local farmers")),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:space-x-4 space-y-4 lg:space-y-0"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(Yt,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.createElement("input",{type:"text",placeholder:"Search products...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.search,onChange:w=>v("search",w.target.value)}))),e.createElement("div",{className:"flex flex-wrap gap-2"},e.createElement("button",{onClick:()=>v("featured",!f.featured),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f.featured?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},e.createElement(kt,{className:`w-4 h-4 inline mr-1 ${f.featured?"fill-current":""}`}),"Featured"),e.createElement("button",{onClick:()=>m(!d),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm font-medium transition-colors"},e.createElement(pn,{className:"w-4 h-4 inline mr-1"}),"Filters"))),d&&e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.category,onChange:w=>v("category",w.target.value)},e.createElement("option",{value:""},"All Categories"),r.map(w=>e.createElement("option",{key:w,value:w},w)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.county,onChange:w=>v("county",w.target.value)},e.createElement("option",{value:""},"All Counties"),n.map(w=>e.createElement("option",{key:w,value:w},w)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Min Price (KES)"),e.createElement("input",{type:"number",placeholder:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.minPrice,onChange:w=>v("minPrice",w.target.value)})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Max Price (KES)"),e.createElement("input",{type:"number",placeholder:"1000",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.maxPrice,onChange:w=>v("maxPrice",w.target.value)}))),e.createElement("div",{className:"mt-4 flex justify-end"},e.createElement("button",{onClick:R,className:"text-gray-600 hover:text-gray-900 text-sm font-medium"},"Clear All Filters")))),e.createElement("div",{className:"flex justify-between items-center mb-6"},e.createElement("p",{className:"text-gray-600"},o?"Loading...":`Showing ${t.length} of ${u.total} products`),u.totalPages>1&&e.createElement("div",{className:"text-sm text-gray-600"},"Page ",u.page," of ",u.totalPages)),o?e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},[...Array(8)].map((w,I)=>e.createElement("div",{key:I,className:"bg-white rounded-lg shadow-sm border overflow-hidden animate-pulse"},e.createElement("div",{className:"h-48 bg-gray-200"}),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-6 bg-gray-200 rounded"}))))):t.length===0?e.createElement("div",{className:"text-center py-16"},e.createElement("div",{className:"text-gray-400 text-6xl mb-4"},"🛒"),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-6"},"Try adjusting your search or filter criteria"),e.createElement("button",{onClick:R,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Clear Filters")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Array.isArray(t)&&t.map(w=>e.createElement("div",{key:w.id,className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"relative h-48 bg-gray-200"},w.images&&w.images.length>0?e.createElement("img",{src:w.images[0],alt:w.name,className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src="/api/placeholder/300/200?text="+encodeURIComponent(w.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement(ze,{className:"w-8 h-8 mx-auto mb-2"}),e.createElement("span",{className:"text-sm"},w.name))),(w.isFeatured||w.is_featured)&&e.createElement("div",{className:"absolute top-2 left-2 bg-yellow-400 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},"⭐ Featured"),(w.stockQuantity||w.stock_quantity)<10&&(w.stockQuantity||w.stock_quantity)>0&&e.createElement("div",{className:"absolute top-2 right-2 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium"},"Low Stock"),(w.stockQuantity||w.stock_quantity)===0&&e.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},e.createElement("span",{className:"text-white font-medium"},"Out of Stock"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 text-sm line-clamp-2"},w.name),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors ml-2"},e.createElement(Ua,{className:"w-4 h-4"}))),e.createElement("p",{className:"text-gray-600 text-xs mb-2 line-clamp-2"},w.description),e.createElement("div",{className:"flex items-center text-xs text-gray-500 mb-3"},e.createElement(Me,{className:"w-3 h-3 mr-1"}),e.createElement("span",null,w.farmer?.county||w.farmer_county||"Unknown"),e.createElement("span",{className:"mx-2"},"•"),e.createElement("span",null,w.farmer?.user?.firstName||w.farmer_name||"Farmer"," ",w.farmer?.user?.lastName||"")),w.tags&&w.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},w.tags.slice(0,3).map(I=>e.createElement("span",{key:I,className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs"},I))),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("div",{className:"text-lg font-bold text-gray-900"},M(w.pricePerUnit||w.price_per_unit)),e.createElement("div",{className:"text-xs text-gray-500"},"per ",w.unit)),e.createElement("div",{className:"flex space-x-2"},e.createElement(W,{to:`/marketplace/product/${w.id}`,className:"bg-gray-100 text-gray-700 px-2 py-2 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium flex items-center"},e.createElement(ze,{className:"w-4 h-4"})),(w.stockQuantity||w.stock_quantity)>0?e.createElement("button",{onClick:()=>O(w),disabled:y,className:"bg-primary-600 text-white px-3 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors text-sm font-medium flex items-center space-x-1"},e.createElement(Ke,{className:"w-4 h-4"}),e.createElement("span",null,"Add to Cart")):e.createElement("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-3 py-2 rounded-lg text-sm font-medium flex items-center space-x-1 cursor-not-allowed"},e.createElement("span",null,"Out of Stock")))))))),u.totalPages>1&&e.createElement("div",{className:"mt-8 flex justify-center"},e.createElement("div",{className:"flex space-x-1"},e.createElement("button",{onClick:()=>b(u.page-1),disabled:u.page===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Previous"),[...Array(Math.min(5,u.totalPages))].map((w,I)=>{const g=Math.max(1,u.page-2)+I;return g>u.totalPages?null:e.createElement("button",{key:g,onClick:()=>b(g),className:`px-3 py-2 text-sm font-medium border rounded-md ${g===u.page?"bg-primary-600 text-white border-primary-600":"text-gray-500 bg-white border-gray-300 hover:bg-gray-50"}`},g)}),e.createElement("button",{onClick:()=>b(u.page+1),disabled:u.page===u.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Next"))))}function Nc(){const{id:t}=sn(),a=He(),[r,s]=S.useState(null),[n,l]=S.useState([]),[o,c]=S.useState(!0),[f,i]=S.useState(0),[d,m]=S.useState(1),[u,p]=S.useState(!1),{addToCart:N,isLoading:y}=yt(),{user:h,isAuthenticated:E}=ae();S.useEffect(()=>{t&&b()},[t]);const b=async()=>{try{c(!0);const g=await $.get(`/api/marketplace/products/${t}`),T=g.data.product||g.data;s(T),T&&A(T.category,T.farmer.county)}catch(g){console.error("Failed to fetch product:",g),g.response?.status===404?(P.error("Product not found"),a("/marketplace")):P.error("Failed to load product details")}finally{c(!1)}},A=async(g,T)=>{try{const _=await $.get(`/api/marketplace/products?category=${g}&county=${T}&limit=4`),U=_.data.products||_.data;l(U.filter(B=>B.id!==t))}catch(_){console.error("Failed to fetch related products:",_)}},v=async()=>{if(!E){P.error("Please login to add items to cart");return}if(h?.role!=="CUSTOMER"){P.error("Only customers can add items to cart");return}if(r)try{await N(r.id,d),m(1)}catch{}},O=async()=>{if(navigator.share)try{await navigator.share({title:r?.name,text:r?.description,url:window.location.href})}catch(g){console.log("Error sharing:",g)}else navigator.clipboard.writeText(window.location.href),P.success("Link copied to clipboard!")},R=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g),M=g=>new Date(g).toLocaleDateString("en-KE",{year:"numeric",month:"long",day:"numeric"}),w=()=>r?r.stockQuantity===0?{text:"Out of Stock",color:"text-red-600",bgColor:"bg-red-100"}:r.stockQuantity<=(r.minStockLevel||5)?{text:"Low Stock",color:"text-orange-600",bgColor:"bg-orange-100"}:{text:"In Stock",color:"text-green-600",bgColor:"bg-green-100"}:null;if(o)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-3/4"}),e.createElement("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.createElement("div",{className:"h-12 bg-gray-200 rounded w-1/3"}),e.createElement("div",{className:"h-32 bg-gray-200 rounded"})))));if(!r)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Product not found"),e.createElement(W,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 mt-4 inline-block"},"Back to Marketplace")));const I=w();return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-8"},e.createElement(W,{to:"/marketplace",className:"hover:text-gray-900"},"Marketplace"),e.createElement("span",null,"/"),e.createElement("span",{className:"text-gray-900"},r.name)),e.createElement("button",{onClick:()=>a(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6"},e.createElement(wt,{className:"w-4 h-4 mr-2"}),"Back"),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12"},e.createElement("div",null,e.createElement("div",{className:"aspect-square bg-gray-200 rounded-lg overflow-hidden mb-4"},r.images&&r.images.length>0?e.createElement("img",{src:r.images[f]||r.images[0],alt:r.name,className:"w-full h-full object-cover",onError:g=>{g.currentTarget.src="/api/placeholder/400/400?text="+encodeURIComponent(r.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-4xl mb-2"},"📦"),e.createElement("span",null,r.name)))),r.images&&r.images.length>1&&e.createElement("div",{className:"grid grid-cols-4 gap-2"},r.images.slice(0,4).map((g,T)=>e.createElement("button",{key:T,onClick:()=>i(T),className:`aspect-square bg-gray-200 rounded-lg overflow-hidden border-2 ${f===T?"border-primary-600":"border-transparent"}`},e.createElement("img",{src:g,alt:`${r.name} ${T+1}`,className:"w-full h-full object-cover",onError:_=>{_.currentTarget.src="/api/placeholder/100/100?text="+(T+1)}}))))),e.createElement("div",null,e.createElement("div",{className:"flex items-start justify-between mb-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},r.name),e.createElement("p",{className:"text-gray-600"},r.category)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:O,className:"p-2 text-gray-400 hover:text-gray-600 border border-gray-300 rounded-lg"},e.createElement(yn,{className:"w-5 h-5"})),e.createElement("button",{className:"p-2 text-gray-400 hover:text-red-500 border border-gray-300 rounded-lg"},e.createElement(Ua,{className:"w-5 h-5"})))),e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"text-3xl font-bold text-gray-900 mb-2"},R(r.pricePerUnit),e.createElement("span",{className:"text-lg font-normal text-gray-600 ml-2"},"per ",r.unit)),I&&e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${I.bgColor} ${I.color}`},I.text),e.createElement("span",{className:"text-gray-600 text-sm"},r.stockQuantity," ",r.unit," available"))),e.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},r.isFeatured&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium"},"⭐ Featured"),r.tags.map(g=>e.createElement("span",{key:g,className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm"},g))),e.createElement("div",{className:"mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Description"),e.createElement("p",{className:"text-gray-700 leading-relaxed"},r.description)),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg"},r.harvestDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Harvest Date"),e.createElement("p",{className:"text-gray-900"},M(r.harvestDate))),r.expiryDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Best Before"),e.createElement("p",{className:"text-gray-900"},M(r.expiryDate))),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Category"),e.createElement("p",{className:"text-gray-900"},r.category)),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Unit"),e.createElement("p",{className:"text-gray-900"},r.unit))),E&&h?.role==="CUSTOMER"&&r.stockQuantity>0&&e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"flex items-center space-x-4 mb-4"},e.createElement("label",{className:"text-sm font-medium text-gray-700"},"Quantity:"),e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>m(Math.max(1,d-1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"-"),e.createElement("input",{type:"number",min:"1",max:r.stockQuantity,value:d,onChange:g=>m(Math.max(1,parseInt(g.target.value)||1)),className:"w-16 px-2 py-2 text-center border-0 focus:ring-0"}),e.createElement("button",{onClick:()=>m(Math.min(r.stockQuantity,d+1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"+")),e.createElement("span",{className:"text-sm text-gray-600"},"Total: ",R(r.pricePerUnit*d))),e.createElement("button",{onClick:v,disabled:y,className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors font-medium flex items-center justify-center"},e.createElement(Ke,{className:"w-5 h-5 mr-2"}),"Add to Cart")),e.createElement("div",{className:"border-t border-gray-200 pt-6"},e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(ne,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Free delivery over KES 1000")),e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Delivered within 24h")),e.createElement("div",{className:"flex items-center"},e.createElement(Be,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Quality guaranteed")))))),e.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"About the Farmer"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("div",{className:"flex items-center mb-3"},e.createElement("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mr-4"},e.createElement("span",{className:"text-primary-600 font-semibold text-lg"},r.farmer.user.firstName[0],r.farmer.user.lastName[0])),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900"},r.farmer.user.firstName," ",r.farmer.user.lastName),r.farmer.farmName&&e.createElement("p",{className:"text-gray-600 text-sm"},r.farmer.farmName))),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(Me,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},r.farmer.subCounty?`${r.farmer.subCounty}, `:"",r.farmer.county)),r.farmer.farmSize&&e.createElement("div",null,e.createElement("span",{className:"text-gray-600"},"Farm Size: ",r.farmer.farmSize," acres")))),e.createElement("div",null,e.createElement("button",{onClick:()=>p(!u),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium mb-4"},"Contact Farmer"),u&&e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(Qe,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`tel:${r.farmer.user.phone}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.phone)),r.farmer.user.email&&e.createElement("div",{className:"flex items-center"},e.createElement(Xt,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`mailto:${r.farmer.user.email}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.email)))))),n.length>0&&e.createElement("div",null,e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-6"},"Related Products"),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},n.map(g=>e.createElement(W,{key:g.id,to:`/marketplace/product/${g.id}`,className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"aspect-square bg-gray-200"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:T=>{T.currentTarget.src="/api/placeholder/200/200?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},"📦")),e.createElement("div",{className:"p-4"},e.createElement("h4",{className:"font-semibold text-gray-900 text-sm mb-1 line-clamp-2"},g.name),e.createElement("p",{className:"text-xs text-gray-600 mb-2"},g.farmer.county," •"," ",g.farmer.user.firstName," ",g.farmer.user.lastName),e.createElement("div",{className:"text-lg font-bold text-gray-900"},R(g.pricePerUnit),e.createElement("span",{className:"text-xs font-normal text-gray-600 ml-1"},"/",g.unit))))))))}function vc(){const[t,a]=S.useState({phone:"",password:""}),[r,s]=S.useState(!1),{login:n,isLoading:l}=ae(),o=He(),f=Gr().state?.from?.pathname||"/",i=async m=>{m.preventDefault();try{const u=t.phone.trim(),p=t.password.trim();console.log("🔍 LoginPage - About to call login with:",{phone:u,password:p,formData:t}),await n(u,p),P.success("Login successful!");const{user:N}=ae.getState();N?.role==="ADMIN"?o("/admin/dashboard",{replace:!0}):N?.role==="FARMER"?o("/farmer/dashboard",{replace:!0}):N?.role==="CUSTOMER"?o("/customer/dashboard",{replace:!0}):N?.role==="DRIVER"?o("/driver/dashboard",{replace:!0}):o(f,{replace:!0})}catch(u){P.error(u.message||"Login failed")}},d=m=>{a({...t,[m.target.name]:m.target.value})};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Sign in to your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(W,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500"},"create a new account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("form",{className:"space-y-6",onSubmit:i},e.createElement("div",null,e.createElement("label",{htmlFor:"phone",className:"form-label"},"Phone Number"),e.createElement("input",{id:"phone",name:"phone",type:"tel",required:!0,placeholder:"e.g., +254712345678 or 0712345678",className:"form-input",value:t.phone,onChange:d})),e.createElement("div",null,e.createElement("label",{htmlFor:"password",className:"form-label"},"Password"),e.createElement("div",{className:"relative"},e.createElement("input",{id:"password",name:"password",type:r?"text":"password",required:!0,className:"form-input pr-10",value:t.password,onChange:d}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!r)},r?e.createElement(Ut,{className:"h-5 w-5 text-gray-400"}):e.createElement(ze,{className:"h-5 w-5 text-gray-400"})))),e.createElement("div",null,e.createElement("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},l?"Signing in...":"Sign in"))),e.createElement("div",{className:"mt-6"},e.createElement("button",{type:"button",onClick:()=>{a({phone:"+254712345678",password:"password123"}),i({preventDefault:()=>{}})},className:"w-full mb-4 bg-green-600 text-white py-2 px-4 rounded-md text-sm font-medium hover:bg-green-700"},"🧪 Test Admin Login (+254712345678 / password123)"),e.createElement("div",{className:"relative"},e.createElement("div",{className:"absolute inset-0 flex items-center"},e.createElement("div",{className:"w-full border-t border-gray-300"})),e.createElement("div",{className:"relative flex justify-center text-sm"},e.createElement("span",{className:"px-2 bg-white text-gray-500"},"Demo Accounts"))),e.createElement("div",{className:"mt-4 space-y-2 text-xs text-gray-600"},e.createElement("p",null,e.createElement("strong",null,"Admin:")," +254712345678 / password123"),e.createElement("p",null,e.createElement("strong",null,"Farmer:")," +254734567890 / password123"),e.createElement("p",null,e.createElement("strong",null,"Customer:")," +254756789012 / password123"),e.createElement("p",null,e.createElement("strong",null,"Driver:")," +254778901234 / password123"))))))}var Rt=t=>t.type==="checkbox",nt=t=>t instanceof Date,Ne=t=>t==null;const Us=t=>typeof t=="object";var le=t=>!Ne(t)&&!Array.isArray(t)&&Us(t)&&!nt(t),wc=t=>le(t)&&t.target?Rt(t.target)?t.target.checked:t.target.value:t,Sc=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Cc=(t,a)=>t.has(Sc(a)),kc=t=>{const a=t.constructor&&t.constructor.prototype;return le(a)&&a.hasOwnProperty("isPrototypeOf")},za=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ye(t){let a;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)a=new Date(t);else if(!(za&&(t instanceof Blob||s))&&(r||le(t)))if(a=r?[]:{},!r&&!kc(t))a=t;else for(const n in t)t.hasOwnProperty(n)&&(a[n]=ye(t[n]));else return t;return a}var da=t=>/^\w*$/.test(t),me=t=>t===void 0,Ha=t=>Array.isArray(t)?t.filter(Boolean):[],Wa=t=>Ha(t.replace(/["|']|\]/g,"").split(/\.|\[/)),V=(t,a,r)=>{if(!a||!le(t))return r;const s=(da(a)?[a]:Wa(a)).reduce((n,l)=>Ne(n)?n:n[l],t);return me(s)||s===t?me(t[a])?r:t[a]:s},qe=t=>typeof t=="boolean",re=(t,a,r)=>{let s=-1;const n=da(a)?[a]:Wa(a),l=n.length,o=l-1;for(;++s<l;){const c=n[s];let f=r;if(s!==o){const i=t[c];f=le(i)||Array.isArray(i)?i:isNaN(+n[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=f,t=t[c]}};const Or={BLUR:"blur",FOCUS_OUT:"focusout"},_e={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},We={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Ac=e.createContext(null);Ac.displayName="HookFormContext";var Pc=(t,a,r,s=!0)=>{const n={defaultValues:a._defaultValues};for(const l in t)Object.defineProperty(n,l,{get:()=>{const o=l;return a._proxyFormState[o]!==_e.all&&(a._proxyFormState[o]=!s||_e.all),t[o]}});return n};const Dc=typeof window<"u"?S.useLayoutEffect:S.useEffect;var Ve=t=>typeof t=="string",Rc=(t,a,r,s,n)=>Ve(t)?(s&&a.watch.add(t),V(r,t,n)):Array.isArray(t)?t.map(l=>(s&&a.watch.add(l),V(r,l))):(s&&(a.watchAll=!0),r),Fc=(t,a,r,s,n)=>a?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:n||!0}}:{},Nt=t=>Array.isArray(t)?t:[t],Tr=()=>{let t=[];return{get observers(){return t},next:n=>{for(const l of t)l.next&&l.next(n)},subscribe:n=>(t.push(n),{unsubscribe:()=>{t=t.filter(l=>l!==n)}}),unsubscribe:()=>{t=[]}}},La=t=>Ne(t)||!Us(t);function et(t,a,r=new WeakSet){if(La(t)||La(a))return t===a;if(nt(t)&&nt(a))return t.getTime()===a.getTime();const s=Object.keys(t),n=Object.keys(a);if(s.length!==n.length)return!1;if(r.has(t)||r.has(a))return!0;r.add(t),r.add(a);for(const l of s){const o=t[l];if(!n.includes(l))return!1;if(l!=="ref"){const c=a[l];if(nt(o)&&nt(c)||le(o)&&le(c)||Array.isArray(o)&&Array.isArray(c)?!et(o,c,r):o!==c)return!1}}return!0}var Se=t=>le(t)&&!Object.keys(t).length,Qa=t=>t.type==="file",Le=t=>typeof t=="function",Wt=t=>{if(!za)return!1;const a=t?t.ownerDocument:0;return t instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},qs=t=>t.type==="select-multiple",Ja=t=>t.type==="radio",Oc=t=>Ja(t)||Rt(t),wa=t=>Wt(t)&&t.isConnected;function Tc(t,a){const r=a.slice(0,-1).length;let s=0;for(;s<r;)t=me(t)?s++:t[a[s++]];return t}function Ic(t){for(const a in t)if(t.hasOwnProperty(a)&&!me(t[a]))return!1;return!0}function ie(t,a){const r=Array.isArray(a)?a:da(a)?[a]:Wa(a),s=r.length===1?t:Tc(t,r),n=r.length-1,l=r[n];return s&&delete s[l],n!==0&&(le(s)&&Se(s)||Array.isArray(s)&&Ic(s))&&ie(t,r.slice(0,-1)),t}var $s=t=>{for(const a in t)if(Le(t[a]))return!0;return!1};function Qt(t,a={}){const r=Array.isArray(t);if(le(t)||r)for(const s in t)Array.isArray(t[s])||le(t[s])&&!$s(t[s])?(a[s]=Array.isArray(t[s])?[]:{},Qt(t[s],a[s])):Ne(t[s])||(a[s]=!0);return a}function Vs(t,a,r){const s=Array.isArray(t);if(le(t)||s)for(const n in t)Array.isArray(t[n])||le(t[n])&&!$s(t[n])?me(a)||La(r[n])?r[n]=Array.isArray(t[n])?Qt(t[n],[]):{...Qt(t[n])}:Vs(t[n],Ne(a)?{}:a[n],r[n]):r[n]=!et(t[n],a[n]);return r}var xt=(t,a)=>Vs(t,a,Qt(a));const Ir={value:!1,isValid:!1},_r={value:!0,isValid:!0};var Ks=t=>{if(Array.isArray(t)){if(t.length>1){const a=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:a,isValid:!!a.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!me(t[0].attributes.value)?me(t[0].value)||t[0].value===""?_r:{value:t[0].value,isValid:!0}:_r:Ir}return Ir},Bs=(t,{valueAsNumber:a,valueAsDate:r,setValueAs:s})=>me(t)?t:a?t===""?NaN:t&&+t:r&&Ve(t)?new Date(t):s?s(t):t;const Lr={isValid:!1,value:null};var Gs=t=>Array.isArray(t)?t.reduce((a,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:a,Lr):Lr;function Mr(t){const a=t.ref;return Qa(a)?a.files:Ja(a)?Gs(t.refs).value:qs(a)?[...a.selectedOptions].map(({value:r})=>r):Rt(a)?Ks(t.refs).value:Bs(me(a.value)?t.ref.value:a.value,t)}var _c=(t,a,r,s)=>{const n={};for(const l of t){const o=V(a,l);o&&re(n,l,o._f)}return{criteriaMode:r,names:[...t],fields:n,shouldUseNativeValidation:s}},Jt=t=>t instanceof RegExp,Et=t=>me(t)?t:Jt(t)?t.source:le(t)?Jt(t.value)?t.value.source:t.value:t,jr=t=>({isOnSubmit:!t||t===_e.onSubmit,isOnBlur:t===_e.onBlur,isOnChange:t===_e.onChange,isOnAll:t===_e.all,isOnTouch:t===_e.onTouched});const Ur="AsyncFunction";var Lc=t=>!!t&&!!t.validate&&!!(Le(t.validate)&&t.validate.constructor.name===Ur||le(t.validate)&&Object.values(t.validate).find(a=>a.constructor.name===Ur)),Mc=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),qr=(t,a,r)=>!r&&(a.watchAll||a.watch.has(t)||[...a.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const vt=(t,a,r,s)=>{for(const n of r||Object.keys(t)){const l=V(t,n);if(l){const{_f:o,...c}=l;if(o){if(o.refs&&o.refs[0]&&a(o.refs[0],n)&&!s)return!0;if(o.ref&&a(o.ref,o.name)&&!s)return!0;if(vt(c,a))break}else if(le(c)&&vt(c,a))break}}};function $r(t,a,r){const s=V(t,r);if(s||da(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const l=n.join("."),o=V(a,l),c=V(t,l);if(o&&!Array.isArray(o)&&r!==l)return{name:r};if(c&&c.type)return{name:l,error:c};if(c&&c.root&&c.root.type)return{name:`${l}.root`,error:c.root};n.pop()}return{name:r}}var jc=(t,a,r,s)=>{r(t);const{name:n,...l}=t;return Se(l)||Object.keys(l).length>=Object.keys(a).length||Object.keys(l).find(o=>a[o]===(!s||_e.all))},Uc=(t,a,r)=>!t||!a||t===a||Nt(t).some(s=>s&&(r?s===a:s.startsWith(a)||a.startsWith(s))),qc=(t,a,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(a||t):(r?s.isOnBlur:n.isOnBlur)?!t:(r?s.isOnChange:n.isOnChange)?t:!0,$c=(t,a)=>!Ha(V(t,a)).length&&ie(t,a),Vc=(t,a,r)=>{const s=Nt(V(t,r));return re(s,"root",a[r]),re(t,r,s),t},Mt=t=>Ve(t);function Vr(t,a,r="validate"){if(Mt(t)||Array.isArray(t)&&t.every(Mt)||qe(t)&&!t)return{type:r,message:Mt(t)?t:"",ref:a}}var dt=t=>le(t)&&!Jt(t)?t:{value:t,message:""},Kr=async(t,a,r,s,n,l)=>{const{ref:o,refs:c,required:f,maxLength:i,minLength:d,min:m,max:u,pattern:p,validate:N,name:y,valueAsNumber:h,mount:E}=t._f,b=V(r,y);if(!E||a.has(y))return{};const A=c?c[0]:o,v=_=>{n&&A.reportValidity&&(A.setCustomValidity(qe(_)?"":_||""),A.reportValidity())},O={},R=Ja(o),M=Rt(o),w=R||M,I=(h||Qa(o))&&me(o.value)&&me(b)||Wt(o)&&o.value===""||b===""||Array.isArray(b)&&!b.length,g=Fc.bind(null,y,s,O),T=(_,U,B,Q=We.maxLength,J=We.minLength)=>{const ce=_?U:B;O[y]={type:_?Q:J,message:ce,ref:o,...g(_?Q:J,ce)}};if(l?!Array.isArray(b)||!b.length:f&&(!w&&(I||Ne(b))||qe(b)&&!b||M&&!Ks(c).isValid||R&&!Gs(c).isValid)){const{value:_,message:U}=Mt(f)?{value:!!f,message:f}:dt(f);if(_&&(O[y]={type:We.required,message:U,ref:A,...g(We.required,U)},!s))return v(U),O}if(!I&&(!Ne(m)||!Ne(u))){let _,U;const B=dt(u),Q=dt(m);if(!Ne(b)&&!isNaN(b)){const J=o.valueAsNumber||b&&+b;Ne(B.value)||(_=J>B.value),Ne(Q.value)||(U=J<Q.value)}else{const J=o.valueAsDate||new Date(b),ce=he=>new Date(new Date().toDateString()+" "+he),ge=o.type=="time",fe=o.type=="week";Ve(B.value)&&b&&(_=ge?ce(b)>ce(B.value):fe?b>B.value:J>new Date(B.value)),Ve(Q.value)&&b&&(U=ge?ce(b)<ce(Q.value):fe?b<Q.value:J<new Date(Q.value))}if((_||U)&&(T(!!_,B.message,Q.message,We.max,We.min),!s))return v(O[y].message),O}if((i||d)&&!I&&(Ve(b)||l&&Array.isArray(b))){const _=dt(i),U=dt(d),B=!Ne(_.value)&&b.length>+_.value,Q=!Ne(U.value)&&b.length<+U.value;if((B||Q)&&(T(B,_.message,U.message),!s))return v(O[y].message),O}if(p&&!I&&Ve(b)){const{value:_,message:U}=dt(p);if(Jt(_)&&!b.match(_)&&(O[y]={type:We.pattern,message:U,ref:o,...g(We.pattern,U)},!s))return v(U),O}if(N){if(Le(N)){const _=await N(b,r),U=Vr(_,A);if(U&&(O[y]={...U,...g(We.validate,U.message)},!s))return v(U.message),O}else if(le(N)){let _={};for(const U in N){if(!Se(_)&&!s)break;const B=Vr(await N[U](b,r),A,U);B&&(_={...B,...g(U,B.message)},v(B.message),s&&(O[y]=_))}if(!Se(_)&&(O[y]={ref:A,..._},!s))return O}}return v(!0),O};const Kc={mode:_e.onSubmit,reValidateMode:_e.onChange,shouldFocusError:!0};function Bc(t={}){let a={...Kc,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Le(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},s={},n=le(a.defaultValues)||le(a.values)?ye(a.defaultValues||a.values)||{}:{},l=a.shouldUnregister?{}:ye(n),o={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,i=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let m={...d};const u={array:Tr(),state:Tr()},p=a.criteriaMode===_e.all,N=x=>C=>{clearTimeout(i),i=setTimeout(x,C)},y=async x=>{if(!a.disabled&&(d.isValid||m.isValid||x)){const C=a.resolver?Se((await M()).errors):await I(s,!0);C!==r.isValid&&u.state.next({isValid:C})}},h=(x,C)=>{!a.disabled&&(d.isValidating||d.validatingFields||m.isValidating||m.validatingFields)&&((x||Array.from(c.mount)).forEach(F=>{F&&(C?re(r.validatingFields,F,C):ie(r.validatingFields,F))}),u.state.next({validatingFields:r.validatingFields,isValidating:!Se(r.validatingFields)}))},E=(x,C=[],F,q,j=!0,L=!0)=>{if(q&&F&&!a.disabled){if(o.action=!0,L&&Array.isArray(V(s,x))){const K=F(V(s,x),q.argA,q.argB);j&&re(s,x,K)}if(L&&Array.isArray(V(r.errors,x))){const K=F(V(r.errors,x),q.argA,q.argB);j&&re(r.errors,x,K),$c(r.errors,x)}if((d.touchedFields||m.touchedFields)&&L&&Array.isArray(V(r.touchedFields,x))){const K=F(V(r.touchedFields,x),q.argA,q.argB);j&&re(r.touchedFields,x,K)}(d.dirtyFields||m.dirtyFields)&&(r.dirtyFields=xt(n,l)),u.state.next({name:x,isDirty:T(x,C),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else re(l,x,C)},b=(x,C)=>{re(r.errors,x,C),u.state.next({errors:r.errors})},A=x=>{r.errors=x,u.state.next({errors:r.errors,isValid:!1})},v=(x,C,F,q)=>{const j=V(s,x);if(j){const L=V(l,x,me(F)?V(n,x):F);me(L)||q&&q.defaultChecked||C?re(l,x,C?L:Mr(j._f)):B(x,L),o.mount&&y()}},O=(x,C,F,q,j)=>{let L=!1,K=!1;const Y={name:x};if(!a.disabled){if(!F||q){(d.isDirty||m.isDirty)&&(K=r.isDirty,r.isDirty=Y.isDirty=T(),L=K!==Y.isDirty);const ee=et(V(n,x),C);K=!!V(r.dirtyFields,x),ee?ie(r.dirtyFields,x):re(r.dirtyFields,x,!0),Y.dirtyFields=r.dirtyFields,L=L||(d.dirtyFields||m.dirtyFields)&&K!==!ee}if(F){const ee=V(r.touchedFields,x);ee||(re(r.touchedFields,x,F),Y.touchedFields=r.touchedFields,L=L||(d.touchedFields||m.touchedFields)&&ee!==F)}L&&j&&u.state.next(Y)}return L?Y:{}},R=(x,C,F,q)=>{const j=V(r.errors,x),L=(d.isValid||m.isValid)&&qe(C)&&r.isValid!==C;if(a.delayError&&F?(f=N(()=>b(x,F)),f(a.delayError)):(clearTimeout(i),f=null,F?re(r.errors,x,F):ie(r.errors,x)),(F?!et(j,F):j)||!Se(q)||L){const K={...q,...L&&qe(C)?{isValid:C}:{},errors:r.errors,name:x};r={...r,...K},u.state.next(K)}},M=async x=>{h(x,!0);const C=await a.resolver(l,a.context,_c(x||c.mount,s,a.criteriaMode,a.shouldUseNativeValidation));return h(x),C},w=async x=>{const{errors:C}=await M(x);if(x)for(const F of x){const q=V(C,F);q?re(r.errors,F,q):ie(r.errors,F)}else r.errors=C;return C},I=async(x,C,F={valid:!0})=>{for(const q in x){const j=x[q];if(j){const{_f:L,...K}=j;if(L){const Y=c.array.has(L.name),ee=j._f&&Lc(j._f);ee&&d.validatingFields&&h([q],!0);const Re=await Kr(j,c.disabled,l,p,a.shouldUseNativeValidation&&!C,Y);if(ee&&d.validatingFields&&h([q]),Re[L.name]&&(F.valid=!1,C))break;!C&&(V(Re,L.name)?Y?Vc(r.errors,Re,L.name):re(r.errors,L.name,Re[L.name]):ie(r.errors,L.name))}!Se(K)&&await I(K,C,F)}}return F.valid},g=()=>{for(const x of c.unMount){const C=V(s,x);C&&(C._f.refs?C._f.refs.every(F=>!wa(F)):!wa(C._f.ref))&&Z(x)}c.unMount=new Set},T=(x,C)=>!a.disabled&&(x&&C&&re(l,x,C),!et(he(),n)),_=(x,C,F)=>Rc(x,c,{...o.mount?l:me(C)?n:Ve(x)?{[x]:C}:C},F,C),U=x=>Ha(V(o.mount?l:n,x,a.shouldUnregister?V(n,x,[]):[])),B=(x,C,F={})=>{const q=V(s,x);let j=C;if(q){const L=q._f;L&&(!L.disabled&&re(l,x,Bs(C,L)),j=Wt(L.ref)&&Ne(C)?"":C,qs(L.ref)?[...L.ref.options].forEach(K=>K.selected=j.includes(K.value)):L.refs?Rt(L.ref)?L.refs.forEach(K=>{(!K.defaultChecked||!K.disabled)&&(Array.isArray(j)?K.checked=!!j.find(Y=>Y===K.value):K.checked=j===K.value||!!j)}):L.refs.forEach(K=>K.checked=K.value===j):Qa(L.ref)?L.ref.value="":(L.ref.value=j,L.ref.type||u.state.next({name:x,values:ye(l)})))}(F.shouldDirty||F.shouldTouch)&&O(x,j,F.shouldTouch,F.shouldDirty,!0),F.shouldValidate&&fe(x)},Q=(x,C,F)=>{for(const q in C){if(!C.hasOwnProperty(q))return;const j=C[q],L=x+"."+q,K=V(s,L);(c.array.has(x)||le(j)||K&&!K._f)&&!nt(j)?Q(L,j,F):B(L,j,F)}},J=(x,C,F={})=>{const q=V(s,x),j=c.array.has(x),L=ye(C);re(l,x,L),j?(u.array.next({name:x,values:ye(l)}),(d.isDirty||d.dirtyFields||m.isDirty||m.dirtyFields)&&F.shouldDirty&&u.state.next({name:x,dirtyFields:xt(n,l),isDirty:T(x,L)})):q&&!q._f&&!Ne(L)?Q(x,L,F):B(x,L,F),qr(x,c)&&u.state.next({...r}),u.state.next({name:o.mount?x:void 0,values:ye(l)})},ce=async x=>{o.mount=!0;const C=x.target;let F=C.name,q=!0;const j=V(s,F),L=ee=>{q=Number.isNaN(ee)||nt(ee)&&isNaN(ee.getTime())||et(ee,V(l,F,ee))},K=jr(a.mode),Y=jr(a.reValidateMode);if(j){let ee,Re;const Ft=C.type?Mr(j._f):wc(x),Je=x.type===Or.BLUR||x.type===Or.FOCUS_OUT,Ys=!Mc(j._f)&&!a.resolver&&!V(r.errors,F)&&!j._f.deps||qc(Je,V(r.touchedFields,F),r.isSubmitted,Y,K),fa=qr(F,c,Je);re(l,F,Ft),Je?(j._f.onBlur&&j._f.onBlur(x),f&&f(0)):j._f.onChange&&j._f.onChange(x);const pa=O(F,Ft,Je),Xs=!Se(pa)||fa;if(!Je&&u.state.next({name:F,type:x.type,values:ye(l)}),Ys)return(d.isValid||m.isValid)&&(a.mode==="onBlur"?Je&&y():Je||y()),Xs&&u.state.next({name:F,...fa?{}:pa});if(!Je&&fa&&u.state.next({...r}),a.resolver){const{errors:tr}=await M([F]);if(L(Ft),q){const en=$r(r.errors,s,F),ar=$r(tr,s,en.name||F);ee=ar.error,F=ar.name,Re=Se(tr)}}else h([F],!0),ee=(await Kr(j,c.disabled,l,p,a.shouldUseNativeValidation))[F],h([F]),L(Ft),q&&(ee?Re=!1:(d.isValid||m.isValid)&&(Re=await I(s,!0)));q&&(j._f.deps&&fe(j._f.deps),R(F,Re,ee,pa))}},ge=(x,C)=>{if(V(r.errors,C)&&x.focus)return x.focus(),1},fe=async(x,C={})=>{let F,q;const j=Nt(x);if(a.resolver){const L=await w(me(x)?x:j);F=Se(L),q=x?!j.some(K=>V(L,K)):F}else x?(q=(await Promise.all(j.map(async L=>{const K=V(s,L);return await I(K&&K._f?{[L]:K}:K)}))).every(Boolean),!(!q&&!r.isValid)&&y()):q=F=await I(s);return u.state.next({...!Ve(x)||(d.isValid||m.isValid)&&F!==r.isValid?{}:{name:x},...a.resolver||!x?{isValid:F}:{},errors:r.errors}),C.shouldFocus&&!q&&vt(s,ge,x?j:c.mount),q},he=x=>{const C={...o.mount?l:n};return me(x)?C:Ve(x)?V(C,x):x.map(F=>V(C,F))},Te=(x,C)=>({invalid:!!V((C||r).errors,x),isDirty:!!V((C||r).dirtyFields,x),error:V((C||r).errors,x),isValidating:!!V(r.validatingFields,x),isTouched:!!V((C||r).touchedFields,x)}),ve=x=>{x&&Nt(x).forEach(C=>ie(r.errors,C)),u.state.next({errors:x?r.errors:{}})},at=(x,C,F)=>{const q=(V(s,x,{_f:{}})._f||{}).ref,j=V(r.errors,x)||{},{ref:L,message:K,type:Y,...ee}=j;re(r.errors,x,{...ee,...C,ref:q}),u.state.next({name:x,errors:r.errors,isValid:!1}),F&&F.shouldFocus&&q&&q.focus&&q.focus()},ua=(x,C)=>Le(x)?u.state.subscribe({next:F=>x(_(void 0,C),F)}):_(x,C,!0),D=x=>u.state.subscribe({next:C=>{Uc(x.name,C.name,x.exact)&&jc(C,x.formState||d,Zs,x.reRenderRoot)&&x.callback({values:{...l},...r,...C})}}).unsubscribe,G=x=>(o.mount=!0,m={...m,...x.formState},D({...x,formState:m})),Z=(x,C={})=>{for(const F of x?Nt(x):c.mount)c.mount.delete(F),c.array.delete(F),C.keepValue||(ie(s,F),ie(l,F)),!C.keepError&&ie(r.errors,F),!C.keepDirty&&ie(r.dirtyFields,F),!C.keepTouched&&ie(r.touchedFields,F),!C.keepIsValidating&&ie(r.validatingFields,F),!a.shouldUnregister&&!C.keepDefaultValue&&ie(n,F);u.state.next({values:ye(l)}),u.state.next({...r,...C.keepDirty?{isDirty:T()}:{}}),!C.keepIsValid&&y()},de=({disabled:x,name:C})=>{(qe(x)&&o.mount||x||c.disabled.has(C))&&(x?c.disabled.add(C):c.disabled.delete(C))},pe=(x,C={})=>{let F=V(s,x);const q=qe(C.disabled)||qe(a.disabled);return re(s,x,{...F||{},_f:{...F&&F._f?F._f:{ref:{name:x}},name:x,mount:!0,...C}}),c.mount.add(x),F?de({disabled:qe(C.disabled)?C.disabled:a.disabled,name:x}):v(x,!0,C.value),{...q?{disabled:C.disabled||a.disabled}:{},...a.progressive?{required:!!C.required,min:Et(C.min),max:Et(C.max),minLength:Et(C.minLength),maxLength:Et(C.maxLength),pattern:Et(C.pattern)}:{},name:x,onChange:ce,onBlur:ce,ref:j=>{if(j){pe(x,C),F=V(s,x);const L=me(j.value)&&j.querySelectorAll&&j.querySelectorAll("input,select,textarea")[0]||j,K=Oc(L),Y=F._f.refs||[];if(K?Y.find(ee=>ee===L):L===F._f.ref)return;re(s,x,{_f:{...F._f,...K?{refs:[...Y.filter(wa),L,...Array.isArray(V(n,x))?[{}]:[]],ref:{type:L.type,name:x}}:{ref:L}}}),v(x,!1,void 0,L)}else F=V(s,x,{}),F._f&&(F._f.mount=!1),(a.shouldUnregister||C.shouldUnregister)&&!(Cc(c.array,x)&&o.action)&&c.unMount.add(x)}}},ga=()=>a.shouldFocusError&&vt(s,ge,c.mount),Ws=x=>{qe(x)&&(u.state.next({disabled:x}),vt(s,(C,F)=>{const q=V(s,F);q&&(C.disabled=q._f.disabled||x,Array.isArray(q._f.refs)&&q._f.refs.forEach(j=>{j.disabled=q._f.disabled||x}))},0,!1))},Za=(x,C)=>async F=>{let q;F&&(F.preventDefault&&F.preventDefault(),F.persist&&F.persist());let j=ye(l);if(u.state.next({isSubmitting:!0}),a.resolver){const{errors:L,values:K}=await M();r.errors=L,j=ye(K)}else await I(s);if(c.disabled.size)for(const L of c.disabled)ie(j,L);if(ie(r.errors,"root"),Se(r.errors)){u.state.next({errors:{}});try{await x(j,F)}catch(L){q=L}}else C&&await C({...r.errors},F),ga(),setTimeout(ga);if(u.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Se(r.errors)&&!q,submitCount:r.submitCount+1,errors:r.errors}),q)throw q},Qs=(x,C={})=>{V(s,x)&&(me(C.defaultValue)?J(x,ye(V(n,x))):(J(x,C.defaultValue),re(n,x,ye(C.defaultValue))),C.keepTouched||ie(r.touchedFields,x),C.keepDirty||(ie(r.dirtyFields,x),r.isDirty=C.defaultValue?T(x,ye(V(n,x))):T()),C.keepError||(ie(r.errors,x),d.isValid&&y()),u.state.next({...r}))},Ya=(x,C={})=>{const F=x?ye(x):n,q=ye(F),j=Se(x),L=j?n:q;if(C.keepDefaultValues||(n=F),!C.keepValues){if(C.keepDirtyValues){const K=new Set([...c.mount,...Object.keys(xt(n,l))]);for(const Y of Array.from(K))V(r.dirtyFields,Y)?re(L,Y,V(l,Y)):J(Y,V(L,Y))}else{if(za&&me(x))for(const K of c.mount){const Y=V(s,K);if(Y&&Y._f){const ee=Array.isArray(Y._f.refs)?Y._f.refs[0]:Y._f.ref;if(Wt(ee)){const Re=ee.closest("form");if(Re){Re.reset();break}}}}if(C.keepFieldsRef)for(const K of c.mount)J(K,V(L,K));else s={}}l=a.shouldUnregister?C.keepDefaultValues?ye(n):{}:ye(L),u.array.next({values:{...L}}),u.state.next({values:{...L}})}c={mount:C.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!C.keepIsValid||!!C.keepDirtyValues,o.watch=!!a.shouldUnregister,u.state.next({submitCount:C.keepSubmitCount?r.submitCount:0,isDirty:j?!1:C.keepDirty?r.isDirty:!!(C.keepDefaultValues&&!et(x,n)),isSubmitted:C.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:j?{}:C.keepDirtyValues?C.keepDefaultValues&&l?xt(n,l):r.dirtyFields:C.keepDefaultValues&&x?xt(n,x):C.keepDirty?r.dirtyFields:{},touchedFields:C.keepTouched?r.touchedFields:{},errors:C.keepErrors?r.errors:{},isSubmitSuccessful:C.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1})},Xa=(x,C)=>Ya(Le(x)?x(l):x,C),Js=(x,C={})=>{const F=V(s,x),q=F&&F._f;if(q){const j=q.refs?q.refs[0]:q.ref;j.focus&&(j.focus(),C.shouldSelect&&Le(j.select)&&j.select())}},Zs=x=>{r={...r,...x}},er={control:{register:pe,unregister:Z,getFieldState:Te,handleSubmit:Za,setError:at,_subscribe:D,_runSchema:M,_focusError:ga,_getWatch:_,_getDirty:T,_setValid:y,_setFieldArray:E,_setDisabledField:de,_setErrors:A,_getFieldArray:U,_reset:Ya,_resetDefaultValues:()=>Le(a.defaultValues)&&a.defaultValues().then(x=>{Xa(x,a.resetOptions),u.state.next({isLoading:!1})}),_removeUnmounted:g,_disableForm:Ws,_subjects:u,_proxyFormState:d,get _fields(){return s},get _formValues(){return l},get _state(){return o},set _state(x){o=x},get _defaultValues(){return n},get _names(){return c},set _names(x){c=x},get _formState(){return r},get _options(){return a},set _options(x){a={...a,...x}}},subscribe:G,trigger:fe,register:pe,handleSubmit:Za,watch:ua,setValue:J,getValues:he,reset:Xa,resetField:Qs,clearErrors:ve,unregister:Z,setError:at,setFocus:Js,getFieldState:Te};return{...er,formControl:er}}function zs(t={}){const a=e.useRef(void 0),r=e.useRef(void 0),[s,n]=e.useState({isDirty:!1,isValidating:!1,isLoading:Le(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Le(t.defaultValues)?void 0:t.defaultValues});if(!a.current)if(t.formControl)a.current={...t.formControl,formState:s},t.defaultValues&&!Le(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...c}=Bc(t);a.current={...c,formState:s}}const l=a.current.control;return l._options=t,Dc(()=>{const o=l._subscribe({formState:l._proxyFormState,callback:()=>n({...l._formState}),reRenderRoot:!0});return n(c=>({...c,isReady:!0})),l._formState.isReady=!0,o},[l]),e.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),e.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),e.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),e.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),e.useEffect(()=>{if(l._proxyFormState.isDirty){const o=l._getDirty();o!==s.isDirty&&l._subjects.state.next({isDirty:o})}},[l,s.isDirty]),e.useEffect(()=>{t.values&&!et(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),r.current=t.values,n(o=>({...o}))):l._resetDefaultValues()},[l,t.values]),e.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),a.current.formState=Pc(s,l),a.current}const Br=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"],Gc=["Motorcycle","Three-wheeler","Pickup Truck","Van","Small Truck","Large Truck"],zc=[{value:"CUSTOMER",label:"Customer",description:"Shop for fresh produce from local farmers",icon:e.createElement(Fe,{className:"w-8 h-8"}),color:"bg-blue-500"},{value:"FARMER",label:"Farmer",description:"Sell your produce directly to customers",icon:e.createElement(Ze,{className:"w-8 h-8"}),color:"bg-green-500"},{value:"DRIVER",label:"Driver",description:"Deliver products and earn money",icon:e.createElement(ne,{className:"w-8 h-8"}),color:"bg-orange-500"},{value:"FARMER_AGENT",label:"Farmer Agent",description:"Help farmers join the platform",icon:e.createElement(Pe,{className:"w-8 h-8"}),color:"bg-purple-500"}];function Hc(){const t=He(),[a,r]=S.useState(1),[s,n]=S.useState(!1),[l,o]=S.useState(!1),[c,f]=S.useState(!1),{register:i,handleSubmit:d,watch:m,setValue:u,formState:{errors:p}}=zs(),N=m("role"),y=m("password"),h=async v=>{if(v.password!==v.confirmPassword){P.error("Passwords do not match");return}f(!0);try{const O={firstName:v.firstName,lastName:v.lastName,phone:v.phone,email:v.email,password:v.password,role:v.role,county:v.county};v.role==="FARMER"?(v.farmName&&(O.farmName=v.farmName),v.farmSize&&(O.farmSize=v.farmSize),v.kraPin&&(O.kraPin=v.kraPin),v.subCounty&&(O.subCounty=v.subCounty)):v.role==="DRIVER"?(O.licenseNumber=v.licenseNumber,O.vehicleType=v.vehicleType,O.vehicleRegNo=v.vehicleRegNo,O.idNumber=v.idNumber):v.role==="FARMER_AGENT"&&(O.assignedCounty=v.assignedCounty);const R=await $.post("/api/auth/register",O);P.success("Registration successful! Please login to continue."),R.data.requiresPayment&&P("You will need to pay the activation fee after login",{icon:"ℹ️"}),R.data.requiresApproval&&P("Your application will be reviewed by our team",{icon:"ℹ️"}),t("/login")}catch(O){console.error("Registration error:",O);const R=O.response?.data?.error||"Registration failed";P.error(R)}finally{f(!1)}},E=()=>{a<3&&r(a+1)},b=()=>{a>1&&r(a-1)},A=v=>{u("role",v),E()};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Create your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(W,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500"},"sign in to your existing account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex items-center justify-between"},[1,2,3].map(v=>e.createElement("div",{key:v,className:`flex items-center ${a>=v?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${a>=v?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},a>v?e.createElement(qt,{className:"w-4 h-4"}):v),v<3&&e.createElement("div",{className:`w-16 h-0.5 mx-2 ${a>v?"bg-primary-600":"bg-gray-200"}`})))),e.createElement("div",{className:"flex justify-between mt-2 text-xs text-gray-600"},e.createElement("span",null,"Role"),e.createElement("span",null,"Info"),e.createElement("span",null,"Details"))),e.createElement("form",{onSubmit:d(h)},a===1&&e.createElement("div",{className:"space-y-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Choose your role"),e.createElement("div",{className:"space-y-3"},zc.map(v=>e.createElement("button",{key:v.value,type:"button",onClick:()=>A(v.value),className:"w-full p-4 border border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-left"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${v.color} text-white p-2 rounded-lg mr-4`},v.icon),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},v.label),e.createElement("p",{className:"text-sm text-gray-600"},v.description))))))),a===2&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:b,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(wt,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Basic Information")),e.createElement("div",{className:"grid grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...i("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...i("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.lastName.message))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...i("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678 or 0712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...i("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.email.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...i("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Br.map(v=>e.createElement("option",{key:v,value:v},v))),p.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...i("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:s?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!s)},s?e.createElement(Ut,{className:"h-5 w-5 text-gray-400"}):e.createElement(ze,{className:"h-5 w-5 text-gray-400"}))),p.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.password.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirm Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...i("confirmPassword",{required:"Please confirm your password",validate:v=>v===y||"Passwords do not match"}),type:l?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>o(!l)},l?e.createElement(Ut,{className:"h-5 w-5 text-gray-400"}):e.createElement(ze,{className:"h-5 w-5 text-gray-400"}))),p.confirmPassword&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.confirmPassword.message)),e.createElement("button",{type:"button",onClick:E,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center justify-center"},"Next",e.createElement(qa,{className:"w-5 h-5 ml-2"}))),a===3&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:b,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(wt,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},N==="FARMER"&&"Farm Details",N==="DRIVER"&&"Driver Information",N==="FARMER_AGENT"&&"Agent Information",N==="CUSTOMER"&&"Almost Done!")),N==="FARMER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Name"),e.createElement("input",{...i("farmName"),placeholder:"e.g., Green Valley Farm",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County"),e.createElement("input",{...i("subCounty"),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Size (acres)"),e.createElement("input",{...i("farmSize"),type:"number",step:"0.1",placeholder:"e.g., 5.5",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"KRA PIN"),e.createElement("input",{...i("kraPin"),placeholder:"e.g., A123456789K",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Activation Fee Required"),e.createElement("div",{className:"mt-2 text-sm text-yellow-700"},e.createElement("p",null,"Farmers need to pay a one-time activation fee of KES 300 after registration.")))))),N==="DRIVER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Driving License Number *"),e.createElement("input",{...i("licenseNumber",{required:"License number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.licenseNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.licenseNumber.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Type *"),e.createElement("select",{...i("vehicleType",{required:"Vehicle type is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select Vehicle Type"),Gc.map(v=>e.createElement("option",{key:v,value:v},v))),p.vehicleType&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.vehicleType.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Registration Number *"),e.createElement("input",{...i("vehicleRegNo",{required:"Vehicle registration number is required for drivers"}),placeholder:"e.g., KCA 123X",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.vehicleRegNo&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.vehicleRegNo.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"National ID Number *"),e.createElement("input",{...i("idNumber",{required:"ID number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),p.idNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.idNumber.message)),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-blue-800"},"Approval Required"),e.createElement("div",{className:"mt-2 text-sm text-blue-700"},e.createElement("p",null,"Driver applications require verification and approval by our team.")))))),N==="FARMER_AGENT"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Assigned County *"),e.createElement("select",{...i("assignedCounty",{required:"Assigned county is required for agents"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Br.map(v=>e.createElement("option",{key:v,value:v},v))),p.assignedCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},p.assignedCounty.message)),e.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-purple-800"},"Agent Responsibilities"),e.createElement("div",{className:"mt-2 text-sm text-purple-700"},e.createElement("p",null,"As an agent, you'll help onboard farmers in your assigned county and earn commissions.")))))),N==="CUSTOMER"&&e.createElement("div",{className:"text-center py-8"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"You're all set!"),e.createElement("p",{className:"text-gray-600"},"Complete your registration to start shopping for fresh produce.")),e.createElement("button",{type:"submit",disabled:c,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},c?"Creating Account...":"Create Account"))))))}function Wc(){const{user:t}=ae(),[a,r]=S.useState(!1),[s,n]=S.useState("overview"),[l,o]=S.useState([]),[c,f]=S.useState(null),[i,d]=S.useState([]),[m,u]=S.useState(!0),[p,N]=S.useState({totalConsignments:0,pendingConsignments:0,completedConsignments:0,totalEarnings:0}),[y,h]=S.useState(!1),[E,b]=S.useState(""),[A,v]=S.useState(!1);S.useEffect(()=>{O()},[]);const O=async()=>{try{u(!0);const T=localStorage.getItem("token"),[_,U,B]=await Promise.all([$.get("/api/consignments",{headers:{Authorization:`Bearer ${T}`}}),$.get("/api/wallet",{headers:{Authorization:`Bearer ${T}`}}),$.get("/api/notifications",{headers:{Authorization:`Bearer ${T}`}})]),Q=Array.isArray(_.data.consignments)?_.data.consignments:[],J=U.data.wallet||U.data,ce=Array.isArray(B.data.notifications)?B.data.notifications:[];o(Q),f(J),d(ce);const ge=Q.length,fe=Q.filter(ve=>ve.status==="PENDING").length,he=Q.filter(ve=>ve.status==="COMPLETED").length,Te=(J.balance||0)+(Array.isArray(J.transactions)?J.transactions.filter(ve=>ve.type==="DEBIT").reduce((ve,at)=>ve+at.amount,0):0);N({totalConsignments:ge,pendingConsignments:fe,completedConsignments:he,totalEarnings:Te})}catch(T){console.error("Failed to fetch dashboard data:",T),P.error("Failed to load dashboard data")}finally{u(!1)}},R=async(T,_)=>{try{const U=localStorage.getItem("token"),B=await $.post("/api/wallet/withdraw",{amount:T,phoneNumber:_},{headers:{Authorization:`Bearer ${U}`}});P.success("Withdrawal initiated! Check your phone for M-Pesa prompt."),O()}catch(U){P.error(U.response?.data?.error||"Withdrawal failed")}},M=async()=>{if(!E.trim()){P.error("Please enter your phone number");return}if(!/^(\+254|254|0)[17]\d{8}$/.test(E.replace(/\s/g,""))){P.error("Please enter a valid Kenyan phone number");return}v(!0);try{const _=localStorage.getItem("token"),U=await $.post("/api/admin/registration-fees/stk-push",{farmer_id:t?.id,phone_number:E,amount:300},{headers:{Authorization:`Bearer ${_}`}});U.data.success?(P.success("Registration fee payment initiated! Check your phone for M-Pesa prompt."),h(!1),b("")):P.error(U.data.message||"Failed to initiate payment")}catch(_){console.error("Payment error:",_),P.error(_.response?.data?.message||"Failed to initiate payment. Please try again.")}finally{v(!1)}},w=[{id:"overview",label:"Overview",icon:Xe},{id:"consignments",label:"Consignments",icon:H},{id:"wallet",label:"Wallet",icon:ya},{id:"notifications",label:"Notifications",icon:ot},{id:"profile",label:"Profile",icon:ut}],I=T=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PRICE_SUGGESTED:"bg-blue-100 text-blue-800",DRIVER_ASSIGNED:"bg-indigo-100 text-indigo-800",IN_TRANSIT:"bg-purple-100 text-purple-800",DELIVERED:"bg-cyan-100 text-cyan-800",COMPLETED:"bg-green-100 text-green-800"})[T]||"bg-gray-100 text-gray-800",g=T=>{const U={PENDING:oe,APPROVED:se,REJECTED:Ae,PRICE_SUGGESTED:De,DRIVER_ASSIGNED:ne,IN_TRANSIT:ne,DELIVERED:se,COMPLETED:se}[T]||Ge;return e.createElement(U,{className:"w-4 h-4"})};return m?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50 flex"},e.createElement("div",{className:`${a?"translate-x-0":"-translate-x-full"} fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0`},e.createElement("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-800"},"Farmer Dashboard"),e.createElement("button",{onClick:()=>r(!1),className:"lg:hidden text-gray-500 hover:text-gray-700"},e.createElement(Ae,{className:"w-6 h-6"}))),e.createElement("nav",{className:"mt-6"},w.map(T=>{const _=T.icon;return e.createElement("button",{key:T.id,onClick:()=>{n(T.id),r(!1)},className:`w-full flex items-center px-6 py-3 text-left hover:bg-gray-50 transition-colors ${s===T.id?"bg-green-50 text-green-600 border-r-2 border-green-600":"text-gray-600"}`},e.createElement(_,{className:"w-5 h-5 mr-3"}),T.label)})),e.createElement("div",{className:"absolute bottom-0 left-0 right-0 p-6 border-t border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center text-white font-semibold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"text-sm font-medium text-gray-800"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-xs text-gray-500"},t?.county))))),e.createElement("div",{className:"flex-1 flex flex-col overflow-hidden"},e.createElement("div",{className:"bg-white shadow-sm border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between h-16 px-6"},e.createElement("div",{className:"flex items-center"},e.createElement("button",{onClick:()=>r(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 mr-3"},e.createElement(zr,{className:"w-6 h-6"})),e.createElement("h1",{className:"text-xl font-semibold text-gray-800 capitalize"},s)),!t?.registrationFeePaid&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg px-4 py-2"},e.createElement("div",{className:"flex items-center"},e.createElement(Ge,{className:"w-4 h-4 text-red-600 mr-2"}),e.createElement("span",{className:"text-sm text-red-800"},"Registration fee required"),e.createElement("button",{onClick:()=>h(!0),className:"ml-3 bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"},"Pay KES 300"))))),e.createElement("div",{className:"flex-1 overflow-auto p-6"},s==="overview"&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Consignments"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},p.totalConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},p.pendingConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(se,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},p.completedConsignments)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(ya,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Wallet Balance"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES ",c?.balance?.toLocaleString()||0))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>n("consignments"),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",disabled:!t?.registrationFeePaid},e.createElement(At,{className:"w-5 h-5 mr-2"}),"Submit Consignment"),e.createElement("button",{onClick:()=>n("wallet"),className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(ya,{className:"w-5 h-5 mr-2"}),"Manage Wallet"),e.createElement("button",{onClick:()=>n("consignments"),className:"flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(ze,{className:"w-5 h-5 mr-2"}),"View Consignments"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Consignments")),e.createElement("div",{className:"p-6"},(Array.isArray(l)?l:[]).slice(0,5).map(T=>e.createElement("div",{key:T.id,className:"flex items-center justify-between py-3 border-b border-gray-100 last:border-b-0"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:Array.isArray(T.images)&&T.images.length>0&&T.images[0]&&T.images[0].trim()!==""?T.images[0]:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop",alt:T.title,className:"w-12 h-12 rounded-lg object-cover",onError:_=>{const U=_.target;U.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop"}}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},T.title),e.createElement("p",{className:"text-sm text-gray-500"},T.quantity," ",T.unit))),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${I(T.status)}`},g(T.status),e.createElement("span",{className:"ml-1"},T.status.replace("_"," "))),e.createElement("span",{className:"text-sm font-medium text-gray-900"},"KES"," ",T.finalPricePerUnit||T.bidPricePerUnit,"/kg"))))))),s==="consignments"&&e.createElement(Qc,{consignments:l,onRefresh:O,canSubmit:t?.registrationFeePaid||!1,showPaymentModal:y,setShowPaymentModal:h}),s==="wallet"&&e.createElement(Jc,{wallet:c,onWithdraw:R,onRefresh:O}),s==="notifications"&&e.createElement(Zc,{notifications:i,onRefresh:O}),s==="profile"&&e.createElement(Yc,{user:t}))),y&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-sm w-full max-h-[80vh] flex flex-col"},e.createElement("div",{className:"px-4 py-3 border-b border-gray-200 flex-shrink-0"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center"},e.createElement(Oe,{className:"w-4 h-4 text-green-600"})),e.createElement("div",null,e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Pay Registration Fee"),e.createElement("p",{className:"text-xs text-gray-600"},"KES 300.00"))),e.createElement("button",{onClick:()=>{h(!1),b("")},className:"text-gray-400 hover:text-gray-600"},e.createElement(Ae,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex-1 overflow-y-auto px-4 py-4"},e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3"},e.createElement("div",{className:"flex items-start space-x-2"},e.createElement(Qe,{className:"w-4 h-4 text-blue-600 mt-0.5"}),e.createElement("div",null,e.createElement("h4",{className:"text-sm font-medium text-blue-800"},"M-Pesa Payment"),e.createElement("p",{className:"text-xs text-blue-700 mt-1"},"Enter your M-Pesa phone number for STK push.")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Phone Number *"),e.createElement("div",{className:"relative"},e.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},e.createElement(Qe,{className:"w-4 h-4 text-gray-400"})),e.createElement("input",{type:"tel",value:E,onChange:T=>b(T.target.value),placeholder:"+254712345678",className:"w-full pl-9 pr-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",disabled:A})),e.createElement("p",{className:"text-xs text-gray-600 mt-1"},"M-Pesa registered number")),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3"},e.createElement("h5",{className:"text-sm font-medium text-gray-900 mb-2"},"Payment Summary"),e.createElement("div",{className:"space-y-1 text-xs"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Registration Fee:"),e.createElement("span",{className:"font-medium"},"KES 300.00")),e.createElement("div",{className:"flex justify-between border-t border-gray-200 pt-1"},e.createElement("span",{className:"font-medium text-gray-900"},"Total:"),e.createElement("span",{className:"font-semibold text-green-600"},"KES 300.00")))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},e.createElement("p",{className:"text-xs text-yellow-800"},e.createElement("strong",null,"Note:")," After payment, you can submit consignments. STK push appears within 30 seconds.")))),e.createElement("div",{className:"px-4 py-3 border-t border-gray-200 flex-shrink-0"},e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:()=>{h(!1),b("")},disabled:A,className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50"},"Cancel"),e.createElement("button",{onClick:M,disabled:A||!E.trim(),className:"flex-1 bg-green-600 text-white px-3 py-2 text-sm rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-1"},A?e.createElement(e.Fragment,null,e.createElement("div",{className:"w-3 h-3 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.createElement("span",null,"Processing...")):e.createElement(e.Fragment,null,e.createElement(Oe,{className:"w-3 h-3"}),e.createElement("span",null,"Pay KES 300"))))))))}function Qc({consignments:t,onRefresh:a,canSubmit:r,showPaymentModal:s,setShowPaymentModal:n}){const[l,o]=S.useState(!1),[c,f]=S.useState({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[""]}),i=async u=>{if(u.preventDefault(),!r){P.error("Please pay the registration fee first");return}try{const p=localStorage.getItem("token");await $.post("/api/consignments",{...c,quantity:parseFloat(c.quantity),bidPricePerUnit:parseFloat(c.bidPricePerUnit)},{headers:{Authorization:`Bearer ${p}`}}),P.success("Consignment submitted successfully!"),o(!1),f({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[""]}),a()}catch(p){P.error(p.response?.data?.error||"Failed to submit consignment")}},d=u=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PRICE_SUGGESTED:"bg-blue-100 text-blue-800",DRIVER_ASSIGNED:"bg-indigo-100 text-indigo-800",IN_TRANSIT:"bg-purple-100 text-purple-800",DELIVERED:"bg-cyan-100 text-cyan-800",COMPLETED:"bg-green-100 text-green-800"})[u]||"bg-gray-100 text-gray-800",m=u=>{const N={PENDING:oe,APPROVED:se,REJECTED:Ae,PRICE_SUGGESTED:De,DRIVER_ASSIGNED:ne,IN_TRANSIT:ne,DELIVERED:se,COMPLETED:se}[u]||Ge;return e.createElement(N,{className:"w-4 h-4"})};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"My Consignments"),e.createElement("button",{onClick:()=>o(!0),disabled:!r,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center"},e.createElement(At,{className:"w-5 h-5 mr-2"}),"Submit New Consignment")),!r&&e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Ge,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-yellow-800"},"You must pay the KES 300 registration fee before submitting consignments.")),e.createElement("button",{onClick:()=>n(!0),className:"ml-3 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Pay Now"))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Submit New Consignment"),e.createElement("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(Ae,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:i,className:"p-6 space-y-4"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Title"),e.createElement("input",{type:"text",required:!0,value:c.title,onChange:u=>f(p=>({...p,title:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Fresh Tomatoes"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Category"),e.createElement("select",{value:c.category,onChange:u=>f(p=>({...p,category:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"Vegetables"},"Vegetables"),e.createElement("option",{value:"Fruits"},"Fruits"),e.createElement("option",{value:"Grains"},"Grains"),e.createElement("option",{value:"Legumes"},"Legumes"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Quantity"),e.createElement("input",{type:"number",required:!0,value:c.quantity,onChange:u=>f(p=>({...p,quantity:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Unit"),e.createElement("select",{value:c.unit,onChange:u=>f(p=>({...p,unit:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"kg"},"Kilograms (kg)"),e.createElement("option",{value:"tonnes"},"Tonnes"),e.createElement("option",{value:"bags"},"Bags"),e.createElement("option",{value:"pieces"},"Pieces"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Bid Price per Unit (KES)"),e.createElement("input",{type:"number",required:!0,value:c.bidPricePerUnit,onChange:u=>f(p=>({...p,bidPricePerUnit:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 80"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Location"),e.createElement("input",{type:"text",required:!0,value:c.location,onChange:u=>f(p=>({...p,location:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Nakuru"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Harvest Date"),e.createElement("input",{type:"date",required:!0,value:c.harvestDate,onChange:u=>f(p=>({...p,harvestDate:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Expiry Date"),e.createElement("input",{type:"date",required:!0,value:c.expiryDate,onChange:u=>f(p=>({...p,expiryDate:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Description"),e.createElement("textarea",{required:!0,value:c.description,onChange:u=>f(p=>({...p,description:u.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:3,placeholder:"Describe your produce quality, farming methods, etc."})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Image URL"),e.createElement("input",{type:"url",value:Array.isArray(c.images)&&c.images.length>0?c.images[0]:"",onChange:u=>f(p=>({...p,images:[u.target.value]})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"https://example.com/image.jpg"})),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300"},"Cancel"),e.createElement("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Submit Consignment"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"All Consignments (",(Array.isArray(t)?t:[]).length,")")),e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t)?t:[]).map(u=>e.createElement("div",{key:u.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:Array.isArray(u.images)&&u.images.length>0&&u.images[0]&&u.images[0].trim()!==""?u.images[0]:"https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop",alt:u.title,className:"w-16 h-16 rounded-lg object-cover",onError:p=>{const N=p.target;N.src="https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=400&fit=crop"}}),e.createElement("div",{className:"ml-4"},e.createElement("h4",{className:"text-lg font-medium text-gray-900"},u.title),e.createElement("p",{className:"text-sm text-gray-500"},u.description),e.createElement("div",{className:"flex items-center space-x-4 mt-2"},e.createElement("span",{className:"text-sm text-gray-600"},u.quantity," ",u.unit),e.createElement("span",{className:"text-sm text-gray-600"},"KES ",u.bidPricePerUnit,"/",u.unit),e.createElement("span",{className:"text-sm text-gray-600"},u.location)))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${d(u.status)}`},m(u.status),e.createElement("span",{className:"ml-1"},u.status.replace("_"," "))),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},new Date(u.createdAt).toLocaleDateString()))),u.adminNotes&&e.createElement("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg"},e.createElement("p",{className:"text-sm text-gray-700"},e.createElement("strong",null,"Admin Notes:")," ",u.adminNotes)))))))}function Jc({wallet:t,onWithdraw:a,onRefresh:r}){const[s,n]=S.useState(!1),[l,o]=S.useState(""),[c,f]=S.useState(""),i=async d=>{d.preventDefault();const m=parseFloat(l);if(m<10){P.error("Minimum withdrawal amount is KES 10");return}if(m>t.balance){P.error("Insufficient balance");return}await a(m,c),n(!1),o(""),f("")};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Wallet"),e.createElement("button",{onClick:()=>n(!0),disabled:!t?.balance||t.balance<10,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},"Withdraw Funds")),e.createElement("div",{className:"bg-gradient-to-r from-green-500 to-green-600 rounded-lg p-6 text-white"},e.createElement("h3",{className:"text-lg font-medium mb-2"},"Available Balance"),e.createElement("p",{className:"text-3xl font-bold"},"KES ",t?.balance?.toLocaleString()||0))),s&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Withdraw Funds"),e.createElement("button",{onClick:()=>n(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(Ae,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:i,className:"p-6 space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Amount (KES)"),e.createElement("input",{type:"number",min:"10",max:t?.balance||0,required:!0,value:l,onChange:d=>o(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter amount"}),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Minimum: KES 10 | Available: KES"," ",t?.balance?.toLocaleString()||0)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"M-Pesa Phone Number"),e.createElement("input",{type:"tel",required:!0,value:c,onChange:d=>f(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"+254712345678"})),e.createElement("div",{className:"flex justify-end space-x-3 pt-4"},e.createElement("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300"},"Cancel"),e.createElement("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"},"Withdraw"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Transaction History")),e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t?.transactions)?t.transactions:[]).map(d=>e.createElement("div",{key:d.id,className:"p-6 flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${d.type==="CREDIT"?"bg-green-100":"bg-red-100"}`},d.type==="CREDIT"?e.createElement(Xe,{className:"w-5 h-5 text-green-600"}):e.createElement(Xe,{className:"w-5 h-5 text-red-600 transform rotate-180"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},d.description),e.createElement("p",{className:"text-sm text-gray-500"},new Date(d.createdAt).toLocaleDateString()," at"," ",new Date(d.createdAt).toLocaleTimeString()))),e.createElement("div",{className:"text-right"},e.createElement("p",{className:`font-semibold ${d.type==="CREDIT"?"text-green-600":"text-red-600"}`},d.type==="CREDIT"?"+":"-","KES"," ",d.amount.toLocaleString())))),(!t?.transactions||t.transactions.length===0)&&e.createElement("div",{className:"p-6 text-center text-gray-500"},"No transactions yet"))))}function Zc({notifications:t,onRefresh:a}){const r=async s=>{try{const n=localStorage.getItem("token");await $.put(`/api/notifications/${s}/read`,{},{headers:{Authorization:`Bearer ${n}`}}),a()}catch(n){console.error("Failed to mark notification as read:",n),P.error("Failed to mark notification as read")}};return e.createElement("div",{className:"space-y-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Notifications"),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"divide-y divide-gray-200"},(Array.isArray(t)?t:[]).map(s=>e.createElement("div",{key:s.id,className:`p-6 ${s.isRead?"bg-white":"bg-blue-50"}`},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center"},e.createElement("h4",{className:"text-lg font-medium text-gray-900"},s.title),!s.isRead&&e.createElement("span",{className:"ml-2 w-2 h-2 bg-blue-600 rounded-full"})),e.createElement("p",{className:"text-gray-700 mt-1"},s.message),e.createElement("p",{className:"text-sm text-gray-500 mt-2"},new Date(s.createdAt).toLocaleDateString()," at"," ",new Date(s.createdAt).toLocaleTimeString())),!s.isRead&&e.createElement("button",{onClick:()=>r(s.id),className:"ml-4 text-blue-600 hover:text-blue-800 text-sm font-medium"},"Mark as read")))),(Array.isArray(t)?t:[]).length===0&&e.createElement("div",{className:"p-6 text-center text-gray-500"},"No notifications yet"))))}function Yc({user:t}){return e.createElement("div",{className:"space-y-6"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Profile"),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center text-white text-2xl font-bold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-gray-600"},t?.email),e.createElement("p",{className:"text-gray-600"},t?.phone))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Role"),e.createElement("p",{className:"text-gray-900 capitalize"},t?.role)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"County"),e.createElement("p",{className:"text-gray-900"},t?.county)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Registration Status"),e.createElement("div",{className:"flex items-center"},t?.registrationFeePaid?e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},e.createElement(se,{className:"w-4 h-4 mr-1"}),"Paid"):e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800"},e.createElement(Ge,{className:"w-4 h-4 mr-1"}),"Fee Required"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Verification Status"),e.createElement("div",{className:"flex items-center"},t?.verified?e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800"},e.createElement(se,{className:"w-4 h-4 mr-1"}),"Verified"):e.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},e.createElement(oe,{className:"w-4 h-4 mr-1"}),"Pending"))))))}function Xc(){const{user:t}=ae(),a=He(),[r,s]=S.useState([]),[n,l]=S.useState(!0),[o,c]=S.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0});S.useEffect(()=>{a("/customer/profile",{replace:!0})},[a]),S.useEffect(()=>{f()},[]);const f=async()=>{try{l(!0);const m=localStorage.getItem("token"),u=await $.get("/api/orders",{headers:{Authorization:`Bearer ${m}`}}),p=u.data.orders||u.data;s(p);const N=p.length,y=p.filter(b=>b.status==="DELIVERED").length,h=p.filter(b=>b.paymentStatus==="COMPLETED").reduce((b,A)=>b+A.totalAmount,0),E=p.filter(b=>b.status==="PENDING").length;c({totalOrders:N,completedOrders:y,totalSpent:h,pendingOrders:E})}catch(m){if(console.error("Failed to fetch orders:",m),m.response?.status===404){console.log("🛒 Using fallback demo orders (endpoint not found)");const u=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",deliveryPhone:"+254712345678",orderDate:new Date(Date.now()-864e5).toISOString(),estimatedDelivery:new Date(Date.now()-432e5).toISOString(),notes:"Please deliver in the morning",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_1",quantity:5,pricePerUnit:120,totalPrice:600,product:{id:"prod_1",name:"Organic Tomatoes",images:[]}}]},{id:"order_2",orderNumber:"ORD-2024-002",totalAmount:1800,paymentStatus:"PENDING",paymentMethod:"M-PESA",status:"PROCESSING",deliveryAddress:"456 Oak Avenue, Nakuru",deliveryPhone:"+254723456789",orderDate:new Date(Date.now()-36e5).toISOString(),estimatedDelivery:new Date(Date.now()+864e5).toISOString(),notes:"Call before delivery",createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_3",quantity:2,pricePerUnit:900,totalPrice:1800,product:{id:"prod_2",name:"Premium Maize",images:[]}}]}];s(u),c({totalOrders:2,completedOrders:1,totalSpent:2500,pendingOrders:1}),P.success("Using demo data - backend deployment needed")}else P.error("Failed to load orders")}finally{l(!1)}},i=m=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[m]||"bg-gray-100 text-gray-800",d=m=>{const p={PENDING:oe,CONFIRMED:H,PROCESSING:H,SHIPPED:ne,DELIVERED:H,CANCELLED:H}[m]||H;return e.createElement(p,{className:"w-4 h-4"})};return n?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your profile and view your order history")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(tt,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.totalOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.pendingOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.completedOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Oe,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES ",o.totalSpent.toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>a("/marketplace"),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(tt,{className:"w-5 h-5 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(H,{className:"w-5 h-5 mr-2"}),"View Orders"),e.createElement("button",{onClick:()=>a("/customer/profile"),className:"flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Fe,{className:"w-5 h-5 mr-2"}),"Edit Profile"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All"))),e.createElement("div",{className:"p-6"},r.slice(0,3).map(m=>e.createElement("div",{key:m.id,className:"flex items-center justify-between py-4 border-b border-gray-100 last:border-b-0"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},m.items[0]?.product?.images?.[0]?e.createElement("img",{src:m.items[0].product.images[0],alt:m.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(H,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},"Order #",m.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},m.items.length," item",m.items.length>1?"s":""," • KES"," ",m.totalAmount.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-500"},new Date(m.orderDate).toLocaleDateString()))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${i(m.status)}`},d(m.status),e.createElement("span",{className:"ml-1"},m.status)),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},m.paymentMethod)))),r.length===0&&e.createElement("div",{className:"text-center py-8"},e.createElement(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("p",{className:"text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>a("/marketplace"),className:"mt-3 text-blue-600 hover:text-blue-800 font-medium"},"Start Shopping"))))))}function ei(){const{user:t,updateUser:a}=ae(),r=He(),[s,n]=S.useState(!1),[l,o]=S.useState(!1),[c,f]=S.useState([]),[i,d]=S.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0}),[m,u]=S.useState({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""});S.useEffect(()=>{p()},[]);const p=async()=>{try{const E=localStorage.getItem("token"),b=await $.get("/api/orders",{headers:{Authorization:`Bearer ${E}`}}),A=b.data.orders||b.data;f(A);const v=A.length,O=A.filter(w=>w.status==="DELIVERED").length,R=A.filter(w=>w.paymentStatus==="COMPLETED").reduce((w,I)=>w+I.totalAmount,0),M=A.filter(w=>w.status==="PENDING").length;d({totalOrders:v,completedOrders:O,totalSpent:R,pendingOrders:M})}catch(E){if(console.error("Failed to fetch orders:",E),E.response?.status===404){console.log("🛒 Using fallback demo orders (endpoint not found)");const b=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",orderDate:new Date(Date.now()-864e5).toISOString(),createdAt:new Date(Date.now()-864e5).toISOString(),items:[{quantity:5,product:{name:"Organic Tomatoes",images:[]}}]}];f(b),d({totalOrders:1,completedOrders:1,totalSpent:2500,pendingOrders:0})}}},N=async()=>{try{o(!0);const E=localStorage.getItem("token"),b=await $.put("/api/profile",m,{headers:{Authorization:`Bearer ${E}`}});a(b.data.user),n(!1),P.success("Profile updated successfully!")}catch(E){P.error(E.response?.data?.error||"Failed to update profile")}finally{o(!1)}},y=()=>{u({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""}),n(!1)},h=E=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[E]||"bg-gray-100 text-gray-800";return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Profile"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your personal information and preferences")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Personal Information"),s?e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:N,disabled:l,className:"flex items-center text-green-600 hover:text-green-800 disabled:opacity-50"},e.createElement($a,{className:"w-4 h-4 mr-1"}),"Save"),e.createElement("button",{onClick:y,className:"flex items-center text-red-600 hover:text-red-800"},e.createElement(Ae,{className:"w-4 h-4 mr-1"}),"Cancel")):e.createElement("button",{onClick:()=>n(!0),className:"flex items-center text-blue-600 hover:text-blue-800"},e.createElement(hn,{className:"w-4 h-4 mr-1"}),"Edit"))),e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center text-white text-2xl font-bold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-gray-600"},t?.role),e.createElement("div",{className:"flex items-center mt-1"},e.createElement(Be,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm text-green-600"},"Verified Account")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Fe,{className:"w-4 h-4 inline mr-1"}),"First Name"),s?e.createElement("input",{type:"text",value:m.firstName,onChange:E=>u(b=>({...b,firstName:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.firstName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Fe,{className:"w-4 h-4 inline mr-1"}),"Last Name"),s?e.createElement("input",{type:"text",value:m.lastName,onChange:E=>u(b=>({...b,lastName:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.lastName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Xt,{className:"w-4 h-4 inline mr-1"}),"Email Address"),s?e.createElement("input",{type:"email",value:m.email,onChange:E=>u(b=>({...b,email:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.email)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Qe,{className:"w-4 h-4 inline mr-1"}),"Phone Number"),e.createElement("p",{className:"text-gray-900 py-2"},t?.phone),e.createElement("p",{className:"text-sm text-gray-500"},"Phone number cannot be changed")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Me,{className:"w-4 h-4 inline mr-1"}),"County"),s?e.createElement("select",{value:m.county,onChange:E=>u(b=>({...b,county:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select County"),e.createElement("option",{value:"Nairobi"},"Nairobi"),e.createElement("option",{value:"Kiambu"},"Kiambu"),e.createElement("option",{value:"Nakuru"},"Nakuru"),e.createElement("option",{value:"Mombasa"},"Mombasa"),e.createElement("option",{value:"Kisumu"},"Kisumu"),e.createElement("option",{value:"Eldoret"},"Eldoret"),e.createElement("option",{value:"Thika"},"Thika"),e.createElement("option",{value:"Nyeri"},"Nyeri")):e.createElement("p",{className:"text-gray-900 py-2"},t?.county)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(ct,{className:"w-4 h-4 inline mr-1"}),"Member Since"),e.createElement("p",{className:"text-gray-900 py-2"},new Date(t?.createdAt||new Date).toLocaleDateString())))))),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Account Summary"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(tt,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Orders")),e.createElement("span",{className:"font-semibold text-gray-900"},i.totalOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Pending")),e.createElement("span",{className:"font-semibold text-gray-900"},i.pendingOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Completed")),e.createElement("span",{className:"font-semibold text-gray-900"},i.completedOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Oe,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Spent")),e.createElement("span",{className:"font-semibold text-gray-900"},"KES ",i.totalSpent.toLocaleString())))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>r("/marketplace"),className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(tt,{className:"w-4 h-4 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(H,{className:"w-4 h-4 mr-2"}),"View Order History"),e.createElement("button",{onClick:()=>r("/cart"),className:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(tt,{className:"w-4 h-4 mr-2"}),"View Cart"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All")),e.createElement("div",{className:"space-y-3"},c.slice(0,3).map(E=>e.createElement("div",{key:E.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},"Order #",E.id.slice(-6)),e.createElement("p",{className:"text-xs text-gray-500"},new Date(E.orderDate).toLocaleDateString())),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${h(E.status)}`},E.status),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"KES ",E.totalAmount.toLocaleString())))),c.length===0&&e.createElement("div",{className:"text-center py-4"},e.createElement(H,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-sm text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>r("/marketplace"),className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium"},"Start Shopping"))))))))}function ti(){const{user:t}=ae(),[a,r]=S.useState([]),[s,n]=S.useState(!0),[l,o]=S.useState(null);S.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const m=localStorage.getItem("token"),u=await $.get("/api/orders",{headers:{Authorization:`Bearer ${m}`}});r(u.data)}catch(m){console.error("Failed to fetch orders:",m),P.error("Failed to load orders")}finally{n(!1)}},f=m=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[m]||"bg-gray-100 text-gray-800",i=m=>{const p={PENDING:oe,CONFIRMED:H,PROCESSING:H,SHIPPED:ne,DELIVERED:se,CANCELLED:Ae}[m]||H;return e.createElement(p,{className:"w-4 h-4"})},d=m=>({PENDING:"bg-yellow-100 text-yellow-800",COMPLETED:"bg-green-100 text-green-800",FAILED:"bg-red-100 text-red-800",CANCELLED:"bg-gray-100 text-gray-800"})[m]||"bg-gray-100 text-gray-800";return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Order History"),e.createElement("p",{className:"text-gray-600 mt-2"},"Track and manage your orders")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(m=>m.status==="PENDING").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(se,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Delivered"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(m=>m.status==="DELIVERED").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Oe,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES"," ",a.filter(m=>m.paymentStatus==="COMPLETED").reduce((m,u)=>m+u.totalAmount,0).toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"All Orders")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(H,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders yet"),e.createElement("p",{className:"text-gray-500 mb-6"},"Start shopping to see your orders here"),e.createElement("button",{onClick:()=>window.location.href="/marketplace",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"},"Browse Marketplace")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(m=>e.createElement("div",{key:m.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},m.items[0]?.product?.images?.[0]?e.createElement("img",{src:m.items[0].product.images[0],alt:m.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(H,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Order #",m.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},m.items.length," item",m.items.length>1?"s":""," • KES"," ",m.totalAmount.toLocaleString()))),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f(m.status)}`},i(m.status),e.createElement("span",{className:"ml-1"},m.status)),e.createElement("button",{onClick:()=>o(m),className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center"},e.createElement(ze,{className:"w-4 h-4 mr-1"}),"View Details"))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(ct,{className:"w-4 h-4 mr-2"}),"Ordered: ",new Date(m.orderDate).toLocaleDateString()),e.createElement("div",{className:"flex items-center"},e.createElement(Oe,{className:"w-4 h-4 mr-2"}),"Payment:"," ",e.createElement("span",{className:`ml-1 px-2 py-0.5 rounded text-xs ${d(m.paymentStatus)}`},m.paymentStatus)),e.createElement("div",{className:"flex items-center"},e.createElement(ne,{className:"w-4 h-4 mr-2"}),"Method: ",m.paymentMethod)),m.status==="SHIPPED"||m.status==="DELIVERED"?e.createElement("div",{className:"mt-4 p-3 bg-green-50 rounded-lg"},e.createElement("p",{className:"text-sm text-green-800"},m.status==="DELIVERED"?"Order delivered successfully!":"Your order is on the way!")):null)))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Order Details #",l.id.slice(-8)),e.createElement("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700"},e.createElement(Ae,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Order Status"),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${f(l.status)}`},i(l.status),e.createElement("span",{className:"ml-1"},l.status)),e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${d(l.paymentStatus)}`},l.paymentStatus))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Items Ordered"),e.createElement("div",{className:"space-y-3"},l.items.map(m=>e.createElement("div",{key:m.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:m.product.images[0]||"/placeholder.jpg",alt:m.product.name,className:"w-12 h-12 rounded-lg object-cover"}),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"font-medium text-gray-900"},m.product.name),e.createElement("p",{className:"text-sm text-gray-500"},m.quantity," ",m.product.unit," × KES"," ",m.pricePerUnit))),e.createElement("p",{className:"font-medium text-gray-900"},"KES ",m.totalPrice.toLocaleString()))))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Delivery Information"),e.createElement("div",{className:"space-y-2 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(Me,{className:"w-4 h-4 mr-2"}),l.deliveryAddress),e.createElement("div",{className:"flex items-center"},e.createElement(Qe,{className:"w-4 h-4 mr-2"}),l.deliveryPhone),e.createElement("div",{className:"flex items-center"},e.createElement(ct,{className:"w-4 h-4 mr-2"}),"Expected:"," ",new Date(l.estimatedDelivery).toLocaleDateString()))),e.createElement("div",{className:"border-t pt-4"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("span",{className:"text-lg font-medium text-gray-900"},"Total Amount"),e.createElement("span",{className:"text-lg font-bold text-gray-900"},"KES ",l.totalAmount.toLocaleString())),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Payment via ",l.paymentMethod)))))))}function ai(){const{cart:t,updateQuantity:a,removeFromCart:r,clearCart:s,refreshCart:n}=yt(),{user:l,isAuthenticated:o}=ae();He();const[c,f]=S.useState(null),[i,d]=S.useState(""),[m,u]=S.useState(null);S.useEffect(()=>{n()},[n]);const p=async(g,T)=>{if(!(T<0)){f(g);try{T===0?r(g):a(g,T)}catch{}finally{f(null)}}},N=async g=>{if(window.confirm("Are you sure you want to remove this item from your cart?"))try{r(g)}catch{}},y=async()=>{if(window.confirm("Are you sure you want to clear your entire cart?"))try{await s()}catch{}},h=()=>{i.toLowerCase()==="first10"?(u({code:"FIRST10",discount:10,type:"percentage"}),P.success("Coupon applied successfully!"),d("")):i.toLowerCase()==="save100"?(u({code:"SAVE100",discount:100,type:"fixed"}),P.success("Coupon applied successfully!"),d("")):P.error("Invalid coupon code")},E=()=>{u(null),P.success("Coupon removed")},b=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g),A=g=>m?m.type==="percentage"?g*m.discount/100:Math.min(m.discount,g):0,v=g=>g>=1e3?0:150;if(!t||t.items.length===0)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center py-16"},e.createElement(tt,{className:"w-24 h-24 text-gray-300 mx-auto mb-6"}),e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-4"},"Your cart is empty"),e.createElement("p",{className:"text-gray-600 mb-8"},"Looks like you haven't added any items to your cart yet."),e.createElement(W,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center"},e.createElement(tt,{className:"w-5 h-5 mr-2"}),"Start Shopping")));const O=t.totalAmount,R=A(O),M=O-R,w=v(M),I=M+w;return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"flex items-center justify-between mb-8"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Shopping Cart"),e.createElement("p",{className:"text-gray-600 mt-2"},t.totalItems," ",t.totalItems===1?"item":"items"," in your cart")),t.items.length>0&&e.createElement("button",{onClick:y,className:"text-red-600 hover:text-red-700 text-sm font-medium"},"Clear Cart")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"space-y-6"},t.items.map(g=>e.createElement("div",{key:g.id,className:"flex items-start space-x-4 pb-6 border-b border-gray-200 last:border-b-0 last:pb-0"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:T=>{T.currentTarget.src="/api/placeholder/80/80?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},"📦"))),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},e.createElement(W,{to:`/marketplace/product/${g.productId}`,className:"hover:text-primary-600 transition-colors"},g.name)),e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement("span",null,"Fresh Produce")),e.createElement("div",{className:"flex items-center space-x-4 mb-3"},e.createElement("span",{className:"text-lg font-semibold text-gray-900"},b(g.pricePerUnit)," / ",g.unit))),e.createElement("div",{className:"flex flex-col items-end space-y-2 ml-4"},e.createElement("button",{onClick:()=>N(g.id),className:"text-gray-400 hover:text-red-500 transition-colors",title:"Remove item"},e.createElement(Zr,{className:"w-5 h-5"})),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors"},e.createElement(Ua,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex items-center justify-between mt-4"},e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>p(g.id,g.quantity-1),disabled:c===g.id||g.quantity<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(xn,{className:"w-4 h-4"})),e.createElement("input",{type:"number",min:"1",max:999,value:g.quantity,onChange:T=>{const _=parseInt(T.target.value)||1;_!==g.quantity&&p(g.id,_)},className:"w-16 px-2 py-2 text-center border-0 focus:ring-0",disabled:c===g.id}),e.createElement("button",{onClick:()=>p(g.id,g.quantity+1),disabled:c===g.id,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(At,{className:"w-4 h-4"}))),e.createElement("div",{className:"text-right"},e.createElement("div",{className:"text-lg font-bold text-gray-900"},b((g.pricePerUnit||0)*(g.quantity||0))),g.quantity>1&&e.createElement("div",{className:"text-sm text-gray-600"},g.quantity," ×"," ",b(g.pricePerUnit||0)))),c===g.id&&e.createElement("div",{className:"mt-2 text-sm text-primary-600"},"Updating..."))))))),e.createElement("div",{className:"mt-6"},e.createElement(W,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 font-medium inline-flex items-center"},"← Continue Shopping"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",t.totalItems," items)"),e.createElement("span",null,b(O))),m&&e.createElement("div",{className:"flex justify-between text-green-600"},e.createElement("span",{className:"flex items-center"},e.createElement(Yr,{className:"w-4 h-4 mr-1"}),m.code,e.createElement("button",{onClick:E,className:"ml-2 text-red-500 hover:text-red-700"},"×")),e.createElement("span",null,"-",b(R))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",w===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,b(w))),e.createElement("div",{className:"border-t border-gray-200 pt-3"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,b(I))))),e.createElement("div",{className:"mb-6"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Coupon Code"),e.createElement("div",{className:"flex space-x-2"},e.createElement("input",{type:"text",placeholder:"Enter coupon code",value:i,onChange:g=>d(g.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{onClick:h,disabled:!i.trim(),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},"Apply")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Try: FIRST10 (10% off) or SAVE100 (KES 100 off)")),e.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(oe,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},w===0?"🎉 You qualify for free delivery!":`Spend ${b(1e3-M)} more for free delivery`)),e.createElement(W,{to:"/checkout",className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center justify-center"},"Proceed to Checkout",e.createElement(qa,{className:"w-5 h-5 ml-2"})),e.createElement("div",{className:"mt-4 text-center"},e.createElement("div",{className:"text-xs text-gray-500"},"🔒 Secure checkout powered by M-Pesa"))))))}const Zt=t=>{const a=t.replace(/[\s\-\(\)]/g,"");return a.startsWith("+254")?a.substring(1):a.startsWith("254")?a:a.startsWith("0")?"254"+a.substring(1):a.length===9&&(a.startsWith("7")||a.startsWith("1"))?"254"+a:a},Ma=t=>{const a=Zt(t);return/^254[71]\d{8}$/.test(a)},ri=async(t,a=30,r=2e3)=>{for(let s=0;s<a;s++)try{const l=await(await fetch(`/api/payments/status/${t}`)).json();if(l.status==="COMPLETED")return{success:!0,status:"COMPLETED",data:l};if(l.status==="FAILED"||l.status==="CANCELLED")return{success:!1,status:l.status,data:l};await new Promise(o=>setTimeout(o,r))}catch(n){console.error("Error polling payment status:",n)}return{success:!1,status:"TIMEOUT"}},si=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"];function ni(){const t=He(),{cart:a,clearCart:r}=yt(),{user:s,isAuthenticated:n,loginWithData:l}=ae(),[o,c]=S.useState(null),[f,i]=S.useState(!0),[d,m]=S.useState(!1),[u,p]=S.useState(1),[N,y]=S.useState(null),{register:h,handleSubmit:E,watch:b,setValue:A,formState:{errors:v}}=zs({defaultValues:{firstName:s?.firstName||"",lastName:s?.lastName||"",phone:s?.phone||"",email:s?.email||"",paymentMethod:"MPESA",mpesaPhone:s?.phone||"",createAccount:!n,password:""}}),O=b("paymentMethod");b("county");const R=b("createAccount");S.useEffect(()=>{M()},[]);const M=async()=>{try{i(!0);const g=a.totalAmount>2e3?0:300,T={items:a.items,totalItems:a.totalItems,totalAmount:a.totalAmount,isReadyForCheckout:a.items.length>0,deliveryFee:g,subtotal:a.totalAmount,total:a.totalAmount+g,grandTotal:a.totalAmount+g,unavailableItems:[]};if(c(T),a.totalItems===0){P.error("Your cart is empty"),t("/marketplace");return}}catch(g){console.error("Failed to load cart summary:",g),P.error("Failed to load cart summary"),t("/cart")}finally{i(!1)}},w=async g=>{if(o){m(!0);try{const T={items:o.items.map(U=>({productId:U.productId,quantity:U.quantity,price:U.pricePerUnit})),customerInfo:{firstName:g.firstName,lastName:g.lastName,phone:g.phone,email:g.email,address:`${g.street}, ${g.ward}, ${g.subCounty}, ${g.county}`,county:g.county,buildingName:g.buildingName,deliveryInstructions:g.deliveryInstructions},paymentMethod:g.paymentMethod,mpesaPhone:g.paymentMethod==="MPESA"?g.mpesaPhone:void 0,deliveryFee:o.deliveryFee,totalAmount:o.grandTotal},_=await $.post("/api/orders",T);if(y(_.data),g.paymentMethod==="MPESA"&&g.mpesaPhone)try{const U=Zt(g.mpesaPhone);if(!Ma(U)){P.error("Please enter a valid Kenyan phone number");return}P("Initiating M-Pesa payment...",{icon:"ℹ️"});const B=await $.post("/api/payments/stk-push",{phone:U,amount:o.grandTotal,orderId:_.data.orderId,accountReference:`Order-${_.data.orderId}`,transactionDesc:`Payment for order ${_.data.orderId}`});if(B.data.success){P.success("M-Pesa payment request sent! Please check your phone.");try{P("Waiting for payment confirmation...",{icon:"ℹ️"});const Q=await ri(B.data.transactionId);Q.success?P.success("Payment completed successfully!"):P.error(`Payment ${Q.status.toLowerCase()}. Please try again.`)}catch(Q){console.error("Payment polling error:",Q),P("Payment initiated. Status will be updated shortly.",{icon:"⚠️"})}}else P.error("Failed to initiate M-Pesa payment")}catch(U){console.error("M-Pesa STK push error:",U),P.error("Failed to process M-Pesa payment")}if(!n&&g.createAccount&&g.password)try{const U={firstName:g.firstName,lastName:g.lastName,phone:g.phone,email:g.email,password:g.password,county:g.county,role:"CUSTOMER"},B=await $.post("/api/auth/register",U);if(B.data.success){const{user:Q,token:J}=B.data;l(Q,J),P.success("Account created and logged in successfully!")}}catch(U){console.error("Failed to create account:",U),P.error("Order placed successfully, but failed to create account. You can register later.")}await r(),p(4),P.success("Order placed successfully!")}catch(T){console.error("Failed to create order:",T);const _=T.response?.data?.error||"Failed to place order";P.error(_)}finally{m(!1)}}},I=g=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(g);return f?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-32 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"h-48 bg-gray-200 rounded-lg"})),e.createElement("div",{className:"h-64 bg-gray-200 rounded-lg"})))):!o||o.totalItems===0?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement(tt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-2"},"No items to checkout"),e.createElement("p",{className:"text-gray-600 mb-6"},"Your cart is empty or items are unavailable"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Continue Shopping"))):e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("button",{onClick:()=>t("/cart"),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4"},e.createElement(wt,{className:"w-4 h-4 mr-2"}),"Back to Cart"),e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Checkout"),e.createElement("div",{className:"mt-6"},e.createElement("div",{className:"flex items-center"},[{step:1,title:"Information"},{step:2,title:"Review"},{step:3,title:"Payment"},{step:4,title:"Confirmation"}].map((g,T)=>e.createElement(e.Fragment,{key:g.step},e.createElement("div",{className:`flex items-center ${u>=g.step?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${u>=g.step?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},u>g.step?e.createElement(qt,{className:"w-4 h-4"}):g.step),e.createElement("span",{className:"ml-2 text-sm font-medium"},g.title)),T<3&&e.createElement("div",{className:`flex-1 h-0.5 mx-4 ${u>g.step?"bg-primary-600":"bg-gray-200"}`})))))),u===4?e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-8 text-center"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Order Placed Successfully!"),N&&e.createElement("div",{className:"mb-6"},e.createElement("p",{className:"text-gray-600 mb-2"},"Order Number:"),e.createElement("p",{className:"text-lg font-semibold text-gray-900 mb-4"},N.order?.orderNumber||N.order?.id),e.createElement("p",{className:"text-gray-600 mb-2"},"Total Amount:"),e.createElement("p",{className:"text-2xl font-bold text-primary-600 mb-6"},I(o.grandTotal)),e.createElement("div",{className:"bg-blue-50 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center text-blue-700 mb-2"},e.createElement(oe,{className:"w-5 h-5 mr-2"}),e.createElement("span",{className:"font-medium"},"Estimated Delivery")),e.createElement("p",{className:"text-blue-600"},"1-2 business days"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>t("/customer/dashboard"),className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium"},"View Order Status"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Continue Shopping")))):e.createElement("form",{onSubmit:E(w)},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2 space-y-8"},u>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Fe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Customer Information")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...h("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...h("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.lastName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...h("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...h("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.email.message)))),u>=1&&!n&&e.createElement("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement(En,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Create Account (Optional)")),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{...h("createAccount"),type:"checkbox",className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-700"},"Create an account to track your orders and save delivery addresses"))),R&&e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("input",{...h("password",{required:R?"Password is required":!1,minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter password for your new account",disabled:u>1}),v.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.password.message))),u>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Me,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Delivery Address")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...h("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1},e.createElement("option",{value:""},"Select County"),si.map(g=>e.createElement("option",{key:g,value:g},g))),v.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County *"),e.createElement("input",{...h("subCounty",{required:"Sub-county is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.subCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.subCounty.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ward *"),e.createElement("input",{...h("ward",{required:"Ward is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.ward&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.ward.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Street/Road *"),e.createElement("input",{...h("street",{required:"Street is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1}),v.street&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.street.message)),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Building/House Name"),e.createElement("input",{...h("buildingName"),placeholder:"Optional: Building name, house number, apartment, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1})),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Delivery Instructions"),e.createElement("textarea",{...h("deliveryInstructions"),rows:3,placeholder:"Optional: Special delivery instructions, landmarks, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>1})))),u>=2&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Oe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Payment Method")),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center"},e.createElement("input",{...h("paymentMethod"),type:"radio",value:"MPESA",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:u>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"M-Pesa STK Push")),O==="MPESA"&&e.createElement("div",{className:"ml-7"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"M-Pesa Phone Number *"),e.createElement("input",{...h("mpesaPhone",{required:O==="MPESA"?"M-Pesa phone number is required":!1,pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full max-w-md border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:u>2}),v.mpesaPhone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.mpesaPhone.message)),e.createElement("div",{className:"flex items-center"},e.createElement("input",{...h("paymentMethod"),type:"radio",value:"COD",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:u>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"Cash on Delivery")))),e.createElement("div",{className:"flex justify-between"},u>1&&u<4&&e.createElement("button",{type:"button",onClick:()=>p(u-1),className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Previous"),u<3&&e.createElement("button",{type:"button",onClick:()=>p(u+1),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium ml-auto"},"Next"),u===3&&e.createElement("button",{type:"submit",disabled:d,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium ml-auto"},d?"Placing Order...":"Place Order"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto"},o.items.map(g=>e.createElement("div",{key:g.id,className:"flex items-center space-x-3"},e.createElement("div",{className:"w-12 h-12 bg-gray-200 rounded overflow-hidden flex-shrink-0"},g.images&&g.images.length>0?e.createElement("img",{src:g.images[0],alt:g.name,className:"w-full h-full object-cover",onError:T=>{T.currentTarget.src="/api/placeholder/48/48?text="+encodeURIComponent(g.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},"📦")),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},g.name),e.createElement("p",{className:"text-xs text-gray-600"},g.quantity," × ",I(g.pricePerUnit))),e.createElement("p",{className:"text-sm font-medium text-gray-900"},I((g.pricePerUnit||0)*(g.quantity||0)))))),e.createElement("div",{className:"space-y-2 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",o.totalItems," items)"),e.createElement("span",null,I(o.totalAmount))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",o.deliveryFee===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,I(o.deliveryFee))),e.createElement("div",{className:"border-t border-gray-200 pt-2"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,I(o.grandTotal))))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(ne,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},"Orders placed before 3 PM are processed the same day")))))))}function li(){const{user:t,token:a}=ae(),r=He(),s=h=>{r("/admin/consignments")},n=async h=>{try{await new Promise(E=>setTimeout(E,500)),P.success(`User ${h} approved successfully`),f(E=>({...E,recentUsers:E.recentUsers.map(b=>b.id===h?{...b,status:"ACTIVE"}:b),pendingApprovals:Math.max(0,E.pendingApprovals-1)}))}catch(E){console.error("Error approving user:",E),P.error("Failed to approve user")}},l=async()=>{try{console.log("👥 Fetching users from real database");const h=await fetch("/api/admin/users",{headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"}});if(!h.ok)throw new Error(`HTTP ${h.status}: ${h.statusText}`);const E=await h.json(),b=E.users||E;console.log("👥 Users data received:",b);const A=Array.isArray(b)?b:[];f(v=>({...v,recentUsers:A.slice(0,5).map(O=>({id:O.id,name:`${O.first_name||O.firstName} ${O.last_name||O.lastName}`,email:O.email,role:O.role,status:O.verified?"ACTIVE":"PENDING",joinedAt:new Date(O.created_at||O.createdAt).toLocaleDateString()}))}))}catch(h){console.error("Error fetching users:",h),P.error("Failed to fetch users data")}},o=async()=>{try{console.log("🔄 Fetching recent activity from database");const h=await bt.get("/admin/activity");if(h.data.success){const E=h.data.activities.map(b=>({id:b.id,type:b.type,message:b.description,time:new Date(b.timestamp).toLocaleString(),status:b.status}));f(b=>({...b,recentActivities:E})),console.log("✅ Recent activity loaded:",E)}}catch(h){console.error("❌ Error fetching recent activity:",h),f(E=>({...E,recentActivities:[{id:1,type:"user",message:"New farmer registration: John Kimani",time:"5 minutes ago",status:"pending"},{id:2,type:"consignment",message:"Consignment submitted by Jane Wanjiku",time:"15 minutes ago",status:"pending"}]}))}},[c,f]=S.useState({totalUsers:0,pendingApprovals:0,activeConsignments:0,monthlyRevenue:0,recentActivities:[],pendingConsignments:[],recentUsers:[]}),[i,d]=S.useState(!0),m=async()=>{try{console.log("📊 Fetching analytics stats from database");const h=await bt.get("/admin/analytics/stats");if(h.data.success){const E=h.data.stats;console.log("📊 Analytics stats received:",E),f(b=>({...b,totalUsers:E.totalUsers||0,pendingApprovals:E.pendingApprovals||0,activeConsignments:E.totalConsignments||0,monthlyRevenue:E.totalRevenue||0}))}}catch(h){console.error("❌ Error fetching analytics stats:",h),P.error("Failed to fetch analytics data")}};S.useEffect(()=>{(async()=>{d(!0),await Promise.all([l(),m(),o()]),f(E=>({...E,pendingConsignments:[{id:1,title:"Organic Tomatoes - 100kg",farmer:"Jane Wanjiku",value:13e3,submittedAt:"2 hours ago"},{id:2,title:"Premium Maize - 200kg",farmer:"Peter Kamau",value:12e3,submittedAt:"5 hours ago"},{id:3,title:"Fresh Spinach - 50 bunches",farmer:"Grace Muthoni",value:2500,submittedAt:"1 day ago"}]})),d(!1)})()},[]);const u=[{title:"Manage Users",description:"View and manage platform users",icon:Pe,color:"bg-blue-500",link:"/admin/users",count:c.totalUsers},{title:"Review Consignments",description:"Approve pending consignments",icon:H,color:"bg-green-500",link:"/admin/consignments",count:c.pendingApprovals},{title:"Marketplace Management",description:"Manage products and orders",icon:De,color:"bg-orange-500",link:"/admin/marketplace",count:null},{title:"Registration Fees",description:"Manage farmer registration fees",icon:Oe,color:"bg-red-500",link:"/admin/registration-fees",count:null},{title:"View Analytics",description:"Platform insights and metrics",icon:ja,color:"bg-purple-500",link:"/admin/analytics",count:null},{title:"System Settings",description:"Configure platform settings",icon:ut,color:"bg-gray-500",link:"/admin/settings",count:null}],p=h=>{switch(h){case"user":return e.createElement(Pe,{className:"w-4 h-4"});case"consignment":return e.createElement(H,{className:"w-4 h-4"});case"order":return e.createElement(De,{className:"w-4 h-4"});case"driver":return e.createElement(ne,{className:"w-4 h-4"});default:return e.createElement($t,{className:"w-4 h-4"})}},N=h=>{switch(h){case"pending":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},y=h=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(h);return i?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading dashboard..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-1"},"Here's what's happening on your platform today.")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement($t,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},c.totalUsers),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(Ge,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},c.pendingApprovals),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approvals")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(H,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},c.activeConsignments),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Consignments")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(De,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},y(c.monthlyRevenue)),e.createElement("p",{className:"text-gray-600 text-sm"},"Monthly Revenue"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-6"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},u.map((h,E)=>e.createElement(W,{key:E,to:h.link,className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200 group"},e.createElement("div",{className:"flex items-start justify-between mb-3"},e.createElement("div",{className:`p-2 rounded-lg ${h.color}`},e.createElement(h.icon,{className:"w-5 h-5 text-white"})),h.count!==null&&e.createElement("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-xs font-medium"},h.count)),e.createElement("h3",{className:"font-medium text-gray-900 group-hover:text-primary-600 transition-colors"},h.title),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},h.description),e.createElement("div",{className:"flex items-center mt-3 text-primary-600 group-hover:text-primary-700"},e.createElement("span",{className:"text-sm font-medium"},"Manage"),e.createElement(qa,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement(ot,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.recentActivities.map(h=>e.createElement("div",{key:h.id,className:"p-6"},e.createElement("div",{className:"flex items-start"},e.createElement("div",{className:`p-2 rounded-lg ${N(h.status)} mr-4`},p(h.type)),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},h.message),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},h.time)),h.status==="pending"&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},"Action Required"))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(W,{to:"/admin/notifications",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all activities →"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Pending Consignments"),e.createElement(H,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.pendingConsignments.map(h=>e.createElement("div",{key:h.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h4",{className:"text-sm font-medium text-gray-900"},h.title),e.createElement("p",{className:"text-sm text-gray-500"},"by ",h.farmer),e.createElement("p",{className:"text-sm text-gray-500"},h.submittedAt)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},y(h.value)),e.createElement("button",{onClick:()=>s(h.id),className:"mt-2 bg-primary-600 text-white px-3 py-1 rounded text-xs hover:bg-primary-700"},"Review")))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(W,{to:"/admin/consignments",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all consignments →")))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Users"),e.createElement(Ca,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Action"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.recentUsers.map(h=>e.createElement("tr",{key:h.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},h.name)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800"},h.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${h.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},h.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},h.joinedAt),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},h.status==="PENDING"?e.createElement("button",{onClick:()=>n(h.id),className:"text-green-600 hover:text-green-900"},"Approve"):e.createElement("button",{onClick:()=>r("/admin/users"),className:"text-primary-600 hover:text-primary-900"},"View"))))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(W,{to:"/admin/users",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all users →")))))}const oi={ADMIN:"bg-red-100 text-red-800",FARMER:"bg-green-100 text-green-800",CUSTOMER:"bg-blue-100 text-blue-800",DRIVER:"bg-purple-100 text-purple-800",AGENT:"bg-yellow-100 text-yellow-800"},ci={ACTIVE:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",SUSPENDED:"bg-orange-100 text-orange-800",BLOCKED:"bg-red-100 text-red-800"};function ii(){const{token:t}=ae(),[a,r]=S.useState([]),[s,n]=S.useState(!0),[l,o]=S.useState(""),[c,f]=S.useState("ALL"),[i,d]=S.useState("ALL"),[m,u]=S.useState(null),[p,N]=S.useState(!1),[y,h]=S.useState("activate");S.useEffect(()=>{E()},[]);const E=async()=>{try{const w=[{id:"1",phone:"+254712345678",email:"admin@zuasoko.com",firstName:"Admin",lastName:"User",role:"ADMIN",status:"ACTIVE",createdAt:new Date().toISOString()},{id:"2",phone:"+254734567890",email:"farmer@zuasoko.com",firstName:"Jane",lastName:"Wanjiku",role:"FARMER",status:"ACTIVE",profile:{farmName:"Green Valley Farm",county:"Kiambu"},createdAt:new Date(Date.now()-6048e5).toISOString()},{id:"3",phone:"+254756789012",email:"customer@zuasoko.com",firstName:"Mary",lastName:"Wangari",role:"CUSTOMER",status:"ACTIVE",profile:{county:"Nairobi"},createdAt:new Date(Date.now()-12096e5).toISOString()},{id:"4",phone:"+254778901234",email:"driver@zuasoko.com",firstName:"Michael",lastName:"Kiprotich",role:"DRIVER",status:"ACTIVE",profile:{vehicleType:"Pickup Truck",licenseNumber:"DL123456789"},createdAt:new Date(Date.now()-18144e5).toISOString()},{id:"5",phone:"+254790123456",email:"pending.farmer@zuasoko.com",firstName:"John",lastName:"Kimani",role:"FARMER",status:"PENDING",profile:{farmName:"Highlands Farm",county:"Nyeri"},createdAt:new Date(Date.now()-1728e5).toISOString()}];r(w)}catch(w){console.error("Error fetching users:",w),P.error("Failed to fetch users")}finally{n(!1)}},b=(w,I)=>{u(w),h(I),N(!0)},A=async()=>{if(m)try{let w=m.status,I="";switch(y){case"activate":w="ACTIVE",I="User activated successfully";break;case"suspend":w="SUSPENDED",I="User suspended successfully";break;case"block":w="BLOCKED",I="User blocked successfully";break;case"delete":r(a.filter(g=>g.id!==m.id)),P.success("User deleted successfully"),N(!1);return}r(a.map(g=>g.id===m.id?{...g,status:w}:g)),P.success(I),N(!1)}catch{P.error("Failed to update user")}},v=Array.isArray(a)?a:[],O=v.filter(w=>{const I=w.firstName.toLowerCase().includes(l.toLowerCase())||w.lastName.toLowerCase().includes(l.toLowerCase())||w.email?.toLowerCase().includes(l.toLowerCase())||w.phone.includes(l),g=c==="ALL"||w.role===c,T=i==="ALL"||w.status===i;return I&&g&&T}),M=(()=>{const w=v.length,I=v.filter(_=>_.status==="ACTIVE").length,g=v.filter(_=>_.status==="PENDING").length,T=v.filter(_=>_.status==="BLOCKED"||_.status==="SUSPENDED").length;return{total:w,active:I,pending:g,blocked:T}})();return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading users..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"User Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage platform users and their permissions")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(Be,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Panel")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.total),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(Ca,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.active),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Users")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(Ca,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.pending),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approval")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(bn,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.blocked),e.createElement("p",{className:"text-gray-600 text-sm"},"Blocked/Suspended"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.createElement("input",{type:"text",placeholder:"Search users...",value:l,onChange:w=>o(w.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:c,onChange:w=>f(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Roles"),e.createElement("option",{value:"ADMIN"},"Admin"),e.createElement("option",{value:"FARMER"},"Farmer"),e.createElement("option",{value:"CUSTOMER"},"Customer"),e.createElement("option",{value:"DRIVER"},"Driver"),e.createElement("option",{value:"AGENT"},"Agent")),e.createElement("select",{value:i,onChange:w=>d(w.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Status"),e.createElement("option",{value:"ACTIVE"},"Active"),e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"SUSPENDED"},"Suspended"),e.createElement("option",{value:"BLOCKED"},"Blocked"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Users (",O.length,")")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contact"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},O.map(w=>e.createElement("tr",{key:w.id,className:"hover:bg-gray-50"},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement("span",{className:"text-primary-600 font-medium"},w.firstName[0],w.lastName[0])),e.createElement("div",{className:"ml-4"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},w.firstName," ",w.lastName),w.profile?.farmName&&e.createElement("div",{className:"text-sm text-gray-500"},w.profile.farmName)))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm text-gray-900"},e.createElement("div",{className:"flex items-center gap-1 mb-1"},e.createElement(Qe,{className:"w-3 h-3"}),w.phone),w.email&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Xt,{className:"w-3 h-3"}),w.email))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${oi[w.role]||"bg-gray-100 text-gray-800"}`},w.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ci[w.status]||"bg-gray-100 text-gray-800"}`},w.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},new Date(w.createdAt).toLocaleDateString()),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},e.createElement("div",{className:"flex items-center gap-2"},w.status==="PENDING"&&e.createElement("button",{onClick:()=>b(w,"activate"),className:"text-green-600 hover:text-green-900"},"Activate"),w.status==="ACTIVE"&&e.createElement("button",{onClick:()=>b(w,"suspend"),className:"text-yellow-600 hover:text-yellow-900"},"Suspend"),w.status!=="BLOCKED"&&e.createElement("button",{onClick:()=>b(w,"block"),className:"text-red-600 hover:text-red-900"},"Block"))))))))),p&&m&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Confirm Action")),e.createElement("div",{className:"p-6"},e.createElement("p",{className:"text-gray-600 mb-4"},"Are you sure you want to ",y,' user "',m.firstName," ",m.lastName,'"?'),y==="delete"&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},e.createElement("p",{className:"text-red-700 text-sm"},e.createElement("strong",null,"Warning:")," This action cannot be undone. All user data will be permanently deleted.")),e.createElement("div",{className:"flex gap-4"},e.createElement("button",{type:"button",onClick:()=>N(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:A,className:`flex-1 px-4 py-2 rounded-lg transition-colors ${y==="delete"?"bg-red-600 text-white hover:bg-red-700":"bg-primary-600 text-white hover:bg-primary-700"}`},"Confirm ",y)))))))}const mi={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:oe,label:"Pending Review"},APPROVED:{color:"bg-green-100 text-green-800",icon:se,label:"Approved"},REJECTED:{color:"bg-red-100 text-red-800",icon:Nn,label:"Rejected"},PRICE_SUGGESTED:{color:"bg-blue-100 text-blue-800",icon:De,label:"Price Suggested"},DRIVER_ASSIGNED:{color:"bg-purple-100 text-purple-800",icon:ne,label:"Driver Assigned"},IN_TRANSIT:{color:"bg-indigo-100 text-indigo-800",icon:ne,label:"In Transit"},DELIVERED:{color:"bg-teal-100 text-teal-800",icon:H,label:"Delivered"},COMPLETED:{color:"bg-gray-100 text-gray-800",icon:se,label:"Completed"}};function di(){const{token:t}=ae(),[a,r]=S.useState([]),[s,n]=S.useState([]),[l,o]=S.useState(!0),[c,f]=S.useState("ALL"),[i,d]=S.useState(null),[m,u]=S.useState(!1),[p,N]=S.useState("approve"),[y,h]=S.useState(""),[E,b]=S.useState("");S.useEffect(()=>{A(),v()},[]);const A=async()=>{try{console.log("📦 Fetching consignments from live database");const g=await $.get("/api/consignments",{headers:{Authorization:`Bearer ${t}`}});console.log("📦 Consignments response:",g.data);const T=Array.isArray(g.data)?g.data:g.data.consignments||[];console.log("📦 Setting consignments array:",T),r(Array.isArray(T)?T:[])}catch(g){console.error("❌ Error fetching consignments:",g),P.error("Failed to fetch consignments from database"),r([])}finally{o(!1)}},v=async()=>{try{console.log("🚛 Fetching drivers from live database");const g=await $.get("/api/drivers",{headers:{Authorization:`Bearer ${t}`}});console.log("🚛 Drivers response:",g.data);const T=Array.isArray(g.data)?g.data:g.data.drivers||[];console.log("🚛 Setting drivers array:",T),n(Array.isArray(T)?T:[])}catch(g){console.error("❌ Error fetching drivers:",g),P.error("Failed to fetch drivers from database"),n([])}},O=async(g,T)=>{d(g),N(T),u(!0),T==="suggest_price"&&h(g.proposedPricePerUnit?.toString()||"0")},R=async()=>{if(i)try{let g={};switch(p){case"approve":g={status:"APPROVED"};break;case"reject":g={status:"REJECTED"};break;case"suggest_price":if(!y||Number(y)<=0){P.error("Please enter a valid price");return}g={status:"PRICE_SUGGESTED",suggestedPrice:Number(y)};break;case"assign_driver":if(!E){P.error("Please select a driver");return}g={status:"DRIVER_ASSIGNED",driverId:E};break}await $.patch(`/api/admin/consignments/${i.id}`,g,{headers:{Authorization:`Bearer ${t}`}}),P.success("Consignment updated successfully!"),u(!1),A(),h(""),b("")}catch(g){console.error("Error updating consignment:",g),P.error("Failed to update consignment")}},M=Array.isArray(a)?a:[],w=c==="ALL"?M:M.filter(g=>g.status===c),I=g=>{switch(g.status){case"PENDING":return e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>O(g,"approve"),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Approve"),e.createElement("button",{onClick:()=>O(g,"suggest_price"),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},"Suggest Price"),e.createElement("button",{onClick:()=>O(g,"reject"),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"},"Reject"));case"APPROVED":return e.createElement("button",{onClick:()=>O(g,"assign_driver"),className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700"},"Assign Driver");default:return null}};return l?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading consignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Consignment Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Review and manage farmer consignments")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(g=>g.status==="PENDING").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Review")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(se,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(g=>g.status==="APPROVED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Approved")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(ne,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(g=>g.status==="DRIVER_ASSIGNED"||g.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(H,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(g=>g.status==="DELIVERED"||g.status==="COMPLETED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-wrap gap-2"},["ALL","PENDING","APPROVED","DRIVER_ASSIGNED","IN_TRANSIT","DELIVERED"].map(g=>e.createElement("button",{key:g,onClick:()=>f(g),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c===g?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},g.replace("_"," "))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Consignments (",w.length,")")),w.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(H,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No consignments found"),e.createElement("p",{className:"text-gray-600"},c==="ALL"?"No consignments have been submitted yet":`No ${c.toLowerCase()} consignments`)):e.createElement("div",{className:"divide-y divide-gray-200"},w.map(g=>{const T=mi[g.status],_=T?.icon||H,U=(g.finalPricePerUnit||g.proposedPricePerUnit||0)*(g.quantity||0);return e.createElement("div",{key:g.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(H,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},g.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},g.description),g.farmer&&e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Fe,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Qe,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.phone)),g.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Me,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.profile.county))),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,g.quantity," ",g.unit),e.createElement("span",null,"•"),e.createElement("span",null,"KSh ",g.proposedPricePerUnit," per"," ",g.unit),e.createElement("span",null,"•"),e.createElement("span",null,g.category),e.createElement("span",null,"•"),e.createElement("span",null,"Total: KSh ",U.toLocaleString())),g.status==="PRICE_SUGGESTED"&&g.adminSuggestedPrice&&e.createElement("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("p",{className:"text-sm text-blue-700"},e.createElement("strong",null,"Price suggested:")," KSh"," ",g.adminSuggestedPrice," per"," ",g.unit,e.createElement("span",{className:"ml-2 text-blue-600"},"(Total: KSh"," ",(g.adminSuggestedPrice*g.quantity).toLocaleString(),")")))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${T?.color||"bg-gray-100 text-gray-800"}`},e.createElement(_,{className:"w-4 h-4"}),T?.label||g.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(ct,{className:"w-3 h-3"}),new Date(g.createdAt).toLocaleDateString()),I(g))))}))),m&&i&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},p==="approve"&&"Approve Consignment",p==="reject"&&"Reject Consignment",p==="suggest_price"&&"Suggest New Price",p==="assign_driver"&&"Assign Driver"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},i.title)),e.createElement("div",{className:"p-6"},p==="suggest_price"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Current proposed price: KSh"," ",i.proposedPricePerUnit," per"," ",i.unit),e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Your suggested price (KSh per ",i.unit,")"),e.createElement("input",{type:"number",value:y,onChange:g=>h(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter suggested price",min:"1",required:!0}))),p==="assign_driver"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Select Driver"),e.createElement("select",{value:E,onChange:g=>b(g.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0},e.createElement("option",{value:""},"Choose a driver"),Array.isArray(s)?s.filter(g=>g.isAvailable).map(g=>e.createElement("option",{key:g.id,value:g.userId},g.name," - ",g.vehicleType," (",g.vehicleRegNo,") - Rating:"," ",g.rating,"⭐")):[]))),(p==="approve"||p==="reject")&&e.createElement("p",{className:"text-gray-600"},"Are you sure you want to ",p," this consignment?"),e.createElement("div",{className:"flex gap-4 mt-6"},e.createElement("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:R,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors"},"Confirm")))))))}function ui(){const{token:t}=ae(),[a,r]=S.useState(!0),[s,n]=S.useState("30"),[l,o]=S.useState({totalUsers:0,totalConsignments:0,totalOrders:0,totalRevenue:0,activeDrivers:0,pendingApprovals:0,userGrowth:0,revenueGrowth:0}),[c,f]=S.useState([]);S.useEffect(()=>{i()},[]);const i=async()=>{try{r(!0),console.log("📊 Fetching analytics data from database");const[N,y]=await Promise.all([$.get("/api/admin/analytics/stats",{headers:{Authorization:`Bearer ${t}`}}),$.get("/api/admin/analytics/monthly",{headers:{Authorization:`Bearer ${t}`}})]);N.data.success&&(o(N.data.stats),console.log("✅ Analytics stats loaded:",N.data.stats)),y.data.success&&(f(y.data.monthlyData),console.log("✅ Monthly data loaded:",y.data.monthlyData))}catch(N){console.error("❌ Error fetching analytics:",N),P.error("Failed to fetch analytics data"),o({totalUsers:1247,totalConsignments:856,totalOrders:2341,totalRevenue:4567890,activeDrivers:23,pendingApprovals:12,userGrowth:12.5,revenueGrowth:8.2}),f([{name:"Jan",value:32e4},{name:"Feb",value:28e4},{name:"Mar",value:45e4},{name:"Apr",value:38e4},{name:"May",value:52e4},{name:"Jun",value:49e4},{name:"Jul",value:64e4},{name:"Aug",value:58e4},{name:"Sep",value:72e4},{name:"Oct",value:68e4},{name:"Nov",value:75e4},{name:"Dec",value:82e4}])}finally{r(!1)}},[d]=S.useState([{name:"Vegetables",value:45},{name:"Fruits",value:25},{name:"Grains",value:15},{name:"Leafy Greens",value:10},{name:"Others",value:5}]),[m]=S.useState([{id:1,type:"order",message:"New order placed by Mary Wangari",amount:"KSh 2,450",time:"5 minutes ago"},{id:2,type:"consignment",message:"Consignment approved for Jane Wanjiku",amount:"KSh 15,000",time:"12 minutes ago"},{id:3,type:"user",message:"New farmer registered: Peter Kamau",amount:"",time:"25 minutes ago"},{id:4,type:"delivery",message:"Delivery completed by Michael Kiprotich",amount:"KSh 3,200",time:"1 hour ago"},{id:5,type:"payment",message:"Payment processed for Grace Muthoni",amount:"KSh 8,750",time:"2 hours ago"}]);S.useEffect(()=>{setTimeout(()=>r(!1),1e3)},[s]);const u=N=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(N),p=N=>{switch(N){case"order":return e.createElement(H,{className:"w-4 h-4 text-blue-600"});case"consignment":return e.createElement(Xe,{className:"w-4 h-4 text-green-600"});case"user":return e.createElement(Pe,{className:"w-4 h-4 text-purple-600"});case"delivery":return e.createElement(ne,{className:"w-4 h-4 text-orange-600"});case"payment":return e.createElement(De,{className:"w-4 h-4 text-emerald-600"});default:return e.createElement($t,{className:"w-4 h-4 text-gray-600"})}};return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading analytics..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Analytics Dashboard"),e.createElement("p",{className:"text-gray-600 mt-1"},"Platform insights and performance metrics")),e.createElement("div",{className:"flex items-center gap-4"},e.createElement("button",{onClick:i,disabled:a,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},e.createElement(it,{className:`w-4 h-4 ${a?"animate-spin":""}`}),e.createElement("span",null,"Refresh")),e.createElement("select",{value:s,onChange:N=>n(N.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"7"},"Last 7 days"),e.createElement("option",{value:"30"},"Last 30 days"),e.createElement("option",{value:"90"},"Last 3 months"),e.createElement("option",{value:"365"},"Last year")),e.createElement("button",{className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(jt,{className:"w-4 h-4"}),"Export")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Revenue"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},u(l.totalRevenue))),e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(De,{className:"w-6 h-6 text-green-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Xe,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",l.revenueGrowth,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Users"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.totalUsers.toLocaleString())),e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Xe,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",l.userGrowth,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.totalOrders.toLocaleString())),e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(H,{className:"w-6 h-6 text-purple-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Xe,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+15.3%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Active Drivers"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},l.activeDrivers)),e.createElement("div",{className:"p-3 bg-orange-100 rounded-lg"},e.createElement(ne,{className:"w-6 h-6 text-orange-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(Xe,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+2"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Monthly Revenue"),e.createElement(ja,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"h-64 flex items-end justify-between gap-2"},c.map((N,y)=>e.createElement("div",{key:y,className:"flex flex-col items-center flex-1"},e.createElement("div",{className:"bg-primary-600 rounded-t w-full transition-all duration-300 hover:bg-primary-700",style:{height:`${N.value/Math.max(...c.map(h=>h.value))*100}%`,minHeight:"4px"}}),e.createElement("span",{className:"text-xs text-gray-500 mt-2"},N.name))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Product Categories"),e.createElement(vn,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"space-y-4"},d.map((N,y)=>e.createElement("div",{key:y,className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-4 h-4 rounded mr-3",style:{backgroundColor:`hsl(${y*72}, 70%, 50%)`}}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},N.name)),e.createElement("span",{className:"text-sm text-gray-500"},N.value,"%")))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement($t,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},m.map(N=>e.createElement("div",{key:N.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg mr-4"},p(N.type)),e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},N.message),e.createElement("p",{className:"text-sm text-gray-500"},N.time))),N.amount&&e.createElement("div",{className:"text-sm font-medium text-gray-900"},N.amount)))))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left"},e.createElement(Pe,{className:"w-6 h-6 text-blue-600 mb-2"}),e.createElement("h4",{className:"font-medium text-gray-900"},"Manage Users"),e.createElement("p",{className:"text-sm text-gray-500"},"View and manage platform users")),e.createElement("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left"},e.createElement(H,{className:"w-6 h-6 text-green-600 mb-2"}),e.createElement("h4",{className:"font-medium text-gray-900"},"Review Consignments"),e.createElement("p",{className:"text-sm text-gray-500"},"Approve pending consignments")),e.createElement("button",{className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors text-left"},e.createElement(jt,{className:"w-6 h-6 text-purple-600 mb-2"}),e.createElement("h4",{className:"font-medium text-gray-900"},"Generate Reports"),e.createElement("p",{className:"text-sm text-gray-500"},"Download detailed analytics"))))))}function gi(){const{token:t}=ae(),[a,r]=S.useState(!0),[s,n]=S.useState(!1),[l,o]=S.useState("platform"),[c,f]=S.useState(!1),[i,d]=S.useState({platform:{name:"Zuasoko Agricultural Platform",description:"Connecting farmers directly with customers and managing agricultural supply chains",supportEmail:"support@zuasoko.com",supportPhone:"+254700000000"},fees:{farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7},payments:{mpesaEnabled:!0,mpesaShortcode:"174379",mpesaPasskey:"",bankTransferEnabled:!0,commissionRate:5},notifications:{emailEnabled:!0,smsEnabled:!0,pushEnabled:!0,adminNotifications:!0},security:{passwordMinLength:8,sessionTimeout:24,twoFactorRequired:!1,maxLoginAttempts:5},features:{consignmentApprovalRequired:!0,autoDriverAssignment:!1,inventoryTracking:!0,priceModeration:!0}});S.useEffect(()=>{m()},[]);const m=async()=>{try{const y=await $.get("/api/admin/settings",{headers:{Authorization:`Bearer ${t}`}});y.data.settings&&d(y.data.settings)}catch{console.log("Using default settings - API endpoint not available")}finally{r(!1)}},u=async()=>{n(!0);try{await $.put("/api/admin/settings",i,{headers:{Authorization:`Bearer ${t}`}}),P.success("Settings saved successfully")}catch(y){console.error("Error saving settings:",y),P.success("Settings saved locally (demo mode)")}finally{n(!1)}},p=(y,h,E)=>{d(b=>({...b,[y]:{...b[y],[h]:E}}))},N=[{id:"platform",label:"Platform",icon:or},{id:"payments",label:"Payments",icon:Oe},{id:"fees",label:"Registration Fees",icon:De},{id:"notifications",label:"Notifications",icon:ot},{id:"security",label:"Security",icon:Be},{id:"features",label:"Features",icon:ut}];return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(it,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading settings..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"System Settings"),e.createElement("p",{className:"text-gray-600 mt-1"},"Configure platform settings and system behavior")),e.createElement("button",{onClick:u,disabled:s,className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},s?e.createElement(it,{className:"w-4 h-4 animate-spin"}):e.createElement($a,{className:"w-4 h-4"}),e.createElement("span",null,s?"Saving...":"Save Changes")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8"},e.createElement("div",{className:"lg:col-span-1"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Settings Categories")),e.createElement("nav",{className:"p-2"},N.map(y=>e.createElement("button",{key:y.id,onClick:()=>o(y.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${l===y.id?"bg-green-50 text-green-700 border border-green-200":"text-gray-600 hover:bg-gray-50"}`},e.createElement(y.icon,{className:"w-5 h-5"}),e.createElement("span",null,y.label)))))),e.createElement("div",{className:"lg:col-span-3"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},l==="platform"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(or,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Name"),e.createElement("input",{type:"text",value:i.platform.name,onChange:y=>p("platform","name",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Description"),e.createElement("textarea",{value:i.platform.description,onChange:y=>p("platform","description",y.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Email"),e.createElement("input",{type:"email",value:i.platform.supportEmail,onChange:y=>p("platform","supportEmail",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Phone"),e.createElement("input",{type:"tel",value:i.platform.supportPhone,onChange:y=>p("platform","supportPhone",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))))),l==="payments"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Oe,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Payment Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"M-Pesa Integration"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable M-Pesa payments")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.payments.mpesaEnabled,onChange:y=>p("payments","mpesaEnabled",y.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Bank Transfer"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable bank transfers")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.payments.bankTransferEnabled,onChange:y=>p("payments","bankTransferEnabled",y.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))),i.payments.mpesaEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"M-Pesa Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Business Shortcode"),e.createElement("input",{type:"text",value:i.payments.mpesaShortcode,onChange:y=>p("payments","mpesaShortcode",y.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Passkey"),e.createElement("div",{className:"relative"},e.createElement("input",{type:c?"text":"password",value:i.payments.mpesaPasskey,onChange:y=>p("payments","mpesaPasskey",y.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter M-Pesa passkey"}),e.createElement("button",{type:"button",onClick:()=>f(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center"},c?e.createElement(Ut,{className:"w-4 h-4 text-gray-400"}):e.createElement(ze,{className:"w-4 h-4 text-gray-400"})))))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Commission Rate (%)"),e.createElement("input",{type:"number",min:"0",max:"20",step:"0.1",value:i.payments.commissionRate,onChange:y=>p("payments","commissionRate",parseFloat(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Platform commission charged on transactions")))),l==="notifications"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(ot,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Notification Settings")),e.createElement("div",{className:"space-y-4"},[{key:"emailEnabled",label:"Email Notifications",desc:"Send notifications via email"},{key:"smsEnabled",label:"SMS Notifications",desc:"Send notifications via SMS"},{key:"pushEnabled",label:"Push Notifications",desc:"Send push notifications to mobile apps"},{key:"adminNotifications",label:"Admin Notifications",desc:"Receive admin-specific notifications"}].map(y=>e.createElement("div",{key:y.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},y.label),e.createElement("p",{className:"text-sm text-gray-600"},y.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.notifications[y.key],onChange:h=>p("notifications",y.key,h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))),l==="fees"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(De,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Registration Fee Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(wn,{className:"w-5 h-5 text-yellow-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-yellow-800"},"Important"),e.createElement("p",{className:"text-sm text-yellow-700 mt-1"},"Farmers must pay the registration fee before they can register consignments. This helps maintain platform quality and covers operational costs.")))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Enable Registration Fee"),e.createElement("p",{className:"text-sm text-gray-600"},"Require farmers to pay registration fee before consignment submission")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.fees.registrationFeeEnabled,onChange:y=>p("fees","registrationFeeEnabled",y.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),i.fees.registrationFeeEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"Registration Fee Settings"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Registration Fee Amount (KES)"),e.createElement("input",{type:"number",min:"0",step:"1",value:i.fees.farmerRegistrationFee,onChange:y=>p("fees","farmerRegistrationFee",parseInt(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Amount farmers must pay to register on the platform")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Grace Period (Days)"),e.createElement("input",{type:"number",min:"0",max:"30",value:i.fees.gracePeriodDays,onChange:y=>p("fees","gracePeriodDays",parseInt(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Days to allow farmers to submit consignments before payment"))),e.createElement("div",{className:"bg-white p-4 rounded border border-green-300"},e.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Payment Process"),e.createElement("ol",{className:"text-sm text-gray-700 space-y-1 list-decimal list-inside"},e.createElement("li",null,"Farmer registers on the platform"),e.createElement("li",null,"Admin sends STK push for registration fee payment"),e.createElement("li",null,"Upon successful payment, farmer can submit consignments"),e.createElement("li",null,"Unpaid farmers have"," ",i.fees.gracePeriodDays," days grace period")))))),l==="security"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Be,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Security Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Minimum Password Length"),e.createElement("input",{type:"number",min:"6",max:"20",value:i.security.passwordMinLength,onChange:y=>p("security","passwordMinLength",parseInt(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Session Timeout (hours)"),e.createElement("input",{type:"number",min:"1",max:"168",value:i.security.sessionTimeout,onChange:y=>p("security","sessionTimeout",parseInt(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Maximum Login Attempts"),e.createElement("input",{type:"number",min:"3",max:"10",value:i.security.maxLoginAttempts,onChange:y=>p("security","maxLoginAttempts",parseInt(y.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Two-Factor Authentication"),e.createElement("p",{className:"text-sm text-gray-600"},"Require 2FA for admin accounts")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.security.twoFactorRequired,onChange:y=>p("security","twoFactorRequired",y.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))))),l==="features"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(ut,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Features")),e.createElement("div",{className:"space-y-4"},[{key:"consignmentApprovalRequired",label:"Require Consignment Approval",desc:"Admin approval required for all consignments"},{key:"autoDriverAssignment",label:"Auto Driver Assignment",desc:"Automatically assign drivers to deliveries"},{key:"inventoryTracking",label:"Inventory Tracking",desc:"Track product inventory levels"},{key:"priceModeration",label:"Price Moderation",desc:"Review and moderate product prices"}].map(y=>e.createElement("div",{key:y.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},y.label),e.createElement("p",{className:"text-sm text-gray-600"},y.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:i.features[y.key],onChange:h=>p("features",y.key,h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))))))))}function fi(){const{token:t}=ae(),[a,r]=S.useState("products"),[s,n]=S.useState(!0),[l,o]=S.useState([]),[c,f]=S.useState([]),[i,d]=S.useState([]),[m,u]=S.useState([]),[p,N]=S.useState(""),[y,h]=S.useState("all"),[E,b]=S.useState("all"),[A,v]=S.useState(!1),[O,R]=S.useState(null),[M,w]=S.useState(null),[I,g]=S.useState({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]}),[T,_]=S.useState({totalProducts:0,activeProducts:0,totalOrders:0,pendingOrders:0,totalRevenue:0,unpaidOrders:0});S.useEffect(()=>{U()},[a]),S.useEffect(()=>{J()},[p,y,E,l,c]);const U=async()=>{n(!0);try{a==="products"?await B():a==="orders"&&await Q()}finally{n(!1)}},B=async()=>{try{console.log("🛍️ Fetching marketplace products (refresh)");const D=await $.get("/api/admin/marketplace/products",{headers:{Authorization:`Bearer ${t}`}});if(D.data.success){const G=D.data.products;console.log("📦 Setting new product data:",G),o(G),_(Z=>({...Z,totalProducts:G.length,activeProducts:G.filter(de=>de.is_active).length})),console.log("✅ Products state updated successfully")}}catch(D){console.error("❌ Error fetching products:",D),P.error("Failed to fetch products")}},Q=async()=>{try{console.log("📋 Fetching orders");const D=await $.get("/api/admin/orders",{headers:{Authorization:`Bearer ${t}`}});if(D.data.success){const G=D.data.orders;f(G);const Z=G.filter(de=>de.payment_status==="PAID").reduce((de,pe)=>de+pe.total_amount,0);_(de=>({...de,totalOrders:G.length,pendingOrders:G.filter(pe=>pe.status==="PENDING").length,totalRevenue:Z,unpaidOrders:G.filter(pe=>pe.payment_status==="UNPAID").length})),console.log("✅ Orders loaded:",G)}}catch(D){console.error("❌ Error fetching orders:",D),P.error("Failed to fetch orders")}},J=()=>{if(a==="products"){let D=l.filter(G=>{const Z=G.name.toLowerCase().includes(p.toLowerCase())||G.description.toLowerCase().includes(p.toLowerCase()),de=y==="all"||y==="active"&&G.is_active||y==="inactive"&&!G.is_active,pe=E==="all"||G.category===E;return Z&&de&&pe});d(D)}else if(a==="orders"){let D=c.filter(G=>{const Z=G.first_name?.toLowerCase().includes(p.toLowerCase())||G.last_name?.toLowerCase().includes(p.toLowerCase())||G.customer_phone.includes(p)||G.customer_email?.toLowerCase().includes(p.toLowerCase()),de=y==="all"||G.status===y;return Z&&de});u(D)}},ce=async D=>{if(D.preventDefault(),!I.name||!I.category||!I.price_per_unit){P.error("Please fill in all required fields");return}try{const G={...I,price_per_unit:parseFloat(I.price_per_unit),stock_quantity:parseInt(I.stock_quantity)||0};console.log("📝 Saving product data:",G),console.log("🔄 Editing existing product:",O?.id);let Z;O?(Z=await $.put(`/api/admin/marketplace/products/${O.id}`,G,{headers:{Authorization:`Bearer ${t}`}}),P.success("Product updated successfully")):(Z=await $.post("/api/admin/marketplace/products",G,{headers:{Authorization:`Bearer ${t}`}}),P.success("Product created successfully")),Z.data.success?(console.log("✅ Product update response:",Z.data),v(!1),R(null),he(),await B()):(console.error("❌ Product update failed:",Z.data),P.error(Z.data.message||"Failed to save product"))}catch(G){console.error("❌ Error saving product:",G),G.response?.data?.message?P.error(G.response.data.message):P.error("Failed to save product")}},ge=async D=>{if(confirm("Are you sure you want to delete this product?"))try{await $.delete(`/api/admin/marketplace/products/${D}`,{headers:{Authorization:`Bearer ${t}`}}),P.success("Product deleted successfully"),B()}catch(G){console.error("❌ Error deleting product:",G),P.error("Failed to delete product")}},fe=D=>{console.log("✏️ Editing product:",D),R(D),g({name:D.name,category:D.category,price_per_unit:D.price_per_unit.toString(),unit:D.unit,description:D.description||"",stock_quantity:D.stock_quantity.toString(),is_featured:D.is_featured||!1,farmer_name:D.farmer_name||"Admin",farmer_county:D.farmer_county||"Central",images:D.images||[]}),v(!0)},he=()=>{g({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]})},Te=async D=>{try{(await $.post(`/api/admin/orders/${D.id}/stk-push`,{phone_number:D.customer_phone,amount:D.total_amount},{headers:{Authorization:`Bearer ${t}`}})).data.success&&(P.success("STK push initiated successfully"),Q())}catch(G){console.error("❌ Error initiating STK push:",G),P.error("Failed to initiate STK push")}},ve=async D=>{try{const G=await $.get(`/api/admin/orders/${D.id}/invoice`,{headers:{Authorization:`Bearer ${t}`}});if(G.data.success){const Z=G.data.invoice,de=window.open("","_blank");de&&(de.document.write(`
            <html>
              <head>
                <title>Invoice ${Z.invoice_number}</title>
                <style>
                  body { font-family: Arial, sans-serif; margin: 20px; }
                  .header { text-align: center; margin-bottom: 30px; }
                  .invoice-details { margin-bottom: 20px; }
                  .customer-info { margin-bottom: 20px; }
                  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                  th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                  th { background-color: #f2f2f2; }
                  .total { font-weight: bold; font-size: 18px; }
                  .footer { margin-top: 30px; text-align: center; color: #666; }
                </style>
              </head>
              <body>
                <div class="header">
                  <h1>Zuasoko Agricultural Platform</h1>
                  <h2>Invoice ${Z.invoice_number}</h2>
                </div>
                
                <div class="invoice-details">
                  <p><strong>Order ID:</strong> ${Z.order_id}</p>
                  <p><strong>Date:</strong> ${new Date(Z.created_at).toLocaleDateString()}</p>
                  <p><strong>Due Date:</strong> ${new Date(Z.due_date).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${Z.payment_status}</p>
                </div>
                
                <div class="customer-info">
                  <h3>Customer Information</h3>
                  <p><strong>Name:</strong> ${Z.customer.name}</p>
                  <p><strong>Phone:</strong> ${Z.customer.phone}</p>
                  <p><strong>Email:</strong> ${Z.customer.email}</p>
                  <p><strong>County:</strong> ${Z.customer.county}</p>
                </div>
                
                <table>
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Quantity</th>
                      <th>Unit Price</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${Z.items.map(pe=>`
                      <tr>
                        <td>${pe.product_name}</td>
                        <td>${pe.quantity}</td>
                        <td>KSh ${pe.unit_price?.toLocaleString()}</td>
                        <td>KSh ${(pe.total||pe.quantity*pe.unit_price)?.toLocaleString()}</td>
                      </tr>
                    `).join("")}
                  </tbody>
                  <tfoot>
                    <tr class="total">
                      <td colspan="3"><strong>Total Amount</strong></td>
                      <td><strong>KSh ${Z.total_amount.toLocaleString()}</strong></td>
                    </tr>
                  </tfoot>
                </table>
                
                <div class="footer">
                  <p>Thank you for your business!</p>
                  <p>For any inquiries, contact us at support@zuasoko.com</p>
                </div>
              </body>
            </html>
          `),de.document.close(),de.print()),P.success("Invoice generated successfully")}}catch(G){console.error("❌ Error generating invoice:",G),P.error("Failed to generate invoice")}},at=["Vegetables","Fruits","Grains","Leafy Greens","Root Vegetables","Herbs"],ua=["kg","pieces","bunches","bags","boxes"];return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(it,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading marketplace data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Marketplace Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage products, orders, and marketplace operations")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:U,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(it,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),a==="products"&&e.createElement("button",{onClick:()=>{he(),R(null),v(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(At,{className:"w-4 h-4"}),e.createElement("span",null,"Add Product"))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(H,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},T.totalProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Products")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(se,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},T.activeProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Products")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(Ke,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},T.totalOrders),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Orders")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(De,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"KSh ",T.totalRevenue.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Revenue"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"border-b border-gray-200"},e.createElement("nav",{className:"flex"},[{id:"products",label:"Products",icon:H},{id:"orders",label:"Orders",icon:Ke}].map(D=>e.createElement("button",{key:D.id,onClick:()=>r(D.id),className:`flex items-center space-x-2 px-6 py-4 border-b-2 font-medium text-sm ${a===D.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},e.createElement(D.icon,{className:"w-5 h-5"}),e.createElement("span",null,D.label))))),e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:a==="products"?"Search products...":"Search orders...",value:p,onChange:D=>N(D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:y,onChange:D=>h(D.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Status"),a==="products"?e.createElement(e.Fragment,null,e.createElement("option",{value:"active"},"Active"),e.createElement("option",{value:"inactive"},"Inactive")):e.createElement(e.Fragment,null,e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"COMPLETED"},"Completed"),e.createElement("option",{value:"CANCELLED"},"Cancelled"))),a==="products"&&e.createElement("select",{value:E,onChange:D=>b(D.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Categories"),at.map(D=>e.createElement("option",{key:D,value:D},D)))))),a==="products"&&e.createElement("div",{className:"p-6"},i.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(H,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-4"},p||y!=="all"||E!=="all"?"Try adjusting your search or filters":"Get started by adding your first product"),e.createElement("button",{onClick:()=>{he(),R(null),v(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700"},"Add Product")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},i.map(D=>e.createElement("div",{key:D.id,className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"h-48 bg-gray-100 flex items-center justify-center"},D.images&&D.images.length>0?e.createElement("img",{src:D.images[0],alt:D.name,className:"w-full h-full object-cover"}):e.createElement("div",{className:"text-center"},e.createElement(Sn,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500 text-sm"},"No image"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 line-clamp-2"},D.name),D.is_featured&&e.createElement(kt,{className:"w-4 h-4 text-yellow-500 fill-current flex-shrink-0 ml-2"})),e.createElement("p",{className:"text-sm text-gray-600 mb-2"},D.category),e.createElement("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2"},D.description),e.createElement("div",{className:"flex items-center justify-between mb-3"},e.createElement("span",{className:"text-lg font-semibold text-green-600"},"KSh ",D.price_per_unit.toLocaleString(),"/",D.unit),e.createElement("span",{className:"text-sm text-gray-600"},"Stock: ",D.stock_quantity)),e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${D.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},D.is_active?"Active":"Inactive"),e.createElement("span",{className:"text-xs text-gray-500"},D.farmer_name)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:()=>fe(D),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 flex items-center justify-center space-x-1"},e.createElement(Cn,{className:"w-4 h-4"}),e.createElement("span",null,"Edit")),e.createElement("button",{onClick:()=>ge(D.id),className:"flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 flex items-center justify-center space-x-1"},e.createElement(Zr,{className:"w-4 h-4"}),e.createElement("span",null,"Delete")))))))),a==="orders"&&e.createElement("div",{className:"p-6"},m.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(Ke,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders found"),e.createElement("p",{className:"text-gray-600"},p||y!=="all"?"Try adjusting your search or filters":"Orders will appear here once customers start placing them")):e.createElement("div",{className:"space-y-4"},m.map(D=>e.createElement("div",{key:D.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Order #",D.id),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${D.status==="COMPLETED"?"bg-green-100 text-green-800":D.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},D.status),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${D.payment_status==="PAID"?"bg-green-100 text-green-800":D.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},D.payment_status)),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Customer:")," ",D.first_name," ",D.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",D.customer_phone)),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Email:")," ",D.customer_email),e.createElement("p",null,e.createElement("strong",null,"Amount:")," KSh"," ",D.total_amount.toLocaleString())),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(D.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Items:")," ",D.items?.length||0," products")))),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("button",{onClick:()=>w(D),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 flex items-center space-x-1"},e.createElement(ze,{className:"w-4 h-4"}),e.createElement("span",null,"Details")),e.createElement("button",{onClick:()=>ve(D),className:"bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700 flex items-center space-x-1"},e.createElement(cr,{className:"w-4 h-4"}),e.createElement("span",null,"Invoice")),D.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>Te(D),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Vt,{className:"w-4 h-4"}),e.createElement("span",null,"STK Push")))))))))),A&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},O?"Edit Product":"Add New Product"),e.createElement("button",{onClick:()=>{v(!1),R(null),he()},className:"text-gray-400 hover:text-gray-600"},e.createElement(Ae,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:ce,className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Name *"),e.createElement("input",{type:"text",required:!0,value:I.name,onChange:D=>g({...I,name:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product name"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category *"),e.createElement("select",{required:!0,value:I.category,onChange:D=>g({...I,category:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select category"),at.map(D=>e.createElement("option",{key:D,value:D},D)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Price per Unit *"),e.createElement("input",{type:"number",required:!0,min:"0",step:"0.01",value:I.price_per_unit,onChange:D=>g({...I,price_per_unit:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Unit"),e.createElement("select",{value:I.unit,onChange:D=>g({...I,unit:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},ua.map(D=>e.createElement("option",{key:D,value:D},D)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Stock Quantity"),e.createElement("input",{type:"number",min:"0",value:I.stock_quantity,onChange:D=>g({...I,stock_quantity:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farmer County"),e.createElement("input",{type:"text",value:I.farmer_county,onChange:D=>g({...I,farmer_county:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"County"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),e.createElement("textarea",{rows:4,value:I.description,onChange:D=>g({...I,description:D.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product description"})),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"checkbox",checked:I.is_featured,onChange:D=>g({...I,is_featured:D.target.checked}),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Featured Product"))),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{type:"button",onClick:()=>{v(!1),R(null),he()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},"Cancel"),e.createElement("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement($a,{className:"w-4 h-4"}),e.createElement("span",null,O?"Update":"Create"," Product")))))),M&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Order #",M.id," Details"),e.createElement("button",{onClick:()=>w(null),className:"text-gray-400 hover:text-gray-600"},e.createElement(Ae,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Customer Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Name:")," ",M.first_name," ",M.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",M.customer_phone),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",M.customer_email))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Status:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${M.status==="COMPLETED"?"bg-green-100 text-green-800":M.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},M.status)),e.createElement("p",null,e.createElement("strong",null,"Payment:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${M.payment_status==="PAID"?"bg-green-100 text-green-800":M.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},M.payment_status)),e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(M.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Total:")," KSh"," ",M.total_amount.toLocaleString())))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Items"),M.items&&M.items.length>0?e.createElement("div",{className:"space-y-2"},M.items.map((D,G)=>e.createElement("div",{key:G,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"font-medium"},D.product_name),e.createElement("p",{className:"text-sm text-gray-600"},"Quantity: ",D.quantity)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"font-medium"},"KSh"," ",(D.unit_price*D.quantity).toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"@ KSh ",D.unit_price,"/unit"))))):e.createElement("p",{className:"text-gray-600"},"No items available")),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{onClick:()=>ve(M),className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(cr,{className:"w-4 h-4"}),e.createElement("span",null,"Generate Invoice")),M.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>{Te(M),w(null)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Vt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))}function pi(){const{token:t}=ae(),[a,r]=S.useState(!0),[s,n]=S.useState([]),[l,o]=S.useState([]),[c,f]=S.useState(""),[i,d]=S.useState("all"),[m,u]=S.useState({farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7}),[p,N]=S.useState({totalUnpaid:0,withinGracePeriod:0,overdue:0,totalOutstanding:0});S.useEffect(()=>{y()},[]),S.useEffect(()=>{h()},[c,i,s]);const y=async()=>{r(!0);try{console.log("💰 Fetching unpaid farmers data");const A=await $.get("/api/admin/settings",{headers:{Authorization:`Bearer ${t}`}});A.data.success&&A.data.settings.fees&&u(A.data.settings.fees);const v=await $.get("/api/admin/registration-fees/unpaid",{headers:{Authorization:`Bearer ${t}`}});if(v.data.success){const O=v.data.farmers;n(O);const R=O.length,M=O.filter(g=>g.gracePeriodRemaining>0).length,w=O.filter(g=>g.gracePeriodRemaining<=0).length,I=O.length*m.farmerRegistrationFee;N({totalUnpaid:R,withinGracePeriod:M,overdue:w,totalOutstanding:I}),console.log("✅ Unpaid farmers loaded:",O)}}catch(A){console.error("❌ Error fetching unpaid farmers:",A);const v=[{id:"farmer-001",firstName:"John",lastName:"Kimani",email:"john@example.com",phone:"+254712345678",county:"Nakuru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-5*24*60*60*1e3).toISOString(),daysSinceRegistration:5,gracePeriodRemaining:2,consignmentCount:0},{id:"farmer-002",firstName:"Mary",lastName:"Wanjiku",email:"mary@example.com",phone:"+254723456789",county:"Meru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-10*24*60*60*1e3).toISOString(),daysSinceRegistration:10,gracePeriodRemaining:-3,consignmentCount:2},{id:"farmer-003",firstName:"Peter",lastName:"Mwangi",email:"peter@example.com",phone:"+254734567890",county:"Kiambu",registrationFeePaid:!1,registeredAt:new Date(Date.now()-3*24*60*60*1e3).toISOString(),daysSinceRegistration:3,gracePeriodRemaining:4,consignmentCount:1}];n(v),N({totalUnpaid:3,withinGracePeriod:2,overdue:1,totalOutstanding:900}),P.error("Failed to fetch data, showing demo")}finally{r(!1)}},h=()=>{let A=s.filter(v=>{const O=v.firstName.toLowerCase().includes(c.toLowerCase())||v.lastName.toLowerCase().includes(c.toLowerCase())||v.phone.includes(c)||v.email.toLowerCase().includes(c.toLowerCase()),R=i==="all"||i==="grace"&&v.gracePeriodRemaining>0||i==="overdue"&&v.gracePeriodRemaining<=0;return O&&R});o(A)},E=async A=>{try{console.log(`💳 Initiating STK push for farmer ${A.id}`);const v=await $.post("/api/admin/registration-fees/stk-push",{farmer_id:A.id,phone_number:A.phone,amount:m.farmerRegistrationFee},{headers:{Authorization:`Bearer ${t}`}});v.data.success?(P.success(`STK push sent to ${A.firstName} ${A.lastName}`),n(O=>O.map(R=>R.id===A.id?{...R,lastPaymentAttempt:new Date().toISOString()}:R))):P.error(v.data.message||"Failed to send STK push")}catch(v){console.error("❌ STK push error:",v),P.error(v.response?.data?.message||"Failed to send STK push")}},b=async()=>{if(confirm(`Send STK push to all ${l.length} farmers?`))try{const A=l.map(v=>E(v));await Promise.all(A),P.success(`STK push sent to ${l.length} farmers`)}catch{P.error("Some STK pushes failed")}};return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(it,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading registration fees data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Registration Fees Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage farmer registration fees and payment collection")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:y,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(it,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),l.length>0&&e.createElement("button",{onClick:b,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Vt,{className:"w-4 h-4"}),e.createElement("span",null,"Bulk STK Push"))))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(Oe,{className:"w-5 h-5 text-blue-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-blue-800"},"Current Fee Settings"),e.createElement("p",{className:"text-sm text-blue-700 mt-1"},"Registration Fee:"," ",e.createElement("strong",null,"KSh ",m.farmerRegistrationFee.toLocaleString())," ","• Grace Period:"," ",e.createElement("strong",null,m.gracePeriodDays," days")," • Status:"," ",e.createElement("strong",null,m.registrationFeeEnabled?"Enabled":"Disabled"))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(Pe,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},p.totalUnpaid),e.createElement("p",{className:"text-gray-600 text-sm"},"Unpaid Farmers")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},p.withinGracePeriod),e.createElement("p",{className:"text-gray-600 text-sm"},"Within Grace Period")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(Ge,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},p.overdue),e.createElement("p",{className:"text-gray-600 text-sm"},"Overdue")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(De,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"KSh ",p.totalOutstanding.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Outstanding"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(Yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:"Search farmers by name, phone, or email...",value:c,onChange:A=>f(A.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("select",{value:i,onChange:A=>d(A.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Farmers"),e.createElement("option",{value:"grace"},"Within Grace Period"),e.createElement("option",{value:"overdue"},"Overdue"))))),e.createElement("div",{className:"p-6"},l.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(Pe,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No unpaid farmers found"),e.createElement("p",{className:"text-gray-600"},c||i!=="all"?"Try adjusting your search or filters":"All farmers have paid their registration fees")):e.createElement("div",{className:"space-y-4"},l.map(A=>e.createElement("div",{key:A.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},A.firstName," ",A.lastName),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${A.gracePeriodRemaining>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},A.gracePeriodRemaining>0?`${A.gracePeriodRemaining} days remaining`:`${Math.abs(A.gracePeriodRemaining)} days overdue`),A.consignmentCount>0&&e.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs"},A.consignmentCount," consignments")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Qe,{className:"w-4 h-4"}),e.createElement("span",null,A.phone)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Xt,{className:"w-4 h-4"}),e.createElement("span",null,A.email)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(ct,{className:"w-4 h-4"}),e.createElement("span",null,"Registered ",A.daysSinceRegistration," days ago"))),A.lastPaymentAttempt&&e.createElement("div",{className:"mt-2 text-sm text-gray-500"},"Last STK push:"," ",new Date(A.lastPaymentAttempt).toLocaleDateString())),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("div",{className:"text-right mb-2 sm:mb-0 sm:mr-4"},e.createElement("p",{className:"font-semibold text-gray-900"},"KSh"," ",m.farmerRegistrationFee.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"Registration Fee")),e.createElement("button",{onClick:()=>E(A),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Vt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))))))}function yi(){const{user:t,token:a}=ae(),[r,s]=S.useState([]),[n,l]=S.useState(!0);S.useEffect(()=>{o()},[]);const o=async()=>{try{const E=await $.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${a}`}});s(E.data.assignments||E.data)}catch(E){console.error("Error fetching assignments:",E),E.response?.status===404?(console.log("🚛 Using fallback demo assignments (endpoint not found)"),s([{id:"assign_1",consignmentId:"cons_1",title:"Organic Tomatoes Delivery",farmerName:"Jane Wanjiku",farmerPhone:"+254712345678",pickupLocation:"Nakuru, Rift Valley",deliveryLocation:"Nairobi Central Market",quantity:"100 kg",status:"DRIVER_ASSIGNED",estimatedValue:13e3,distance:"180 km",estimatedTime:"3 hours"},{id:"assign_2",consignmentId:"cons_2",title:"Fresh Spinach Delivery",farmerName:"Peter Kamau",farmerPhone:"+254723456789",pickupLocation:"Kiambu, Central Kenya",deliveryLocation:"Westlands Market",quantity:"50 bunches",status:"IN_TRANSIT",estimatedValue:2500,distance:"45 km",estimatedTime:"1.5 hours"}]),P.success("Using demo data - backend deployment needed")):P.error("Failed to fetch assignments")}finally{l(!1)}},c=async E=>{try{await $.put(`/api/driver/assignments/${E}/status`,{status:"IN_TRANSIT",notes:"Pickup started"},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Started pickup for delivery ${E}`),o()}catch(b){console.error("Error updating delivery status:",b),b.response?.status===404?(P.success("Demo mode: Status update simulated"),o()):P.error("Failed to start pickup")}},f=async E=>{try{await $.put(`/api/driver/assignments/${E}/status`,{status:"DELIVERED",notes:"Delivery completed"},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Marked delivery ${E} as completed`),o()}catch(b){console.error("Error updating delivery status:",b),b.response?.status===404?(P.success("Demo mode: Delivery marked as completed"),o()):P.error("Failed to mark as delivered")}},i=async()=>{try{if(!navigator.geolocation){P.error("Geolocation is not supported by this browser");return}P("Getting your location...",{icon:"ℹ️"}),navigator.geolocation.getCurrentPosition(async E=>{const{latitude:b,longitude:A}=E.coords;try{await $.put("/api/driver/location",{latitude:b,longitude:A,timestamp:new Date().toISOString()},{headers:{Authorization:`Bearer ${a}`}}),P.success(`Location updated: ${b.toFixed(6)}, ${A.toFixed(6)}`)}catch(v){console.error("Error updating location on server:",v),P.success(`Location obtained: ${b.toFixed(6)}, ${A.toFixed(6)}`),P("Could not sync with server - using local GPS",{icon:"⚠️"})}},E=>{console.error("Geolocation error:",E),P.error("Failed to get location. Please enable GPS and try again.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(E){console.error("Location update error:",E),P.error("Failed to update location")}},d=()=>{P.success("Looking for new deliveries...")},m=()=>{P("Issue reporting form would open here",{icon:"ℹ️"})},u=()=>{P("Earnings details would be shown here",{icon:"ℹ️"})},p=[{title:"Deliveries Today",value:"8",icon:e.createElement(ne,{className:"w-6 h-6"}),color:"bg-blue-500"},{title:"Total Earnings",value:"KES 12,500",icon:e.createElement(De,{className:"w-6 h-6"}),color:"bg-green-500"},{title:"Average Rating",value:"4.8",icon:e.createElement(se,{className:"w-6 h-6"}),color:"bg-yellow-500"},{title:"Pending Pickups",value:"3",icon:e.createElement(Ge,{className:"w-6 h-6"}),color:"bg-red-500"}],N=r.map(E=>({id:E.id,customer:`${E.farmer?.user?.firstName||"Unknown"} ${E.farmer?.user?.lastName||"Farmer"}`,location:E.location||"Unknown location",status:E.status==="DRIVER_ASSIGNED"?"pending":E.status==="IN_TRANSIT"?"in_transit":E.status==="DELIVERED"?"delivered":"unknown",time:new Date(E.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:`KES ${((E.finalPricePerUnit||E.bidPricePerUnit)*E.quantity).toLocaleString()}`})),y=E=>{switch(E){case"pending":return"bg-yellow-100 text-yellow-800";case"in_transit":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},h=E=>{switch(E){case"pending":return"Pending Pickup";case"in_transit":return"In Transit";case"delivered":return"Delivered";default:return E}};return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Here's your delivery schedule for today.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},p.map((E,b)=>e.createElement("div",{key:b,className:"bg-white rounded-lg shadow p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${E.color} text-white p-3 rounded-lg`},E.icon),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-600"},E.title),e.createElement("p",{className:"text-2xl font-semibold text-gray-900"},E.value)))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Driver Status"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Status"),e.createElement("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},"Available")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Vehicle"),e.createElement("span",{className:"text-gray-900 font-medium"},"Pickup Truck - KCA123X")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Current Location"),e.createElement("span",{className:"text-gray-900 font-medium"},"Nairobi CBD")),e.createElement("button",{onClick:i,className:"w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors"},"Update Location"))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:d,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Accept New Delivery"),e.createElement("div",{className:"text-sm text-gray-600"},"Find deliveries near you")),e.createElement("button",{onClick:m,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Report Issue"),e.createElement("div",{className:"text-sm text-gray-600"},"Report delivery problems")),e.createElement("button",{onClick:u,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"View Earnings"),e.createElement("div",{className:"text-sm text-gray-600"},"Check payment history")))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Today's Summary"),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Completed"),e.createElement("span",{className:"font-semibold text-green-600"},"5 deliveries")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"In Progress"),e.createElement("span",{className:"font-semibold text-blue-600"},"1 delivery")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Pending"),e.createElement("span",{className:"font-semibold text-orange-600"},"2 deliveries")),e.createElement("div",{className:"border-t pt-3 mt-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Total Earnings"),e.createElement("span",{className:"font-semibold text-gray-900"},"KES 2,400")))))),e.createElement("div",{className:"bg-white rounded-lg shadow"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Today's Deliveries")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"w-full"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Order ID"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Customer"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Location"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Time"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Value"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},n?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"Loading deliveries...")):N.length===0?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"No deliveries assigned")):N.map(E=>e.createElement("tr",{key:E.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},E.id),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.customer),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(Me,{className:"w-4 h-4 text-gray-400 mr-1"}),E.location)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(oe,{className:"w-4 h-4 text-gray-400 mr-1"}),E.time)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.value),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${y(E.status)}`},h(E.status))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.status==="pending"&&e.createElement("button",{onClick:()=>c(E.id),className:"text-primary-600 hover:text-primary-700 font-medium"},"Start Pickup"),E.status==="in_transit"&&e.createElement("button",{onClick:()=>f(E.id),className:"text-green-600 hover:text-green-700 font-medium"},"Mark Delivered"),E.status==="delivered"&&e.createElement("span",{className:"text-gray-400"},"Completed")))))))))}const hi={DRIVER_ASSIGNED:{color:"bg-yellow-100 text-yellow-800",icon:oe,label:"Ready for Pickup",action:"Start Transport"},IN_TRANSIT:{color:"bg-blue-100 text-blue-800",icon:ka,label:"In Transit",action:"Mark as Delivered"},DELIVERED:{color:"bg-green-100 text-green-800",icon:se,label:"Delivered",action:null}};function xi(){const{token:t}=ae(),[a,r]=S.useState([]),[s,n]=S.useState(!0),[l,o]=S.useState(null);S.useEffect(()=>{c()},[]);const c=async()=>{try{const d=await $.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${t}`}});r(d.data.assignments)}catch(d){console.error("Error fetching assignments:",d),P.error("Failed to fetch assignments")}finally{n(!1)}},f=async(d,m)=>{o(d);try{await $.patch(`/api/driver/assignments/${d}/status`,{status:m},{headers:{Authorization:`Bearer ${t}`}}),P.success("Assignment status updated successfully!"),c()}catch(u){console.error("Error updating assignment status:",u),P.error("Failed to update assignment status")}finally{o(null)}},i=d=>{d.status==="DRIVER_ASSIGNED"?f(d.id,"IN_TRANSIT"):d.status==="IN_TRANSIT"&&f(d.id,"DELIVERED")};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading assignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Assignments"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage your transport assignments and deliveries")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(ne,{className:"w-4 h-4"}),e.createElement("span",null,"Driver Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(oe,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(d=>d.status==="DRIVER_ASSIGNED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Ready for Pickup")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(ka,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(d=>d.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(se,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(d=>d.status==="DELIVERED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Active Assignments")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(ne,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No assignments yet"),e.createElement("p",{className:"text-gray-600"},"You'll see your transport assignments here when they are assigned to you")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(d=>{const m=hi[d.status],u=m?.icon||H,p=d.finalPricePerUnit*d.quantity;return e.createElement("div",{key:d.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(H,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},d.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},d.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,d.quantity," ",d.unit),e.createElement("span",null,"•"),e.createElement("span",null,d.category),e.createElement("span",null,"•"),e.createElement("span",null,"Value: KSh ",p.toLocaleString())),d.farmer&&e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3"},e.createElement("h4",{className:"text-sm font-medium text-blue-900 mb-2"},"Farmer Contact"),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-blue-700"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Fe,{className:"w-4 h-4"}),e.createElement("span",null,d.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Qe,{className:"w-4 h-4"}),e.createElement("a",{href:`tel:${d.farmer.phone}`,className:"hover:underline"},d.farmer.phone)),d.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Me,{className:"w-4 h-4"}),e.createElement("span",null,d.farmer.profile.county)))),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(ct,{className:"w-4 h-4"}),e.createElement("span",null,"Expected:"," ",new Date(d.expectedDeliveryDate).toLocaleDateString())))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${m?.color||"bg-gray-100 text-gray-800"}`},e.createElement(u,{className:"w-4 h-4"}),m?.label||d.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(ct,{className:"w-3 h-3"}),"Assigned:"," ",new Date(d.createdAt).toLocaleDateString()),m?.action&&e.createElement("button",{onClick:()=>i(d),disabled:l===d.id,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${d.status==="DRIVER_ASSIGNED"?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`},l===d.id?e.createElement(e.Fragment,null,e.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."):e.createElement(e.Fragment,null,d.status==="DRIVER_ASSIGNED"?e.createElement(kn,{className:"w-4 h-4"}):e.createElement(An,{className:"w-4 h-4"}),m.action)),d.status==="DELIVERED"&&e.createElement("div",{className:"text-xs text-green-600 font-medium"},"✓ Ready for warehouse processing"))),d.status==="DRIVER_ASSIGNED"&&e.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(Ge,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-yellow-700"},e.createElement("p",{className:"font-medium mb-1"},"Transport Instructions:"),e.createElement("ul",{className:"text-xs space-y-1"},e.createElement("li",null,"• Contact farmer to arrange pickup time"),e.createElement("li",null,"• Verify produce quality and quantity"),e.createElement("li",null,"• Handle with care during transport"),e.createElement("li",null,"• Deliver to Main Warehouse, Nairobi Industrial Area"))))),d.status==="IN_TRANSIT"&&e.createElement("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(ka,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-blue-700"},e.createElement("p",{className:"font-medium mb-1"},"En Route to Warehouse"),e.createElement("p",{className:"text-xs"},"Mark as delivered once you arrive at the warehouse and unload the produce.")))))})))))}function Ei(){const{token:t}=ae(),[a,r]=S.useState([]),[s,n]=S.useState(!0),[l,o]=S.useState(!1),[c,f]=S.useState(null),[i,d]=S.useState({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]}),[m,u]=S.useState(""),[p,N]=S.useState(!1);S.useEffect(()=>{y()},[]);const y=async()=>{try{const R=await $.get("/api/warehouse/inventory",{headers:{Authorization:`Bearer ${t}`}});r(R.data.inventory)}catch(R){console.error("Error fetching inventory:",R),P.error("Failed to fetch warehouse inventory")}finally{n(!1)}},h=R=>{f(R),d({marketPrice:R.finalPricePerUnit.toString(),description:R.description,images:R.images,isFeatured:!1,tags:[]}),o(!0)},E=()=>{m.trim()&&!i.tags.includes(m.trim())&&(d({...i,tags:[...i.tags,m.trim()]}),u(""))},b=R=>{d({...i,tags:i.tags.filter(M=>M!==R)})},A=()=>{const R=prompt("Enter image URL:");R&&R.trim()&&d({...i,images:[...i.images,R.trim()]})},v=R=>{d({...i,images:i.images.filter((M,w)=>w!==R)})},O=async()=>{if(c){if(!i.marketPrice||Number(i.marketPrice)<=0){P.error("Please enter a valid market price");return}N(!0);try{await $.post("/api/warehouse/add-to-marketplace",{consignmentId:c.id,marketPrice:Number(i.marketPrice),description:i.description,images:i.images,isFeatured:i.isFeatured,tags:i.tags},{headers:{Authorization:`Bearer ${t}`}}),P.success("Product added to marketplace successfully!"),o(!1),y(),d({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]})}catch(R){console.error("Error adding to marketplace:",R),P.error("Failed to add product to marketplace")}finally{N(!1)}}};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading warehouse inventory..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Warehouse Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage delivered produce and add items to marketplace")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(H,{className:"w-4 h-4"}),e.createElement("span",null,"Inventory Manager")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(H,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.length),e.createElement("p",{className:"text-gray-600 text-sm"},"Items in Warehouse")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(se,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(R=>R.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Added to Marketplace")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(ir,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(R=>!R.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Upload"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Warehouse Inventory")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(H,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No inventory items"),e.createElement("p",{className:"text-gray-600"},"Delivered produce will appear here for marketplace processing")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(R=>e.createElement("div",{key:R.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},R.images.length>0?e.createElement("img",{src:R.images[0],alt:R.title,className:"w-full h-full object-cover rounded-lg"}):e.createElement(H,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},R.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},R.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("span",null,R.quantity," ",R.unit),e.createElement("span",null,"•"),e.createElement("span",null,"KSh ",R.finalPricePerUnit," per ",R.unit),e.createElement("span",null,"•"),e.createElement("span",null,R.category)),e.createElement("div",{className:"text-sm"},e.createElement("span",{className:"text-gray-500"},"Total Value: "),e.createElement("span",{className:"font-semibold text-gray-900"},"KSh"," ",(R.finalPricePerUnit*R.quantity).toLocaleString()))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},R.marketplaceProductId?e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},e.createElement(se,{className:"w-4 h-4"}),"On Marketplace"):e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium"},e.createElement(ir,{className:"w-4 h-4"}),"Ready to Upload"),R.marketplaceProductId?e.createElement("button",{className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center gap-2",disabled:!0},e.createElement(ze,{className:"w-4 h-4"}),"View on Marketplace"):e.createElement("button",{onClick:()=>h(R),className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(At,{className:"w-4 h-4"}),"Add to Marketplace"))))))),l&&c&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Add to Marketplace"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},c.title)),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Price (KSh per ",c.unit,") *"),e.createElement("input",{type:"number",value:i.marketPrice,onChange:R=>d({...i,marketPrice:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter market price",min:"1",required:!0}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Farmer price: KSh ",c.finalPricePerUnit," per"," ",c.unit)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Description"),e.createElement("textarea",{value:i.description,onChange:R=>d({...i,description:R.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enhance the product description for customers"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images"),e.createElement("div",{className:"space-y-3"},i.images.length>0&&e.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3"},i.images.map((R,M)=>e.createElement("div",{key:M,className:"relative"},e.createElement("img",{src:R,alt:`Product ${M+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{onClick:()=>v(M),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"},"×")))),e.createElement("button",{onClick:A,className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors"},e.createElement(Jr,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Add Image URL")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Tags"),e.createElement("div",{className:"space-y-3"},i.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-2"},i.tags.map((R,M)=>e.createElement("span",{key:M,className:"inline-flex items-center gap-1 bg-primary-100 text-primary-800 px-2 py-1 rounded text-sm"},R,e.createElement("button",{onClick:()=>b(R),className:"text-primary-600 hover:text-primary-800"},"×")))),e.createElement("div",{className:"flex gap-2"},e.createElement("input",{type:"text",value:m,onChange:R=>u(R.target.value),onKeyPress:R=>R.key==="Enter"&&E(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Add a tag (e.g., organic, fresh)"}),e.createElement("button",{onClick:E,className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors"},e.createElement(Yr,{className:"w-4 h-4"}))))),e.createElement("div",null,e.createElement("label",{className:"flex items-center gap-2"},e.createElement("input",{type:"checkbox",checked:i.isFeatured,onChange:R=>d({...i,isFeatured:R.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},"Mark as Featured Product")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Featured products appear prominently on the marketplace")),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:p},"Cancel"),e.createElement("button",{onClick:O,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:p},p?"Adding...":"Add to Marketplace")))))))}function bi({title:t="Coming Soon",description:a="This feature is currently under development and will be available soon.",features:r=[]}){const s=He();return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center py-12 px-4"},e.createElement("div",{className:"max-w-md w-full"},e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center"},e.createElement("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(Pn,{className:"w-10 h-10 text-primary-600"})),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4"},t),e.createElement("p",{className:"text-gray-600 mb-6"},a),r.length>0&&e.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left"},e.createElement("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center"},e.createElement(kt,{className:"w-4 h-4 text-yellow-500 mr-2"}),"Coming Features:"),e.createElement("ul",{className:"space-y-2"},r.map((n,l)=>e.createElement("li",{key:l,className:"text-sm text-gray-600 flex items-center"},e.createElement("div",{className:"w-1.5 h-1.5 bg-primary-600 rounded-full mr-2"}),n)))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center justify-center text-blue-700"},e.createElement(oe,{className:"w-4 h-4 mr-2"}),e.createElement("span",{className:"text-sm font-medium"},"Expected Launch: Coming Soon"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>s(-1),className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors flex items-center justify-center"},e.createElement(wt,{className:"w-4 h-4 mr-2"}),"Go Back"),e.createElement(W,{to:"/",className:"block w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors"},"Return to Homepage")),e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("p",{className:"text-xs text-gray-500"},"We're working hard to bring you the best experience.",e.createElement("br",null),"Thank you for your patience!")))))}function Ni(){const[t,a]=S.useState("0712345678"),[r,s]=S.useState(100),[n,l]=S.useState(!1),o=()=>localStorage.getItem("token"),c=async()=>{l(!0);try{const m=o();if(!m){P.error("Please login first");return}const u=await $.post("/api/payments/registration-fee",{phoneNumber:t},{headers:{Authorization:`Bearer ${m}`}});P.success("Registration fee payment initiated!"),console.log("Registration fee response:",u.data)}catch(m){P.error(m.response?.data?.error||"Payment failed"),console.error("Registration fee error:",m)}finally{l(!1)}},f=async()=>{l(!0);try{const m=o();if(!m){P.error("Please login first");return}const u=await $.post("/api/wallet/withdraw",{amount:r,phoneNumber:t},{headers:{Authorization:`Bearer ${m}`}});P.success("Wallet withdrawal initiated!"),console.log("Withdrawal response:",u.data)}catch(m){P.error(m.response?.data?.error||"Withdrawal failed"),console.error("Withdrawal error:",m)}finally{l(!1)}},i=async()=>{l(!0);try{const m=Zt(t);if(!Ma(m)){P.error("Please enter a valid Kenyan phone number");return}const u=await $.post("/api/payments/stk-push",{phone:m,amount:r,orderId:"test-order-"+Date.now(),accountReference:"Test Payment",transactionDesc:"Test STK Push"});u.data.success?(P.success("M-Pesa payment request sent!"),console.log("STK Push response:",u.data)):P.error("Failed to initiate payment")}catch(m){P.error(m.response?.data?.error||"STK Push failed"),console.error("STK Push error:",m)}finally{l(!1)}},d=()=>{const m=Zt(t),u=Ma(t);P(`Phone: ${t} → ${m} (Valid: ${u})`,{icon:"ℹ️"}),console.log("Phone validation:",{original:t,formatted:m,isValid:u})};return e.createElement("div",{className:"max-w-4xl mx-auto p-6"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-8"},"M-Pesa Integration Test"),e.createElement("div",{className:"bg-white rounded-lg shadow p-6 mb-6"},e.createElement("h2",{className:"text-xl font-semibold mb-4"},"Test Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number"),e.createElement("input",{type:"tel",value:t,onChange:m=>a(m.target.value),placeholder:"0712345678",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Amount (KES)"),e.createElement("input",{type:"number",value:r,onChange:m=>s(Number(m.target.value)),min:"1",max:"150000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("button",{onClick:d,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},"Validate Phone"),e.createElement("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},"Test Registration Fee"),e.createElement("button",{onClick:f,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},"Test Withdrawal"),e.createElement("button",{onClick:i,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50"},"Test STK Push"))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-yellow-800 mb-2"},"Demo Configuration"),e.createElement("div",{className:"text-sm text-yellow-700 space-y-1"},e.createElement("p",null,e.createElement("strong",null,"Environment:")," Sandbox"),e.createElement("p",null,e.createElement("strong",null,"Business Short Code:")," 174379"),e.createElement("p",null,e.createElement("strong",null,"Test Phone:")," 0712345678 (or any valid Kenyan number)"),e.createElement("p",null,e.createElement("strong",null,"Demo Credentials:")," Configured for development"))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h3",{className:"text-lg font-semibold text-blue-800 mb-2"},"How to Test"),e.createElement("div",{className:"text-sm text-blue-700 space-y-2"},e.createElement("p",null,"1. ",e.createElement("strong",null,"Login:")," Use demo credentials to login as farmer/customer"),e.createElement("p",null,"2. ",e.createElement("strong",null,"Registration Fee:")," Test farmer activation payment (KES 300)"),e.createElement("p",null,"3. ",e.createElement("strong",null,"Wallet Withdrawal:")," Test farmer wallet withdrawal"),e.createElement("p",null,"4. ",e.createElement("strong",null,"STK Push:")," Test direct M-Pesa payment request"),e.createElement("p",null,"5. ",e.createElement("strong",null,"Checkout:")," Go to marketplace, add items, and checkout with M-Pesa"))))}const we=({children:t,allowedRoles:a})=>{const{user:r,isAuthenticated:s}=ae();return s?a&&r&&!a.includes(r.role)?e.createElement($e,{to:"/",replace:!0}):e.createElement(e.Fragment,null,t):e.createElement($e,{to:"/login",replace:!0})},vi=()=>{const{user:t}=ae();if(!t)return e.createElement($e,{to:"/login",replace:!0});switch(t.role){case"FARMER":return e.createElement($e,{to:"/farmer/dashboard",replace:!0});case"CUSTOMER":return e.createElement($e,{to:"/customer/profile",replace:!0});case"ADMIN":return e.createElement($e,{to:"/admin/dashboard",replace:!0});case"DRIVER":return e.createElement($e,{to:"/driver/dashboard",replace:!0});default:return e.createElement($e,{to:"/",replace:!0})}};function wi(){const{isAuthenticated:t,user:a}=ae();return S.useEffect(()=>{dc()},[]),e.createElement(mc,null,e.createElement(nn,null,e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement(gc,null),e.createElement("main",{className:"pb-16 lg:pb-0"},e.createElement(ln,null,e.createElement(te,{path:"/",element:e.createElement(xc,null)}),e.createElement(te,{path:"/marketplace",element:e.createElement(bc,null)}),e.createElement(te,{path:"/marketplace/product/:id",element:e.createElement(Nc,null)}),e.createElement(te,{path:"/login",element:e.createElement(vc,null)}),e.createElement(te,{path:"/register",element:e.createElement(Hc,null)}),e.createElement(te,{path:"/dashboard",element:e.createElement(vi,null)}),e.createElement(te,{path:"/farmer/dashboard",element:e.createElement(we,{allowedRoles:["FARMER"]},e.createElement(Wc,null))}),e.createElement(te,{path:"/customer/dashboard",element:e.createElement(we,{allowedRoles:["CUSTOMER"]},e.createElement(Xc,null))}),e.createElement(te,{path:"/customer/profile",element:e.createElement(we,{allowedRoles:["CUSTOMER"]},e.createElement(ei,null))}),e.createElement(te,{path:"/customer/orders",element:e.createElement(we,{allowedRoles:["CUSTOMER"]},e.createElement(ti,null))}),e.createElement(te,{path:"/cart",element:e.createElement(ai,null)}),e.createElement(te,{path:"/checkout",element:e.createElement(ni,null)}),e.createElement(te,{path:"/admin/dashboard",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(li,null))}),e.createElement(te,{path:"/admin/users",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(ii,null))}),e.createElement(te,{path:"/admin/consignments",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(di,null))}),e.createElement(te,{path:"/admin/analytics",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(ui,null))}),e.createElement(te,{path:"/admin/settings",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(gi,null))}),e.createElement(te,{path:"/admin/marketplace",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(fi,null))}),e.createElement(te,{path:"/admin/registration-fees",element:e.createElement(we,{allowedRoles:["ADMIN"]},e.createElement(pi,null))}),e.createElement(te,{path:"/driver/dashboard",element:e.createElement(we,{allowedRoles:["DRIVER"]},e.createElement(yi,null))}),e.createElement(te,{path:"/driver/assignments",element:e.createElement(we,{allowedRoles:["DRIVER"]},e.createElement(xi,null))}),e.createElement(te,{path:"/driver/warehouse",element:e.createElement(we,{allowedRoles:["DRIVER"]},e.createElement(Ei,null))}),e.createElement(te,{path:"/farmer/consignments",element:e.createElement($e,{to:"/farmer/dashboard",replace:!0})}),e.createElement(te,{path:"/farmer/wallet",element:e.createElement($e,{to:"/farmer/dashboard",replace:!0})}),e.createElement(te,{path:"/test-mpesa",element:e.createElement(Ni,null)}),e.createElement(te,{path:"*",element:e.createElement(bi,null)}))),t&&a&&e.createElement(fc,null),e.createElement(pc,null),e.createElement(Dn,{position:"top-right"}))))}window.addEventListener("error",t=>{t.error&&t.error.message&&t.error.message.includes("filter is not a function")&&(console.error("🔴 ARRAY OPERATION ERROR DETECTED:",t.error.message),console.error("This error has been caught and handled gracefully."),t.preventDefault())});window.addEventListener("unhandledrejection",t=>{t.reason&&typeof t.reason=="string"&&t.reason.includes("filter")&&(console.error("🔴 PROMISE REJECTION WITH ARRAY ERROR:",t.reason),t.preventDefault())});const Si=new Qn({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:2,staleTime:10*60*1e3,cacheTime:15*60*1e3},mutations:{retry:1}}}),Hs=document.getElementById("root");if(!Hs)throw new Error("Root element not found");const Ci=Aa.createRoot(Hs);Ci.render(e.createElement(el,{client:Si},e.createElement(wi)));
