import{a as rn,b as sn,c as e,r as P,g as nn}from"./vendor-9bZoipD1.js";import{u as _e,L as H,a as Xr,b as ln,B as on,R as cn,c as Y,N as Ue}from"./router-BAAhKjlc.js";import{S as $e,L as ur,X as Fe,M as mn,H as es,a as ts,C as dn,U as Ae,b as at,B as Za,T as me,A as lt,W as gr,D as fr,c as as,d as La,e as Wt,f as At,g as fe,h as pr,i as de,j as Oe,k as Te,l as rs,m as rt,K as un,n as gn,o as fn,P as pn,p as yn,q as ze,r as ke,Q as hn,s as Ie,t as ia,F as bn,E as Ke,u as Xa,V as A,v as St,w as En,x as Ye,y as ma,z as kt,G as Qt,I as be,J as it,N as B,O as yr,R as Ce,Y as Dt,Z as Jt,_ as er,$ as xn,a0 as Je,a1 as vn,a2 as da,a3 as st,a4 as Nn,a5 as ss,a6 as wn,a7 as Yt,a8 as ja,a9 as Sn,aa as kn,ab as Ve,ac as Cn,ad as Ua,ae as Pn,af as An,ag as hr,ah as Zt,ai as Dn,aj as qa,ak as Rn,al as Fn,am as On,an as Tn}from"./ui-XvAg7uig.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerPolicy&&(l.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?l.credentials="include":n.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(n){if(n.ep)return;n.ep=!0;const l=r(n);fetch(n.href,l)}})();var $a={},br=rn;$a.createRoot=br.createRoot,$a.hydrateRoot=br.hydrateRoot;function Va(t,a){return Va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Va(t,a)}function ua(t,a){t.prototype=Object.create(a.prototype),t.prototype.constructor=t,Va(t,a)}var ga=function(){function t(){this.listeners=[]}var a=t.prototype;return a.subscribe=function(s){var n=this,l=s||function(){};return this.listeners.push(l),this.onSubscribe(),function(){n.listeners=n.listeners.filter(function(o){return o!==l}),n.onUnsubscribe()}},a.hasListeners=function(){return this.listeners.length>0},a.onSubscribe=function(){},a.onUnsubscribe=function(){},t}();function J(){return J=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var s in r)({}).hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},J.apply(null,arguments)}var ns=typeof window>"u";function ye(){}function In(t,a){return typeof t=="function"?t(a):t}function _n(t){return typeof t=="number"&&t>=0&&t!==1/0}function Xt(t){return Array.isArray(t)?t:[t]}function Mn(t,a){return Math.max(t+(a||0)-Date.now(),0)}function Ra(t,a,r){return fa(t)?typeof a=="function"?J({},r,{queryKey:t,queryFn:a}):J({},a,{queryKey:t}):t}function We(t,a,r){return fa(t)?[J({},a,{queryKey:t}),r]:[t||{},a]}function Ln(t,a){if(t===!0&&a===!0||t==null&&a==null)return"all";if(t===!1&&a===!1)return"none";var r=t??!a;return r?"active":"inactive"}function Er(t,a){var r=t.active,s=t.exact,n=t.fetching,l=t.inactive,o=t.predicate,c=t.queryKey,f=t.stale;if(fa(c)){if(s){if(a.queryHash!==tr(c,a.options))return!1}else if(!ea(a.queryKey,c))return!1}var m=Ln(r,l);if(m==="none")return!1;if(m!=="all"){var g=a.isActive();if(m==="active"&&!g||m==="inactive"&&g)return!1}return!(typeof f=="boolean"&&a.isStale()!==f||typeof n=="boolean"&&a.isFetching()!==n||o&&!o(a))}function xr(t,a){var r=t.exact,s=t.fetching,n=t.predicate,l=t.mutationKey;if(fa(l)){if(!a.options.mutationKey)return!1;if(r){if(Ze(a.options.mutationKey)!==Ze(l))return!1}else if(!ea(a.options.mutationKey,l))return!1}return!(typeof s=="boolean"&&a.state.status==="loading"!==s||n&&!n(a))}function tr(t,a){var r=a?.queryKeyHashFn||Ze;return r(t)}function Ze(t){var a=Xt(t);return jn(a)}function jn(t){return JSON.stringify(t,function(a,r){return Ka(r)?Object.keys(r).sort().reduce(function(s,n){return s[n]=r[n],s},{}):r})}function ea(t,a){return ls(Xt(t),Xt(a))}function ls(t,a){return t===a?!0:typeof t!=typeof a?!1:t&&a&&typeof t=="object"&&typeof a=="object"?!Object.keys(a).some(function(r){return!ls(t[r],a[r])}):!1}function os(t,a){if(t===a)return t;var r=Array.isArray(t)&&Array.isArray(a);if(r||Ka(t)&&Ka(a)){for(var s=r?t.length:Object.keys(t).length,n=r?a:Object.keys(a),l=n.length,o=r?[]:{},c=0,f=0;f<l;f++){var m=r?f:n[f];o[m]=os(t[m],a[m]),o[m]===t[m]&&c++}return s===l&&c===s?t:o}return a}function Ka(t){if(!vr(t))return!1;var a=t.constructor;if(typeof a>"u")return!0;var r=a.prototype;return!(!vr(r)||!r.hasOwnProperty("isPrototypeOf"))}function vr(t){return Object.prototype.toString.call(t)==="[object Object]"}function fa(t){return typeof t=="string"||Array.isArray(t)}function Un(t){return new Promise(function(a){setTimeout(a,t)})}function Nr(t){Promise.resolve().then(t).catch(function(a){return setTimeout(function(){throw a})})}function cs(){if(typeof AbortController=="function")return new AbortController}var qn=function(t){ua(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!ns&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("visibilitychange",o,!1),window.addEventListener("focus",o,!1),function(){window.removeEventListener("visibilitychange",o),window.removeEventListener("focus",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setFocused(c):o.onFocus()})},r.setFocused=function(n){this.focused=n,n&&this.onFocus()},r.onFocus=function(){this.listeners.forEach(function(n){n()})},r.isFocused=function(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)},a}(ga),Vt=new qn,$n=function(t){ua(a,t);function a(){var s;return s=t.call(this)||this,s.setup=function(n){var l;if(!ns&&((l=window)!=null&&l.addEventListener)){var o=function(){return n()};return window.addEventListener("online",o,!1),window.addEventListener("offline",o,!1),function(){window.removeEventListener("online",o),window.removeEventListener("offline",o)}}},s}var r=a.prototype;return r.onSubscribe=function(){this.cleanup||this.setEventListener(this.setup)},r.onUnsubscribe=function(){if(!this.hasListeners()){var n;(n=this.cleanup)==null||n.call(this),this.cleanup=void 0}},r.setEventListener=function(n){var l,o=this;this.setup=n,(l=this.cleanup)==null||l.call(this),this.cleanup=n(function(c){typeof c=="boolean"?o.setOnline(c):o.onOnline()})},r.setOnline=function(n){this.online=n,n&&this.onOnline()},r.onOnline=function(){this.listeners.forEach(function(n){n()})},r.isOnline=function(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine},a}(ga),Kt=new $n;function Vn(t){return Math.min(1e3*Math.pow(2,t),3e4)}function ta(t){return typeof t?.cancel=="function"}var is=function(a){this.revert=a?.revert,this.silent=a?.silent};function Fa(t){return t instanceof is}var ms=function(a){var r=this,s=!1,n,l,o,c;this.abort=a.abort,this.cancel=function(y){return n?.(y)},this.cancelRetry=function(){s=!0},this.continueRetry=function(){s=!1},this.continue=function(){return l?.()},this.failureCount=0,this.isPaused=!1,this.isResolved=!1,this.isTransportCancelable=!1,this.promise=new Promise(function(y,b){o=y,c=b});var f=function(b){r.isResolved||(r.isResolved=!0,a.onSuccess==null||a.onSuccess(b),l?.(),o(b))},m=function(b){r.isResolved||(r.isResolved=!0,a.onError==null||a.onError(b),l?.(),c(b))},g=function(){return new Promise(function(b){l=b,r.isPaused=!0,a.onPause==null||a.onPause()}).then(function(){l=void 0,r.isPaused=!1,a.onContinue==null||a.onContinue()})},d=function y(){if(!r.isResolved){var b;try{b=a.fn()}catch(w){b=Promise.reject(w)}n=function(h){if(!r.isResolved&&(m(new is(h)),r.abort==null||r.abort(),ta(b)))try{b.cancel()}catch{}},r.isTransportCancelable=ta(b),Promise.resolve(b).then(f).catch(function(w){var h,x;if(!r.isResolved){var E=(h=a.retry)!=null?h:3,N=(x=a.retryDelay)!=null?x:Vn,k=typeof N=="function"?N(r.failureCount,w):N,v=E===!0||typeof E=="number"&&r.failureCount<E||typeof E=="function"&&E(r.failureCount,w);if(s||!v){m(w);return}r.failureCount++,a.onFail==null||a.onFail(r.failureCount,w),Un(k).then(function(){if(!Vt.isFocused()||!Kt.isOnline())return g()}).then(function(){s?m(w):y()})}})}};d()},Kn=function(){function t(){this.queue=[],this.transactions=0,this.notifyFn=function(r){r()},this.batchNotifyFn=function(r){r()}}var a=t.prototype;return a.batch=function(s){var n;this.transactions++;try{n=s()}finally{this.transactions--,this.transactions||this.flush()}return n},a.schedule=function(s){var n=this;this.transactions?this.queue.push(s):Nr(function(){n.notifyFn(s)})},a.batchCalls=function(s){var n=this;return function(){for(var l=arguments.length,o=new Array(l),c=0;c<l;c++)o[c]=arguments[c];n.schedule(function(){s.apply(void 0,o)})}},a.flush=function(){var s=this,n=this.queue;this.queue=[],n.length&&Nr(function(){s.batchNotifyFn(function(){n.forEach(function(l){s.notifyFn(l)})})})},a.setNotifyFunction=function(s){this.notifyFn=s},a.setBatchNotifyFunction=function(s){this.batchNotifyFn=s},t}(),ue=new Kn,ds=console;function us(){return ds}function Bn(t){ds=t}var Gn=function(){function t(r){this.abortSignalConsumed=!1,this.hadObservers=!1,this.defaultOptions=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.cache=r.cache,this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.initialState=r.state||this.getDefaultState(this.options),this.state=this.initialState,this.meta=r.meta,this.scheduleGc()}var a=t.prototype;return a.setOptions=function(s){var n;this.options=J({},this.defaultOptions,s),this.meta=s?.meta,this.cacheTime=Math.max(this.cacheTime||0,(n=this.options.cacheTime)!=null?n:5*60*1e3)},a.setDefaultOptions=function(s){this.defaultOptions=s},a.scheduleGc=function(){var s=this;this.clearGcTimeout(),_n(this.cacheTime)&&(this.gcTimeout=setTimeout(function(){s.optionalRemove()},this.cacheTime))},a.clearGcTimeout=function(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)},a.optionalRemove=function(){this.observers.length||(this.state.isFetching?this.hadObservers&&this.scheduleGc():this.cache.remove(this))},a.setData=function(s,n){var l,o,c=this.state.data,f=In(s,c);return(l=(o=this.options).isDataEqual)!=null&&l.call(o,c,f)?f=c:this.options.structuralSharing!==!1&&(f=os(c,f)),this.dispatch({data:f,type:"success",dataUpdatedAt:n?.updatedAt}),f},a.setState=function(s,n){this.dispatch({type:"setState",state:s,setStateOptions:n})},a.cancel=function(s){var n,l=this.promise;return(n=this.retryer)==null||n.cancel(s),l?l.then(ye).catch(ye):Promise.resolve()},a.destroy=function(){this.clearGcTimeout(),this.cancel({silent:!0})},a.reset=function(){this.destroy(),this.setState(this.initialState)},a.isActive=function(){return this.observers.some(function(s){return s.options.enabled!==!1})},a.isFetching=function(){return this.state.isFetching},a.isStale=function(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(function(s){return s.getCurrentResult().isStale})},a.isStaleByTime=function(s){return s===void 0&&(s=0),this.state.isInvalidated||!this.state.dataUpdatedAt||!Mn(this.state.dataUpdatedAt,s)},a.onFocus=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnWindowFocus()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.onOnline=function(){var s,n=this.observers.find(function(l){return l.shouldFetchOnReconnect()});n&&n.refetch(),(s=this.retryer)==null||s.continue()},a.addObserver=function(s){this.observers.indexOf(s)===-1&&(this.observers.push(s),this.hadObservers=!0,this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:s}))},a.removeObserver=function(s){this.observers.indexOf(s)!==-1&&(this.observers=this.observers.filter(function(n){return n!==s}),this.observers.length||(this.retryer&&(this.retryer.isTransportCancelable||this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.cacheTime?this.scheduleGc():this.cache.remove(this)),this.cache.notify({type:"observerRemoved",query:this,observer:s}))},a.getObserversCount=function(){return this.observers.length},a.invalidate=function(){this.state.isInvalidated||this.dispatch({type:"invalidate"})},a.fetch=function(s,n){var l=this,o,c,f;if(this.state.isFetching){if(this.state.dataUpdatedAt&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var m;return(m=this.retryer)==null||m.continueRetry(),this.promise}}if(s&&this.setOptions(s),!this.options.queryFn){var g=this.observers.find(function(N){return N.options.queryFn});g&&this.setOptions(g.options)}var d=Xt(this.queryKey),y=cs(),b={queryKey:d,pageParam:void 0,meta:this.meta};Object.defineProperty(b,"signal",{enumerable:!0,get:function(){if(y)return l.abortSignalConsumed=!0,y.signal}});var w=function(){return l.options.queryFn?(l.abortSignalConsumed=!1,l.options.queryFn(b)):Promise.reject("Missing queryFn")},h={fetchOptions:n,options:this.options,queryKey:d,state:this.state,fetchFn:w,meta:this.meta};if((o=this.options.behavior)!=null&&o.onFetch){var x;(x=this.options.behavior)==null||x.onFetch(h)}if(this.revertState=this.state,!this.state.isFetching||this.state.fetchMeta!==((c=h.fetchOptions)==null?void 0:c.meta)){var E;this.dispatch({type:"fetch",meta:(E=h.fetchOptions)==null?void 0:E.meta})}return this.retryer=new ms({fn:h.fetchFn,abort:y==null||(f=y.abort)==null?void 0:f.bind(y),onSuccess:function(k){l.setData(k),l.cache.config.onSuccess==null||l.cache.config.onSuccess(k,l),l.cacheTime===0&&l.optionalRemove()},onError:function(k){Fa(k)&&k.silent||l.dispatch({type:"error",error:k}),Fa(k)||(l.cache.config.onError==null||l.cache.config.onError(k,l),us().error(k)),l.cacheTime===0&&l.optionalRemove()},onFail:function(){l.dispatch({type:"failed"})},onPause:function(){l.dispatch({type:"pause"})},onContinue:function(){l.dispatch({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay}),this.promise=this.retryer.promise,this.promise},a.dispatch=function(s){var n=this;this.state=this.reducer(this.state,s),ue.batch(function(){n.observers.forEach(function(l){l.onQueryUpdate(s)}),n.cache.notify({query:n,type:"queryUpdated",action:s})})},a.getDefaultState=function(s){var n=typeof s.initialData=="function"?s.initialData():s.initialData,l=typeof s.initialData<"u",o=l?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0,c=typeof n<"u";return{data:n,dataUpdateCount:0,dataUpdatedAt:c?o??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchMeta:null,isFetching:!1,isInvalidated:!1,isPaused:!1,status:c?"success":"idle"}},a.reducer=function(s,n){var l,o;switch(n.type){case"failed":return J({},s,{fetchFailureCount:s.fetchFailureCount+1});case"pause":return J({},s,{isPaused:!0});case"continue":return J({},s,{isPaused:!1});case"fetch":return J({},s,{fetchFailureCount:0,fetchMeta:(l=n.meta)!=null?l:null,isFetching:!0,isPaused:!1},!s.dataUpdatedAt&&{error:null,status:"loading"});case"success":return J({},s,{data:n.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:(o=n.dataUpdatedAt)!=null?o:Date.now(),error:null,fetchFailureCount:0,isFetching:!1,isInvalidated:!1,isPaused:!1,status:"success"});case"error":var c=n.error;return Fa(c)&&c.revert&&this.revertState?J({},this.revertState):J({},s,{error:c,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,isFetching:!1,isPaused:!1,status:"error"});case"invalidate":return J({},s,{isInvalidated:!0});case"setState":return J({},s,n.state);default:return s}},t}(),Hn=function(t){ua(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.queries=[],n.queriesMap={},n}var r=a.prototype;return r.build=function(n,l,o){var c,f=l.queryKey,m=(c=l.queryHash)!=null?c:tr(f,l),g=this.get(m);return g||(g=new Gn({cache:this,queryKey:f,queryHash:m,options:n.defaultQueryOptions(l),state:o,defaultOptions:n.getQueryDefaults(f),meta:l.meta}),this.add(g)),g},r.add=function(n){this.queriesMap[n.queryHash]||(this.queriesMap[n.queryHash]=n,this.queries.push(n),this.notify({type:"queryAdded",query:n}))},r.remove=function(n){var l=this.queriesMap[n.queryHash];l&&(n.destroy(),this.queries=this.queries.filter(function(o){return o!==n}),l===n&&delete this.queriesMap[n.queryHash],this.notify({type:"queryRemoved",query:n}))},r.clear=function(){var n=this;ue.batch(function(){n.queries.forEach(function(l){n.remove(l)})})},r.get=function(n){return this.queriesMap[n]},r.getAll=function(){return this.queries},r.find=function(n,l){var o=We(n,l),c=o[0];return typeof c.exact>"u"&&(c.exact=!0),this.queries.find(function(f){return Er(c,f)})},r.findAll=function(n,l){var o=We(n,l),c=o[0];return Object.keys(c).length>0?this.queries.filter(function(f){return Er(c,f)}):this.queries},r.notify=function(n){var l=this;ue.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){var n=this;ue.batch(function(){n.queries.forEach(function(l){l.onFocus()})})},r.onOnline=function(){var n=this;ue.batch(function(){n.queries.forEach(function(l){l.onOnline()})})},a}(ga),zn=function(){function t(r){this.options=J({},r.defaultOptions,r.options),this.mutationId=r.mutationId,this.mutationCache=r.mutationCache,this.observers=[],this.state=r.state||Wn(),this.meta=r.meta}var a=t.prototype;return a.setState=function(s){this.dispatch({type:"setState",state:s})},a.addObserver=function(s){this.observers.indexOf(s)===-1&&this.observers.push(s)},a.removeObserver=function(s){this.observers=this.observers.filter(function(n){return n!==s})},a.cancel=function(){return this.retryer?(this.retryer.cancel(),this.retryer.promise.then(ye).catch(ye)):Promise.resolve()},a.continue=function(){return this.retryer?(this.retryer.continue(),this.retryer.promise):this.execute()},a.execute=function(){var s=this,n,l=this.state.status==="loading",o=Promise.resolve();return l||(this.dispatch({type:"loading",variables:this.options.variables}),o=o.then(function(){s.mutationCache.config.onMutate==null||s.mutationCache.config.onMutate(s.state.variables,s)}).then(function(){return s.options.onMutate==null?void 0:s.options.onMutate(s.state.variables)}).then(function(c){c!==s.state.context&&s.dispatch({type:"loading",context:c,variables:s.state.variables})})),o.then(function(){return s.executeMutation()}).then(function(c){n=c,s.mutationCache.config.onSuccess==null||s.mutationCache.config.onSuccess(n,s.state.variables,s.state.context,s)}).then(function(){return s.options.onSuccess==null?void 0:s.options.onSuccess(n,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(n,null,s.state.variables,s.state.context)}).then(function(){return s.dispatch({type:"success",data:n}),n}).catch(function(c){return s.mutationCache.config.onError==null||s.mutationCache.config.onError(c,s.state.variables,s.state.context,s),us().error(c),Promise.resolve().then(function(){return s.options.onError==null?void 0:s.options.onError(c,s.state.variables,s.state.context)}).then(function(){return s.options.onSettled==null?void 0:s.options.onSettled(void 0,c,s.state.variables,s.state.context)}).then(function(){throw s.dispatch({type:"error",error:c}),c})})},a.executeMutation=function(){var s=this,n;return this.retryer=new ms({fn:function(){return s.options.mutationFn?s.options.mutationFn(s.state.variables):Promise.reject("No mutationFn found")},onFail:function(){s.dispatch({type:"failed"})},onPause:function(){s.dispatch({type:"pause"})},onContinue:function(){s.dispatch({type:"continue"})},retry:(n=this.options.retry)!=null?n:0,retryDelay:this.options.retryDelay}),this.retryer.promise},a.dispatch=function(s){var n=this;this.state=Qn(this.state,s),ue.batch(function(){n.observers.forEach(function(l){l.onMutationUpdate(s)}),n.mutationCache.notify(n)})},t}();function Wn(){return{context:void 0,data:void 0,error:null,failureCount:0,isPaused:!1,status:"idle",variables:void 0}}function Qn(t,a){switch(a.type){case"failed":return J({},t,{failureCount:t.failureCount+1});case"pause":return J({},t,{isPaused:!0});case"continue":return J({},t,{isPaused:!1});case"loading":return J({},t,{context:a.context,data:void 0,error:null,isPaused:!1,status:"loading",variables:a.variables});case"success":return J({},t,{data:a.data,error:null,status:"success",isPaused:!1});case"error":return J({},t,{data:void 0,error:a.error,failureCount:t.failureCount+1,isPaused:!1,status:"error"});case"setState":return J({},t,a.state);default:return t}}var Jn=function(t){ua(a,t);function a(s){var n;return n=t.call(this)||this,n.config=s||{},n.mutations=[],n.mutationId=0,n}var r=a.prototype;return r.build=function(n,l,o){var c=new zn({mutationCache:this,mutationId:++this.mutationId,options:n.defaultMutationOptions(l),state:o,defaultOptions:l.mutationKey?n.getMutationDefaults(l.mutationKey):void 0,meta:l.meta});return this.add(c),c},r.add=function(n){this.mutations.push(n),this.notify(n)},r.remove=function(n){this.mutations=this.mutations.filter(function(l){return l!==n}),n.cancel(),this.notify(n)},r.clear=function(){var n=this;ue.batch(function(){n.mutations.forEach(function(l){n.remove(l)})})},r.getAll=function(){return this.mutations},r.find=function(n){return typeof n.exact>"u"&&(n.exact=!0),this.mutations.find(function(l){return xr(n,l)})},r.findAll=function(n){return this.mutations.filter(function(l){return xr(n,l)})},r.notify=function(n){var l=this;ue.batch(function(){l.listeners.forEach(function(o){o(n)})})},r.onFocus=function(){this.resumePausedMutations()},r.onOnline=function(){this.resumePausedMutations()},r.resumePausedMutations=function(){var n=this.mutations.filter(function(l){return l.state.isPaused});return ue.batch(function(){return n.reduce(function(l,o){return l.then(function(){return o.continue().catch(ye)})},Promise.resolve())})},a}(ga);function Yn(){return{onFetch:function(a){a.fetchFn=function(){var r,s,n,l,o,c,f=(r=a.fetchOptions)==null||(s=r.meta)==null?void 0:s.refetchPage,m=(n=a.fetchOptions)==null||(l=n.meta)==null?void 0:l.fetchMore,g=m?.pageParam,d=m?.direction==="forward",y=m?.direction==="backward",b=((o=a.state.data)==null?void 0:o.pages)||[],w=((c=a.state.data)==null?void 0:c.pageParams)||[],h=cs(),x=h?.signal,E=w,N=!1,k=a.options.queryFn||function(){return Promise.reject("Missing queryFn")},v=function(K,z,W,te){return E=te?[z].concat(E):[].concat(E,[z]),te?[W].concat(K):[].concat(K,[W])},F=function(K,z,W,te){if(N)return Promise.reject("Cancelled");if(typeof W>"u"&&!z&&K.length)return Promise.resolve(K);var le={queryKey:a.queryKey,signal:x,pageParam:W,meta:a.meta},oe=k(le),Ee=Promise.resolve(oe).then(function(ft){return v(K,W,ft,te)});if(ta(oe)){var Se=Ee;Se.cancel=oe.cancel}return Ee},R;if(!b.length)R=F([]);else if(d){var M=typeof g<"u",C=M?g:wr(a.options,b);R=F(b,M,C)}else if(y){var I=typeof g<"u",u=I?g:Zn(a.options,b);R=F(b,I,u,!0)}else(function(){E=[];var $=typeof a.options.getNextPageParam>"u",K=f&&b[0]?f(b[0],0,b):!0;R=K?F([],$,w[0]):Promise.resolve(v([],w[0],b[0]));for(var z=function(le){R=R.then(function(oe){var Ee=f&&b[le]?f(b[le],le,b):!0;if(Ee){var Se=$?w[le]:wr(a.options,oe);return F(oe,$,Se)}return Promise.resolve(v(oe,w[le],b[le]))})},W=1;W<b.length;W++)z(W)})();var L=R.then(function($){return{pages:$,pageParams:E}}),j=L;return j.cancel=function(){N=!0,h?.abort(),ta(R)&&R.cancel()},L}}}}function wr(t,a){return t.getNextPageParam==null?void 0:t.getNextPageParam(a[a.length-1],a)}function Zn(t,a){return t.getPreviousPageParam==null?void 0:t.getPreviousPageParam(a[0],a)}var Xn=function(){function t(r){r===void 0&&(r={}),this.queryCache=r.queryCache||new Hn,this.mutationCache=r.mutationCache||new Jn,this.defaultOptions=r.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[]}var a=t.prototype;return a.mount=function(){var s=this;this.unsubscribeFocus=Vt.subscribe(function(){Vt.isFocused()&&Kt.isOnline()&&(s.mutationCache.onFocus(),s.queryCache.onFocus())}),this.unsubscribeOnline=Kt.subscribe(function(){Vt.isFocused()&&Kt.isOnline()&&(s.mutationCache.onOnline(),s.queryCache.onOnline())})},a.unmount=function(){var s,n;(s=this.unsubscribeFocus)==null||s.call(this),(n=this.unsubscribeOnline)==null||n.call(this)},a.isFetching=function(s,n){var l=We(s,n),o=l[0];return o.fetching=!0,this.queryCache.findAll(o).length},a.isMutating=function(s){return this.mutationCache.findAll(J({},s,{fetching:!0})).length},a.getQueryData=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state.data},a.getQueriesData=function(s){return this.getQueryCache().findAll(s).map(function(n){var l=n.queryKey,o=n.state,c=o.data;return[l,c]})},a.setQueryData=function(s,n,l){var o=Ra(s),c=this.defaultQueryOptions(o);return this.queryCache.build(this,c).setData(n,l)},a.setQueriesData=function(s,n,l){var o=this;return ue.batch(function(){return o.getQueryCache().findAll(s).map(function(c){var f=c.queryKey;return[f,o.setQueryData(f,n,l)]})})},a.getQueryState=function(s,n){var l;return(l=this.queryCache.find(s,n))==null?void 0:l.state},a.removeQueries=function(s,n){var l=We(s,n),o=l[0],c=this.queryCache;ue.batch(function(){c.findAll(o).forEach(function(f){c.remove(f)})})},a.resetQueries=function(s,n,l){var o=this,c=We(s,n,l),f=c[0],m=c[1],g=this.queryCache,d=J({},f,{active:!0});return ue.batch(function(){return g.findAll(f).forEach(function(y){y.reset()}),o.refetchQueries(d,m)})},a.cancelQueries=function(s,n,l){var o=this,c=We(s,n,l),f=c[0],m=c[1],g=m===void 0?{}:m;typeof g.revert>"u"&&(g.revert=!0);var d=ue.batch(function(){return o.queryCache.findAll(f).map(function(y){return y.cancel(g)})});return Promise.all(d).then(ye).catch(ye)},a.invalidateQueries=function(s,n,l){var o,c,f,m=this,g=We(s,n,l),d=g[0],y=g[1],b=J({},d,{active:(o=(c=d.refetchActive)!=null?c:d.active)!=null?o:!0,inactive:(f=d.refetchInactive)!=null?f:!1});return ue.batch(function(){return m.queryCache.findAll(d).forEach(function(w){w.invalidate()}),m.refetchQueries(b,y)})},a.refetchQueries=function(s,n,l){var o=this,c=We(s,n,l),f=c[0],m=c[1],g=ue.batch(function(){return o.queryCache.findAll(f).map(function(y){return y.fetch(void 0,J({},m,{meta:{refetchPage:f?.refetchPage}}))})}),d=Promise.all(g).then(ye);return m?.throwOnError||(d=d.catch(ye)),d},a.fetchQuery=function(s,n,l){var o=Ra(s,n,l),c=this.defaultQueryOptions(o);typeof c.retry>"u"&&(c.retry=!1);var f=this.queryCache.build(this,c);return f.isStaleByTime(c.staleTime)?f.fetch(c):Promise.resolve(f.state.data)},a.prefetchQuery=function(s,n,l){return this.fetchQuery(s,n,l).then(ye).catch(ye)},a.fetchInfiniteQuery=function(s,n,l){var o=Ra(s,n,l);return o.behavior=Yn(),this.fetchQuery(o)},a.prefetchInfiniteQuery=function(s,n,l){return this.fetchInfiniteQuery(s,n,l).then(ye).catch(ye)},a.cancelMutations=function(){var s=this,n=ue.batch(function(){return s.mutationCache.getAll().map(function(l){return l.cancel()})});return Promise.all(n).then(ye).catch(ye)},a.resumePausedMutations=function(){return this.getMutationCache().resumePausedMutations()},a.executeMutation=function(s){return this.mutationCache.build(this,s).execute()},a.getQueryCache=function(){return this.queryCache},a.getMutationCache=function(){return this.mutationCache},a.getDefaultOptions=function(){return this.defaultOptions},a.setDefaultOptions=function(s){this.defaultOptions=s},a.setQueryDefaults=function(s,n){var l=this.queryDefaults.find(function(o){return Ze(s)===Ze(o.queryKey)});l?l.defaultOptions=n:this.queryDefaults.push({queryKey:s,defaultOptions:n})},a.getQueryDefaults=function(s){var n;return s?(n=this.queryDefaults.find(function(l){return ea(s,l.queryKey)}))==null?void 0:n.defaultOptions:void 0},a.setMutationDefaults=function(s,n){var l=this.mutationDefaults.find(function(o){return Ze(s)===Ze(o.mutationKey)});l?l.defaultOptions=n:this.mutationDefaults.push({mutationKey:s,defaultOptions:n})},a.getMutationDefaults=function(s){var n;return s?(n=this.mutationDefaults.find(function(l){return ea(s,l.mutationKey)}))==null?void 0:n.defaultOptions:void 0},a.defaultQueryOptions=function(s){if(s?._defaulted)return s;var n=J({},this.defaultOptions.queries,this.getQueryDefaults(s?.queryKey),s,{_defaulted:!0});return!n.queryHash&&n.queryKey&&(n.queryHash=tr(n.queryKey,n)),n},a.defaultQueryObserverOptions=function(s){return this.defaultQueryOptions(s)},a.defaultMutationOptions=function(s){return s?._defaulted?s:J({},this.defaultOptions.mutations,this.getMutationDefaults(s?.mutationKey),s,{_defaulted:!0})},a.clear=function(){this.queryCache.clear(),this.mutationCache.clear()},t}(),el=sn.unstable_batchedUpdates;ue.setBatchNotifyFunction(el);var tl=console;Bn(tl);var Sr=e.createContext(void 0),al=e.createContext(!1);function rl(t){return t&&typeof window<"u"?(window.ReactQueryClientContext||(window.ReactQueryClientContext=Sr),window.ReactQueryClientContext):Sr}var sl=function(a){var r=a.client,s=a.contextSharing,n=s===void 0?!1:s,l=a.children;e.useEffect(function(){return r.mount(),function(){r.unmount()}},[r]);var o=rl(n);return e.createElement(al.Provider,{value:n},e.createElement(o.Provider,{value:r},l))};const nl={},kr=t=>{let a;const r=new Set,s=(g,d)=>{const y=typeof g=="function"?g(a):g;if(!Object.is(y,a)){const b=a;a=d??(typeof y!="object"||y===null)?y:Object.assign({},a,y),r.forEach(w=>w(a,b))}},n=()=>a,f={setState:s,getState:n,getInitialState:()=>m,subscribe:g=>(r.add(g),()=>r.delete(g)),destroy:()=>{(nl?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},m=a=t(s,n,f);return f},ll=t=>t?kr(t):kr;var gs={exports:{}},fs={},ps={exports:{}},ys={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mt=P;function ol(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var cl=typeof Object.is=="function"?Object.is:ol,il=mt.useState,ml=mt.useEffect,dl=mt.useLayoutEffect,ul=mt.useDebugValue;function gl(t,a){var r=a(),s=il({inst:{value:r,getSnapshot:a}}),n=s[0].inst,l=s[1];return dl(function(){n.value=r,n.getSnapshot=a,Oa(n)&&l({inst:n})},[t,r,a]),ml(function(){return Oa(n)&&l({inst:n}),t(function(){Oa(n)&&l({inst:n})})},[t]),ul(r),r}function Oa(t){var a=t.getSnapshot;t=t.value;try{var r=a();return!cl(t,r)}catch{return!0}}function fl(t,a){return a()}var pl=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?fl:gl;ys.useSyncExternalStore=mt.useSyncExternalStore!==void 0?mt.useSyncExternalStore:pl;ps.exports=ys;var yl=ps.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pa=P,hl=yl;function bl(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var El=typeof Object.is=="function"?Object.is:bl,xl=hl.useSyncExternalStore,vl=pa.useRef,Nl=pa.useEffect,wl=pa.useMemo,Sl=pa.useDebugValue;fs.useSyncExternalStoreWithSelector=function(t,a,r,s,n){var l=vl(null);if(l.current===null){var o={hasValue:!1,value:null};l.current=o}else o=l.current;l=wl(function(){function f(b){if(!m){if(m=!0,g=b,b=s(b),n!==void 0&&o.hasValue){var w=o.value;if(n(w,b))return d=w}return d=b}if(w=d,El(g,b))return w;var h=s(b);return n!==void 0&&n(w,h)?(g=b,w):(g=b,d=h)}var m=!1,g,d,y=r===void 0?null:r;return[function(){return f(a())},y===null?void 0:function(){return f(y())}]},[a,r,s,n]);var c=xl(t,l[0],l[1]);return Nl(function(){o.hasValue=!0,o.value=c},[c]),Sl(c),c};gs.exports=fs;var kl=gs.exports;const Cl=nn(kl),hs={},{useDebugValue:Pl}=e,{useSyncExternalStoreWithSelector:Al}=Cl;let Cr=!1;const Dl=t=>t;function Rl(t,a=Dl,r){(hs?"production":void 0)!=="production"&&r&&!Cr&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Cr=!0);const s=Al(t.subscribe,t.getState,t.getServerState||t.getInitialState,a,r);return Pl(s),s}const Fl=t=>{(hs?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const a=typeof t=="function"?ll(t):t,r=(s,n)=>Rl(a,s,n);return Object.assign(r,a),r},bs=t=>Fl,Ol={};function Tl(t,a){let r;try{r=t()}catch{return}return{getItem:n=>{var l;const o=f=>f===null?null:JSON.parse(f,void 0),c=(l=r.getItem(n))!=null?l:null;return c instanceof Promise?c.then(o):o(c)},setItem:(n,l)=>r.setItem(n,JSON.stringify(l,void 0)),removeItem:n=>r.removeItem(n)}}const Ct=t=>a=>{try{const r=t(a);return r instanceof Promise?r:{then(s){return Ct(s)(r)},catch(s){return this}}}catch(r){return{then(s){return this},catch(s){return Ct(s)(r)}}}},Il=(t,a)=>(r,s,n)=>{let l={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:x=>x,version:0,merge:(x,E)=>({...E,...x}),...a},o=!1;const c=new Set,f=new Set;let m;try{m=l.getStorage()}catch{}if(!m)return t((...x)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...x)},s,n);const g=Ct(l.serialize),d=()=>{const x=l.partialize({...s()});let E;const N=g({state:x,version:l.version}).then(k=>m.setItem(l.name,k)).catch(k=>{E=k});if(E)throw E;return N},y=n.setState;n.setState=(x,E)=>{y(x,E),d()};const b=t((...x)=>{r(...x),d()},s,n);let w;const h=()=>{var x;if(!m)return;o=!1,c.forEach(N=>N(s()));const E=((x=l.onRehydrateStorage)==null?void 0:x.call(l,s()))||void 0;return Ct(m.getItem.bind(m))(l.name).then(N=>{if(N)return l.deserialize(N)}).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==l.version){if(l.migrate)return l.migrate(N.state,N.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return N.state}).then(N=>{var k;return w=l.merge(N,(k=s())!=null?k:b),r(w,!0),d()}).then(()=>{E?.(w,void 0),o=!0,f.forEach(N=>N(w))}).catch(N=>{E?.(void 0,N)})};return n.persist={setOptions:x=>{l={...l,...x},x.getStorage&&(m=x.getStorage())},clearStorage:()=>{m?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>h(),hasHydrated:()=>o,onHydrate:x=>(c.add(x),()=>{c.delete(x)}),onFinishHydration:x=>(f.add(x),()=>{f.delete(x)})},h(),w||b},_l=(t,a)=>(r,s,n)=>{let l={storage:Tl(()=>localStorage),partialize:h=>h,version:0,merge:(h,x)=>({...x,...h}),...a},o=!1;const c=new Set,f=new Set;let m=l.storage;if(!m)return t((...h)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),r(...h)},s,n);const g=()=>{const h=l.partialize({...s()});return m.setItem(l.name,{state:h,version:l.version})},d=n.setState;n.setState=(h,x)=>{d(h,x),g()};const y=t((...h)=>{r(...h),g()},s,n);n.getInitialState=()=>y;let b;const w=()=>{var h,x;if(!m)return;o=!1,c.forEach(N=>{var k;return N((k=s())!=null?k:y)});const E=((x=l.onRehydrateStorage)==null?void 0:x.call(l,(h=s())!=null?h:y))||void 0;return Ct(m.getItem.bind(m))(l.name).then(N=>{if(N)if(typeof N.version=="number"&&N.version!==l.version){if(l.migrate)return[!0,l.migrate(N.state,N.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,N.state];return[!1,void 0]}).then(N=>{var k;const[v,F]=N;if(b=l.merge(F,(k=s())!=null?k:y),r(b,!0),v)return g()}).then(()=>{E?.(b,void 0),b=s(),o=!0,f.forEach(N=>N(b))}).catch(N=>{E?.(void 0,N)})};return n.persist={setOptions:h=>{l={...l,...h},h.storage&&(m=h.storage)},clearStorage:()=>{m?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:h=>(c.add(h),()=>{c.delete(h)}),onFinishHydration:h=>(f.add(h),()=>{f.delete(h)})},l.skipHydration||w(),b||y},Ml=(t,a)=>"getStorage"in a||"serialize"in a||"deserialize"in a?((Ol?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),Il(t,a)):_l(t,a),Es=Ml;function xs(t,a){return function(){return t.apply(a,arguments)}}const{toString:Ll}=Object.prototype,{getPrototypeOf:ar}=Object,{iterator:ya,toStringTag:vs}=Symbol,ha=(t=>a=>{const r=Ll.call(a);return t[r]||(t[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Me=t=>(t=t.toLowerCase(),a=>ha(a)===t),ba=t=>a=>typeof a===t,{isArray:dt}=Array,Pt=ba("undefined");function Rt(t){return t!==null&&!Pt(t)&&t.constructor!==null&&!Pt(t.constructor)&&Ne(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Ns=Me("ArrayBuffer");function jl(t){let a;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?a=ArrayBuffer.isView(t):a=t&&t.buffer&&Ns(t.buffer),a}const Ul=ba("string"),Ne=ba("function"),ws=ba("number"),Ft=t=>t!==null&&typeof t=="object",ql=t=>t===!0||t===!1,Bt=t=>{if(ha(t)!=="object")return!1;const a=ar(t);return(a===null||a===Object.prototype||Object.getPrototypeOf(a)===null)&&!(vs in t)&&!(ya in t)},$l=t=>{if(!Ft(t)||Rt(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Vl=Me("Date"),Kl=Me("File"),Bl=Me("Blob"),Gl=Me("FileList"),Hl=t=>Ft(t)&&Ne(t.pipe),zl=t=>{let a;return t&&(typeof FormData=="function"&&t instanceof FormData||Ne(t.append)&&((a=ha(t))==="formdata"||a==="object"&&Ne(t.toString)&&t.toString()==="[object FormData]"))},Wl=Me("URLSearchParams"),[Ql,Jl,Yl,Zl]=["ReadableStream","Request","Response","Headers"].map(Me),Xl=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Ot(t,a,{allOwnKeys:r=!1}={}){if(t===null||typeof t>"u")return;let s,n;if(typeof t!="object"&&(t=[t]),dt(t))for(s=0,n=t.length;s<n;s++)a.call(null,t[s],s,t);else{if(Rt(t))return;const l=r?Object.getOwnPropertyNames(t):Object.keys(t),o=l.length;let c;for(s=0;s<o;s++)c=l[s],a.call(null,t[c],c,t)}}function Ss(t,a){if(Rt(t))return null;a=a.toLowerCase();const r=Object.keys(t);let s=r.length,n;for(;s-- >0;)if(n=r[s],a===n.toLowerCase())return n;return null}const Xe=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ks=t=>!Pt(t)&&t!==Xe;function Ba(){const{caseless:t}=ks(this)&&this||{},a={},r=(s,n)=>{const l=t&&Ss(a,n)||n;Bt(a[l])&&Bt(s)?a[l]=Ba(a[l],s):Bt(s)?a[l]=Ba({},s):dt(s)?a[l]=s.slice():a[l]=s};for(let s=0,n=arguments.length;s<n;s++)arguments[s]&&Ot(arguments[s],r);return a}const eo=(t,a,r,{allOwnKeys:s}={})=>(Ot(a,(n,l)=>{r&&Ne(n)?t[l]=xs(n,r):t[l]=n},{allOwnKeys:s}),t),to=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),ao=(t,a,r,s)=>{t.prototype=Object.create(a.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:a.prototype}),r&&Object.assign(t.prototype,r)},ro=(t,a,r,s)=>{let n,l,o;const c={};if(a=a||{},t==null)return a;do{for(n=Object.getOwnPropertyNames(t),l=n.length;l-- >0;)o=n[l],(!s||s(o,t,a))&&!c[o]&&(a[o]=t[o],c[o]=!0);t=r!==!1&&ar(t)}while(t&&(!r||r(t,a))&&t!==Object.prototype);return a},so=(t,a,r)=>{t=String(t),(r===void 0||r>t.length)&&(r=t.length),r-=a.length;const s=t.indexOf(a,r);return s!==-1&&s===r},no=t=>{if(!t)return null;if(dt(t))return t;let a=t.length;if(!ws(a))return null;const r=new Array(a);for(;a-- >0;)r[a]=t[a];return r},lo=(t=>a=>t&&a instanceof t)(typeof Uint8Array<"u"&&ar(Uint8Array)),oo=(t,a)=>{const s=(t&&t[ya]).call(t);let n;for(;(n=s.next())&&!n.done;){const l=n.value;a.call(t,l[0],l[1])}},co=(t,a)=>{let r;const s=[];for(;(r=t.exec(a))!==null;)s.push(r);return s},io=Me("HTMLFormElement"),mo=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,s,n){return s.toUpperCase()+n}),Pr=(({hasOwnProperty:t})=>(a,r)=>t.call(a,r))(Object.prototype),uo=Me("RegExp"),Cs=(t,a)=>{const r=Object.getOwnPropertyDescriptors(t),s={};Ot(r,(n,l)=>{let o;(o=a(n,l,t))!==!1&&(s[l]=o||n)}),Object.defineProperties(t,s)},go=t=>{Cs(t,(a,r)=>{if(Ne(t)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const s=t[r];if(Ne(s)){if(a.enumerable=!1,"writable"in a){a.writable=!1;return}a.set||(a.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},fo=(t,a)=>{const r={},s=n=>{n.forEach(l=>{r[l]=!0})};return dt(t)?s(t):s(String(t).split(a)),r},po=()=>{},yo=(t,a)=>t!=null&&Number.isFinite(t=+t)?t:a;function ho(t){return!!(t&&Ne(t.append)&&t[vs]==="FormData"&&t[ya])}const bo=t=>{const a=new Array(10),r=(s,n)=>{if(Ft(s)){if(a.indexOf(s)>=0)return;if(Rt(s))return s;if(!("toJSON"in s)){a[n]=s;const l=dt(s)?[]:{};return Ot(s,(o,c)=>{const f=r(o,n+1);!Pt(f)&&(l[c]=f)}),a[n]=void 0,l}}return s};return r(t,0)},Eo=Me("AsyncFunction"),xo=t=>t&&(Ft(t)||Ne(t))&&Ne(t.then)&&Ne(t.catch),Ps=((t,a)=>t?setImmediate:a?((r,s)=>(Xe.addEventListener("message",({source:n,data:l})=>{n===Xe&&l===r&&s.length&&s.shift()()},!1),n=>{s.push(n),Xe.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Ne(Xe.postMessage)),vo=typeof queueMicrotask<"u"?queueMicrotask.bind(Xe):typeof process<"u"&&process.nextTick||Ps,No=t=>t!=null&&Ne(t[ya]),D={isArray:dt,isArrayBuffer:Ns,isBuffer:Rt,isFormData:zl,isArrayBufferView:jl,isString:Ul,isNumber:ws,isBoolean:ql,isObject:Ft,isPlainObject:Bt,isEmptyObject:$l,isReadableStream:Ql,isRequest:Jl,isResponse:Yl,isHeaders:Zl,isUndefined:Pt,isDate:Vl,isFile:Kl,isBlob:Bl,isRegExp:uo,isFunction:Ne,isStream:Hl,isURLSearchParams:Wl,isTypedArray:lo,isFileList:Gl,forEach:Ot,merge:Ba,extend:eo,trim:Xl,stripBOM:to,inherits:ao,toFlatObject:ro,kindOf:ha,kindOfTest:Me,endsWith:so,toArray:no,forEachEntry:oo,matchAll:co,isHTMLForm:io,hasOwnProperty:Pr,hasOwnProp:Pr,reduceDescriptors:Cs,freezeMethods:go,toObjectSet:fo,toCamelCase:mo,noop:po,toFiniteNumber:yo,findKey:Ss,global:Xe,isContextDefined:ks,isSpecCompliantForm:ho,toJSONObject:bo,isAsyncFn:Eo,isThenable:xo,setImmediate:Ps,asap:vo,isIterable:No};function G(t,a,r,s,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",a&&(this.code=a),r&&(this.config=r),s&&(this.request=s),n&&(this.response=n,this.status=n.status?n.status:null)}D.inherits(G,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:D.toJSONObject(this.config),code:this.code,status:this.status}}});const As=G.prototype,Ds={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Ds[t]={value:t}});Object.defineProperties(G,Ds);Object.defineProperty(As,"isAxiosError",{value:!0});G.from=(t,a,r,s,n,l)=>{const o=Object.create(As);return D.toFlatObject(t,o,function(f){return f!==Error.prototype},c=>c!=="isAxiosError"),G.call(o,t.message,a,r,s,n),o.cause=t,o.name=t.name,l&&Object.assign(o,l),o};const wo=null;function Ga(t){return D.isPlainObject(t)||D.isArray(t)}function Rs(t){return D.endsWith(t,"[]")?t.slice(0,-2):t}function Ar(t,a,r){return t?t.concat(a).map(function(n,l){return n=Rs(n),!r&&l?"["+n+"]":n}).join(r?".":""):a}function So(t){return D.isArray(t)&&!t.some(Ga)}const ko=D.toFlatObject(D,{},null,function(a){return/^is[A-Z]/.test(a)});function Ea(t,a,r){if(!D.isObject(t))throw new TypeError("target must be an object");a=a||new FormData,r=D.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(h,x){return!D.isUndefined(x[h])});const s=r.metaTokens,n=r.visitor||g,l=r.dots,o=r.indexes,f=(r.Blob||typeof Blob<"u"&&Blob)&&D.isSpecCompliantForm(a);if(!D.isFunction(n))throw new TypeError("visitor must be a function");function m(w){if(w===null)return"";if(D.isDate(w))return w.toISOString();if(D.isBoolean(w))return w.toString();if(!f&&D.isBlob(w))throw new G("Blob is not supported. Use a Buffer instead.");return D.isArrayBuffer(w)||D.isTypedArray(w)?f&&typeof Blob=="function"?new Blob([w]):Buffer.from(w):w}function g(w,h,x){let E=w;if(w&&!x&&typeof w=="object"){if(D.endsWith(h,"{}"))h=s?h:h.slice(0,-2),w=JSON.stringify(w);else if(D.isArray(w)&&So(w)||(D.isFileList(w)||D.endsWith(h,"[]"))&&(E=D.toArray(w)))return h=Rs(h),E.forEach(function(k,v){!(D.isUndefined(k)||k===null)&&a.append(o===!0?Ar([h],v,l):o===null?h:h+"[]",m(k))}),!1}return Ga(w)?!0:(a.append(Ar(x,h,l),m(w)),!1)}const d=[],y=Object.assign(ko,{defaultVisitor:g,convertValue:m,isVisitable:Ga});function b(w,h){if(!D.isUndefined(w)){if(d.indexOf(w)!==-1)throw Error("Circular reference detected in "+h.join("."));d.push(w),D.forEach(w,function(E,N){(!(D.isUndefined(E)||E===null)&&n.call(a,E,D.isString(N)?N.trim():N,h,y))===!0&&b(E,h?h.concat(N):[N])}),d.pop()}}if(!D.isObject(t))throw new TypeError("data must be an object");return b(t),a}function Dr(t){const a={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return a[s]})}function rr(t,a){this._pairs=[],t&&Ea(t,this,a)}const Fs=rr.prototype;Fs.append=function(a,r){this._pairs.push([a,r])};Fs.toString=function(a){const r=a?function(s){return a.call(this,s,Dr)}:Dr;return this._pairs.map(function(n){return r(n[0])+"="+r(n[1])},"").join("&")};function Co(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Os(t,a,r){if(!a)return t;const s=r&&r.encode||Co;D.isFunction(r)&&(r={serialize:r});const n=r&&r.serialize;let l;if(n?l=n(a,r):l=D.isURLSearchParams(a)?a.toString():new rr(a,r).toString(s),l){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+l}return t}class Rr{constructor(){this.handlers=[]}use(a,r,s){return this.handlers.push({fulfilled:a,rejected:r,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(a){this.handlers[a]&&(this.handlers[a]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(a){D.forEach(this.handlers,function(s){s!==null&&a(s)})}}const Ts={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Po=typeof URLSearchParams<"u"?URLSearchParams:rr,Ao=typeof FormData<"u"?FormData:null,Do=typeof Blob<"u"?Blob:null,Ro={isBrowser:!0,classes:{URLSearchParams:Po,FormData:Ao,Blob:Do},protocols:["http","https","file","blob","url","data"]},sr=typeof window<"u"&&typeof document<"u",Ha=typeof navigator=="object"&&navigator||void 0,Fo=sr&&(!Ha||["ReactNative","NativeScript","NS"].indexOf(Ha.product)<0),Oo=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",To=sr&&window.location.href||"http://localhost",Io=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:sr,hasStandardBrowserEnv:Fo,hasStandardBrowserWebWorkerEnv:Oo,navigator:Ha,origin:To},Symbol.toStringTag,{value:"Module"})),ge={...Io,...Ro};function _o(t,a){return Ea(t,new ge.classes.URLSearchParams,{visitor:function(r,s,n,l){return ge.isNode&&D.isBuffer(r)?(this.append(s,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...a})}function Mo(t){return D.matchAll(/\w+|\[(\w*)]/g,t).map(a=>a[0]==="[]"?"":a[1]||a[0])}function Lo(t){const a={},r=Object.keys(t);let s;const n=r.length;let l;for(s=0;s<n;s++)l=r[s],a[l]=t[l];return a}function Is(t){function a(r,s,n,l){let o=r[l++];if(o==="__proto__")return!0;const c=Number.isFinite(+o),f=l>=r.length;return o=!o&&D.isArray(n)?n.length:o,f?(D.hasOwnProp(n,o)?n[o]=[n[o],s]:n[o]=s,!c):((!n[o]||!D.isObject(n[o]))&&(n[o]=[]),a(r,s,n[o],l)&&D.isArray(n[o])&&(n[o]=Lo(n[o])),!c)}if(D.isFormData(t)&&D.isFunction(t.entries)){const r={};return D.forEachEntry(t,(s,n)=>{a(Mo(s),n,r,0)}),r}return null}function jo(t,a,r){if(D.isString(t))try{return(a||JSON.parse)(t),D.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(r||JSON.stringify)(t)}const Tt={transitional:Ts,adapter:["xhr","http","fetch"],transformRequest:[function(a,r){const s=r.getContentType()||"",n=s.indexOf("application/json")>-1,l=D.isObject(a);if(l&&D.isHTMLForm(a)&&(a=new FormData(a)),D.isFormData(a))return n?JSON.stringify(Is(a)):a;if(D.isArrayBuffer(a)||D.isBuffer(a)||D.isStream(a)||D.isFile(a)||D.isBlob(a)||D.isReadableStream(a))return a;if(D.isArrayBufferView(a))return a.buffer;if(D.isURLSearchParams(a))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),a.toString();let c;if(l){if(s.indexOf("application/x-www-form-urlencoded")>-1)return _o(a,this.formSerializer).toString();if((c=D.isFileList(a))||s.indexOf("multipart/form-data")>-1){const f=this.env&&this.env.FormData;return Ea(c?{"files[]":a}:a,f&&new f,this.formSerializer)}}return l||n?(r.setContentType("application/json",!1),jo(a)):a}],transformResponse:[function(a){const r=this.transitional||Tt.transitional,s=r&&r.forcedJSONParsing,n=this.responseType==="json";if(D.isResponse(a)||D.isReadableStream(a))return a;if(a&&D.isString(a)&&(s&&!this.responseType||n)){const o=!(r&&r.silentJSONParsing)&&n;try{return JSON.parse(a)}catch(c){if(o)throw c.name==="SyntaxError"?G.from(c,G.ERR_BAD_RESPONSE,this,null,this.response):c}}return a}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ge.classes.FormData,Blob:ge.classes.Blob},validateStatus:function(a){return a>=200&&a<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};D.forEach(["delete","get","head","post","put","patch"],t=>{Tt.headers[t]={}});const Uo=D.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),qo=t=>{const a={};let r,s,n;return t&&t.split(`
`).forEach(function(o){n=o.indexOf(":"),r=o.substring(0,n).trim().toLowerCase(),s=o.substring(n+1).trim(),!(!r||a[r]&&Uo[r])&&(r==="set-cookie"?a[r]?a[r].push(s):a[r]=[s]:a[r]=a[r]?a[r]+", "+s:s)}),a},Fr=Symbol("internals");function Et(t){return t&&String(t).trim().toLowerCase()}function Gt(t){return t===!1||t==null?t:D.isArray(t)?t.map(Gt):String(t)}function $o(t){const a=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=r.exec(t);)a[s[1]]=s[2];return a}const Vo=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Ta(t,a,r,s,n){if(D.isFunction(s))return s.call(this,a,r);if(n&&(a=r),!!D.isString(a)){if(D.isString(s))return a.indexOf(s)!==-1;if(D.isRegExp(s))return s.test(a)}}function Ko(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(a,r,s)=>r.toUpperCase()+s)}function Bo(t,a){const r=D.toCamelCase(" "+a);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+r,{value:function(n,l,o){return this[s].call(this,a,n,l,o)},configurable:!0})})}let we=class{constructor(a){a&&this.set(a)}set(a,r,s){const n=this;function l(c,f,m){const g=Et(f);if(!g)throw new Error("header name must be a non-empty string");const d=D.findKey(n,g);(!d||n[d]===void 0||m===!0||m===void 0&&n[d]!==!1)&&(n[d||f]=Gt(c))}const o=(c,f)=>D.forEach(c,(m,g)=>l(m,g,f));if(D.isPlainObject(a)||a instanceof this.constructor)o(a,r);else if(D.isString(a)&&(a=a.trim())&&!Vo(a))o(qo(a),r);else if(D.isObject(a)&&D.isIterable(a)){let c={},f,m;for(const g of a){if(!D.isArray(g))throw TypeError("Object iterator must return a key-value pair");c[m=g[0]]=(f=c[m])?D.isArray(f)?[...f,g[1]]:[f,g[1]]:g[1]}o(c,r)}else a!=null&&l(r,a,s);return this}get(a,r){if(a=Et(a),a){const s=D.findKey(this,a);if(s){const n=this[s];if(!r)return n;if(r===!0)return $o(n);if(D.isFunction(r))return r.call(this,n,s);if(D.isRegExp(r))return r.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(a,r){if(a=Et(a),a){const s=D.findKey(this,a);return!!(s&&this[s]!==void 0&&(!r||Ta(this,this[s],s,r)))}return!1}delete(a,r){const s=this;let n=!1;function l(o){if(o=Et(o),o){const c=D.findKey(s,o);c&&(!r||Ta(s,s[c],c,r))&&(delete s[c],n=!0)}}return D.isArray(a)?a.forEach(l):l(a),n}clear(a){const r=Object.keys(this);let s=r.length,n=!1;for(;s--;){const l=r[s];(!a||Ta(this,this[l],l,a,!0))&&(delete this[l],n=!0)}return n}normalize(a){const r=this,s={};return D.forEach(this,(n,l)=>{const o=D.findKey(s,l);if(o){r[o]=Gt(n),delete r[l];return}const c=a?Ko(l):String(l).trim();c!==l&&delete r[l],r[c]=Gt(n),s[c]=!0}),this}concat(...a){return this.constructor.concat(this,...a)}toJSON(a){const r=Object.create(null);return D.forEach(this,(s,n)=>{s!=null&&s!==!1&&(r[n]=a&&D.isArray(s)?s.join(", "):s)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([a,r])=>a+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(a){return a instanceof this?a:new this(a)}static concat(a,...r){const s=new this(a);return r.forEach(n=>s.set(n)),s}static accessor(a){const s=(this[Fr]=this[Fr]={accessors:{}}).accessors,n=this.prototype;function l(o){const c=Et(o);s[c]||(Bo(n,o),s[c]=!0)}return D.isArray(a)?a.forEach(l):l(a),this}};we.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);D.reduceDescriptors(we.prototype,({value:t},a)=>{let r=a[0].toUpperCase()+a.slice(1);return{get:()=>t,set(s){this[r]=s}}});D.freezeMethods(we);function Ia(t,a){const r=this||Tt,s=a||r,n=we.from(s.headers);let l=s.data;return D.forEach(t,function(c){l=c.call(r,l,n.normalize(),a?a.status:void 0)}),n.normalize(),l}function _s(t){return!!(t&&t.__CANCEL__)}function ut(t,a,r){G.call(this,t??"canceled",G.ERR_CANCELED,a,r),this.name="CanceledError"}D.inherits(ut,G,{__CANCEL__:!0});function Ms(t,a,r){const s=r.config.validateStatus;!r.status||!s||s(r.status)?t(r):a(new G("Request failed with status code "+r.status,[G.ERR_BAD_REQUEST,G.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Go(t){const a=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return a&&a[1]||""}function Ho(t,a){t=t||10;const r=new Array(t),s=new Array(t);let n=0,l=0,o;return a=a!==void 0?a:1e3,function(f){const m=Date.now(),g=s[l];o||(o=m),r[n]=f,s[n]=m;let d=l,y=0;for(;d!==n;)y+=r[d++],d=d%t;if(n=(n+1)%t,n===l&&(l=(l+1)%t),m-o<a)return;const b=g&&m-g;return b?Math.round(y*1e3/b):void 0}}function zo(t,a){let r=0,s=1e3/a,n,l;const o=(m,g=Date.now())=>{r=g,n=null,l&&(clearTimeout(l),l=null),t(...m)};return[(...m)=>{const g=Date.now(),d=g-r;d>=s?o(m,g):(n=m,l||(l=setTimeout(()=>{l=null,o(n)},s-d)))},()=>n&&o(n)]}const aa=(t,a,r=3)=>{let s=0;const n=Ho(50,250);return zo(l=>{const o=l.loaded,c=l.lengthComputable?l.total:void 0,f=o-s,m=n(f),g=o<=c;s=o;const d={loaded:o,total:c,progress:c?o/c:void 0,bytes:f,rate:m||void 0,estimated:m&&c&&g?(c-o)/m:void 0,event:l,lengthComputable:c!=null,[a?"download":"upload"]:!0};t(d)},r)},Or=(t,a)=>{const r=t!=null;return[s=>a[0]({lengthComputable:r,total:t,loaded:s}),a[1]]},Tr=t=>(...a)=>D.asap(()=>t(...a)),Wo=ge.hasStandardBrowserEnv?((t,a)=>r=>(r=new URL(r,ge.origin),t.protocol===r.protocol&&t.host===r.host&&(a||t.port===r.port)))(new URL(ge.origin),ge.navigator&&/(msie|trident)/i.test(ge.navigator.userAgent)):()=>!0,Qo=ge.hasStandardBrowserEnv?{write(t,a,r,s,n,l){const o=[t+"="+encodeURIComponent(a)];D.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),D.isString(s)&&o.push("path="+s),D.isString(n)&&o.push("domain="+n),l===!0&&o.push("secure"),document.cookie=o.join("; ")},read(t){const a=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return a?decodeURIComponent(a[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Jo(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function Yo(t,a){return a?t.replace(/\/?\/$/,"")+"/"+a.replace(/^\/+/,""):t}function Ls(t,a,r){let s=!Jo(a);return t&&(s||r==!1)?Yo(t,a):a}const Ir=t=>t instanceof we?{...t}:t;function nt(t,a){a=a||{};const r={};function s(m,g,d,y){return D.isPlainObject(m)&&D.isPlainObject(g)?D.merge.call({caseless:y},m,g):D.isPlainObject(g)?D.merge({},g):D.isArray(g)?g.slice():g}function n(m,g,d,y){if(D.isUndefined(g)){if(!D.isUndefined(m))return s(void 0,m,d,y)}else return s(m,g,d,y)}function l(m,g){if(!D.isUndefined(g))return s(void 0,g)}function o(m,g){if(D.isUndefined(g)){if(!D.isUndefined(m))return s(void 0,m)}else return s(void 0,g)}function c(m,g,d){if(d in a)return s(m,g);if(d in t)return s(void 0,m)}const f={url:l,method:l,data:l,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:c,headers:(m,g,d)=>n(Ir(m),Ir(g),d,!0)};return D.forEach(Object.keys({...t,...a}),function(g){const d=f[g]||n,y=d(t[g],a[g],g);D.isUndefined(y)&&d!==c||(r[g]=y)}),r}const js=t=>{const a=nt({},t);let{data:r,withXSRFToken:s,xsrfHeaderName:n,xsrfCookieName:l,headers:o,auth:c}=a;a.headers=o=we.from(o),a.url=Os(Ls(a.baseURL,a.url,a.allowAbsoluteUrls),t.params,t.paramsSerializer),c&&o.set("Authorization","Basic "+btoa((c.username||"")+":"+(c.password?unescape(encodeURIComponent(c.password)):"")));let f;if(D.isFormData(r)){if(ge.hasStandardBrowserEnv||ge.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((f=o.getContentType())!==!1){const[m,...g]=f?f.split(";").map(d=>d.trim()).filter(Boolean):[];o.setContentType([m||"multipart/form-data",...g].join("; "))}}if(ge.hasStandardBrowserEnv&&(s&&D.isFunction(s)&&(s=s(a)),s||s!==!1&&Wo(a.url))){const m=n&&l&&Qo.read(l);m&&o.set(n,m)}return a},Zo=typeof XMLHttpRequest<"u",Xo=Zo&&function(t){return new Promise(function(r,s){const n=js(t);let l=n.data;const o=we.from(n.headers).normalize();let{responseType:c,onUploadProgress:f,onDownloadProgress:m}=n,g,d,y,b,w;function h(){b&&b(),w&&w(),n.cancelToken&&n.cancelToken.unsubscribe(g),n.signal&&n.signal.removeEventListener("abort",g)}let x=new XMLHttpRequest;x.open(n.method.toUpperCase(),n.url,!0),x.timeout=n.timeout;function E(){if(!x)return;const k=we.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),F={data:!c||c==="text"||c==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:k,config:t,request:x};Ms(function(M){r(M),h()},function(M){s(M),h()},F),x=null}"onloadend"in x?x.onloadend=E:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(E)},x.onabort=function(){x&&(s(new G("Request aborted",G.ECONNABORTED,t,x)),x=null)},x.onerror=function(){s(new G("Network Error",G.ERR_NETWORK,t,x)),x=null},x.ontimeout=function(){let v=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const F=n.transitional||Ts;n.timeoutErrorMessage&&(v=n.timeoutErrorMessage),s(new G(v,F.clarifyTimeoutError?G.ETIMEDOUT:G.ECONNABORTED,t,x)),x=null},l===void 0&&o.setContentType(null),"setRequestHeader"in x&&D.forEach(o.toJSON(),function(v,F){x.setRequestHeader(F,v)}),D.isUndefined(n.withCredentials)||(x.withCredentials=!!n.withCredentials),c&&c!=="json"&&(x.responseType=n.responseType),m&&([y,w]=aa(m,!0),x.addEventListener("progress",y)),f&&x.upload&&([d,b]=aa(f),x.upload.addEventListener("progress",d),x.upload.addEventListener("loadend",b)),(n.cancelToken||n.signal)&&(g=k=>{x&&(s(!k||k.type?new ut(null,t,x):k),x.abort(),x=null)},n.cancelToken&&n.cancelToken.subscribe(g),n.signal&&(n.signal.aborted?g():n.signal.addEventListener("abort",g)));const N=Go(n.url);if(N&&ge.protocols.indexOf(N)===-1){s(new G("Unsupported protocol "+N+":",G.ERR_BAD_REQUEST,t));return}x.send(l||null)})},ec=(t,a)=>{const{length:r}=t=t?t.filter(Boolean):[];if(a||r){let s=new AbortController,n;const l=function(m){if(!n){n=!0,c();const g=m instanceof Error?m:this.reason;s.abort(g instanceof G?g:new ut(g instanceof Error?g.message:g))}};let o=a&&setTimeout(()=>{o=null,l(new G(`timeout ${a} of ms exceeded`,G.ETIMEDOUT))},a);const c=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(m=>{m.unsubscribe?m.unsubscribe(l):m.removeEventListener("abort",l)}),t=null)};t.forEach(m=>m.addEventListener("abort",l));const{signal:f}=s;return f.unsubscribe=()=>D.asap(c),f}},tc=function*(t,a){let r=t.byteLength;if(r<a){yield t;return}let s=0,n;for(;s<r;)n=s+a,yield t.slice(s,n),s=n},ac=async function*(t,a){for await(const r of rc(t))yield*tc(r,a)},rc=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const a=t.getReader();try{for(;;){const{done:r,value:s}=await a.read();if(r)break;yield s}}finally{await a.cancel()}},_r=(t,a,r,s)=>{const n=ac(t,a);let l=0,o,c=f=>{o||(o=!0,s&&s(f))};return new ReadableStream({async pull(f){try{const{done:m,value:g}=await n.next();if(m){c(),f.close();return}let d=g.byteLength;if(r){let y=l+=d;r(y)}f.enqueue(new Uint8Array(g))}catch(m){throw c(m),m}},cancel(f){return c(f),n.return()}},{highWaterMark:2})},xa=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Us=xa&&typeof ReadableStream=="function",sc=xa&&(typeof TextEncoder=="function"?(t=>a=>t.encode(a))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),qs=(t,...a)=>{try{return!!t(...a)}catch{return!1}},nc=Us&&qs(()=>{let t=!1;const a=new Request(ge.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!a}),Mr=64*1024,za=Us&&qs(()=>D.isReadableStream(new Response("").body)),ra={stream:za&&(t=>t.body)};xa&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(a=>{!ra[a]&&(ra[a]=D.isFunction(t[a])?r=>r[a]():(r,s)=>{throw new G(`Response type '${a}' is not supported`,G.ERR_NOT_SUPPORT,s)})})})(new Response);const lc=async t=>{if(t==null)return 0;if(D.isBlob(t))return t.size;if(D.isSpecCompliantForm(t))return(await new Request(ge.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(D.isArrayBufferView(t)||D.isArrayBuffer(t))return t.byteLength;if(D.isURLSearchParams(t)&&(t=t+""),D.isString(t))return(await sc(t)).byteLength},oc=async(t,a)=>{const r=D.toFiniteNumber(t.getContentLength());return r??lc(a)},cc=xa&&(async t=>{let{url:a,method:r,data:s,signal:n,cancelToken:l,timeout:o,onDownloadProgress:c,onUploadProgress:f,responseType:m,headers:g,withCredentials:d="same-origin",fetchOptions:y}=js(t);m=m?(m+"").toLowerCase():"text";let b=ec([n,l&&l.toAbortSignal()],o),w;const h=b&&b.unsubscribe&&(()=>{b.unsubscribe()});let x;try{if(f&&nc&&r!=="get"&&r!=="head"&&(x=await oc(g,s))!==0){let F=new Request(a,{method:"POST",body:s,duplex:"half"}),R;if(D.isFormData(s)&&(R=F.headers.get("content-type"))&&g.setContentType(R),F.body){const[M,C]=Or(x,aa(Tr(f)));s=_r(F.body,Mr,M,C)}}D.isString(d)||(d=d?"include":"omit");const E="credentials"in Request.prototype;w=new Request(a,{...y,signal:b,method:r.toUpperCase(),headers:g.normalize().toJSON(),body:s,duplex:"half",credentials:E?d:void 0});let N=await fetch(w,y);const k=za&&(m==="stream"||m==="response");if(za&&(c||k&&h)){const F={};["status","statusText","headers"].forEach(I=>{F[I]=N[I]});const R=D.toFiniteNumber(N.headers.get("content-length")),[M,C]=c&&Or(R,aa(Tr(c),!0))||[];N=new Response(_r(N.body,Mr,M,()=>{C&&C(),h&&h()}),F)}m=m||"text";let v=await ra[D.findKey(ra,m)||"text"](N,t);return!k&&h&&h(),await new Promise((F,R)=>{Ms(F,R,{data:v,headers:we.from(N.headers),status:N.status,statusText:N.statusText,config:t,request:w})})}catch(E){throw h&&h(),E&&E.name==="TypeError"&&/Load failed|fetch/i.test(E.message)?Object.assign(new G("Network Error",G.ERR_NETWORK,t,w),{cause:E.cause||E}):G.from(E,E&&E.code,t,w)}}),Wa={http:wo,xhr:Xo,fetch:cc};D.forEach(Wa,(t,a)=>{if(t){try{Object.defineProperty(t,"name",{value:a})}catch{}Object.defineProperty(t,"adapterName",{value:a})}});const Lr=t=>`- ${t}`,ic=t=>D.isFunction(t)||t===null||t===!1,$s={getAdapter:t=>{t=D.isArray(t)?t:[t];const{length:a}=t;let r,s;const n={};for(let l=0;l<a;l++){r=t[l];let o;if(s=r,!ic(r)&&(s=Wa[(o=String(r)).toLowerCase()],s===void 0))throw new G(`Unknown adapter '${o}'`);if(s)break;n[o||"#"+l]=s}if(!s){const l=Object.entries(n).map(([c,f])=>`adapter ${c} `+(f===!1?"is not supported by the environment":"is not available in the build"));let o=a?l.length>1?`since :
`+l.map(Lr).join(`
`):" "+Lr(l[0]):"as no adapter specified";throw new G("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:Wa};function _a(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new ut(null,t)}function jr(t){return _a(t),t.headers=we.from(t.headers),t.data=Ia.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),$s.getAdapter(t.adapter||Tt.adapter)(t).then(function(s){return _a(t),s.data=Ia.call(t,t.transformResponse,s),s.headers=we.from(s.headers),s},function(s){return _s(s)||(_a(t),s&&s.response&&(s.response.data=Ia.call(t,t.transformResponse,s.response),s.response.headers=we.from(s.response.headers))),Promise.reject(s)})}const Vs="1.11.0",va={};["object","boolean","number","function","string","symbol"].forEach((t,a)=>{va[t]=function(s){return typeof s===t||"a"+(a<1?"n ":" ")+t}});const Ur={};va.transitional=function(a,r,s){function n(l,o){return"[Axios v"+Vs+"] Transitional option '"+l+"'"+o+(s?". "+s:"")}return(l,o,c)=>{if(a===!1)throw new G(n(o," has been removed"+(r?" in "+r:"")),G.ERR_DEPRECATED);return r&&!Ur[o]&&(Ur[o]=!0,console.warn(n(o," has been deprecated since v"+r+" and will be removed in the near future"))),a?a(l,o,c):!0}};va.spelling=function(a){return(r,s)=>(console.warn(`${s} is likely a misspelling of ${a}`),!0)};function mc(t,a,r){if(typeof t!="object")throw new G("options must be an object",G.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let n=s.length;for(;n-- >0;){const l=s[n],o=a[l];if(o){const c=t[l],f=c===void 0||o(c,l,t);if(f!==!0)throw new G("option "+l+" must be "+f,G.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new G("Unknown option "+l,G.ERR_BAD_OPTION)}}const Ht={assertOptions:mc,validators:va},Le=Ht.validators;let tt=class{constructor(a){this.defaults=a||{},this.interceptors={request:new Rr,response:new Rr}}async request(a,r){try{return await this._request(a,r)}catch(s){if(s instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const l=n.stack?n.stack.replace(/^.+\n/,""):"";try{s.stack?l&&!String(s.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+l):s.stack=l}catch{}}throw s}}_request(a,r){typeof a=="string"?(r=r||{},r.url=a):r=a||{},r=nt(this.defaults,r);const{transitional:s,paramsSerializer:n,headers:l}=r;s!==void 0&&Ht.assertOptions(s,{silentJSONParsing:Le.transitional(Le.boolean),forcedJSONParsing:Le.transitional(Le.boolean),clarifyTimeoutError:Le.transitional(Le.boolean)},!1),n!=null&&(D.isFunction(n)?r.paramsSerializer={serialize:n}:Ht.assertOptions(n,{encode:Le.function,serialize:Le.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),Ht.assertOptions(r,{baseUrl:Le.spelling("baseURL"),withXsrfToken:Le.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let o=l&&D.merge(l.common,l[r.method]);l&&D.forEach(["delete","get","head","post","put","patch","common"],w=>{delete l[w]}),r.headers=we.concat(o,l);const c=[];let f=!0;this.interceptors.request.forEach(function(h){typeof h.runWhen=="function"&&h.runWhen(r)===!1||(f=f&&h.synchronous,c.unshift(h.fulfilled,h.rejected))});const m=[];this.interceptors.response.forEach(function(h){m.push(h.fulfilled,h.rejected)});let g,d=0,y;if(!f){const w=[jr.bind(this),void 0];for(w.unshift(...c),w.push(...m),y=w.length,g=Promise.resolve(r);d<y;)g=g.then(w[d++],w[d++]);return g}y=c.length;let b=r;for(d=0;d<y;){const w=c[d++],h=c[d++];try{b=w(b)}catch(x){h.call(this,x);break}}try{g=jr.call(this,b)}catch(w){return Promise.reject(w)}for(d=0,y=m.length;d<y;)g=g.then(m[d++],m[d++]);return g}getUri(a){a=nt(this.defaults,a);const r=Ls(a.baseURL,a.url,a.allowAbsoluteUrls);return Os(r,a.params,a.paramsSerializer)}};D.forEach(["delete","get","head","options"],function(a){tt.prototype[a]=function(r,s){return this.request(nt(s||{},{method:a,url:r,data:(s||{}).data}))}});D.forEach(["post","put","patch"],function(a){function r(s){return function(l,o,c){return this.request(nt(c||{},{method:a,headers:s?{"Content-Type":"multipart/form-data"}:{},url:l,data:o}))}}tt.prototype[a]=r(),tt.prototype[a+"Form"]=r(!0)});let dc=class Ks{constructor(a){if(typeof a!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const s=this;this.promise.then(n=>{if(!s._listeners)return;let l=s._listeners.length;for(;l-- >0;)s._listeners[l](n);s._listeners=null}),this.promise.then=n=>{let l;const o=new Promise(c=>{s.subscribe(c),l=c}).then(n);return o.cancel=function(){s.unsubscribe(l)},o},a(function(l,o,c){s.reason||(s.reason=new ut(l,o,c),r(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(a){if(this.reason){a(this.reason);return}this._listeners?this._listeners.push(a):this._listeners=[a]}unsubscribe(a){if(!this._listeners)return;const r=this._listeners.indexOf(a);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const a=new AbortController,r=s=>{a.abort(s)};return this.subscribe(r),a.signal.unsubscribe=()=>this.unsubscribe(r),a.signal}static source(){let a;return{token:new Ks(function(n){a=n}),cancel:a}}};function uc(t){return function(r){return t.apply(null,r)}}function gc(t){return D.isObject(t)&&t.isAxiosError===!0}const Qa={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Qa).forEach(([t,a])=>{Qa[a]=t});function Bs(t){const a=new tt(t),r=xs(tt.prototype.request,a);return D.extend(r,tt.prototype,a,{allOwnKeys:!0}),D.extend(r,a,null,{allOwnKeys:!0}),r.create=function(n){return Bs(nt(t,n))},r}const V=Bs(Tt);V.Axios=tt;V.CanceledError=ut;V.CancelToken=dc;V.isCancel=_s;V.VERSION=Vs;V.toFormData=Ea;V.AxiosError=G;V.Cancel=V.CanceledError;V.all=function(a){return Promise.all(a)};V.spread=uc;V.isAxiosError=gc;V.mergeConfig=nt;V.AxiosHeaders=we;V.formToJSON=t=>Is(D.isHTMLForm(t)?new FormData(t):t);V.getAdapter=$s.getAdapter;V.HttpStatusCode=Qa;V.default=V;const{Axios:Ii,AxiosError:_i,CanceledError:Mi,isCancel:Li,CancelToken:ji,VERSION:Ui,all:qi,Cancel:$i,isAxiosError:Vi,spread:Ki,toFormData:Bi,AxiosHeaders:Gi,HttpStatusCode:Hi,formToJSON:zi,getAdapter:Wi,mergeConfig:Qi}=V,fc=!0,sa="/api";console.log(" API Configuration:",{VITE_API_URL:"/api",API_BASE_URL:sa,MODE:"production",PROD:!0,isProduction:fc,hostname:window.location.hostname});const xe=V.create({baseURL:sa,timeout:15e3,headers:{"Content-Type":"application/json"}});xe.interceptors.request.use(t=>{const a=localStorage.getItem("authToken");return a&&(t.headers.Authorization=`Bearer ${a}`),t});xe.interceptors.response.use(t=>t,t=>{const a=t.response?.status,r=t.response?.data;if(typeof r=="string"&&r.includes("<!DOCTYPE html>")){const n=r.match(/<pre>(.*?)<\/pre>/),l=n?n[1]:"Server endpoint not found";console.error(`API Error (${a}):`,l),t.friendlyMessage=l,t.isEndpointMissing=a===404,t.message=l}else if(typeof r=="object"&&r!==null){const n=r.message||r.error||"Unknown server error";console.error(`API Error (${a}):`,n),t.friendlyMessage=n,t.message=n}else{const n=r||t.message||"Network error";console.error(`API Error (${a}):`,n),t.friendlyMessage=n}return Promise.reject(t)});const ae={login:async t=>(await xe.post("/auth/login",t)).data,register:async t=>(await xe.post("/auth/register",t)).data,getProducts:async t=>{const a=t?`/marketplace/products?${t}`:"/products";return(await xe.get(a)).data},getProduct:async t=>(await xe.get(`/marketplace/products/${t}`)).data,getCategories:async()=>(await xe.get("/marketplace/categories")).data,getCounties:async()=>(await xe.get("/marketplace/counties")).data,getHealth:async()=>(await xe.get("/status")).data,get:async t=>(console.log(` API GET: ${sa}${t}`),await xe.get(t)),post:async(t,a)=>(console.log(` API POST: ${sa}${t}`),await xe.post(t,a)),put:async(t,a)=>await xe.put(t,a),delete:async t=>await xe.delete(t),patch:async(t,a)=>await xe.patch(t,a)},X=bs()(Es((t,a)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,login:async(r,s)=>{try{t({isLoading:!0}),console.log(" Login attempt:",{phone:r});const n=await ae.login({phone:r,password:s});console.log(" Login success:",n);const{user:l,token:o}=n;localStorage.setItem("authToken",o),t({user:l,token:o,isAuthenticated:!0,isLoading:!1})}catch(n){console.error(" Login error:",n),console.error(" Error message:",n.message),console.error(" Error response data:",n.response?.data),console.error(" Error status:",n.response?.status),console.error(" Error status text:",n.response?.statusText),console.error(" Error URL:",n.config?.url),console.error(" Error code:",n.code),console.error(" Error name:",n.name),console.error(" Full error object:",JSON.stringify(n,null,2)),t({isLoading:!1});let l="Login failed";throw n.code==="ERR_NETWORK"||n.name==="AxiosError"&&!n.response?l="Cannot connect to server. Please check if the backend is running.":n.code==="ECONNREFUSED"?l="Connection refused. Server may be down.":n.response?.status===401?l="Invalid phone number or password":n.response?.status===400?l=n.response.data?.error||"Invalid request":n.response?.data?.error?l=n.response.data.error:n.response?.data?.message?l=n.response.data.message:n.message&&n.message!=="[object Object]"&&(l=n.message),console.error(" Final error message:",l),new Error(l)}},loginWithData:(r,s)=>{localStorage.setItem("authToken",s),t({user:r,token:s,isAuthenticated:!0})},logout:()=>{localStorage.removeItem("authToken"),t({user:null,token:null,isAuthenticated:!1})},updateUser:r=>{t({user:r})}}),{name:"auth-storage",partialize:t=>({user:t.user,token:t.token,isAuthenticated:t.isAuthenticated})}));class pc extends P.Component{state={hasError:!1};static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,r){console.error("Error caught by boundary:",a,r)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-50"},e.createElement("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-6 text-center"},e.createElement("div",{className:"text-red-500 text-6xl mb-4"},""),e.createElement("h1",{className:"text-xl font-semibold text-gray-900 mb-2"},"Something went wrong"),e.createElement("p",{className:"text-gray-600 mb-4"},this.state.error?.message||"An unexpected error occurred"),e.createElement("button",{onClick:()=>{this.setState({hasError:!1,error:void 0}),window.location.reload()},className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors"},"Reload Page"))):this.props.children}}const yc=()=>{window.addEventListener("unhandledrejection",t=>{}),window.addEventListener("error",t=>{})},ce=t=>{const a=Number(t);return isNaN(a)||!isFinite(a)?0:a},hc=bs()(Es((t,a)=>({items:[],totalItems:0,totalAmount:0,addToCart:(r,s)=>{const n=a(),l=ce(s),o=ce(r.pricePerUnit);if(l<=0)return;if(n.items.find(f=>f.productId===r.id)){const f=n.items.map(d=>d.productId===r.id?{...d,quantity:ce(d.quantity)+l}:d),m=f.reduce((d,y)=>d+ce(y.quantity),0),g=f.reduce((d,y)=>d+ce(y.pricePerUnit)*ce(y.quantity),0);t({items:f,totalItems:m,totalAmount:g})}else{const f={id:`cart-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,productId:r.id||`product-${Date.now()}`,name:r.name||"Unknown Product",pricePerUnit:o,quantity:l,images:Array.isArray(r.images)?r.images:[],unit:r.unit||"kg"},m=[...n.items,f],g=m.reduce((y,b)=>y+ce(b.quantity),0),d=m.reduce((y,b)=>y+ce(b.pricePerUnit)*ce(b.quantity),0);t({items:m,totalItems:g,totalAmount:d})}},removeFromCart:r=>{const n=a().items.filter(c=>c.id!==r),l=n.reduce((c,f)=>c+ce(f.quantity),0),o=n.reduce((c,f)=>c+ce(f.pricePerUnit)*ce(f.quantity),0);t({items:n,totalItems:l,totalAmount:o})},updateQuantity:(r,s)=>{const n=a(),l=ce(s);if(l<=0){a().removeFromCart(r);return}const o=n.items.map(m=>m.id===r?{...m,quantity:l}:m),c=o.reduce((m,g)=>m+ce(g.quantity),0),f=o.reduce((m,g)=>m+ce(g.pricePerUnit)*ce(g.quantity),0);t({items:o,totalItems:c,totalAmount:f})},clearCart:()=>{t({items:[],totalItems:0,totalAmount:0})},refreshCart:()=>{const r=a(),s=r.items.reduce((l,o)=>l+ce(o.quantity),0),n=r.items.reduce((l,o)=>l+ce(o.pricePerUnit)*ce(o.quantity),0);t({totalItems:s,totalAmount:n})}}),{name:"cart-storage",partialize:t=>({items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount})})),gt=()=>{const t=hc();return{cart:{items:t.items,totalItems:t.totalItems,totalAmount:t.totalAmount},addToCart:t.addToCart,removeFromCart:t.removeFromCart,updateQuantity:t.updateQuantity,clearCart:t.clearCart,refreshCart:t.refreshCart,isLoading:!1}};function bc(){const{isAuthenticated:t,user:a,logout:r}=X(),{cart:s}=gt(),n=_e(),[l,o]=P.useState(!1),c=()=>{r(),n("/"),o(!1)},f=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/"}},m=()=>{o(!1)};return e.createElement("nav",{className:"bg-white shadow-sm border-b sticky top-0 z-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"flex justify-between h-16"},e.createElement("div",{className:"flex items-center"},e.createElement(H,{to:"/",className:"flex items-center space-x-2",onClick:m},e.createElement("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center overflow-hidden"},e.createElement("img",{src:"https://cdn.builder.io/api/v1/image/assets%2Fd9c4872a6831464dbf1ea37e56217255%2F25be9c7c97144293ad2d62bc18c010f8?format=webp&width=800",alt:"Zuasoko Logo",className:"w-full h-full object-contain"})),e.createElement("span",{className:"text-lg sm:text-xl font-bold text-gray-900"},"Zuasoko"))),e.createElement("div",{className:"hidden md:flex items-center space-x-6"},e.createElement(H,{to:"/marketplace",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(H,{to:f(),className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Dashboard"),e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement("span",{className:"text-sm text-gray-600"},a?.firstName),e.createElement("button",{onClick:c,className:"text-gray-700 hover:text-red-600 p-2 rounded-md transition-colors"},e.createElement(ur,{className:"w-4 h-4"})))):e.createElement("div",{className:"flex items-center space-x-3"},e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement(H,{to:"/login",className:"text-gray-700 hover:text-primary-600 px-3 py-2 rounded-md text-sm font-medium transition-colors"},"Login"),e.createElement(H,{to:"/register",className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors"},"Register"))),e.createElement("div",{className:"md:hidden flex items-center space-x-3"},e.createElement(H,{to:"/cart",className:"relative text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors",onClick:m},e.createElement($e,{className:"w-5 h-5"}),s?.totalItems>0&&e.createElement("span",{className:"absolute -top-1 -right-1 bg-primary-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center"},s.totalItems)),e.createElement("button",{onClick:()=>o(!l),className:"text-gray-700 hover:text-primary-600 p-2 rounded-md transition-colors"},l?e.createElement(Fe,{className:"w-5 h-5"}):e.createElement(mn,{className:"w-5 h-5"}))))),l&&e.createElement("div",{className:"md:hidden bg-white border-t border-gray-200"},e.createElement("div",{className:"px-2 pt-2 pb-3 space-y-1"},e.createElement(H,{to:"/",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(es,{className:"w-5 h-5"}),"Home"),e.createElement(H,{to:"/marketplace",className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(ts,{className:"w-5 h-5"}),"Marketplace"),t?e.createElement(e.Fragment,null,e.createElement(H,{to:f(),className:"flex items-center gap-3 px-3 py-3 text-base font-medium text-gray-700 hover:bg-gray-50 rounded-md transition-colors",onClick:m},e.createElement(dn,{className:"w-5 h-5"}),"Dashboard"),e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2"},e.createElement("div",{className:"flex items-center gap-3 mb-3"},e.createElement("div",{className:"w-8 h-8 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement(Ae,{className:"w-4 h-4 text-primary-600"})),e.createElement("div",null,e.createElement("div",{className:"text-sm font-medium text-gray-900"},a?.firstName," ",a?.lastName),e.createElement("div",{className:"text-xs text-gray-500 capitalize"},a?.role?.toLowerCase()))),e.createElement("button",{onClick:c,className:"flex items-center gap-3 w-full px-3 py-2 text-base font-medium text-red-600 hover:bg-red-50 rounded-md transition-colors"},e.createElement(ur,{className:"w-5 h-5"}),"Logout"))):e.createElement("div",{className:"px-3 py-3 border-t border-gray-200 mt-2 space-y-2"},e.createElement(H,{to:"/login",className:"block w-full text-center px-4 py-3 text-base font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",onClick:m},"Login"),e.createElement(H,{to:"/register",className:"block w-full text-center px-4 py-3 text-base font-medium text-white bg-primary-600 hover:bg-primary-700 rounded-lg transition-colors",onClick:m},"Register")))))}function Ec(){const{isAuthenticated:t,user:a}=X(),{cart:r}=gt(),s=Xr(),l=(()=>{const c=[{path:"/",icon:es,label:"Home",show:!0},{path:"/marketplace",icon:ts,label:"Shop",show:!0}];if(!t)return[...c,{path:"/cart",icon:$e,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/login",icon:Ae,label:"Login",show:!0}];switch(a?.role){case"CUSTOMER":return[...c,{path:"/cart",icon:$e,label:"Cart",badge:r?.totalItems||0,show:!0},{path:"/customer/dashboard",icon:Ae,label:"Account",show:!0}];case"FARMER":return[...c,{path:"/farmer/consignments",icon:at,label:"Consign",show:!0},{path:"/farmer/wallet",icon:Ae,label:"Wallet",show:!0}];case"DRIVER":return[...c,{path:"/driver/assignments",icon:me,label:"Transport",show:!0},{path:"/driver/warehouse",icon:Ae,label:"Warehouse",show:!0}];case"ADMIN":return[...c,{path:"/admin/consignments",icon:at,label:"Consign",show:!0},{path:"/admin/analytics",icon:Za,label:"Analytics",show:!0}];default:return c}})().filter(c=>c.show),o=c=>!!(c==="/"&&s.pathname==="/"||c!=="/"&&s.pathname.startsWith(c));return e.createElement("div",{className:"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 z-50"},e.createElement("div",{className:"grid grid-cols-4 py-1"},l.map(c=>{const f=c.icon,m=o(c.path);return e.createElement(H,{key:c.path,to:c.path,className:`flex flex-col items-center justify-center py-2 px-1 text-xs font-medium transition-colors ${m?"text-primary-600":"text-gray-500 hover:text-gray-700"}`},e.createElement("div",{className:"relative"},e.createElement(f,{className:`w-5 h-5 ${m?"text-primary-600":"text-gray-500"}`}),"badge"in c&&c.badge&&c.badge>0&&e.createElement("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-4 w-4 flex items-center justify-center min-w-[16px]"},c.badge>99?"99+":c.badge)),e.createElement("span",{className:`mt-1 ${m?"text-primary-600":"text-gray-500"}`},c.label))})),e.createElement("div",{className:"h-safe-bottom bg-white"}))}function xc(){const[t,a]=P.useState({connected:!1,database:"checking...",loading:!0,error:!1});if(P.useEffect(()=>{const l=async()=>{try{const f=await(await fetch("/api/status")).json(),m=f.status==="OK"&&f.database==="connected",g=f.database_type||f.database;a({connected:m,database:g,loading:!1,error:!1})}catch(c){console.warn("Status check failed:",c.message),a({connected:!1,database:"error",loading:!1,error:!0})}};l();const o=setInterval(l,6e4);return()=>clearInterval(o)},[]),t.loading)return null;const r=t.database==="neon_postgresql"||t.connected,s=t.error||t.database.includes("error"),n=t.database==="demo"||!r&&!s;return e.createElement("div",{className:"fixed bottom-4 right-4 z-50"},e.createElement("div",{className:`flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium shadow-lg transition-all duration-300 ${s?"bg-red-100 text-red-800 border border-red-200":r?"bg-green-100 text-green-800 border border-green-200":n?"bg-blue-100 text-blue-800 border border-blue-200":"bg-yellow-100 text-yellow-800 border border-yellow-200"}`},s?e.createElement(e.Fragment,null,e.createElement(lt,{className:"w-4 h-4"}),e.createElement("span",null,"API Error"),e.createElement(gr,{className:"w-4 h-4"})):r?e.createElement(e.Fragment,null,e.createElement(fr,{className:"w-4 h-4"}),e.createElement("span",null,"Neon DB Live"),e.createElement(as,{className:"w-4 h-4"})):e.createElement(e.Fragment,null,e.createElement(fr,{className:"w-4 h-4"}),e.createElement("span",null,"Demo Mode"),e.createElement(gr,{className:"w-4 h-4"}))))}const vc=()=>{const[t,a]=P.useState(!1),[r,s]=P.useState(null),[n,l]=P.useState(!0),o="/downloads/zuasoko-app.apk",c=async()=>{try{const g=(await fetch(o,{method:"HEAD"})).ok;if(g)try{const d=await fetch("/downloads/app-info.json");if(d.ok){const y=await d.json();s(y)}}catch{console.log("App info not available, using defaults")}return a(g),g}catch(m){return console.error("Error checking APK availability:",m),a(!1),!1}},f=()=>{if(t){const m=document.createElement("a");m.href=o,m.download="zuasoko-app.apk",m.target="_blank",document.body.appendChild(m),m.click(),document.body.removeChild(m),window.gtag&&window.gtag("event","app_download",{event_category:"engagement",event_label:"android_apk",value:1});const g=new CustomEvent("show-toast",{detail:{message:"APK download started! Check your downloads folder.",type:"success"}});window.dispatchEvent(g)}};return P.useEffect(()=>{(async()=>{l(!0),await c(),l(!1)})()},[]),{isAvailable:t,appInfo:r,loading:n,downloadUrl:o,checkAvailability:c,downloadApp:f}},Nc=({isOpen:t,onClose:a,appInfo:r,onDownload:s})=>{if(!t)return null;const n=l=>l.toLowerCase().includes("internet")?e.createElement(as,{className:"w-4 h-4"}):l.toLowerCase().includes("location")?e.createElement(Te,{className:"w-4 h-4"}):l.toLowerCase().includes("camera")?e.createElement(rs,{className:"w-4 h-4"}):l.toLowerCase().includes("storage")?e.createElement(pr,{className:"w-4 h-4"}):l.toLowerCase().includes("notification")?e.createElement(rt,{className:"w-4 h-4"}):e.createElement(Oe,{className:"w-4 h-4"});return e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto shadow-2xl"},e.createElement("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 rounded-t-2xl"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center gap-4"},e.createElement("div",{className:"w-16 h-16 bg-primary-600 rounded-2xl flex items-center justify-center shadow-lg"},e.createElement(La,{className:"w-8 h-8 text-white"})),e.createElement("div",null,e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Zuasoko Mobile App"),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-600"},e.createElement("span",null,"Version ",r.version),e.createElement("span",null,""),e.createElement("span",null,r.size),e.createElement("span",null,""),e.createElement("span",null,"Android ",r.minAndroidVersion,"+")))),e.createElement("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors"},e.createElement(Fe,{className:"w-6 h-6 text-gray-600"})))),e.createElement("div",{className:"p-6 space-y-8"},e.createElement("div",{className:"text-center"},e.createElement("button",{onClick:()=>{s(),a()},className:"bg-primary-600 hover:bg-primary-700 text-white px-8 py-4 rounded-xl font-semibold text-lg transition-all duration-300 transform hover:scale-105 shadow-lg flex items-center gap-3 mx-auto"},e.createElement(Wt,{className:"w-6 h-6"}),"Download APK (",r.size,")"),e.createElement("p",{className:"text-sm text-gray-600 mt-3"},"Released on"," ",new Date(r.releaseDate).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2"},e.createElement(At,{className:"w-5 h-5 text-yellow-500"}),"What's New in v",r.version),e.createElement("div",{className:"space-y-2"},r.releaseNotes.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg"},e.createElement(fe,{className:"w-5 h-5 text-green-500 mt-0.5 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"Key Features"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},r.features.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement(fe,{className:"w-4 h-4 text-primary-600 mt-1 flex-shrink-0"}),e.createElement("span",{className:"text-gray-700 text-sm"},l))))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"System Requirements"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("div",{className:"p-4 bg-blue-50 rounded-lg text-center"},e.createElement(La,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Android Version"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.android)),e.createElement("div",{className:"p-4 bg-green-50 rounded-lg text-center"},e.createElement(pr,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"Storage"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.storage)),e.createElement("div",{className:"p-4 bg-purple-50 rounded-lg text-center"},e.createElement(de,{className:"w-8 h-8 text-purple-600 mx-auto mb-2"}),e.createElement("div",{className:"font-semibold text-gray-900"},"RAM"),e.createElement("div",{className:"text-sm text-gray-600"},r.requirements.ram)))),e.createElement("div",null,e.createElement("h3",{className:"text-xl font-bold text-gray-900 mb-4"},"App Permissions"),e.createElement("div",{className:"space-y-3"},r.permissions.map((l,o)=>e.createElement("div",{key:o,className:"flex items-start gap-3 p-3 border border-gray-200 rounded-lg"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg flex-shrink-0"},n(l)),e.createElement("div",null,e.createElement("div",{className:"font-medium text-gray-900"},l.split(" - ")[0]),l.includes(" - ")&&e.createElement("div",{className:"text-sm text-gray-600 mt-1"},l.split(" - ")[1])))))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start gap-3"},e.createElement(Oe,{className:"w-5 h-5 text-yellow-600 mt-0.5"}),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-yellow-800 mb-2"},"Security Notice"),e.createElement("p",{className:"text-sm text-yellow-700"},'This APK is signed and verified by Zuasoko. Before installing, make sure to enable "Install from unknown sources" in your Android settings. Only download from this official source to ensure security and authenticity.')))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h4",{className:"font-semibold text-blue-800 mb-3"},"Installation Instructions"),e.createElement("ol",{className:"text-sm text-blue-700 space-y-2"},e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"1"),"Download the APK file by clicking the download button above"),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"2"),'Go to Settings  Security  Enable "Unknown Sources" or "Install unknown apps"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"3"),'Open the downloaded APK file and tap "Install"'),e.createElement("li",{className:"flex items-start gap-2"},e.createElement("span",{className:"bg-blue-200 text-blue-800 rounded-full w-5 h-5 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5"},"4"),"Open the Zuasoko app and log in with your account"))))))};function wc(){const{isAuthenticated:t,user:a}=X(),[r,s]=P.useState(!1),[n,l]=P.useState(!1),{isAvailable:o,appInfo:c,loading:f,downloadApp:m}=vc(),g=[{icon:e.createElement(ze,{className:"w-8 h-8 text-primary-600"}),title:"Fresh Produce",description:"Direct from farmers to your table, ensuring maximum freshness and quality."},{icon:e.createElement(ke,{className:"w-8 h-8 text-primary-600"}),title:"Support Farmers",description:"Help local farmers get fair prices for their hard work and dedication."},{icon:e.createElement(me,{className:"w-8 h-8 text-primary-600"}),title:"Fast Delivery",description:"Quick and reliable delivery service to get your orders to you fresh."},{icon:e.createElement(At,{className:"w-8 h-8 text-primary-600"}),title:"Quality Assured",description:"All produce is quality-checked before delivery to ensure satisfaction."}],d=[{icon:e.createElement(rt,{className:"w-6 h-6 text-primary-600"}),title:"Push Notifications",description:"Stay updated on orders, deliveries, and fresh produce availability"},{icon:e.createElement(Te,{className:"w-6 h-6 text-primary-600"}),title:"Live Tracking",description:"Track your deliveries in real-time from farm to your doorstep"},{icon:e.createElement(de,{className:"w-6 h-6 text-primary-600"}),title:"Quick Orders",description:"Reorder your favorites with just one tap"},{icon:e.createElement(Ie,{className:"w-6 h-6 text-primary-600"}),title:"Mobile Payments",description:"Secure M-Pesa integration for seamless transactions"}],y=[{role:"Admin",phone:"+254712345678",description:"Manage users, approve farmers, view analytics",icon:e.createElement(Oe,{className:"w-5 h-5"}),color:"bg-red-100 text-red-800 border-red-200"},{role:"Farmer",phone:"+254734567890",description:"Create consignments, manage produce listings",icon:e.createElement(ze,{className:"w-5 h-5"}),color:"bg-green-100 text-green-800 border-green-200"},{role:"Customer",phone:"+254756789012",description:"Browse marketplace, place orders, track deliveries",icon:e.createElement(ke,{className:"w-5 h-5"}),color:"bg-blue-100 text-blue-800 border-blue-200"},{role:"Driver",phone:"+254778901234",description:"Manage deliveries, update delivery status",icon:e.createElement(me,{className:"w-5 h-5"}),color:"bg-purple-100 text-purple-800 border-purple-200"}],b=()=>{switch(a?.role){case"FARMER":return"/farmer/dashboard";case"CUSTOMER":return"/customer/dashboard";case"ADMIN":return"/admin/dashboard";case"DRIVER":return"/driver/dashboard";default:return"/marketplace"}};return e.createElement("div",{className:"min-h-screen bg-white"},e.createElement("section",{className:"bg-gradient-to-br from-primary-50 to-primary-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-4xl md:text-6xl font-bold text-gray-900 mb-6"},"Welcome to ",e.createElement("span",{className:"text-primary-600"},"Zuasoko")),e.createElement("p",{className:"text-xl md:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto"},"Connecting farmers and customers across Kenya. Fresh produce, fair prices, and sustainable agriculture for everyone."),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center mb-8"},t?e.createElement(H,{to:b(),className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Go to Dashboard"):e.createElement(e.Fragment,null,e.createElement(H,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg text-lg font-semibold hover:bg-primary-700 transition-colors"},"Browse Marketplace"),e.createElement(H,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold border-2 border-primary-600 hover:bg-primary-50 transition-colors"},"Join Now"))),!t&&e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("button",{onClick:()=>s(!r),className:"flex items-center justify-center gap-2 mx-auto text-sm text-gray-600 hover:text-gray-800 transition-colors"},e.createElement(un,{className:"w-4 h-4"}),e.createElement("span",null,"View Demo Credentials"),r?e.createElement(gn,{className:"w-4 h-4"}):e.createElement(fn,{className:"w-4 h-4"})),r&&e.createElement("div",{className:"mt-4 p-4 bg-white rounded-lg border border-gray-200 shadow-sm"},e.createElement("h3",{className:"text-sm font-semibold text-gray-900 mb-3 text-center"},"Demo Account Access"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3"},y.map((w,h)=>e.createElement("div",{key:h,className:`p-3 rounded-lg border ${w.color} text-xs`},e.createElement("div",{className:"flex items-center gap-2 mb-1"},w.icon,e.createElement("span",{className:"font-semibold"},w.role)),e.createElement("div",{className:"font-mono text-xs mb-1"},w.phone),e.createElement("div",{className:"text-xs opacity-80"},w.description)))),e.createElement("div",{className:"text-center mt-3 text-xs text-gray-600"},"Password for all accounts:"," ",e.createElement("span",{className:"font-mono font-semibold"},"password123")),e.createElement("div",{className:"text-center mt-2"},e.createElement(H,{to:"/login",className:"inline-flex items-center gap-1 text-xs text-primary-600 hover:text-primary-700 font-medium"},e.createElement(Oe,{className:"w-3 h-3"}),"Login to any demo account"))))))),e.createElement("section",{className:"py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center mb-16"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Why Choose Zuasoko?"),e.createElement("p",{className:"text-xl text-gray-600 max-w-2xl mx-auto"},"We're revolutionizing agriculture in Kenya by creating direct connections between farmers and customers.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8"},g.map((w,h)=>e.createElement("div",{key:h,className:"text-center p-6 rounded-lg border border-gray-200 hover:shadow-lg transition-shadow"},e.createElement("div",{className:"flex justify-center mb-4"},w.icon),e.createElement("h3",{className:"text-xl font-semibold text-gray-900 mb-2"},w.title),e.createElement("p",{className:"text-gray-600"},w.description)))))),e.createElement("section",{className:"bg-gradient-to-br from-gray-50 to-gray-100 py-20"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center"},e.createElement("div",{className:"space-y-8"},e.createElement("div",{className:"text-center lg:text-left"},e.createElement("div",{className:"inline-flex items-center gap-2 bg-primary-100 text-primary-700 px-4 py-2 rounded-full text-sm font-medium mb-4"},e.createElement(La,{className:"w-4 h-4"}),"Now Available on Mobile"),e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4"},"Take Zuasoko"," ",e.createElement("span",{className:"text-primary-600"},"Anywhere")),e.createElement("p",{className:"text-xl text-gray-600 mb-8"},"Access fresh produce, manage your farm, or track deliveries on the go. Our mobile app brings the complete Zuasoko experience to your smartphone.")),e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center lg:justify-start"},e.createElement("button",{onClick:()=>{o?m():alert(`Android app coming soon! 

We're putting the finishing touches on our mobile app. Stay tuned for the official release!`)},disabled:f,className:`group px-6 py-3 rounded-xl flex items-center gap-3 transition-all duration-300 transform hover:scale-105 shadow-lg ${o?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-900 hover:bg-gray-800 text-white"} ${f?"opacity-50 cursor-not-allowed":""}`},e.createElement("div",{className:"bg-white p-1 rounded"},f?e.createElement("div",{className:"w-6 h-6 border-2 border-gray-300 border-t-gray-900 rounded-full animate-spin"}):e.createElement(pn,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},o?"DOWNLOAD":"GET IT ON"),e.createElement("div",{className:"text-lg font-semibold"},o?"Direct APK":"Google Play"),o&&c&&e.createElement("div",{className:"text-xs text-gray-300"},"v",c.version,"  ",c.size)),e.createElement(Wt,{className:"w-4 h-4 ml-2 group-hover:animate-bounce"}),o&&e.createElement("div",{className:"bg-green-400 text-green-900 px-2 py-1 rounded text-xs font-bold ml-2"},"READY")),e.createElement("a",{href:"#",className:"group bg-gray-900 text-white px-6 py-3 rounded-xl flex items-center gap-3 hover:bg-gray-800 transition-all duration-300 transform hover:scale-105 shadow-lg opacity-60 cursor-not-allowed",onClick:w=>{w.preventDefault(),alert(`iOS app coming soon! 

We're working hard to bring Zuasoko to the App Store. Keep an eye out for updates!`)}},e.createElement("div",{className:"bg-white p-1 rounded"},e.createElement(yn,{className:"w-6 h-6 text-gray-900"})),e.createElement("div",{className:"text-left"},e.createElement("div",{className:"text-xs text-gray-300"},"Download on the"),e.createElement("div",{className:"text-lg font-semibold"},"App Store")),e.createElement("div",{className:"bg-yellow-500 text-yellow-900 px-2 py-1 rounded text-xs font-bold ml-2"},"SOON"))),o&&c&&e.createElement("div",{className:"text-center mt-6"},e.createElement("button",{onClick:()=>l(!0),className:"text-primary-600 hover:text-primary-700 font-medium text-sm border border-primary-300 hover:border-primary-500 px-4 py-2 rounded-lg transition-colors"},"View App Details & Permissions")),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4"},d.map((w,h)=>e.createElement("div",{key:h,className:"flex items-start gap-3 p-4 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"flex-shrink-0 p-2 bg-primary-50 rounded-lg"},w.icon),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900 mb-1"},w.title),e.createElement("p",{className:"text-sm text-gray-600"},w.description)))))),e.createElement("div",{className:"relative"},e.createElement("div",{className:"relative mx-auto w-64 h-96 lg:w-80 lg:h-[480px]"},e.createElement("div",{className:"absolute inset-0 bg-gray-900 rounded-[2.5rem] shadow-2xl"},e.createElement("div",{className:"absolute inset-2 bg-white rounded-[2rem] overflow-hidden"},e.createElement("div",{className:"bg-primary-600 h-8 flex items-center justify-between px-4"},e.createElement("div",{className:"text-white text-xs font-medium"},"9:41"),e.createElement("div",{className:"flex items-center gap-1"},e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}),e.createElement("div",{className:"w-1 h-1 bg-white rounded-full"}))),e.createElement("div",{className:"p-4 space-y-4"},e.createElement("div",{className:"flex items-center gap-3 mb-6"},e.createElement("div",{className:"w-10 h-10 bg-primary-600 rounded-xl flex items-center justify-center"},e.createElement(ze,{className:"w-6 h-6 text-white"})),e.createElement("div",null,e.createElement("div",{className:"font-bold text-gray-900"},"Zuasoko"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from farm"))),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-green-200 rounded-lg flex items-center justify-center"},e.createElement(ze,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Organic Tomatoes"),e.createElement("div",{className:"text-xs text-gray-500"},"Fresh from Nakuru"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 120/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-orange-200 rounded-lg flex items-center justify-center"},e.createElement(ze,{className:"w-6 h-6 text-orange-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Fresh Carrots"),e.createElement("div",{className:"text-xs text-gray-500"},"Direct from farm"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 80/kg"))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3"},e.createElement("div",{className:"w-12 h-12 bg-purple-200 rounded-lg flex items-center justify-center"},e.createElement(ze,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"font-medium text-sm"},"Spinach Bunch"),e.createElement("div",{className:"text-xs text-gray-500"},"Locally grown"),e.createElement("div",{className:"text-primary-600 font-bold text-sm"},"KES 50/bunch")))),e.createElement("div",{className:"absolute bottom-4 left-4 right-4 bg-white border border-gray-200 rounded-lg p-2"},e.createElement("div",{className:"flex justify-around"},e.createElement("div",{className:"p-2 bg-primary-600 rounded-lg"},e.createElement(ze,{className:"w-4 h-4 text-white"})),e.createElement("div",{className:"p-2"},e.createElement(Te,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(rt,{className:"w-4 h-4 text-gray-400"})),e.createElement("div",{className:"p-2"},e.createElement(ke,{className:"w-4 h-4 text-gray-400"})))))))),e.createElement("div",{className:"mt-8 text-center"},e.createElement("div",{className:"inline-block p-4 bg-white rounded-xl shadow-lg border border-gray-200"},e.createElement("div",{className:"w-24 h-24 bg-gray-100 rounded-lg flex items-center justify-center mb-3"},e.createElement(hn,{className:"w-12 h-12 text-gray-600"})),e.createElement("div",{className:"text-sm font-medium text-gray-900 mb-1"},"Scan to Download"),e.createElement("div",{className:"text-xs text-gray-500"},"Coming Soon"))),e.createElement("div",{className:"absolute -top-4 -left-4 w-8 h-8 bg-primary-200 rounded-full animate-pulse"}),e.createElement("div",{className:"absolute -bottom-8 -right-8 w-12 h-12 bg-green-200 rounded-full animate-pulse delay-300"}),e.createElement("div",{className:"absolute top-1/2 -right-6 w-6 h-6 bg-yellow-200 rounded-full animate-pulse delay-700"}))))),t&&a?.role==="ADMIN"&&e.createElement("section",{className:"bg-red-50 py-12"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"inline-flex items-center gap-2 mb-4"},e.createElement(Oe,{className:"w-6 h-6 text-red-600"}),e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"Admin Dashboard")),e.createElement("p",{className:"text-gray-600 mb-6"},"Welcome back, Administrator. Manage your platform efficiently."),e.createElement("div",{className:"flex flex-wrap justify-center gap-4"},e.createElement(H,{to:"/admin/dashboard",className:"bg-red-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-red-700 transition-colors"},"View Dashboard"),e.createElement(H,{to:"/admin/users",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"Manage Users"),e.createElement(H,{to:"/admin/analytics",className:"bg-white text-red-600 px-6 py-2 rounded-lg font-medium border border-red-600 hover:bg-red-50 transition-colors"},"View Analytics"))))),e.createElement("section",{className:"bg-primary-600 py-16"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},e.createElement("h2",{className:"text-3xl md:text-4xl font-bold text-white mb-4"},"Ready to Get Started?"),e.createElement("p",{className:"text-xl text-primary-100 mb-8 max-w-2xl mx-auto"},"Join thousands of farmers and customers who are already part of the Zuasoko community."),!t&&e.createElement("div",{className:"flex flex-col sm:flex-row gap-4 justify-center"},e.createElement(H,{to:"/register",className:"bg-white text-primary-600 px-8 py-3 rounded-lg text-lg font-semibold hover:bg-gray-100 transition-colors"},"Register Now"),e.createElement(H,{to:"/login",className:"bg-transparent text-white px-8 py-3 rounded-lg text-lg font-semibold border-2 border-white hover:bg-white hover:text-primary-600 transition-colors"},"Login")))),n&&c&&e.createElement(Nc,{isOpen:n,onClose:()=>l(!1),appInfo:c,onDownload:m}))}function Sc(){const[t,a]=P.useState([]),[r,s]=P.useState([]),[n,l]=P.useState([]),[o,c]=P.useState(!0),[f,m]=P.useState({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1}),[g,d]=P.useState(!1),[y,b]=P.useState({page:1,limit:12,total:0,totalPages:0}),{addToCart:w,isLoading:h}=gt(),{user:x,isAuthenticated:E}=X(),N=async(C=1)=>{try{c(!0),console.log(" FETCHING PRODUCTS - Page:",C,"Filters:",f);const I=new URLSearchParams({page:C.toString(),limit:y.limit.toString(),...f.category&&{category:f.category},...f.county&&{county:f.county},...f.search&&{search:f.search},...f.minPrice&&{minPrice:f.minPrice},...f.maxPrice&&{maxPrice:f.maxPrice},...f.featured&&{featured:"true"}}),u=await ae.getProducts(I);console.log(" PRODUCTS RESPONSE:",u);const L=u.products||u||[];a(Array.isArray(L)?L:[]),u.pagination?b(j=>({...j,...u.pagination,page:C})):b(j=>({...j,page:C,total:u.products?.length||u.length||0,totalPages:1}))}catch(I){console.error(" FAILED TO FETCH PRODUCTS:",I),A.error("Failed to load products - using demo data"),a([]),b(u=>({...u,page:C,total:0,totalPages:1}))}finally{c(!1)}},k=async()=>{try{console.log(" FETCHING METADATA from real database");const[C,I]=await Promise.all([ae.getCategories(),ae.getCounties()]);console.log(" CATEGORIES RESPONSE:",C),console.log(" COUNTIES RESPONSE:",I),s(C.categories||C||[]),l(I.counties||I||[])}catch(C){console.error(" FAILED TO FETCH METADATA:",C),A.error("Failed to load categories and counties from database")}};P.useEffect(()=>{k()},[]),P.useEffect(()=>{N(1)},[f]);const v=(C,I)=>{m(u=>({...u,[C]:I}))},F=C=>{try{w(C,1),A.success(`Added ${C.name} to cart`)}catch(I){console.error("Failed to add to cart:",I),A.error("Failed to add item to cart")}},R=()=>{m({category:"",county:"",search:"",minPrice:"",maxPrice:"",featured:!1})},M=C=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(C);return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Fresh Marketplace"),e.createElement("p",{className:"text-gray-600"},"Discover fresh produce directly from local farmers")),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:space-x-4 space-y-4 lg:space-y-0"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ia,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.createElement("input",{type:"text",placeholder:"Search products...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.search,onChange:C=>v("search",C.target.value)}))),e.createElement("div",{className:"flex flex-wrap gap-2"},e.createElement("button",{onClick:()=>v("featured",!f.featured),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${f.featured?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},e.createElement(At,{className:`w-4 h-4 inline mr-1 ${f.featured?"fill-current":""}`}),"Featured"),e.createElement("button",{onClick:()=>d(!g),className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm font-medium transition-colors"},e.createElement(bn,{className:"w-4 h-4 inline mr-1"}),"Filters"))),g&&e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.category,onChange:C=>v("category",C.target.value)},e.createElement("option",{value:""},"All Categories"),r.map(C=>e.createElement("option",{key:C,value:C},C)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County"),e.createElement("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.county,onChange:C=>v("county",C.target.value)},e.createElement("option",{value:""},"All Counties"),n.map(C=>e.createElement("option",{key:C,value:C},C)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Min Price (KES)"),e.createElement("input",{type:"number",placeholder:"0",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.minPrice,onChange:C=>v("minPrice",C.target.value)})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Max Price (KES)"),e.createElement("input",{type:"number",placeholder:"1000",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:f.maxPrice,onChange:C=>v("maxPrice",C.target.value)}))),e.createElement("div",{className:"mt-4 flex justify-end"},e.createElement("button",{onClick:R,className:"text-gray-600 hover:text-gray-900 text-sm font-medium"},"Clear All Filters")))),e.createElement("div",{className:"flex justify-between items-center mb-6"},e.createElement("p",{className:"text-gray-600"},o?"Loading...":`Showing ${t.length} of ${y.total} products`),y.totalPages>1&&e.createElement("div",{className:"text-sm text-gray-600"},"Page ",y.page," of ",y.totalPages)),o?e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},[...Array(8)].map((C,I)=>e.createElement("div",{key:I,className:"bg-white rounded-lg shadow-sm border overflow-hidden animate-pulse"},e.createElement("div",{className:"h-48 bg-gray-200"}),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"h-4 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-3 bg-gray-200 rounded mb-2"}),e.createElement("div",{className:"h-6 bg-gray-200 rounded"}))))):t.length===0?e.createElement("div",{className:"text-center py-16"},e.createElement("div",{className:"text-gray-400 text-6xl mb-4"},""),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-6"},"Try adjusting your search or filter criteria"),e.createElement("button",{onClick:R,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Clear Filters")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},Array.isArray(t)&&t.map(C=>e.createElement("div",{key:C.id,className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"relative h-48 bg-gray-200"},C.images&&C.images.length>0?e.createElement("img",{src:C.images[0],alt:C.name,className:"w-full h-full object-cover",onError:I=>{I.currentTarget.src="/api/placeholder/300/200?text="+encodeURIComponent(C.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement(Ke,{className:"w-8 h-8 mx-auto mb-2"}),e.createElement("span",{className:"text-sm"},C.name))),(C.isFeatured||C.is_featured)&&e.createElement("div",{className:"absolute top-2 left-2 bg-yellow-400 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"}," Featured"),(C.stockQuantity||C.stock_quantity)<10&&(C.stockQuantity||C.stock_quantity)>0&&e.createElement("div",{className:"absolute top-2 right-2 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium"},"Low Stock"),(C.stockQuantity||C.stock_quantity)===0&&e.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center"},e.createElement("span",{className:"text-white font-medium"},"Out of Stock"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 text-sm line-clamp-2"},C.name),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors ml-2"},e.createElement(Xa,{className:"w-4 h-4"}))),e.createElement("p",{className:"text-gray-600 text-xs mb-2 line-clamp-2"},C.description),e.createElement("div",{className:"flex items-center text-xs text-gray-500 mb-3"},e.createElement(Te,{className:"w-3 h-3 mr-1"}),e.createElement("span",null,C.farmer?.county||C.farmer_county||"Unknown"),e.createElement("span",{className:"mx-2"},""),e.createElement("span",null,C.farmer?.user?.firstName||C.farmer_name||"Farmer"," ",C.farmer?.user?.lastName||"")),C.tags&&C.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-1 mb-3"},C.tags.slice(0,3).map(I=>e.createElement("span",{key:I,className:"bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs"},I))),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("div",{className:"text-lg font-bold text-gray-900"},M(C.pricePerUnit||C.price_per_unit)),e.createElement("div",{className:"text-xs text-gray-500"},"per ",C.unit)),e.createElement("div",{className:"flex space-x-2"},e.createElement(H,{to:`/marketplace/product/${C.id}`,className:"bg-gray-100 text-gray-700 px-2 py-2 rounded-lg hover:bg-gray-200 transition-colors text-sm font-medium flex items-center"},e.createElement(Ke,{className:"w-4 h-4"})),(C.stockQuantity||C.stock_quantity)>0?e.createElement("button",{onClick:()=>F(C),disabled:h,className:"bg-primary-600 text-white px-3 py-2 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors text-sm font-medium flex items-center space-x-1"},e.createElement($e,{className:"w-4 h-4"}),e.createElement("span",null,"Add to Cart")):e.createElement("button",{disabled:!0,className:"bg-gray-300 text-gray-500 px-3 py-2 rounded-lg text-sm font-medium flex items-center space-x-1 cursor-not-allowed"},e.createElement("span",null,"Out of Stock")))))))),y.totalPages>1&&e.createElement("div",{className:"mt-8 flex justify-center"},e.createElement("div",{className:"flex space-x-1"},e.createElement("button",{onClick:()=>N(y.page-1),disabled:y.page===1,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Previous"),[...Array(Math.min(5,y.totalPages))].map((C,I)=>{const u=Math.max(1,y.page-2)+I;return u>y.totalPages?null:e.createElement("button",{key:u,onClick:()=>N(u),className:`px-3 py-2 text-sm font-medium border rounded-md ${u===y.page?"bg-primary-600 text-white border-primary-600":"text-gray-500 bg-white border-gray-300 hover:bg-gray-50"}`},u)}),e.createElement("button",{onClick:()=>N(y.page+1),disabled:y.page===y.totalPages,className:"px-3 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"},"Next"))))}function kc(){const{id:t}=ln(),a=_e(),[r,s]=P.useState(null),[n,l]=P.useState([]),[o,c]=P.useState(!0),[f,m]=P.useState(0),[g,d]=P.useState(1),[y,b]=P.useState(!1),{addToCart:w,isLoading:h}=gt(),{user:x,isAuthenticated:E}=X();P.useEffect(()=>{t&&N()},[t]);const N=async()=>{try{c(!0);const u=await V.get(`/api/marketplace/products/${t}`),L=u.data.product||u.data;s(L),L&&k(L.category,L.farmer.county)}catch(u){console.error("Failed to fetch product:",u),u.response?.status===404?(A.error("Product not found"),a("/marketplace")):A.error("Failed to load product details")}finally{c(!1)}},k=async(u,L)=>{try{const j=await V.get(`/api/marketplace/products?category=${u}&county=${L}&limit=4`),$=j.data.products||j.data;l($.filter(K=>K.id!==t))}catch(j){console.error("Failed to fetch related products:",j)}},v=async()=>{if(!E){A.error("Please login to add items to cart");return}if(x?.role!=="CUSTOMER"){A.error("Only customers can add items to cart");return}if(r)try{await w(r.id,g),d(1)}catch{}},F=async()=>{if(navigator.share)try{await navigator.share({title:r?.name,text:r?.description,url:window.location.href})}catch(u){console.log("Error sharing:",u)}else navigator.clipboard.writeText(window.location.href),A.success("Link copied to clipboard!")},R=u=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(u),M=u=>new Date(u).toLocaleDateString("en-KE",{year:"numeric",month:"long",day:"numeric"}),C=()=>r?r.stockQuantity===0?{text:"Out of Stock",color:"text-red-600",bgColor:"bg-red-100"}:r.stockQuantity<=(r.minStockLevel||5)?{text:"Low Stock",color:"text-orange-600",bgColor:"bg-orange-100"}:{text:"In Stock",color:"text-green-600",bgColor:"bg-green-100"}:null;if(o)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"h-96 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-3/4"}),e.createElement("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),e.createElement("div",{className:"h-12 bg-gray-200 rounded w-1/3"}),e.createElement("div",{className:"h-32 bg-gray-200 rounded"})))));if(!r)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement("h1",{className:"text-2xl font-bold text-gray-900"},"Product not found"),e.createElement(H,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 mt-4 inline-block"},"Back to Marketplace")));const I=C();return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("nav",{className:"flex items-center space-x-2 text-sm text-gray-600 mb-8"},e.createElement(H,{to:"/marketplace",className:"hover:text-gray-900"},"Marketplace"),e.createElement("span",null,"/"),e.createElement("span",{className:"text-gray-900"},r.name)),e.createElement("button",{onClick:()=>a(-1),className:"flex items-center text-gray-600 hover:text-gray-900 mb-6"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Back"),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12"},e.createElement("div",null,e.createElement("div",{className:"aspect-square bg-gray-200 rounded-lg overflow-hidden mb-4"},r.images&&r.images.length>0?e.createElement("img",{src:r.images[f]||r.images[0],alt:r.name,className:"w-full h-full object-cover",onError:u=>{u.currentTarget.src="/api/placeholder/400/400?text="+encodeURIComponent(r.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"text-4xl mb-2"},""),e.createElement("span",null,r.name)))),r.images&&r.images.length>1&&e.createElement("div",{className:"grid grid-cols-4 gap-2"},r.images.slice(0,4).map((u,L)=>e.createElement("button",{key:L,onClick:()=>m(L),className:`aspect-square bg-gray-200 rounded-lg overflow-hidden border-2 ${f===L?"border-primary-600":"border-transparent"}`},e.createElement("img",{src:u,alt:`${r.name} ${L+1}`,className:"w-full h-full object-cover",onError:j=>{j.currentTarget.src="/api/placeholder/100/100?text="+(L+1)}}))))),e.createElement("div",null,e.createElement("div",{className:"flex items-start justify-between mb-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},r.name),e.createElement("p",{className:"text-gray-600"},r.category)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:F,className:"p-2 text-gray-400 hover:text-gray-600 border border-gray-300 rounded-lg"},e.createElement(En,{className:"w-5 h-5"})),e.createElement("button",{className:"p-2 text-gray-400 hover:text-red-500 border border-gray-300 rounded-lg"},e.createElement(Xa,{className:"w-5 h-5"})))),e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"text-3xl font-bold text-gray-900 mb-2"},R(r.pricePerUnit),e.createElement("span",{className:"text-lg font-normal text-gray-600 ml-2"},"per ",r.unit)),I&&e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${I.bgColor} ${I.color}`},I.text),e.createElement("span",{className:"text-gray-600 text-sm"},r.stockQuantity," ",r.unit," available"))),e.createElement("div",{className:"flex flex-wrap gap-2 mb-6"},r.isFeatured&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full text-sm font-medium"}," Featured"),r.tags.map(u=>e.createElement("span",{key:u,className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm"},u))),e.createElement("div",{className:"mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-2"},"Description"),e.createElement("p",{className:"text-gray-700 leading-relaxed"},r.description)),e.createElement("div",{className:"grid grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg"},r.harvestDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Harvest Date"),e.createElement("p",{className:"text-gray-900"},M(r.harvestDate))),r.expiryDate&&e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Best Before"),e.createElement("p",{className:"text-gray-900"},M(r.expiryDate))),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Category"),e.createElement("p",{className:"text-gray-900"},r.category)),e.createElement("div",null,e.createElement("span",{className:"text-sm font-medium text-gray-600"},"Unit"),e.createElement("p",{className:"text-gray-900"},r.unit))),E&&x?.role==="CUSTOMER"&&r.stockQuantity>0&&e.createElement("div",{className:"mb-6"},e.createElement("div",{className:"flex items-center space-x-4 mb-4"},e.createElement("label",{className:"text-sm font-medium text-gray-700"},"Quantity:"),e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>d(Math.max(1,g-1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"-"),e.createElement("input",{type:"number",min:"1",max:r.stockQuantity,value:g,onChange:u=>d(Math.max(1,parseInt(u.target.value)||1)),className:"w-16 px-2 py-2 text-center border-0 focus:ring-0"}),e.createElement("button",{onClick:()=>d(Math.min(r.stockQuantity,g+1)),className:"px-3 py-2 text-gray-600 hover:text-gray-900"},"+")),e.createElement("span",{className:"text-sm text-gray-600"},"Total: ",R(r.pricePerUnit*g))),e.createElement("button",{onClick:v,disabled:h,className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 disabled:opacity-50 transition-colors font-medium flex items-center justify-center"},e.createElement($e,{className:"w-5 h-5 mr-2"}),"Add to Cart")),e.createElement("div",{className:"border-t border-gray-200 pt-6"},e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(me,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Free delivery over KES 1000")),e.createElement("div",{className:"flex items-center"},e.createElement(de,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Delivered within 24h")),e.createElement("div",{className:"flex items-center"},e.createElement(Oe,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},"Quality guaranteed")))))),e.createElement("div",{className:"bg-white border border-gray-200 rounded-lg p-6 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"About the Farmer"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("div",{className:"flex items-center mb-3"},e.createElement("div",{className:"w-12 h-12 bg-primary-100 rounded-full flex items-center justify-center mr-4"},e.createElement("span",{className:"text-primary-600 font-semibold text-lg"},r.farmer.user.firstName[0],r.farmer.user.lastName[0])),e.createElement("div",null,e.createElement("h4",{className:"font-semibold text-gray-900"},r.farmer.user.firstName," ",r.farmer.user.lastName),r.farmer.farmName&&e.createElement("p",{className:"text-gray-600 text-sm"},r.farmer.farmName))),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(Te,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("span",{className:"text-gray-600"},r.farmer.subCounty?`${r.farmer.subCounty}, `:"",r.farmer.county)),r.farmer.farmSize&&e.createElement("div",null,e.createElement("span",{className:"text-gray-600"},"Farm Size: ",r.farmer.farmSize," acres")))),e.createElement("div",null,e.createElement("button",{onClick:()=>b(!y),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium mb-4"},"Contact Farmer"),y&&e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("div",{className:"flex items-center"},e.createElement(Ye,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`tel:${r.farmer.user.phone}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.phone)),r.farmer.user.email&&e.createElement("div",{className:"flex items-center"},e.createElement(ma,{className:"w-4 h-4 text-gray-400 mr-2"}),e.createElement("a",{href:`mailto:${r.farmer.user.email}`,className:"text-primary-600 hover:text-primary-700"},r.farmer.user.email)))))),n.length>0&&e.createElement("div",null,e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-6"},"Related Products"),e.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"},n.map(u=>e.createElement(H,{key:u.id,to:`/marketplace/product/${u.id}`,className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"aspect-square bg-gray-200"},u.images&&u.images.length>0?e.createElement("img",{src:u.images[0],alt:u.name,className:"w-full h-full object-cover",onError:L=>{L.currentTarget.src="/api/placeholder/200/200?text="+encodeURIComponent(u.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400"},"")),e.createElement("div",{className:"p-4"},e.createElement("h4",{className:"font-semibold text-gray-900 text-sm mb-1 line-clamp-2"},u.name),e.createElement("p",{className:"text-xs text-gray-600 mb-2"},u.farmer.county," "," ",u.farmer.user.firstName," ",u.farmer.user.lastName),e.createElement("div",{className:"text-lg font-bold text-gray-900"},R(u.pricePerUnit),e.createElement("span",{className:"text-xs font-normal text-gray-600 ml-1"},"/",u.unit))))))))}function Cc(){const[t,a]=P.useState({phone:"",password:""}),[r,s]=P.useState(!1),{login:n,isLoading:l}=X(),o=_e(),f=Xr().state?.from?.pathname||"/",m=async d=>{d.preventDefault();try{const y=t.phone.trim(),b=t.password.trim();console.log(" LoginPage - About to call login with:",{phone:y,password:b,formData:t}),await n(y,b),A.success("Login successful!");const{user:w}=X.getState();w?.role==="ADMIN"?o("/admin/dashboard",{replace:!0}):w?.role==="FARMER"?o("/farmer/dashboard",{replace:!0}):w?.role==="CUSTOMER"?o("/customer/dashboard",{replace:!0}):w?.role==="DRIVER"?o("/driver/dashboard",{replace:!0}):o(f,{replace:!0})}catch(y){A.error(y.message||"Login failed")}},g=d=>{a({...t,[d.target.name]:d.target.value})};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Sign in to your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(H,{to:"/register",className:"font-medium text-primary-600 hover:text-primary-500"},"create a new account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("form",{className:"space-y-6",onSubmit:m},e.createElement("div",null,e.createElement("label",{htmlFor:"phone",className:"form-label"},"Phone Number"),e.createElement("input",{id:"phone",name:"phone",type:"tel",required:!0,placeholder:"e.g., +254712345678 or 0712345678",className:"form-input",value:t.phone,onChange:g})),e.createElement("div",null,e.createElement("label",{htmlFor:"password",className:"form-label"},"Password"),e.createElement("div",{className:"relative"},e.createElement("input",{id:"password",name:"password",type:r?"text":"password",required:!0,className:"form-input pr-10",value:t.password,onChange:g}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>s(!r)},r?e.createElement(kt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Ke,{className:"h-5 w-5 text-gray-400"})))),e.createElement("div",null,e.createElement("button",{type:"submit",disabled:l,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed"},l?"Signing in...":"Sign in"))),e.createElement("div",{className:"mt-6"},e.createElement("button",{type:"button",onClick:()=>{a({phone:"+254712345678",password:"password123"}),m({preventDefault:()=>{}})},className:"w-full mb-4 bg-green-600 text-white py-2 px-4 rounded-md text-sm font-medium hover:bg-green-700"}," Test Admin Login (+254712345678 / password123)"),e.createElement("div",{className:"relative"},e.createElement("div",{className:"absolute inset-0 flex items-center"},e.createElement("div",{className:"w-full border-t border-gray-300"})),e.createElement("div",{className:"relative flex justify-center text-sm"},e.createElement("span",{className:"px-2 bg-white text-gray-500"},"Demo Accounts"))),e.createElement("div",{className:"mt-4 space-y-2 text-xs text-gray-600"},e.createElement("p",null,e.createElement("strong",null,"Admin:")," +254712345678 / password123"),e.createElement("p",null,e.createElement("strong",null,"Farmer:")," +254734567890 / password123"),e.createElement("p",null,e.createElement("strong",null,"Customer:")," +254756789012 / password123"),e.createElement("p",null,e.createElement("strong",null,"Driver:")," +254778901234 / password123"))))))}var It=t=>t.type==="checkbox",et=t=>t instanceof Date,he=t=>t==null;const Gs=t=>typeof t=="object";var re=t=>!he(t)&&!Array.isArray(t)&&Gs(t)&&!et(t),Pc=t=>re(t)&&t.target?It(t.target)?t.target.checked:t.target.value:t,Ac=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,Dc=(t,a)=>t.has(Ac(a)),Rc=t=>{const a=t.constructor&&t.constructor.prototype;return re(a)&&a.hasOwnProperty("isPrototypeOf")},nr=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ie(t){let a;const r=Array.isArray(t),s=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)a=new Date(t);else if(!(nr&&(t instanceof Blob||s))&&(r||re(t)))if(a=r?[]:Object.create(Object.getPrototypeOf(t)),!r&&!Rc(t))a=t;else for(const n in t)t.hasOwnProperty(n)&&(a[n]=ie(t[n]));else return t;return a}var Na=t=>/^\w*$/.test(t),ne=t=>t===void 0,lr=t=>Array.isArray(t)?t.filter(Boolean):[],or=t=>lr(t.replace(/["|']|\]/g,"").split(/\.|\[/)),U=(t,a,r)=>{if(!a||!re(t))return r;const s=(Na(a)?[a]:or(a)).reduce((n,l)=>he(n)?n:n[l],t);return ne(s)||s===t?ne(t[a])?r:t[a]:s},je=t=>typeof t=="boolean",ee=(t,a,r)=>{let s=-1;const n=Na(a)?[a]:or(a),l=n.length,o=l-1;for(;++s<l;){const c=n[s];let f=r;if(s!==o){const m=t[c];f=re(m)||Array.isArray(m)?m:isNaN(+n[s+1])?{}:[]}if(c==="__proto__"||c==="constructor"||c==="prototype")return;t[c]=f,t=t[c]}};const qr={BLUR:"blur",FOCUS_OUT:"focusout"},De={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ge={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},Fc=e.createContext(null);Fc.displayName="HookFormContext";var Oc=(t,a,r,s=!0)=>{const n={defaultValues:a._defaultValues};for(const l in t)Object.defineProperty(n,l,{get:()=>{const o=l;return a._proxyFormState[o]!==De.all&&(a._proxyFormState[o]=!s||De.all),t[o]}});return n};const Tc=typeof window<"u"?e.useLayoutEffect:e.useEffect;var qe=t=>typeof t=="string",Ic=(t,a,r,s,n)=>qe(t)?(s&&a.watch.add(t),U(r,t,n)):Array.isArray(t)?t.map(l=>(s&&a.watch.add(l),U(r,l))):(s&&(a.watchAll=!0),r),Ja=t=>he(t)||!Gs(t);function Qe(t,a,r=new WeakSet){if(Ja(t)||Ja(a))return t===a;if(et(t)&&et(a))return t.getTime()===a.getTime();const s=Object.keys(t),n=Object.keys(a);if(s.length!==n.length)return!1;if(r.has(t)||r.has(a))return!0;r.add(t),r.add(a);for(const l of s){const o=t[l];if(!n.includes(l))return!1;if(l!=="ref"){const c=a[l];if(et(o)&&et(c)||re(o)&&re(c)||Array.isArray(o)&&Array.isArray(c)?!Qe(o,c,r):o!==c)return!1}}return!0}var _c=(t,a,r,s,n)=>a?{...r[t],types:{...r[t]&&r[t].types?r[t].types:{},[s]:n||!0}}:{},Nt=t=>Array.isArray(t)?t:[t],$r=()=>{let t=[];return{get observers(){return t},next:n=>{for(const l of t)l.next&&l.next(n)},subscribe:n=>(t.push(n),{unsubscribe:()=>{t=t.filter(l=>l!==n)}}),unsubscribe:()=>{t=[]}}},ve=t=>re(t)&&!Object.keys(t).length,cr=t=>t.type==="file",Re=t=>typeof t=="function",na=t=>{if(!nr)return!1;const a=t?t.ownerDocument:0;return t instanceof(a&&a.defaultView?a.defaultView.HTMLElement:HTMLElement)},Hs=t=>t.type==="select-multiple",ir=t=>t.type==="radio",Mc=t=>ir(t)||It(t),Ma=t=>na(t)&&t.isConnected;function Lc(t,a){const r=a.slice(0,-1).length;let s=0;for(;s<r;)t=ne(t)?s++:t[a[s++]];return t}function jc(t){for(const a in t)if(t.hasOwnProperty(a)&&!ne(t[a]))return!1;return!0}function se(t,a){const r=Array.isArray(a)?a:Na(a)?[a]:or(a),s=r.length===1?t:Lc(t,r),n=r.length-1,l=r[n];return s&&delete s[l],n!==0&&(re(s)&&ve(s)||Array.isArray(s)&&jc(s))&&se(t,r.slice(0,-1)),t}var zs=t=>{for(const a in t)if(Re(t[a]))return!0;return!1};function la(t,a={}){const r=Array.isArray(t);if(re(t)||r)for(const s in t)Array.isArray(t[s])||re(t[s])&&!zs(t[s])?(a[s]=Array.isArray(t[s])?[]:{},la(t[s],a[s])):he(t[s])||(a[s]=!0);return a}function Ws(t,a,r){const s=Array.isArray(t);if(re(t)||s)for(const n in t)Array.isArray(t[n])||re(t[n])&&!zs(t[n])?ne(a)||Ja(r[n])?r[n]=Array.isArray(t[n])?la(t[n],[]):{...la(t[n])}:Ws(t[n],he(a)?{}:a[n],r[n]):r[n]=!Qe(t[n],a[n]);return r}var xt=(t,a)=>Ws(t,a,la(a));const Vr={value:!1,isValid:!1},Kr={value:!0,isValid:!0};var Qs=t=>{if(Array.isArray(t)){if(t.length>1){const a=t.filter(r=>r&&r.checked&&!r.disabled).map(r=>r.value);return{value:a,isValid:!!a.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!ne(t[0].attributes.value)?ne(t[0].value)||t[0].value===""?Kr:{value:t[0].value,isValid:!0}:Kr:Vr}return Vr},Js=(t,{valueAsNumber:a,valueAsDate:r,setValueAs:s})=>ne(t)?t:a?t===""?NaN:t&&+t:r&&qe(t)?new Date(t):s?s(t):t;const Br={isValid:!1,value:null};var Ys=t=>Array.isArray(t)?t.reduce((a,r)=>r&&r.checked&&!r.disabled?{isValid:!0,value:r.value}:a,Br):Br;function Gr(t){const a=t.ref;return cr(a)?a.files:ir(a)?Ys(t.refs).value:Hs(a)?[...a.selectedOptions].map(({value:r})=>r):It(a)?Qs(t.refs).value:Js(ne(a.value)?t.ref.value:a.value,t)}var Uc=(t,a,r,s)=>{const n={};for(const l of t){const o=U(a,l);o&&ee(n,l,o._f)}return{criteriaMode:r,names:[...t],fields:n,shouldUseNativeValidation:s}},oa=t=>t instanceof RegExp,vt=t=>ne(t)?t:oa(t)?t.source:re(t)?oa(t.value)?t.value.source:t.value:t,Hr=t=>({isOnSubmit:!t||t===De.onSubmit,isOnBlur:t===De.onBlur,isOnChange:t===De.onChange,isOnAll:t===De.all,isOnTouch:t===De.onTouched});const zr="AsyncFunction";var qc=t=>!!t&&!!t.validate&&!!(Re(t.validate)&&t.validate.constructor.name===zr||re(t.validate)&&Object.values(t.validate).find(a=>a.constructor.name===zr)),$c=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Wr=(t,a,r)=>!r&&(a.watchAll||a.watch.has(t)||[...a.watch].some(s=>t.startsWith(s)&&/^\.\w+/.test(t.slice(s.length))));const wt=(t,a,r,s)=>{for(const n of r||Object.keys(t)){const l=U(t,n);if(l){const{_f:o,...c}=l;if(o){if(o.refs&&o.refs[0]&&a(o.refs[0],n)&&!s)return!0;if(o.ref&&a(o.ref,o.name)&&!s)return!0;if(wt(c,a))break}else if(re(c)&&wt(c,a))break}}};function Qr(t,a,r){const s=U(t,r);if(s||Na(r))return{error:s,name:r};const n=r.split(".");for(;n.length;){const l=n.join("."),o=U(a,l),c=U(t,l);if(o&&!Array.isArray(o)&&r!==l)return{name:r};if(c&&c.type)return{name:l,error:c};if(c&&c.root&&c.root.type)return{name:`${l}.root`,error:c.root};n.pop()}return{name:r}}var Vc=(t,a,r,s)=>{r(t);const{name:n,...l}=t;return ve(l)||Object.keys(l).length>=Object.keys(a).length||Object.keys(l).find(o=>a[o]===(!s||De.all))},Kc=(t,a,r)=>!t||!a||t===a||Nt(t).some(s=>s&&(r?s===a:s.startsWith(a)||a.startsWith(s))),Bc=(t,a,r,s,n)=>n.isOnAll?!1:!r&&n.isOnTouch?!(a||t):(r?s.isOnBlur:n.isOnBlur)?!t:(r?s.isOnChange:n.isOnChange)?t:!0,Gc=(t,a)=>!lr(U(t,a)).length&&se(t,a),Hc=(t,a,r)=>{const s=Nt(U(t,r));return ee(s,"root",a[r]),ee(t,r,s),t},zt=t=>qe(t);function Jr(t,a,r="validate"){if(zt(t)||Array.isArray(t)&&t.every(zt)||je(t)&&!t)return{type:r,message:zt(t)?t:"",ref:a}}var ct=t=>re(t)&&!oa(t)?t:{value:t,message:""},Yr=async(t,a,r,s,n,l)=>{const{ref:o,refs:c,required:f,maxLength:m,minLength:g,min:d,max:y,pattern:b,validate:w,name:h,valueAsNumber:x,mount:E}=t._f,N=U(r,h);if(!E||a.has(h))return{};const k=c?c[0]:o,v=j=>{n&&k.reportValidity&&(k.setCustomValidity(je(j)?"":j||""),k.reportValidity())},F={},R=ir(o),M=It(o),C=R||M,I=(x||cr(o))&&ne(o.value)&&ne(N)||na(o)&&o.value===""||N===""||Array.isArray(N)&&!N.length,u=_c.bind(null,h,s,F),L=(j,$,K,z=Ge.maxLength,W=Ge.minLength)=>{const te=j?$:K;F[h]={type:j?z:W,message:te,ref:o,...u(j?z:W,te)}};if(l?!Array.isArray(N)||!N.length:f&&(!C&&(I||he(N))||je(N)&&!N||M&&!Qs(c).isValid||R&&!Ys(c).isValid)){const{value:j,message:$}=zt(f)?{value:!!f,message:f}:ct(f);if(j&&(F[h]={type:Ge.required,message:$,ref:k,...u(Ge.required,$)},!s))return v($),F}if(!I&&(!he(d)||!he(y))){let j,$;const K=ct(y),z=ct(d);if(!he(N)&&!isNaN(N)){const W=o.valueAsNumber||N&&+N;he(K.value)||(j=W>K.value),he(z.value)||($=W<z.value)}else{const W=o.valueAsDate||new Date(N),te=Ee=>new Date(new Date().toDateString()+" "+Ee),le=o.type=="time",oe=o.type=="week";qe(K.value)&&N&&(j=le?te(N)>te(K.value):oe?N>K.value:W>new Date(K.value)),qe(z.value)&&N&&($=le?te(N)<te(z.value):oe?N<z.value:W<new Date(z.value))}if((j||$)&&(L(!!j,K.message,z.message,Ge.max,Ge.min),!s))return v(F[h].message),F}if((m||g)&&!I&&(qe(N)||l&&Array.isArray(N))){const j=ct(m),$=ct(g),K=!he(j.value)&&N.length>+j.value,z=!he($.value)&&N.length<+$.value;if((K||z)&&(L(K,j.message,$.message),!s))return v(F[h].message),F}if(b&&!I&&qe(N)){const{value:j,message:$}=ct(b);if(oa(j)&&!N.match(j)&&(F[h]={type:Ge.pattern,message:$,ref:o,...u(Ge.pattern,$)},!s))return v($),F}if(w){if(Re(w)){const j=await w(N,r),$=Jr(j,k);if($&&(F[h]={...$,...u(Ge.validate,$.message)},!s))return v($.message),F}else if(re(w)){let j={};for(const $ in w){if(!ve(j)&&!s)break;const K=Jr(await w[$](N,r),k,$);K&&(j={...K,...u($,K.message)},v(K.message),s&&(F[h]=j))}if(!ve(j)&&(F[h]={ref:k,...j},!s))return F}}return v(!0),F};const zc={mode:De.onSubmit,reValidateMode:De.onChange,shouldFocusError:!0};function Wc(t={}){let a={...zc,...t},r={submitCount:0,isDirty:!1,isReady:!1,isLoading:Re(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:a.errors||{},disabled:a.disabled||!1},s={},n=re(a.defaultValues)||re(a.values)?ie(a.defaultValues||a.values)||{}:{},l=a.shouldUnregister?{}:ie(n),o={action:!1,mount:!1,watch:!1},c={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},f,m=0;const g={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...g};const y={array:$r(),state:$r()},b=a.criteriaMode===De.all,w=i=>p=>{clearTimeout(m),m=setTimeout(i,p)},h=async i=>{if(!a.disabled&&(g.isValid||d.isValid||i)){const p=a.resolver?ve((await M()).errors):await I(s,!0);p!==r.isValid&&y.state.next({isValid:p})}},x=(i,p)=>{!a.disabled&&(g.isValidating||g.validatingFields||d.isValidating||d.validatingFields)&&((i||Array.from(c.mount)).forEach(S=>{S&&(p?ee(r.validatingFields,S,p):se(r.validatingFields,S))}),y.state.next({validatingFields:r.validatingFields,isValidating:!ve(r.validatingFields)}))},E=(i,p=[],S,O,T=!0,_=!0)=>{if(O&&S&&!a.disabled){if(o.action=!0,_&&Array.isArray(U(s,i))){const q=S(U(s,i),O.argA,O.argB);T&&ee(s,i,q)}if(_&&Array.isArray(U(r.errors,i))){const q=S(U(r.errors,i),O.argA,O.argB);T&&ee(r.errors,i,q),Gc(r.errors,i)}if((g.touchedFields||d.touchedFields)&&_&&Array.isArray(U(r.touchedFields,i))){const q=S(U(r.touchedFields,i),O.argA,O.argB);T&&ee(r.touchedFields,i,q)}(g.dirtyFields||d.dirtyFields)&&(r.dirtyFields=xt(n,l)),y.state.next({name:i,isDirty:L(i,p),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else ee(l,i,p)},N=(i,p)=>{ee(r.errors,i,p),y.state.next({errors:r.errors})},k=i=>{r.errors=i,y.state.next({errors:r.errors,isValid:!1})},v=(i,p,S,O)=>{const T=U(s,i);if(T){const _=U(l,i,ne(S)?U(n,i):S);ne(_)||O&&O.defaultChecked||p?ee(l,i,p?_:Gr(T._f)):K(i,_),o.mount&&h()}},F=(i,p,S,O,T)=>{let _=!1,q=!1;const Q={name:i};if(!a.disabled){if(!S||O){(g.isDirty||d.isDirty)&&(q=r.isDirty,r.isDirty=Q.isDirty=L(),_=q!==Q.isDirty);const Z=Qe(U(n,i),p);q=!!U(r.dirtyFields,i),Z?se(r.dirtyFields,i):ee(r.dirtyFields,i,!0),Q.dirtyFields=r.dirtyFields,_=_||(g.dirtyFields||d.dirtyFields)&&q!==!Z}if(S){const Z=U(r.touchedFields,i);Z||(ee(r.touchedFields,i,S),Q.touchedFields=r.touchedFields,_=_||(g.touchedFields||d.touchedFields)&&Z!==S)}_&&T&&y.state.next(Q)}return _?Q:{}},R=(i,p,S,O)=>{const T=U(r.errors,i),_=(g.isValid||d.isValid)&&je(p)&&r.isValid!==p;if(a.delayError&&S?(f=w(()=>N(i,S)),f(a.delayError)):(clearTimeout(m),f=null,S?ee(r.errors,i,S):se(r.errors,i)),(S?!Qe(T,S):T)||!ve(O)||_){const q={...O,..._&&je(p)?{isValid:p}:{},errors:r.errors,name:i};r={...r,...q},y.state.next(q)}},M=async i=>{x(i,!0);const p=await a.resolver(l,a.context,Uc(i||c.mount,s,a.criteriaMode,a.shouldUseNativeValidation));return x(i),p},C=async i=>{const{errors:p}=await M(i);if(i)for(const S of i){const O=U(p,S);O?ee(r.errors,S,O):se(r.errors,S)}else r.errors=p;return p},I=async(i,p,S={valid:!0})=>{for(const O in i){const T=i[O];if(T){const{_f:_,...q}=T;if(_){const Q=c.array.has(_.name),Z=T._f&&qc(T._f);Z&&g.validatingFields&&x([O],!0);const Pe=await Yr(T,c.disabled,l,b,a.shouldUseNativeValidation&&!p,Q);if(Z&&g.validatingFields&&x([O]),Pe[_.name]&&(S.valid=!1,p))break;!p&&(U(Pe,_.name)?Q?Hc(r.errors,Pe,_.name):ee(r.errors,_.name,Pe[_.name]):se(r.errors,_.name))}!ve(q)&&await I(q,p,S)}}return S.valid},u=()=>{for(const i of c.unMount){const p=U(s,i);p&&(p._f.refs?p._f.refs.every(S=>!Ma(S)):!Ma(p._f.ref))&&yt(i)}c.unMount=new Set},L=(i,p)=>!a.disabled&&(i&&p&&ee(l,i,p),!Qe(Ee(),n)),j=(i,p,S)=>Ic(i,c,{...o.mount?l:ne(p)?n:qe(i)?{[i]:p}:p},S,p),$=i=>lr(U(o.mount?l:n,i,a.shouldUnregister?U(n,i,[]):[])),K=(i,p,S={})=>{const O=U(s,i);let T=p;if(O){const _=O._f;_&&(!_.disabled&&ee(l,i,Js(p,_)),T=na(_.ref)&&he(p)?"":p,Hs(_.ref)?[..._.ref.options].forEach(q=>q.selected=T.includes(q.value)):_.refs?It(_.ref)?_.refs.forEach(q=>{(!q.defaultChecked||!q.disabled)&&(Array.isArray(T)?q.checked=!!T.find(Q=>Q===q.value):q.checked=T===q.value||!!T)}):_.refs.forEach(q=>q.checked=q.value===T):cr(_.ref)?_.ref.value="":(_.ref.value=T,_.ref.type||y.state.next({name:i,values:ie(l)})))}(S.shouldDirty||S.shouldTouch)&&F(i,T,S.shouldTouch,S.shouldDirty,!0),S.shouldValidate&&oe(i)},z=(i,p,S)=>{for(const O in p){if(!p.hasOwnProperty(O))return;const T=p[O],_=i+"."+O,q=U(s,_);(c.array.has(i)||re(T)||q&&!q._f)&&!et(T)?z(_,T,S):K(_,T,S)}},W=(i,p,S={})=>{const O=U(s,i),T=c.array.has(i),_=ie(p);ee(l,i,_),T?(y.array.next({name:i,values:ie(l)}),(g.isDirty||g.dirtyFields||d.isDirty||d.dirtyFields)&&S.shouldDirty&&y.state.next({name:i,dirtyFields:xt(n,l),isDirty:L(i,_)})):O&&!O._f&&!he(_)?z(i,_,S):K(i,_,S),Wr(i,c)&&y.state.next({...r,name:i}),y.state.next({name:o.mount?i:void 0,values:ie(l)})},te=async i=>{o.mount=!0;const p=i.target;let S=p.name,O=!0;const T=U(s,S),_=Z=>{O=Number.isNaN(Z)||et(Z)&&isNaN(Z.getTime())||Qe(Z,U(l,S,Z))},q=Hr(a.mode),Q=Hr(a.reValidateMode);if(T){let Z,Pe;const $t=p.type?Gr(T._f):Pc(i),He=i.type===qr.BLUR||i.type===qr.FOCUS_OUT,en=!$c(T._f)&&!a.resolver&&!U(r.errors,S)&&!T._f.deps||Bc(He,U(r.touchedFields,S),r.isSubmitted,Q,q),Aa=Wr(S,c,He);ee(l,S,$t),He?(!p||!p.readOnly)&&(T._f.onBlur&&T._f.onBlur(i),f&&f(0)):T._f.onChange&&T._f.onChange(i);const Da=F(S,$t,He),tn=!ve(Da)||Aa;if(!He&&y.state.next({name:S,type:i.type,values:ie(l)}),en)return(g.isValid||d.isValid)&&(a.mode==="onBlur"?He&&h():He||h()),tn&&y.state.next({name:S,...Aa?{}:Da});if(!He&&Aa&&y.state.next({...r}),a.resolver){const{errors:mr}=await M([S]);if(_($t),O){const an=Qr(r.errors,s,S),dr=Qr(mr,s,an.name||S);Z=dr.error,S=dr.name,Pe=ve(mr)}}else x([S],!0),Z=(await Yr(T,c.disabled,l,b,a.shouldUseNativeValidation))[S],x([S]),_($t),O&&(Z?Pe=!1:(g.isValid||d.isValid)&&(Pe=await I(s,!0)));O&&(T._f.deps&&oe(T._f.deps),R(S,Pe,Z,Da))}},le=(i,p)=>{if(U(r.errors,p)&&i.focus)return i.focus(),1},oe=async(i,p={})=>{let S,O;const T=Nt(i);if(a.resolver){const _=await C(ne(i)?i:T);S=ve(_),O=i?!T.some(q=>U(_,q)):S}else i?(O=(await Promise.all(T.map(async _=>{const q=U(s,_);return await I(q&&q._f?{[_]:q}:q)}))).every(Boolean),!(!O&&!r.isValid)&&h()):O=S=await I(s);return y.state.next({...!qe(i)||(g.isValid||d.isValid)&&S!==r.isValid?{}:{name:i},...a.resolver||!i?{isValid:S}:{},errors:r.errors}),p.shouldFocus&&!O&&wt(s,le,i?T:c.mount),O},Ee=i=>{const p={...o.mount?l:n};return ne(i)?p:qe(i)?U(p,i):i.map(S=>U(p,S))},Se=(i,p)=>({invalid:!!U((p||r).errors,i),isDirty:!!U((p||r).dirtyFields,i),error:U((p||r).errors,i),isValidating:!!U(r.validatingFields,i),isTouched:!!U((p||r).touchedFields,i)}),ft=i=>{i&&Nt(i).forEach(p=>se(r.errors,p)),y.state.next({errors:i?r.errors:{}})},pt=(i,p,S)=>{const O=(U(s,i,{_f:{}})._f||{}).ref,T=U(r.errors,i)||{},{ref:_,message:q,type:Q,...Z}=T;ee(r.errors,i,{...Z,...p,ref:O}),y.state.next({name:i,errors:r.errors,isValid:!1}),S&&S.shouldFocus&&O&&O.focus&&O.focus()},ot=(i,p)=>Re(i)?y.state.subscribe({next:S=>"values"in S&&i(j(void 0,p),S)}):j(i,p,!0),_t=i=>y.state.subscribe({next:p=>{Kc(i.name,p.name,i.exact)&&Vc(p,i.formState||g,Ut,i.reRenderRoot)&&i.callback({values:{...l},...r,...p,defaultValues:n})}}).unsubscribe,wa=i=>(o.mount=!0,d={...d,...i.formState},_t({...i,formState:d})),yt=(i,p={})=>{for(const S of i?Nt(i):c.mount)c.mount.delete(S),c.array.delete(S),p.keepValue||(se(s,S),se(l,S)),!p.keepError&&se(r.errors,S),!p.keepDirty&&se(r.dirtyFields,S),!p.keepTouched&&se(r.touchedFields,S),!p.keepIsValidating&&se(r.validatingFields,S),!a.shouldUnregister&&!p.keepDefaultValue&&se(n,S);y.state.next({values:ie(l)}),y.state.next({...r,...p.keepDirty?{isDirty:L()}:{}}),!p.keepIsValid&&h()},Mt=({disabled:i,name:p})=>{(je(i)&&o.mount||i||c.disabled.has(p))&&(i?c.disabled.add(p):c.disabled.delete(p))},ht=(i,p={})=>{let S=U(s,i);const O=je(p.disabled)||je(a.disabled);return ee(s,i,{...S||{},_f:{...S&&S._f?S._f:{ref:{name:i}},name:i,mount:!0,...p}}),c.mount.add(i),S?Mt({disabled:je(p.disabled)?p.disabled:a.disabled,name:i}):v(i,!0,p.value),{...O?{disabled:p.disabled||a.disabled}:{},...a.progressive?{required:!!p.required,min:vt(p.min),max:vt(p.max),minLength:vt(p.minLength),maxLength:vt(p.maxLength),pattern:vt(p.pattern)}:{},name:i,onChange:te,onBlur:te,ref:T=>{if(T){ht(i,p),S=U(s,i);const _=ne(T.value)&&T.querySelectorAll&&T.querySelectorAll("input,select,textarea")[0]||T,q=Mc(_),Q=S._f.refs||[];if(q?Q.find(Z=>Z===_):_===S._f.ref)return;ee(s,i,{_f:{...S._f,...q?{refs:[...Q.filter(Ma),_,...Array.isArray(U(n,i))?[{}]:[]],ref:{type:_.type,name:i}}:{ref:_}}}),v(i,!1,void 0,_)}else S=U(s,i,{}),S._f&&(S._f.mount=!1),(a.shouldUnregister||p.shouldUnregister)&&!(Dc(c.array,i)&&o.action)&&c.unMount.add(i)}}},Be=()=>a.shouldFocusError&&wt(s,le,c.mount),Sa=i=>{je(i)&&(y.state.next({disabled:i}),wt(s,(p,S)=>{const O=U(s,S);O&&(p.disabled=O._f.disabled||i,Array.isArray(O._f.refs)&&O._f.refs.forEach(T=>{T.disabled=O._f.disabled||i}))},0,!1))},Lt=(i,p)=>async S=>{let O;S&&(S.preventDefault&&S.preventDefault(),S.persist&&S.persist());let T=ie(l);if(y.state.next({isSubmitting:!0}),a.resolver){const{errors:_,values:q}=await M();r.errors=_,T=ie(q)}else await I(s);if(c.disabled.size)for(const _ of c.disabled)se(T,_);if(se(r.errors,"root"),ve(r.errors)){y.state.next({errors:{}});try{await i(T,S)}catch(_){O=_}}else p&&await p({...r.errors},S),Be(),setTimeout(Be);if(y.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ve(r.errors)&&!O,submitCount:r.submitCount+1,errors:r.errors}),O)throw O},ka=(i,p={})=>{U(s,i)&&(ne(p.defaultValue)?W(i,ie(U(n,i))):(W(i,p.defaultValue),ee(n,i,ie(p.defaultValue))),p.keepTouched||se(r.touchedFields,i),p.keepDirty||(se(r.dirtyFields,i),r.isDirty=p.defaultValue?L(i,ie(U(n,i))):L()),p.keepError||(se(r.errors,i),g.isValid&&h()),y.state.next({...r}))},bt=(i,p={})=>{const S=i?ie(i):n,O=ie(S),T=ve(i),_=T?n:O;if(p.keepDefaultValues||(n=S),!p.keepValues){if(p.keepDirtyValues){const q=new Set([...c.mount,...Object.keys(xt(n,l))]);for(const Q of Array.from(q))U(r.dirtyFields,Q)?ee(_,Q,U(l,Q)):W(Q,U(_,Q))}else{if(nr&&ne(i))for(const q of c.mount){const Q=U(s,q);if(Q&&Q._f){const Z=Array.isArray(Q._f.refs)?Q._f.refs[0]:Q._f.ref;if(na(Z)){const Pe=Z.closest("form");if(Pe){Pe.reset();break}}}}if(p.keepFieldsRef)for(const q of c.mount)W(q,U(_,q));else s={}}l=a.shouldUnregister?p.keepDefaultValues?ie(n):{}:ie(_),y.array.next({values:{..._}}),y.state.next({values:{..._}})}c={mount:p.keepDirtyValues?c.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!g.isValid||!!p.keepIsValid||!!p.keepDirtyValues,o.watch=!!a.shouldUnregister,y.state.next({submitCount:p.keepSubmitCount?r.submitCount:0,isDirty:T?!1:p.keepDirty?r.isDirty:!!(p.keepDefaultValues&&!Qe(i,n)),isSubmitted:p.keepIsSubmitted?r.isSubmitted:!1,dirtyFields:T?{}:p.keepDirtyValues?p.keepDefaultValues&&l?xt(n,l):r.dirtyFields:p.keepDefaultValues&&i?xt(n,i):p.keepDirty?r.dirtyFields:{},touchedFields:p.keepTouched?r.touchedFields:{},errors:p.keepErrors?r.errors:{},isSubmitSuccessful:p.keepIsSubmitSuccessful?r.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:n})},jt=(i,p)=>bt(Re(i)?i(l):i,p),Ca=(i,p={})=>{const S=U(s,i),O=S&&S._f;if(O){const T=O.refs?O.refs[0]:O.ref;T.focus&&(T.focus(),p.shouldSelect&&Re(T.select)&&T.select())}},Ut=i=>{r={...r,...i}},qt={control:{register:ht,unregister:yt,getFieldState:Se,handleSubmit:Lt,setError:pt,_subscribe:_t,_runSchema:M,_focusError:Be,_getWatch:j,_getDirty:L,_setValid:h,_setFieldArray:E,_setDisabledField:Mt,_setErrors:k,_getFieldArray:$,_reset:bt,_resetDefaultValues:()=>Re(a.defaultValues)&&a.defaultValues().then(i=>{jt(i,a.resetOptions),y.state.next({isLoading:!1})}),_removeUnmounted:u,_disableForm:Sa,_subjects:y,_proxyFormState:g,get _fields(){return s},get _formValues(){return l},get _state(){return o},set _state(i){o=i},get _defaultValues(){return n},get _names(){return c},set _names(i){c=i},get _formState(){return r},get _options(){return a},set _options(i){a={...a,...i}}},subscribe:wa,trigger:oe,register:ht,handleSubmit:Lt,watch:ot,setValue:W,getValues:Ee,reset:jt,resetField:ka,clearErrors:ft,unregister:yt,setError:pt,setFocus:Ca,getFieldState:Se};return{...qt,formControl:qt}}function Zs(t={}){const a=e.useRef(void 0),r=e.useRef(void 0),[s,n]=e.useState({isDirty:!1,isValidating:!1,isLoading:Re(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Re(t.defaultValues)?void 0:t.defaultValues});if(!a.current)if(t.formControl)a.current={...t.formControl,formState:s},t.defaultValues&&!Re(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:o,...c}=Wc(t);a.current={...c,formState:s}}const l=a.current.control;return l._options=t,Tc(()=>{const o=l._subscribe({formState:l._proxyFormState,callback:()=>n({...l._formState}),reRenderRoot:!0});return n(c=>({...c,isReady:!0})),l._formState.isReady=!0,o},[l]),e.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),e.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),e.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),e.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),e.useEffect(()=>{if(l._proxyFormState.isDirty){const o=l._getDirty();o!==s.isDirty&&l._subjects.state.next({isDirty:o})}},[l,s.isDirty]),e.useEffect(()=>{t.values&&!Qe(t.values,r.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),r.current=t.values,n(o=>({...o}))):l._resetDefaultValues()},[l,t.values]),e.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),a.current.formState=Oc(s,l),a.current}const Zr=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"],Qc=["Motorcycle","Three-wheeler","Pickup Truck","Van","Small Truck","Large Truck"],Jc=[{value:"CUSTOMER",label:"Customer",description:"Shop for fresh produce from local farmers",icon:e.createElement(Ae,{className:"w-8 h-8"}),color:"bg-blue-500"},{value:"FARMER",label:"Farmer",description:"Sell your produce directly to customers",icon:e.createElement(ze,{className:"w-8 h-8"}),color:"bg-green-500"},{value:"DRIVER",label:"Driver",description:"Deliver products and earn money",icon:e.createElement(me,{className:"w-8 h-8"}),color:"bg-orange-500"},{value:"FARMER_AGENT",label:"Farmer Agent",description:"Help farmers join the platform",icon:e.createElement(ke,{className:"w-8 h-8"}),color:"bg-purple-500"}];function Yc(){const t=_e(),[a,r]=P.useState(1),[s,n]=P.useState(!1),[l,o]=P.useState(!1),[c,f]=P.useState(!1),{register:m,handleSubmit:g,watch:d,setValue:y,formState:{errors:b}}=Zs(),w=d("role"),h=d("password"),x=async v=>{if(v.password!==v.confirmPassword){A.error("Passwords do not match");return}f(!0);try{const F={firstName:v.firstName,lastName:v.lastName,phone:v.phone,email:v.email,password:v.password,role:v.role,county:v.county};v.role==="FARMER"?(v.farmName&&(F.farmName=v.farmName),v.farmSize&&(F.farmSize=v.farmSize),v.kraPin&&(F.kraPin=v.kraPin),v.subCounty&&(F.subCounty=v.subCounty)):v.role==="DRIVER"?(F.licenseNumber=v.licenseNumber,F.vehicleType=v.vehicleType,F.vehicleRegNo=v.vehicleRegNo,F.idNumber=v.idNumber):v.role==="FARMER_AGENT"&&(F.assignedCounty=v.assignedCounty);const R=await V.post("/api/auth/register",F);A.success("Registration successful! Please login to continue."),R.data.requiresPayment&&A("You will need to pay the activation fee after login",{icon:""}),R.data.requiresApproval&&A("Your application will be reviewed by our team",{icon:""}),t("/login")}catch(F){console.error("Registration error:",F);const R=F.response?.data?.error||"Registration failed";A.error(R)}finally{f(!1)}},E=()=>{a<3&&r(a+1)},N=()=>{a>1&&r(a-1)},k=v=>{y("role",v),E()};return e.createElement("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8"},e.createElement("div",{className:"sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"flex justify-center"},e.createElement("div",{className:"w-12 h-12 bg-primary-600 rounded-lg flex items-center justify-center"},e.createElement("span",{className:"text-white font-bold text-lg"},"Z"))),e.createElement("h2",{className:"mt-6 text-center text-3xl font-bold text-gray-900"},"Create your account"),e.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Or"," ",e.createElement(H,{to:"/login",className:"font-medium text-primary-600 hover:text-primary-500"},"sign in to your existing account"))),e.createElement("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md"},e.createElement("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex items-center justify-between"},[1,2,3].map(v=>e.createElement("div",{key:v,className:`flex items-center ${a>=v?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${a>=v?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},a>v?e.createElement(Qt,{className:"w-4 h-4"}):v),v<3&&e.createElement("div",{className:`w-16 h-0.5 mx-2 ${a>v?"bg-primary-600":"bg-gray-200"}`})))),e.createElement("div",{className:"flex justify-between mt-2 text-xs text-gray-600"},e.createElement("span",null,"Role"),e.createElement("span",null,"Info"),e.createElement("span",null,"Details"))),e.createElement("form",{onSubmit:g(x)},a===1&&e.createElement("div",{className:"space-y-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Choose your role"),e.createElement("div",{className:"space-y-3"},Jc.map(v=>e.createElement("button",{key:v.value,type:"button",onClick:()=>k(v.value),className:"w-full p-4 border border-gray-300 rounded-lg hover:border-primary-500 hover:bg-primary-50 transition-colors text-left"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${v.color} text-white p-2 rounded-lg mr-4`},v.icon),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},v.label),e.createElement("p",{className:"text-sm text-gray-600"},v.description))))))),a===2&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:N,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(St,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Basic Information")),e.createElement("div",{className:"grid grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...m("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...m("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.lastName.message))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...m("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678 or 0712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...m("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.email.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...m("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Zr.map(v=>e.createElement("option",{key:v,value:v},v))),b.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...m("password",{required:"Password is required",minLength:{value:6,message:"Password must be at least 6 characters"}}),type:s?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>n(!s)},s?e.createElement(kt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Ke,{className:"h-5 w-5 text-gray-400"}))),b.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.password.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Confirm Password *"),e.createElement("div",{className:"relative"},e.createElement("input",{...m("confirmPassword",{required:"Please confirm your password",validate:v=>v===h||"Passwords do not match"}),type:l?"text":"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 pr-10 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>o(!l)},l?e.createElement(kt,{className:"h-5 w-5 text-gray-400"}):e.createElement(Ke,{className:"h-5 w-5 text-gray-400"}))),b.confirmPassword&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.confirmPassword.message)),e.createElement("button",{type:"button",onClick:E,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors font-medium flex items-center justify-center"},"Next",e.createElement(be,{className:"w-5 h-5 ml-2"}))),a===3&&e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement("button",{type:"button",onClick:N,className:"mr-4 text-gray-400 hover:text-gray-600"},e.createElement(St,{className:"w-5 h-5"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900"},w==="FARMER"&&"Farm Details",w==="DRIVER"&&"Driver Information",w==="FARMER_AGENT"&&"Agent Information",w==="CUSTOMER"&&"Almost Done!")),w==="FARMER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Name"),e.createElement("input",{...m("farmName"),placeholder:"e.g., Green Valley Farm",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County"),e.createElement("input",{...m("subCounty"),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farm Size (acres)"),e.createElement("input",{...m("farmSize"),type:"number",step:"0.1",placeholder:"e.g., 5.5",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"KRA PIN"),e.createElement("input",{...m("kraPin"),placeholder:"e.g., A123456789K",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-yellow-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-yellow-800"},"Activation Fee Required"),e.createElement("div",{className:"mt-2 text-sm text-yellow-700"},e.createElement("p",null,"Farmers need to pay a one-time activation fee of KES 300 after registration.")))))),w==="DRIVER"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Driving License Number *"),e.createElement("input",{...m("licenseNumber",{required:"License number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.licenseNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.licenseNumber.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Type *"),e.createElement("select",{...m("vehicleType",{required:"Vehicle type is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select Vehicle Type"),Qc.map(v=>e.createElement("option",{key:v,value:v},v))),b.vehicleType&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.vehicleType.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Vehicle Registration Number *"),e.createElement("input",{...m("vehicleRegNo",{required:"Vehicle registration number is required for drivers"}),placeholder:"e.g., KCA 123X",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.vehicleRegNo&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.vehicleRegNo.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"National ID Number *"),e.createElement("input",{...m("idNumber",{required:"ID number is required for drivers"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),b.idNumber&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.idNumber.message)),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-blue-800"},"Approval Required"),e.createElement("div",{className:"mt-2 text-sm text-blue-700"},e.createElement("p",null,"Driver applications require verification and approval by our team.")))))),w==="FARMER_AGENT"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Assigned County *"),e.createElement("select",{...m("assignedCounty",{required:"Assigned county is required for agents"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500"},e.createElement("option",{value:""},"Select County"),Zr.map(v=>e.createElement("option",{key:v,value:v},v))),b.assignedCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},b.assignedCounty.message)),e.createElement("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("svg",{className:"h-5 w-5 text-purple-400",fill:"currentColor",viewBox:"0 0 20 20"},e.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-6-3a2 2 0 11-4 0 2 2 0 014 0zm-2 4a5 5 0 00-4.546 2.916A5.986 5.986 0 0010 16a5.986 5.986 0 004.546-2.084A5 5 0 0010 11z",clipRule:"evenodd"}))),e.createElement("div",{className:"ml-3"},e.createElement("h3",{className:"text-sm font-medium text-purple-800"},"Agent Responsibilities"),e.createElement("div",{className:"mt-2 text-sm text-purple-700"},e.createElement("p",null,"As an agent, you'll help onboard farmers in your assigned county and earn commissions.")))))),w==="CUSTOMER"&&e.createElement("div",{className:"text-center py-8"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},e.createElement(Qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"You're all set!"),e.createElement("p",{className:"text-gray-600"},"Complete your registration to start shopping for fresh produce.")),e.createElement("button",{type:"submit",disabled:c,className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium"},c?"Creating Account...":"Create Account"))))))}function Zc({wallet:t,token:a}){const[r,s]=P.useState(!1),[n,l]=P.useState(""),[o,c]=P.useState(""),[f,m]=P.useState(!1),g=async d=>{if(d.preventDefault(),!n||!o){A.error("Please fill in all fields");return}if(parseFloat(n)<10){A.error("Minimum withdrawal amount is KSh 10");return}if(parseFloat(n)>(t?.balance||0)){A.error("Insufficient balance");return}m(!0);try{const y=localStorage.getItem("authToken")||a;await V.post("/api/wallet/withdraw",{amount:parseFloat(n),phone:o},{headers:{Authorization:`Bearer ${y}`}}),A.success("STK withdrawal request sent! Check your phone."),s(!1),l(""),c("")}catch(y){console.error(" Withdrawal error:",y),A.error(y.response?.data?.error||"Failed to process withdrawal")}finally{m(!1)}};return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Wallet"),e.createElement("button",{onClick:()=>s(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center"},e.createElement(Ce,{className:"w-4 h-4 mr-2"}),"Withdraw")),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("h3",{className:"text-lg font-semibold mb-4"},"Current Balance"),e.createElement("p",{className:"text-3xl font-bold text-green-600"},"KSh ",t?.balance?.toLocaleString()||0),e.createElement("p",{className:"text-sm text-gray-500 mt-2"},"Available for withdrawal")),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"p-6 border-b"},e.createElement("h3",{className:"text-lg font-semibold"},"Recent Transactions")),e.createElement("div",{className:"divide-y"},t?.transactions?.map(d=>e.createElement("div",{key:d.id,className:"p-6 flex justify-between items-center"},e.createElement("div",null,e.createElement("p",{className:"font-medium"},d.description),e.createElement("p",{className:"text-sm text-gray-500"},new Date(d.date).toLocaleDateString())),e.createElement("div",{className:`text-lg font-semibold ${d.type==="CREDIT"?"text-green-600":"text-red-600"}`},d.type==="CREDIT"?"+":"-","KSh ",d.amount.toLocaleString()))))),r&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"STK Withdrawal"),e.createElement("button",{onClick:()=>s(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(Fe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:g,className:"p-6 space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Amount (KSh) *"),e.createElement("input",{type:"number",required:!0,min:"10",max:t?.balance||0,value:n,onChange:d=>l(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter amount to withdraw"}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Available: KSh ",t?.balance?.toLocaleString()||0)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Phone Number *"),e.createElement("input",{type:"tel",required:!0,value:o,onChange:d=>c(d.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"+254712345678"}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"STK push will be sent to this number")),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3"},e.createElement("p",{className:"text-sm text-yellow-800"},e.createElement("strong",null,"Note:")," You will receive an STK push on your phone to complete the withdrawal.")),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"button",onClick:()=>s(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"},"Cancel"),e.createElement("button",{type:"submit",disabled:f,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},f?"Processing...":"Send STK Push"))))))}function Xc(){const{user:t,token:a}=X(),[r,s]=P.useState("overview"),[n,l]=P.useState([]),[o,c]=P.useState(null),[f,m]=P.useState([]),[g,d]=P.useState(!1),[y,b]=P.useState({totalConsignments:0,pendingConsignments:0,completedConsignments:0,totalEarnings:0}),w=async()=>{try{console.log(" Fetching farmer dashboard data...");const[E,N,k]=await Promise.all([V.get("/api/consignments",{headers:{Authorization:`Bearer ${a}`}}),V.get("/api/wallet",{headers:{Authorization:`Bearer ${a}`}}),V.get("/api/notifications",{headers:{Authorization:`Bearer ${a}`}})]),v=Array.isArray(E.data.consignments)?E.data.consignments:[],F=N.data.wallet||{balance:0,transactions:[]};l(v),c(F),m(k.data.notifications||[]);const R=v.length,M=v.filter(u=>u.status==="PENDING").length,C=v.filter(u=>u.status==="COMPLETED").length,I=F.transactions.filter(u=>u.type==="CREDIT").reduce((u,L)=>u+L.amount,0);b({totalConsignments:R,pendingConsignments:M,completedConsignments:C,totalEarnings:I}),console.log(" Dashboard data loaded successfully")}catch(E){console.error(" Error fetching dashboard data:",E),A.error("Failed to load dashboard data")}};P.useEffect(()=>{w()},[a]);const h=[{id:"overview",label:"Overview",icon:it},{id:"consignments",label:"Consignments",icon:B},{id:"wallet",label:"Wallet",icon:yr},{id:"notifications",label:"Notifications",icon:rt},{id:"settings",label:"Settings",icon:at}],x=t?.registrationFeePaid||t?.role==="ADMIN";return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"flex"},e.createElement("div",{className:"w-64 bg-white shadow-sm"},e.createElement("div",{className:"p-6"},e.createElement("h2",{className:"text-xl font-bold text-gray-900"},"Farmer Dashboard"),e.createElement("p",{className:"text-sm text-gray-600"},t?.firstName," ",t?.lastName)),e.createElement("nav",{className:"mt-6"},h.map(E=>{const N=E.icon;return e.createElement("button",{key:E.id,onClick:()=>s(E.id),className:`w-full flex items-center px-6 py-3 text-left hover:bg-gray-50 ${r===E.id?"bg-green-50 text-green-600 border-r-2 border-green-600":"text-gray-700"}`},e.createElement(N,{className:"w-5 h-5 mr-3"}),E.label)}))),e.createElement("div",{className:"flex-1 p-8"},r==="overview"&&e.createElement("div",{className:"space-y-8"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600"},"Here's your farming business overview.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"},e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Consignments"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},y.totalConsignments)))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(de,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},y.pendingConsignments)))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(fe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},y.completedConsignments)))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(Ce,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Earnings"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KSh ",y.totalEarnings.toLocaleString()))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("h3",{className:"text-lg font-semibold mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>s("consignments"),className:"w-full flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700"},e.createElement(Dt,{className:"w-5 h-5 mr-2"}),"Submit New Consignment"),e.createElement("button",{onClick:()=>s("wallet"),className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700"},e.createElement(yr,{className:"w-5 h-5 mr-2"}),"Check Wallet"))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("h3",{className:"text-lg font-semibold mb-4"},"Recent Activity"),e.createElement("div",{className:"space-y-3"},f.slice(0,3).map(E=>e.createElement("div",{key:E.id,className:"flex items-start space-x-3"},e.createElement("div",{className:"w-2 h-2 bg-green-400 rounded-full mt-2"}),e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium"},E.title),e.createElement("p",{className:"text-xs text-gray-500"},E.message)))))))),r==="consignments"&&e.createElement(ei,{consignments:n,onRefresh:w,canSubmit:x,showPaymentModal:g,setShowPaymentModal:d}),r==="wallet"&&e.createElement(Zc,{wallet:o,token:a}),r==="notifications"&&e.createElement("div",{className:"space-y-6"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Notifications"),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"divide-y"},f.map(E=>e.createElement("div",{key:E.id,className:"p-6"},e.createElement("div",{className:"flex justify-between items-start"},e.createElement("div",{className:"flex-1"},e.createElement("h4",{className:"font-semibold"},E.title),e.createElement("p",{className:"text-gray-600 mt-1"},E.message),e.createElement("p",{className:"text-sm text-gray-500 mt-2"},new Date(E.created_at).toLocaleString())),!E.read&&e.createElement("div",{className:"w-3 h-3 bg-blue-400 rounded-full"}))))))),r==="settings"&&e.createElement("div",{className:"space-y-6"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Settings"),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("h3",{className:"text-lg font-semibold mb-4"},"Profile Information"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700"},"First Name"),e.createElement("input",{type:"text",value:t?.firstName||"",readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Last Name"),e.createElement("input",{type:"text",value:t?.lastName||"",readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email"),e.createElement("input",{type:"email",value:t?.email||"",readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Phone"),e.createElement("input",{type:"tel",value:t?.phone||"",readOnly:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 bg-gray-50"}))))))))}function ei({consignments:t,onRefresh:a,canSubmit:r,showPaymentModal:s,setShowPaymentModal:n}){const[l,o]=P.useState(!1),[c,f]=P.useState({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[]}),[m,g]=P.useState([]),[d,y]=P.useState([]),[b,w]=P.useState(!1),h=k=>{const v=Array.from(k.target.files||[]);if(v.length+m.length>5){A.error("Maximum 5 images allowed");return}if(v.filter(M=>M.size>5*1024*1024).length>0){A.error("Each image must be less than 5MB");return}if(v.filter(M=>!M.type.startsWith("image/")).length>0){A.error("Only image files are allowed");return}g(M=>[...M,...v]),v.forEach(M=>{const C=new FileReader;C.onload=()=>{y(I=>[...I,C.result])},C.readAsDataURL(M)})},x=k=>{g(v=>v.filter((F,R)=>R!==k)),y(v=>v.filter((F,R)=>R!==k))},E=async k=>{if(k.preventDefault(),!r){A.error("Please pay the registration fee first");return}w(!0);try{const v=localStorage.getItem("authToken")||token;if(!v){A.error("Authentication required. Please log in again.");return}console.log(" Submitting with token:",v.substring(0,20)+"...");const F=[];for(const M of m){const C=await new Promise(I=>{const u=new FileReader;u.onload=()=>I(u.result),u.readAsDataURL(M)});F.push(C)}const R={product_name:c.title,category:c.category,quantity:parseFloat(c.quantity),unit:c.unit,price_per_unit:parseFloat(c.bidPricePerUnit),notes:c.description,location:c.location,harvest_date:c.harvestDate,expiry_date:c.expiryDate,images:F};await V.post("/api/consignments",R,{headers:{Authorization:`Bearer ${v}`}}),A.success("Consignment submitted successfully!"),o(!1),f({title:"",description:"",category:"Vegetables",quantity:"",unit:"kg",bidPricePerUnit:"",location:"",harvestDate:"",expiryDate:"",images:[]}),g([]),y([]),a()}catch(v){console.error(" Error submitting consignment:",v),A.error(v.response?.data?.error||"Failed to submit consignment")}finally{w(!1)}},N=k=>({PENDING:"bg-yellow-100 text-yellow-800",APPROVED:"bg-green-100 text-green-800",REJECTED:"bg-red-100 text-red-800",PRICE_SUGGESTED:"bg-blue-100 text-blue-800",DRIVER_ASSIGNED:"bg-indigo-100 text-indigo-800",IN_TRANSIT:"bg-purple-100 text-purple-800",DELIVERED:"bg-cyan-100 text-cyan-800",COMPLETED:"bg-green-100 text-green-800"})[k]||"bg-gray-100 text-gray-800";return e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-2xl font-bold text-gray-900"},"My Consignments"),e.createElement("button",{onClick:()=>o(!0),disabled:!r,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center"},e.createElement(Dt,{className:"w-5 h-5 mr-2"}),"Submit New Consignment")),!r&&e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(lt,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-yellow-800"},"You must pay the KES 300 registration fee before submitting consignments.")),e.createElement("button",{onClick:()=>n(!0),className:"ml-3 bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Pay Now"))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Submit New Consignment"),e.createElement("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700"},e.createElement(Fe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:E,className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Product Title *"),e.createElement("input",{type:"text",required:!0,value:c.title,onChange:k=>f(v=>({...v,title:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Fresh Organic Tomatoes"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Category"),e.createElement("select",{value:c.category,onChange:k=>f(v=>({...v,category:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"Vegetables"},"Vegetables"),e.createElement("option",{value:"Fruits"},"Fruits"),e.createElement("option",{value:"Grains"},"Grains"),e.createElement("option",{value:"Legumes"},"Legumes"),e.createElement("option",{value:"Herbs"},"Herbs"),e.createElement("option",{value:"Root Crops"},"Root Crops"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Quantity *"),e.createElement("input",{type:"number",required:!0,min:"0",step:"0.1",value:c.quantity,onChange:k=>f(v=>({...v,quantity:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Unit"),e.createElement("select",{value:c.unit,onChange:k=>f(v=>({...v,unit:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"kg"},"Kilograms (kg)"),e.createElement("option",{value:"pieces"},"Pieces"),e.createElement("option",{value:"bunches"},"Bunches"),e.createElement("option",{value:"bags"},"Bags"),e.createElement("option",{value:"crates"},"Crates"),e.createElement("option",{value:"tonnes"},"Tonnes"))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Bid Price per Unit (KSh) *"),e.createElement("input",{type:"number",required:!0,min:"0",step:"0.01",value:c.bidPricePerUnit,onChange:k=>f(v=>({...v,bidPricePerUnit:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., 120.00"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Location"),e.createElement("input",{type:"text",value:c.location,onChange:k=>f(v=>({...v,location:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"e.g., Nakuru, Kenya"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Harvest Date"),e.createElement("input",{type:"date",value:c.harvestDate,onChange:k=>f(v=>({...v,harvestDate:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Expiry Date"),e.createElement("input",{type:"date",value:c.expiryDate,onChange:k=>f(v=>({...v,expiryDate:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},"Description *"),e.createElement("textarea",{required:!0,value:c.description,onChange:k=>f(v=>({...v,description:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:3,placeholder:"Describe your produce quality, farming methods, organic certification, etc."})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images (Optional)"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center gap-4"},e.createElement("label",{className:"cursor-pointer"},e.createElement("input",{type:"file",multiple:!0,accept:"image/*",onChange:h,className:"hidden"}),e.createElement("div",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(Jt,{className:"w-4 h-4 mr-2"}),"Add Images")),e.createElement("span",{className:"text-sm text-gray-500"},"Max 5 images, 5MB each (JPG, PNG, GIF)")),d.length>0&&e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4"},d.map((k,v)=>e.createElement("div",{key:v,className:"relative group"},e.createElement("img",{src:k,alt:`Preview ${v+1}`,className:"w-full h-24 object-cover rounded-lg border"}),e.createElement("button",{type:"button",onClick:()=>x(v),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e.createElement(er,{className:"w-3 h-3"}))))),d.length===0&&e.createElement("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center"},e.createElement(xn,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500"},"No images uploaded yet"),e.createElement("p",{className:"text-sm text-gray-400"},"Images help buyers see your produce quality")))),c.quantity&&c.bidPricePerUnit&&e.createElement("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("span",{className:"text-green-800 font-medium"},"Estimated Total Value:"),e.createElement("span",{className:"text-green-900 font-bold text-lg"},"KSh ",(parseFloat(c.quantity)*parseFloat(c.bidPricePerUnit)).toLocaleString()))),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"},"Cancel"),e.createElement("button",{type:"submit",disabled:!r||b,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed"},b?"Submitting...":"Submit Consignment"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"p-6 border-b"},e.createElement("h3",{className:"text-lg font-semibold"},"All Consignments (",t.length,")")),e.createElement("div",{className:"divide-y"},t.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No consignments yet"),e.createElement("p",{className:"text-gray-600"},"Submit your first consignment to start selling your produce.")):t.map(k=>e.createElement("div",{key:k.id,className:"p-6"},e.createElement("div",{className:"flex justify-between items-start"},e.createElement("div",{className:"flex-1"},e.createElement("h4",{className:"font-semibold text-lg"},k.title),e.createElement("p",{className:"text-gray-600 mt-1"},k.description),e.createElement("div",{className:"flex items-center gap-4 mt-2 text-sm text-gray-500"},e.createElement("span",null,k.quantity," ",k.unit),e.createElement("span",null,"KSh ",k.bidPricePerUnit,"/unit"),e.createElement("span",null,k.location))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${N(k.status)}`},k.status),e.createElement("p",{className:"text-gray-500 text-sm mt-1"},new Date(k.createdAt).toLocaleDateString()))))))))}function ti(){const{user:t}=X(),a=_e(),[r,s]=P.useState([]),[n,l]=P.useState(!0),[o,c]=P.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0});P.useEffect(()=>{a("/customer/profile",{replace:!0})},[a]),P.useEffect(()=>{f()},[]);const f=async()=>{try{l(!0);const d=localStorage.getItem("token"),y=await V.get("/api/orders",{headers:{Authorization:`Bearer ${d}`}}),b=y.data.orders||y.data;s(b);const w=b.length,h=b.filter(N=>N.status==="DELIVERED").length,x=b.filter(N=>N.paymentStatus==="COMPLETED").reduce((N,k)=>N+k.totalAmount,0),E=b.filter(N=>N.status==="PENDING").length;c({totalOrders:w,completedOrders:h,totalSpent:x,pendingOrders:E})}catch(d){if(console.error("Failed to fetch orders:",d),d.response?.status===404){console.log(" Using fallback demo orders (endpoint not found)");const y=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",deliveryPhone:"+254712345678",orderDate:new Date(Date.now()-864e5).toISOString(),estimatedDelivery:new Date(Date.now()-432e5).toISOString(),notes:"Please deliver in the morning",createdAt:new Date(Date.now()-864e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_1",quantity:5,pricePerUnit:120,totalPrice:600,product:{id:"prod_1",name:"Organic Tomatoes",images:[]}}]},{id:"order_2",orderNumber:"ORD-2024-002",totalAmount:1800,paymentStatus:"PENDING",paymentMethod:"M-PESA",status:"PROCESSING",deliveryAddress:"456 Oak Avenue, Nakuru",deliveryPhone:"+254723456789",orderDate:new Date(Date.now()-36e5).toISOString(),estimatedDelivery:new Date(Date.now()+864e5).toISOString(),notes:"Call before delivery",createdAt:new Date(Date.now()-36e5).toISOString(),updatedAt:new Date().toISOString(),customerName:"John Doe",items:[{id:"item_3",quantity:2,pricePerUnit:900,totalPrice:1800,product:{id:"prod_2",name:"Premium Maize",images:[]}}]}];s(y),c({totalOrders:2,completedOrders:1,totalSpent:2500,pendingOrders:1}),A.success("Using demo data - backend deployment needed")}else A.error("Failed to load orders")}finally{l(!1)}},m=d=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[d]||"bg-gray-100 text-gray-800",g=d=>{const b={PENDING:de,CONFIRMED:B,PROCESSING:B,SHIPPED:me,DELIVERED:B,CANCELLED:B}[d]||B;return e.createElement(b,{className:"w-4 h-4"})};return n?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your profile and view your order history")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Je,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.totalOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(de,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.pendingOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Completed"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.completedOrders)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES ",o.totalSpent.toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200 mb-8"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>a("/marketplace"),className:"flex items-center justify-center px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(Je,{className:"w-5 h-5 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(B,{className:"w-5 h-5 mr-2"}),"View Orders"),e.createElement("button",{onClick:()=>a("/customer/profile"),className:"flex items-center justify-center px-4 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Ae,{className:"w-5 h-5 mr-2"}),"Edit Profile"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>a("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All"))),e.createElement("div",{className:"p-6"},r.slice(0,3).map(d=>e.createElement("div",{key:d.id,className:"flex items-center justify-between py-4 border-b border-gray-100 last:border-b-0"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},d.items[0]?.product?.images?.[0]?e.createElement("img",{src:d.items[0].product.images[0],alt:d.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(B,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"font-medium text-gray-900"},"Order #",d.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},d.items.length," item",d.items.length>1?"s":"","  KES"," ",d.totalAmount.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-500"},new Date(d.orderDate).toLocaleDateString()))),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${m(d.status)}`},g(d.status),e.createElement("span",{className:"ml-1"},d.status)),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},d.paymentMethod)))),r.length===0&&e.createElement("div",{className:"text-center py-8"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("p",{className:"text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>a("/marketplace"),className:"mt-3 text-blue-600 hover:text-blue-800 font-medium"},"Start Shopping"))))))}function ai(){const{user:t,updateUser:a}=X(),r=_e(),[s,n]=P.useState(!1),[l,o]=P.useState(!1),[c,f]=P.useState([]),[m,g]=P.useState({totalOrders:0,completedOrders:0,totalSpent:0,pendingOrders:0}),[d,y]=P.useState({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""});P.useEffect(()=>{b()},[]);const b=async()=>{try{const E=localStorage.getItem("token"),N=await V.get("/api/orders",{headers:{Authorization:`Bearer ${E}`}}),k=N.data.orders||N.data;f(k);const v=k.length,F=k.filter(C=>C.status==="DELIVERED").length,R=k.filter(C=>C.paymentStatus==="COMPLETED").reduce((C,I)=>C+I.totalAmount,0),M=k.filter(C=>C.status==="PENDING").length;g({totalOrders:v,completedOrders:F,totalSpent:R,pendingOrders:M})}catch(E){if(console.error("Failed to fetch orders:",E),E.response?.status===404){console.log(" Using fallback demo orders (endpoint not found)");const N=[{id:"order_1",orderNumber:"ORD-2024-001",totalAmount:2500,paymentStatus:"COMPLETED",paymentMethod:"M-PESA",status:"DELIVERED",deliveryAddress:"123 Main Street, Nairobi",orderDate:new Date(Date.now()-864e5).toISOString(),createdAt:new Date(Date.now()-864e5).toISOString(),items:[{quantity:5,product:{name:"Organic Tomatoes",images:[]}}]}];f(N),g({totalOrders:1,completedOrders:1,totalSpent:2500,pendingOrders:0})}}},w=async()=>{try{o(!0);const E=localStorage.getItem("token"),N=await V.put("/api/profile",d,{headers:{Authorization:`Bearer ${E}`}});a(N.data.user),n(!1),A.success("Profile updated successfully!")}catch(E){A.error(E.response?.data?.error||"Failed to update profile")}finally{o(!1)}},h=()=>{y({firstName:t?.firstName||"",lastName:t?.lastName||"",email:t?.email||"",county:t?.county||""}),n(!1)},x=E=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[E]||"bg-gray-100 text-gray-800";return e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Profile"),e.createElement("p",{className:"text-gray-600 mt-2"},"Manage your personal information and preferences")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Personal Information"),s?e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:w,disabled:l,className:"flex items-center text-green-600 hover:text-green-800 disabled:opacity-50"},e.createElement(da,{className:"w-4 h-4 mr-1"}),"Save"),e.createElement("button",{onClick:h,className:"flex items-center text-red-600 hover:text-red-800"},e.createElement(Fe,{className:"w-4 h-4 mr-1"}),"Cancel")):e.createElement("button",{onClick:()=>n(!0),className:"flex items-center text-blue-600 hover:text-blue-800"},e.createElement(vn,{className:"w-4 h-4 mr-1"}),"Edit"))),e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement("div",{className:"w-20 h-20 bg-green-600 rounded-full flex items-center justify-center text-white text-2xl font-bold"},t?.firstName?.[0],t?.lastName?.[0]),e.createElement("div",{className:"ml-6"},e.createElement("h3",{className:"text-xl font-semibold text-gray-900"},t?.firstName," ",t?.lastName),e.createElement("p",{className:"text-gray-600"},t?.role),e.createElement("div",{className:"flex items-center mt-1"},e.createElement(Oe,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm text-green-600"},"Verified Account")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Ae,{className:"w-4 h-4 inline mr-1"}),"First Name"),s?e.createElement("input",{type:"text",value:d.firstName,onChange:E=>y(N=>({...N,firstName:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.firstName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Ae,{className:"w-4 h-4 inline mr-1"}),"Last Name"),s?e.createElement("input",{type:"text",value:d.lastName,onChange:E=>y(N=>({...N,lastName:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.lastName)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(ma,{className:"w-4 h-4 inline mr-1"}),"Email Address"),s?e.createElement("input",{type:"email",value:d.email,onChange:E=>y(N=>({...N,email:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}):e.createElement("p",{className:"text-gray-900 py-2"},t?.email)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Ye,{className:"w-4 h-4 inline mr-1"}),"Phone Number"),e.createElement("p",{className:"text-gray-900 py-2"},t?.phone),e.createElement("p",{className:"text-sm text-gray-500"},"Phone number cannot be changed")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(Te,{className:"w-4 h-4 inline mr-1"}),"County"),s?e.createElement("select",{value:d.county,onChange:E=>y(N=>({...N,county:E.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select County"),e.createElement("option",{value:"Nairobi"},"Nairobi"),e.createElement("option",{value:"Kiambu"},"Kiambu"),e.createElement("option",{value:"Nakuru"},"Nakuru"),e.createElement("option",{value:"Mombasa"},"Mombasa"),e.createElement("option",{value:"Kisumu"},"Kisumu"),e.createElement("option",{value:"Eldoret"},"Eldoret"),e.createElement("option",{value:"Thika"},"Thika"),e.createElement("option",{value:"Nyeri"},"Nyeri")):e.createElement("p",{className:"text-gray-900 py-2"},t?.county)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},e.createElement(st,{className:"w-4 h-4 inline mr-1"}),"Member Since"),e.createElement("p",{className:"text-gray-900 py-2"},new Date(t?.createdAt||new Date).toLocaleDateString())))))),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Account Summary"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Je,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Orders")),e.createElement("span",{className:"font-semibold text-gray-900"},m.totalOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(de,{className:"w-5 h-5 text-yellow-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Pending")),e.createElement("span",{className:"font-semibold text-gray-900"},m.pendingOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Completed")),e.createElement("span",{className:"font-semibold text-gray-900"},m.completedOrders)),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-5 h-5 text-green-600 mr-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Total Spent")),e.createElement("span",{className:"font-semibold text-gray-900"},"KES ",m.totalSpent.toLocaleString())))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>r("/marketplace"),className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},e.createElement(Je,{className:"w-4 h-4 mr-2"}),"Browse Marketplace"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"},e.createElement(B,{className:"w-4 h-4 mr-2"}),"View Order History"),e.createElement("button",{onClick:()=>r("/cart"),className:"w-full flex items-center justify-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},e.createElement(Je,{className:"w-4 h-4 mr-2"}),"View Cart"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Orders"),e.createElement("button",{onClick:()=>r("/customer/orders"),className:"text-blue-600 hover:text-blue-800 text-sm font-medium"},"View All")),e.createElement("div",{className:"space-y-3"},c.slice(0,3).map(E=>e.createElement("div",{key:E.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},"Order #",E.id.slice(-6)),e.createElement("p",{className:"text-xs text-gray-500"},new Date(E.orderDate).toLocaleDateString())),e.createElement("div",{className:"text-right"},e.createElement("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${x(E.status)}`},E.status),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"KES ",E.totalAmount.toLocaleString())))),c.length===0&&e.createElement("div",{className:"text-center py-4"},e.createElement(B,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-sm text-gray-500"},"No orders yet"),e.createElement("button",{onClick:()=>r("/marketplace"),className:"mt-2 text-blue-600 hover:text-blue-800 text-sm font-medium"},"Start Shopping"))))))))}function ri(){const{user:t}=X(),[a,r]=P.useState([]),[s,n]=P.useState(!0),[l,o]=P.useState(null);P.useEffect(()=>{c()},[]);const c=async()=>{try{n(!0);const d=localStorage.getItem("token"),y=await V.get("/api/orders",{headers:{Authorization:`Bearer ${d}`}});r(y.data)}catch(d){console.error("Failed to fetch orders:",d),A.error("Failed to load orders")}finally{n(!1)}},f=d=>({PENDING:"bg-yellow-100 text-yellow-800",CONFIRMED:"bg-blue-100 text-blue-800",PROCESSING:"bg-indigo-100 text-indigo-800",SHIPPED:"bg-purple-100 text-purple-800",DELIVERED:"bg-green-100 text-green-800",CANCELLED:"bg-red-100 text-red-800"})[d]||"bg-gray-100 text-gray-800",m=d=>{const b={PENDING:de,CONFIRMED:B,PROCESSING:B,SHIPPED:me,DELIVERED:fe,CANCELLED:Fe}[d]||B;return e.createElement(b,{className:"w-4 h-4"})},g=d=>({PENDING:"bg-yellow-100 text-yellow-800",COMPLETED:"bg-green-100 text-green-800",FAILED:"bg-red-100 text-red-800",CANCELLED:"bg-gray-100 text-gray-800"})[d]||"bg-gray-100 text-gray-800";return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Order History"),e.createElement("p",{className:"text-gray-600 mt-2"},"Track and manage your orders")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(B,{className:"w-8 h-8 text-blue-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(de,{className:"w-8 h-8 text-yellow-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Pending"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(d=>d.status==="PENDING").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(fe,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Delivered"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},a.filter(d=>d.status==="DELIVERED").length)))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm p-6 border border-gray-200"},e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-8 h-8 text-green-600"}),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-500"},"Total Spent"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},"KES"," ",a.filter(d=>d.paymentStatus==="COMPLETED").reduce((d,y)=>d+y.totalAmount,0).toLocaleString()))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"All Orders")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders yet"),e.createElement("p",{className:"text-gray-500 mb-6"},"Start shopping to see your orders here"),e.createElement("button",{onClick:()=>window.location.href="/marketplace",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700"},"Browse Marketplace")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(d=>e.createElement("div",{key:d.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center"},d.items[0]?.product?.images?.[0]?e.createElement("img",{src:d.items[0].product.images[0],alt:d.items[0].product.name,className:"w-12 h-12 rounded-lg object-cover"}):e.createElement(B,{className:"w-6 h-6 text-gray-400"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-medium text-gray-900"},"Order #",d.id.slice(-8)),e.createElement("p",{className:"text-sm text-gray-500"},d.items.length," item",d.items.length>1?"s":"","  KES"," ",d.totalAmount.toLocaleString()))),e.createElement("div",{className:"flex items-center space-x-3"},e.createElement("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${f(d.status)}`},m(d.status),e.createElement("span",{className:"ml-1"},d.status)),e.createElement("button",{onClick:()=>o(d),className:"text-blue-600 hover:text-blue-800 font-medium text-sm flex items-center"},e.createElement(Ke,{className:"w-4 h-4 mr-1"}),"View Details"))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(st,{className:"w-4 h-4 mr-2"}),"Ordered: ",new Date(d.orderDate).toLocaleDateString()),e.createElement("div",{className:"flex items-center"},e.createElement(Ie,{className:"w-4 h-4 mr-2"}),"Payment:"," ",e.createElement("span",{className:`ml-1 px-2 py-0.5 rounded text-xs ${g(d.paymentStatus)}`},d.paymentStatus)),e.createElement("div",{className:"flex items-center"},e.createElement(me,{className:"w-4 h-4 mr-2"}),"Method: ",d.paymentMethod)),d.status==="SHIPPED"||d.status==="DELIVERED"?e.createElement("div",{className:"mt-4 p-3 bg-green-50 rounded-lg"},e.createElement("p",{className:"text-sm text-green-800"},d.status==="DELIVERED"?"Order delivered successfully!":"Your order is on the way!")):null)))),l&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Order Details #",l.id.slice(-8)),e.createElement("button",{onClick:()=>o(null),className:"text-gray-500 hover:text-gray-700"},e.createElement(Fe,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Order Status"),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${f(l.status)}`},m(l.status),e.createElement("span",{className:"ml-1"},l.status)),e.createElement("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${g(l.paymentStatus)}`},l.paymentStatus))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Items Ordered"),e.createElement("div",{className:"space-y-3"},l.items.map(d=>e.createElement("div",{key:d.id,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center"},e.createElement("img",{src:d.product.images[0]||"/placeholder.jpg",alt:d.product.name,className:"w-12 h-12 rounded-lg object-cover"}),e.createElement("div",{className:"ml-3"},e.createElement("p",{className:"font-medium text-gray-900"},d.product.name),e.createElement("p",{className:"text-sm text-gray-500"},d.quantity," ",d.product.unit,"  KES"," ",d.pricePerUnit))),e.createElement("p",{className:"font-medium text-gray-900"},"KES ",d.totalPrice.toLocaleString()))))),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900 mb-2"},"Delivery Information"),e.createElement("div",{className:"space-y-2 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center"},e.createElement(Te,{className:"w-4 h-4 mr-2"}),l.deliveryAddress),e.createElement("div",{className:"flex items-center"},e.createElement(Ye,{className:"w-4 h-4 mr-2"}),l.deliveryPhone),e.createElement("div",{className:"flex items-center"},e.createElement(st,{className:"w-4 h-4 mr-2"}),"Expected:"," ",new Date(l.estimatedDelivery).toLocaleDateString()))),e.createElement("div",{className:"border-t pt-4"},e.createElement("div",{className:"flex justify-between items-center"},e.createElement("span",{className:"text-lg font-medium text-gray-900"},"Total Amount"),e.createElement("span",{className:"text-lg font-bold text-gray-900"},"KES ",l.totalAmount.toLocaleString())),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},"Payment via ",l.paymentMethod)))))))}function si(){const{cart:t,updateQuantity:a,removeFromCart:r,clearCart:s,refreshCart:n}=gt(),{user:l,isAuthenticated:o}=X();_e();const[c,f]=P.useState(null),[m,g]=P.useState(""),[d,y]=P.useState(null);P.useEffect(()=>{n()},[n]);const b=async(u,L)=>{if(!(L<0)){f(u);try{L===0?r(u):a(u,L)}catch{}finally{f(null)}}},w=async u=>{if(window.confirm("Are you sure you want to remove this item from your cart?"))try{r(u)}catch{}},h=async()=>{if(window.confirm("Are you sure you want to clear your entire cart?"))try{await s()}catch{}},x=()=>{m.toLowerCase()==="first10"?(y({code:"FIRST10",discount:10,type:"percentage"}),A.success("Coupon applied successfully!"),g("")):m.toLowerCase()==="save100"?(y({code:"SAVE100",discount:100,type:"fixed"}),A.success("Coupon applied successfully!"),g("")):A.error("Invalid coupon code")},E=()=>{y(null),A.success("Coupon removed")},N=u=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(u),k=u=>d?d.type==="percentage"?u*d.discount/100:Math.min(d.discount,u):0,v=u=>u>=1e3?0:150;if(!t||t.items.length===0)return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center py-16"},e.createElement(Je,{className:"w-24 h-24 text-gray-300 mx-auto mb-6"}),e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-4"},"Your cart is empty"),e.createElement("p",{className:"text-gray-600 mb-8"},"Looks like you haven't added any items to your cart yet."),e.createElement(H,{to:"/marketplace",className:"bg-primary-600 text-white px-8 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center"},e.createElement(Je,{className:"w-5 h-5 mr-2"}),"Start Shopping")));const F=t.totalAmount,R=k(F),M=F-R,C=v(M),I=M+C;return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"flex items-center justify-between mb-8"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Shopping Cart"),e.createElement("p",{className:"text-gray-600 mt-2"},t.totalItems," ",t.totalItems===1?"item":"items"," in your cart")),t.items.length>0&&e.createElement("button",{onClick:h,className:"text-red-600 hover:text-red-700 text-sm font-medium"},"Clear Cart")),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border"},e.createElement("div",{className:"p-6"},e.createElement("div",{className:"space-y-6"},t.items.map(u=>e.createElement("div",{key:u.id,className:"flex items-start space-x-4 pb-6 border-b border-gray-200 last:border-b-0 last:pb-0"},e.createElement("div",{className:"flex-shrink-0"},e.createElement("div",{className:"w-20 h-20 bg-gray-200 rounded-lg overflow-hidden"},u.images&&u.images.length>0?e.createElement("img",{src:u.images[0],alt:u.name,className:"w-full h-full object-cover",onError:L=>{L.currentTarget.src="/api/placeholder/80/80?text="+encodeURIComponent(u.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},""))),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("div",{className:"flex items-start justify-between"},e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},e.createElement(H,{to:`/marketplace/product/${u.productId}`,className:"hover:text-primary-600 transition-colors"},u.name)),e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement("span",null,"Fresh Produce")),e.createElement("div",{className:"flex items-center space-x-4 mb-3"},e.createElement("span",{className:"text-lg font-semibold text-gray-900"},N(u.pricePerUnit)," / ",u.unit))),e.createElement("div",{className:"flex flex-col items-end space-y-2 ml-4"},e.createElement("button",{onClick:()=>w(u.id),className:"text-gray-400 hover:text-red-500 transition-colors",title:"Remove item"},e.createElement(er,{className:"w-5 h-5"})),e.createElement("button",{className:"text-gray-400 hover:text-red-500 transition-colors"},e.createElement(Xa,{className:"w-5 h-5"})))),e.createElement("div",{className:"flex items-center justify-between mt-4"},e.createElement("div",{className:"flex items-center border border-gray-300 rounded-lg"},e.createElement("button",{onClick:()=>b(u.id,u.quantity-1),disabled:c===u.id||u.quantity<=1,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(Nn,{className:"w-4 h-4"})),e.createElement("input",{type:"number",min:"1",max:999,value:u.quantity,onChange:L=>{const j=parseInt(L.target.value)||1;j!==u.quantity&&b(u.id,j)},className:"w-16 px-2 py-2 text-center border-0 focus:ring-0",disabled:c===u.id}),e.createElement("button",{onClick:()=>b(u.id,u.quantity+1),disabled:c===u.id,className:"p-2 text-gray-600 hover:text-gray-900 disabled:opacity-50 disabled:cursor-not-allowed"},e.createElement(Dt,{className:"w-4 h-4"}))),e.createElement("div",{className:"text-right"},e.createElement("div",{className:"text-lg font-bold text-gray-900"},N((u.pricePerUnit||0)*(u.quantity||0))),u.quantity>1&&e.createElement("div",{className:"text-sm text-gray-600"},u.quantity," "," ",N(u.pricePerUnit||0)))),c===u.id&&e.createElement("div",{className:"mt-2 text-sm text-primary-600"},"Updating..."))))))),e.createElement("div",{className:"mt-6"},e.createElement(H,{to:"/marketplace",className:"text-primary-600 hover:text-primary-700 font-medium inline-flex items-center"}," Continue Shopping"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",t.totalItems," items)"),e.createElement("span",null,N(F))),d&&e.createElement("div",{className:"flex justify-between text-green-600"},e.createElement("span",{className:"flex items-center"},e.createElement(ss,{className:"w-4 h-4 mr-1"}),d.code,e.createElement("button",{onClick:E,className:"ml-2 text-red-500 hover:text-red-700"},"")),e.createElement("span",null,"-",N(R))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",C===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,N(C))),e.createElement("div",{className:"border-t border-gray-200 pt-3"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,N(I))))),e.createElement("div",{className:"mb-6"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Coupon Code"),e.createElement("div",{className:"flex space-x-2"},e.createElement("input",{type:"text",placeholder:"Enter coupon code",value:m,onChange:u=>g(u.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.createElement("button",{onClick:x,disabled:!m.trim(),className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},"Apply")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Try: FIRST10 (10% off) or SAVE100 (KES 100 off)")),e.createElement("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(de,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},C===0?" You qualify for free delivery!":`Spend ${N(1e3-M)} more for free delivery`)),e.createElement(H,{to:"/checkout",className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium inline-flex items-center justify-center"},"Proceed to Checkout",e.createElement(be,{className:"w-5 h-5 ml-2"})),e.createElement("div",{className:"mt-4 text-center"},e.createElement("div",{className:"text-xs text-gray-500"}," Secure checkout powered by M-Pesa"))))))}const ca=t=>{const a=t.replace(/[\s\-\(\)]/g,"");return a.startsWith("+254")?a.substring(1):a.startsWith("254")?a:a.startsWith("0")?"254"+a.substring(1):a.length===9&&(a.startsWith("7")||a.startsWith("1"))?"254"+a:a},Ya=t=>{const a=ca(t);return/^254[71]\d{8}$/.test(a)},ni=async(t,a=30,r=2e3)=>{for(let s=0;s<a;s++)try{const l=await(await fetch(`/api/payments/status/${t}`)).json();if(l.status==="COMPLETED")return{success:!0,status:"COMPLETED",data:l};if(l.status==="FAILED"||l.status==="CANCELLED")return{success:!1,status:l.status,data:l};await new Promise(o=>setTimeout(o,r))}catch(n){console.error("Error polling payment status:",n)}return{success:!1,status:"TIMEOUT"}},li=["Nairobi","Mombasa","Kiambu","Nakuru","Machakos","Kajiado","Murang'a","Nyeri","Meru","Embu","Tharaka-Nithi","Kirinyaga","Nyandarua","Laikipia","Samburu","Trans-Nzoia","Uasin-Gishu","Elgeyo-Marakwet","Nandi","Baringo","Kericho","Bomet","Kakamega","Vihiga","Bungoma","Busia","Siaya","Kisumu","Homa Bay","Migori","Kisii","Nyamira","Narok","Turkana","West Pokot","Isiolo","Marsabit","Mandera","Wajir","Garissa","Tana River","Lamu","Taita-Taveta","Kwale","Kilifi"];function oi(){const t=_e(),{cart:a,clearCart:r}=gt(),{user:s,isAuthenticated:n,loginWithData:l}=X(),[o,c]=P.useState(null),[f,m]=P.useState(!0),[g,d]=P.useState(!1),[y,b]=P.useState(1),[w,h]=P.useState(null),{register:x,handleSubmit:E,watch:N,setValue:k,formState:{errors:v}}=Zs({defaultValues:{firstName:s?.firstName||"",lastName:s?.lastName||"",phone:s?.phone||"",email:s?.email||"",paymentMethod:"MPESA",mpesaPhone:s?.phone||"",createAccount:!n,password:""}}),F=N("paymentMethod");N("county");const R=N("createAccount");P.useEffect(()=>{M()},[]);const M=async()=>{try{m(!0);const u=a.totalAmount>2e3?0:300,L={items:a.items,totalItems:a.totalItems,totalAmount:a.totalAmount,isReadyForCheckout:a.items.length>0,deliveryFee:u,subtotal:a.totalAmount,total:a.totalAmount+u,grandTotal:a.totalAmount+u,unavailableItems:[]};if(c(L),a.totalItems===0){A.error("Your cart is empty"),t("/marketplace");return}}catch(u){console.error("Failed to load cart summary:",u),A.error("Failed to load cart summary"),t("/cart")}finally{m(!1)}},C=async u=>{if(o){d(!0);try{const L={items:o.items.map($=>({productId:$.productId,quantity:$.quantity,price:$.pricePerUnit})),customerInfo:{firstName:u.firstName,lastName:u.lastName,phone:u.phone,email:u.email,address:`${u.street}, ${u.ward}, ${u.subCounty}, ${u.county}`,county:u.county,buildingName:u.buildingName,deliveryInstructions:u.deliveryInstructions},paymentMethod:u.paymentMethod,mpesaPhone:u.paymentMethod==="MPESA"?u.mpesaPhone:void 0,deliveryFee:o.deliveryFee,totalAmount:o.grandTotal},j=await V.post("/api/orders",L);if(h(j.data),u.paymentMethod==="MPESA"&&u.mpesaPhone)try{const $=ca(u.mpesaPhone);if(!Ya($)){A.error("Please enter a valid Kenyan phone number");return}A("Initiating M-Pesa payment...",{icon:""});const K=await V.post("/api/payments/stk-push",{phone:$,amount:o.grandTotal,orderId:j.data.orderId,accountReference:`Order-${j.data.orderId}`,transactionDesc:`Payment for order ${j.data.orderId}`});if(K.data.success){A.success("M-Pesa payment request sent! Please check your phone.");try{A("Waiting for payment confirmation...",{icon:""});const z=await ni(K.data.transactionId);z.success?A.success("Payment completed successfully!"):A.error(`Payment ${z.status.toLowerCase()}. Please try again.`)}catch(z){console.error("Payment polling error:",z),A("Payment initiated. Status will be updated shortly.",{icon:""})}}else A.error("Failed to initiate M-Pesa payment")}catch($){console.error("M-Pesa STK push error:",$),A.error("Failed to process M-Pesa payment")}if(!n&&u.createAccount&&u.password)try{const $={firstName:u.firstName,lastName:u.lastName,phone:u.phone,email:u.email,password:u.password,county:u.county,role:"CUSTOMER"},K=await V.post("/api/auth/register",$);if(K.data.success){const{user:z,token:W}=K.data;l(z,W),A.success("Account created and logged in successfully!")}}catch($){console.error("Failed to create account:",$),A.error("Order placed successfully, but failed to create account. You can register later.")}await r(),b(4),A.success("Order placed successfully!")}catch(L){console.error("Failed to create order:",L);const j=L.response?.data?.error||"Failed to place order";A.error(j)}finally{d(!1)}}},I=u=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(u);return f?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"animate-pulse"},e.createElement("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"h-32 bg-gray-200 rounded-lg"}),e.createElement("div",{className:"h-48 bg-gray-200 rounded-lg"})),e.createElement("div",{className:"h-64 bg-gray-200 rounded-lg"})))):!o||o.totalItems===0?e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"text-center"},e.createElement(Je,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-2"},"No items to checkout"),e.createElement("p",{className:"text-gray-600 mb-6"},"Your cart is empty or items are unavailable"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors"},"Continue Shopping"))):e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("button",{onClick:()=>t("/cart"),className:"flex items-center text-gray-600 hover:text-gray-900 mb-4"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Back to Cart"),e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Checkout"),e.createElement("div",{className:"mt-6"},e.createElement("div",{className:"flex items-center"},[{step:1,title:"Information"},{step:2,title:"Review"},{step:3,title:"Payment"},{step:4,title:"Confirmation"}].map((u,L)=>e.createElement(e.Fragment,{key:u.step},e.createElement("div",{className:`flex items-center ${y>=u.step?"text-primary-600":"text-gray-400"}`},e.createElement("div",{className:`w-8 h-8 rounded-full flex items-center justify-center border-2 ${y>=u.step?"border-primary-600 bg-primary-600 text-white":"border-gray-300"}`},y>u.step?e.createElement(Qt,{className:"w-4 h-4"}):u.step),e.createElement("span",{className:"ml-2 text-sm font-medium"},u.title)),L<3&&e.createElement("div",{className:`flex-1 h-0.5 mx-4 ${y>u.step?"bg-primary-600":"bg-gray-200"}`})))))),y===4?e.createElement("div",{className:"max-w-2xl mx-auto"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-8 text-center"},e.createElement("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(Qt,{className:"w-8 h-8 text-green-600"})),e.createElement("h2",{className:"text-2xl font-bold text-gray-900 mb-4"},"Order Placed Successfully!"),w&&e.createElement("div",{className:"mb-6"},e.createElement("p",{className:"text-gray-600 mb-2"},"Order Number:"),e.createElement("p",{className:"text-lg font-semibold text-gray-900 mb-4"},w.order?.orderNumber||w.order?.id),e.createElement("p",{className:"text-gray-600 mb-2"},"Total Amount:"),e.createElement("p",{className:"text-2xl font-bold text-primary-600 mb-6"},I(o.grandTotal)),e.createElement("div",{className:"bg-blue-50 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center text-blue-700 mb-2"},e.createElement(de,{className:"w-5 h-5 mr-2"}),e.createElement("span",{className:"font-medium"},"Estimated Delivery")),e.createElement("p",{className:"text-blue-600"},"1-2 business days"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>t("/customer/dashboard"),className:"w-full bg-primary-600 text-white py-3 px-6 rounded-lg hover:bg-primary-700 transition-colors font-medium"},"View Order Status"),e.createElement("button",{onClick:()=>t("/marketplace"),className:"w-full bg-gray-100 text-gray-700 py-3 px-6 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Continue Shopping")))):e.createElement("form",{onSubmit:E(C)},e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8"},e.createElement("div",{className:"lg:col-span-2 space-y-8"},y>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Ae,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Customer Information")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"First Name *"),e.createElement("input",{...x("firstName",{required:"First name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.firstName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.firstName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Last Name *"),e.createElement("input",{...x("lastName",{required:"Last name is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.lastName&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.lastName.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number *"),e.createElement("input",{...x("phone",{required:"Phone number is required",pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.phone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.phone.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Email Address"),e.createElement("input",{...x("email",{pattern:{value:/^[^\s@]+@[^\s@]+\.[^\s@]+$/,message:"Please enter a valid email address"}}),type:"email",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.email&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.email.message)))),y>=1&&!n&&e.createElement("div",{className:"bg-blue-50 rounded-lg border border-blue-200 p-6"},e.createElement("div",{className:"flex items-center mb-4"},e.createElement(wn,{className:"w-5 h-5 text-blue-600 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Create Account (Optional)")),e.createElement("div",{className:"mb-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{...x("createAccount"),type:"checkbox",className:"mr-2"}),e.createElement("span",{className:"text-sm text-gray-700"},"Create an account to track your orders and save delivery addresses"))),R&&e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Password *"),e.createElement("input",{...x("password",{required:R?"Password is required":!1,minLength:{value:6,message:"Password must be at least 6 characters"}}),type:"password",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Enter password for your new account",disabled:y>1}),v.password&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.password.message))),y>=1&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Te,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Delivery Address")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"County *"),e.createElement("select",{...x("county",{required:"County is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1},e.createElement("option",{value:""},"Select County"),li.map(u=>e.createElement("option",{key:u,value:u},u))),v.county&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.county.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Sub-County *"),e.createElement("input",{...x("subCounty",{required:"Sub-county is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.subCounty&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.subCounty.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Ward *"),e.createElement("input",{...x("ward",{required:"Ward is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.ward&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.ward.message)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Street/Road *"),e.createElement("input",{...x("street",{required:"Street is required"}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1}),v.street&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.street.message)),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Building/House Name"),e.createElement("input",{...x("buildingName"),placeholder:"Optional: Building name, house number, apartment, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1})),e.createElement("div",{className:"md:col-span-2"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Delivery Instructions"),e.createElement("textarea",{...x("deliveryInstructions"),rows:3,placeholder:"Optional: Special delivery instructions, landmarks, etc.",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>1})))),y>=2&&e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6"},e.createElement("div",{className:"flex items-center mb-6"},e.createElement(Ie,{className:"w-5 h-5 text-gray-400 mr-2"}),e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Payment Method")),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center"},e.createElement("input",{...x("paymentMethod"),type:"radio",value:"MPESA",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:y>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"M-Pesa STK Push")),F==="MPESA"&&e.createElement("div",{className:"ml-7"},e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"M-Pesa Phone Number *"),e.createElement("input",{...x("mpesaPhone",{required:F==="MPESA"?"M-Pesa phone number is required":!1,pattern:{value:/^(\+254|0)[7-9]\d{8}$/,message:"Please enter a valid Kenyan phone number"}}),placeholder:"+254712345678",className:"w-full max-w-md border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-primary-500 focus:border-primary-500",disabled:y>2}),v.mpesaPhone&&e.createElement("p",{className:"mt-1 text-sm text-red-600"},v.mpesaPhone.message)),e.createElement("div",{className:"flex items-center"},e.createElement("input",{...x("paymentMethod"),type:"radio",value:"COD",className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300",disabled:y>2}),e.createElement("label",{className:"ml-3 block text-sm font-medium text-gray-700"},"Cash on Delivery")))),e.createElement("div",{className:"flex justify-between"},y>1&&y<4&&e.createElement("button",{type:"button",onClick:()=>b(y-1),className:"bg-gray-100 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium"},"Previous"),y<3&&e.createElement("button",{type:"button",onClick:()=>b(y+1),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors font-medium ml-auto"},"Next"),y===3&&e.createElement("button",{type:"submit",disabled:g,className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-medium ml-auto"},g?"Placing Order...":"Place Order"))),e.createElement("div",null,e.createElement("div",{className:"bg-white rounded-lg shadow-sm border p-6 sticky top-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Order Summary"),e.createElement("div",{className:"space-y-3 mb-6 max-h-60 overflow-y-auto"},o.items.map(u=>e.createElement("div",{key:u.id,className:"flex items-center space-x-3"},e.createElement("div",{className:"w-12 h-12 bg-gray-200 rounded overflow-hidden flex-shrink-0"},u.images&&u.images.length>0?e.createElement("img",{src:u.images[0],alt:u.name,className:"w-full h-full object-cover",onError:L=>{L.currentTarget.src="/api/placeholder/48/48?text="+encodeURIComponent(u.name)}}):e.createElement("div",{className:"w-full h-full flex items-center justify-center text-gray-400 text-xs"},"")),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("p",{className:"text-sm font-medium text-gray-900 truncate"},u.name),e.createElement("p",{className:"text-xs text-gray-600"},u.quantity,"  ",I(u.pricePerUnit))),e.createElement("p",{className:"text-sm font-medium text-gray-900"},I((u.pricePerUnit||0)*(u.quantity||0)))))),e.createElement("div",{className:"space-y-2 mb-6"},e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",null,"Subtotal (",o.totalItems," items)"),e.createElement("span",null,I(o.totalAmount))),e.createElement("div",{className:"flex justify-between text-gray-600"},e.createElement("span",{className:"flex items-center"},"Delivery Fee",o.deliveryFee===0&&e.createElement("span",{className:"ml-2 text-green-600 text-sm"},"(Free)")),e.createElement("span",null,I(o.deliveryFee))),e.createElement("div",{className:"border-t border-gray-200 pt-2"},e.createElement("div",{className:"flex justify-between text-lg font-semibold text-gray-900"},e.createElement("span",null,"Total"),e.createElement("span",null,I(o.grandTotal))))),e.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},e.createElement("div",{className:"flex items-center text-sm text-gray-600 mb-2"},e.createElement(me,{className:"w-4 h-4 mr-2"}),e.createElement("span",null,"Estimated delivery: 1-2 business days")),e.createElement("div",{className:"text-xs text-gray-500"},"Orders placed before 3 PM are processed the same day")))))))}function ci(){const{user:t,token:a}=X(),r=_e(),s=x=>{r("/admin/consignments")},n=async x=>{try{await new Promise(E=>setTimeout(E,500)),A.success(`User ${x} approved successfully`),f(E=>({...E,recentUsers:E.recentUsers.map(N=>N.id===x?{...N,status:"ACTIVE"}:N),pendingApprovals:Math.max(0,E.pendingApprovals-1)}))}catch(E){console.error("Error approving user:",E),A.error("Failed to approve user")}},l=async()=>{try{console.log(" Fetching users from real database");const E=(await ae.get("/admin/users")).data,N=E.users||E;console.log(" Users data received:",N);const k=Array.isArray(N)?N:[];f(v=>({...v,totalUsers:k.length,pendingApprovals:k.filter(F=>!F.verified).length,recentUsers:k.slice(0,5).map(F=>({id:F.id,name:`${F.first_name||F.firstName} ${F.last_name||F.lastName}`,email:F.email,role:F.role,status:F.verified?"ACTIVE":"PENDING",joinedAt:new Date(F.created_at||F.createdAt).toLocaleDateString()}))}))}catch(x){console.error("Error fetching users:",x),f(E=>({...E,totalUsers:5,pendingApprovals:2,recentUsers:[{id:1,name:"Admin User",email:"admin@zuasoko.com",role:"ADMIN",status:"ACTIVE",joinedAt:new Date().toLocaleDateString()},{id:2,name:"John Kimani",email:"john@example.com",role:"FARMER",status:"ACTIVE",joinedAt:new Date().toLocaleDateString()}]})),A.error("Using demo user data - API unavailable")}},o=async()=>{try{console.log(" Fetching recent activity from database");const x=await ae.get("/admin/activity");if(x.data.success){const E=x.data.activities.map(N=>({id:N.id,type:N.type,message:N.description,time:new Date(N.timestamp).toLocaleString(),status:N.status}));f(N=>({...N,recentActivities:E})),console.log(" Recent activity loaded:",E)}}catch(x){console.error(" Error fetching recent activity:",x),f(E=>({...E,recentActivities:[{id:1,type:"user",message:"New farmer registration: John Kimani",time:"5 minutes ago",status:"pending"},{id:2,type:"consignment",message:"Consignment submitted by Jane Wanjiku",time:"15 minutes ago",status:"pending"}]}))}},[c,f]=P.useState({totalUsers:0,pendingApprovals:0,activeConsignments:0,monthlyRevenue:0,recentActivities:[],pendingConsignments:[],recentUsers:[]}),[m,g]=P.useState(!0),d=async()=>{try{console.log(" Fetching analytics stats from database");const x=await ae.get("/admin/analytics/stats");if(x.data.success){const E=x.data.stats;console.log(" Analytics stats received:",E),f(N=>({...N,totalUsers:E.totalUsers||0,pendingApprovals:E.pendingApprovals||0,activeConsignments:E.totalConsignments||0,monthlyRevenue:E.totalRevenue||0}))}}catch(x){console.error(" Error fetching analytics stats:",x),f(E=>({...E,totalUsers:5,pendingApprovals:2,activeConsignments:8,monthlyRevenue:45e3})),A.error("Using demo analytics data - API unavailable")}};P.useEffect(()=>{(async()=>{g(!0),await Promise.all([l(),d(),o()]),f(E=>({...E,pendingConsignments:[{id:1,title:"Organic Tomatoes - 100kg",farmer:"Jane Wanjiku",value:13e3,submittedAt:"2 hours ago"},{id:2,title:"Premium Maize - 200kg",farmer:"Peter Kamau",value:12e3,submittedAt:"5 hours ago"},{id:3,title:"Fresh Spinach - 50 bunches",farmer:"Grace Muthoni",value:2500,submittedAt:"1 day ago"}]})),g(!1)})()},[]);const y=[{title:"Manage Users",description:"View and manage platform users",icon:ke,color:"bg-blue-500",link:"/admin/users",count:c.totalUsers},{title:"Review Consignments",description:"Approve pending consignments",icon:B,color:"bg-green-500",link:"/admin/consignments",count:c.pendingApprovals},{title:"Marketplace Management",description:"Manage products and orders",icon:Ce,color:"bg-orange-500",link:"/admin/marketplace",count:null},{title:"Registration Fees",description:"Manage farmer registration fees",icon:Ie,color:"bg-red-500",link:"/admin/registration-fees",count:null},{title:"View Analytics",description:"Platform insights and metrics",icon:Za,color:"bg-purple-500",link:"/admin/analytics",count:null},{title:"M-Pesa Settings",description:"Configure M-Pesa API credentials",icon:Ie,color:"bg-indigo-500",link:"/admin/mpesa-settings",count:null},{title:"System Settings",description:"Configure platform settings",icon:at,color:"bg-gray-500",link:"/admin/settings",count:null}],b=x=>{switch(x){case"user":return e.createElement(ke,{className:"w-4 h-4"});case"consignment":return e.createElement(B,{className:"w-4 h-4"});case"order":return e.createElement(Ce,{className:"w-4 h-4"});case"driver":return e.createElement(me,{className:"w-4 h-4"});default:return e.createElement(Yt,{className:"w-4 h-4"})}},w=x=>{switch(x){case"pending":return"text-yellow-600 bg-yellow-100";case"completed":return"text-green-600 bg-green-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},h=x=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(x);return m?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading dashboard..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-1"},"Here's what's happening on your platform today.")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(Yt,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>r("/admin/users"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(ke,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},c.totalUsers),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/users?filter=pending"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(lt,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},c.pendingApprovals),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approvals"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/consignments"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(B,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},c.activeConsignments),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Consignments"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>r("/admin/analytics"),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-purple-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors"},e.createElement(Ce,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-purple-600 transition-colors"},h(c.monthlyRevenue)),e.createElement("p",{className:"text-gray-600 text-sm"},"Monthly Revenue"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-purple-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900 mb-6"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},y.map((x,E)=>e.createElement(H,{key:E,to:x.link,className:"p-4 border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200 group"},e.createElement("div",{className:"flex items-start justify-between mb-3"},e.createElement("div",{className:`p-2 rounded-lg ${x.color}`},e.createElement(x.icon,{className:"w-5 h-5 text-white"})),x.count!==null&&e.createElement("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded-full text-xs font-medium"},x.count)),e.createElement("h3",{className:"font-medium text-gray-900 group-hover:text-primary-600 transition-colors"},x.title),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},x.description),e.createElement("div",{className:"flex items-center mt-3 text-primary-600 group-hover:text-primary-700"},e.createElement("span",{className:"text-sm font-medium"},"Manage"),e.createElement(be,{className:"w-4 h-4 ml-1 group-hover:translate-x-1 transition-transform"})))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement(rt,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.recentActivities.map(x=>e.createElement("div",{key:x.id,className:"p-6"},e.createElement("div",{className:"flex items-start"},e.createElement("div",{className:`p-2 rounded-lg ${w(x.status)} mr-4`},b(x.type)),e.createElement("div",{className:"flex-1"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},x.message),e.createElement("p",{className:"text-sm text-gray-500 mt-1"},x.time)),x.status==="pending"&&e.createElement("span",{className:"bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium"},"Action Required"))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/notifications",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all activities "))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Pending Consignments"),e.createElement(B,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},c.pendingConsignments.map(x=>e.createElement("div",{key:x.id,className:"p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h4",{className:"text-sm font-medium text-gray-900"},x.title),e.createElement("p",{className:"text-sm text-gray-500"},"by ",x.farmer),e.createElement("p",{className:"text-sm text-gray-500"},x.submittedAt)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"text-sm font-medium text-gray-900"},h(x.value)),e.createElement("button",{onClick:()=>s(x.id),className:"mt-2 bg-primary-600 text-white px-3 py-1 rounded text-xs hover:bg-primary-700"},"Review")))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/consignments",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all consignments ")))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Users"),e.createElement(ja,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Action"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},c.recentUsers.map(x=>e.createElement("tr",{key:x.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},x.name)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800"},x.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${x.status==="ACTIVE"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`},x.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},x.joinedAt),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},x.status==="PENDING"?e.createElement("button",{onClick:()=>n(x.id),className:"text-green-600 hover:text-green-900"},"Approve"):e.createElement("button",{onClick:()=>r("/admin/users"),className:"text-primary-600 hover:text-primary-900"},"View"))))))),e.createElement("div",{className:"p-6 border-t border-gray-200"},e.createElement(H,{to:"/admin/users",className:"text-primary-600 hover:text-primary-700 text-sm font-medium"},"View all users ")))))}const ii={ADMIN:"bg-red-100 text-red-800",FARMER:"bg-green-100 text-green-800",CUSTOMER:"bg-blue-100 text-blue-800",DRIVER:"bg-purple-100 text-purple-800",AGENT:"bg-yellow-100 text-yellow-800"},mi={ACTIVE:"bg-green-100 text-green-800",PENDING:"bg-yellow-100 text-yellow-800",SUSPENDED:"bg-orange-100 text-orange-800",BLOCKED:"bg-red-100 text-red-800"};function di(){const{token:t}=X(),[a,r]=P.useState([]),[s,n]=P.useState(!0),[l,o]=P.useState(""),[c,f]=P.useState("ALL"),[m,g]=P.useState("ALL"),[d,y]=P.useState(null),[b,w]=P.useState(!1),[h,x]=P.useState("activate");P.useEffect(()=>{E()},[]);const E=async()=>{try{const C=[{id:"1",phone:"+254712345678",email:"admin@zuasoko.com",firstName:"Admin",lastName:"User",role:"ADMIN",status:"ACTIVE",createdAt:new Date().toISOString()},{id:"2",phone:"+254734567890",email:"farmer@zuasoko.com",firstName:"Jane",lastName:"Wanjiku",role:"FARMER",status:"ACTIVE",profile:{farmName:"Green Valley Farm",county:"Kiambu"},createdAt:new Date(Date.now()-6048e5).toISOString()},{id:"3",phone:"+254756789012",email:"customer@zuasoko.com",firstName:"Mary",lastName:"Wangari",role:"CUSTOMER",status:"ACTIVE",profile:{county:"Nairobi"},createdAt:new Date(Date.now()-12096e5).toISOString()},{id:"4",phone:"+254778901234",email:"driver@zuasoko.com",firstName:"Michael",lastName:"Kiprotich",role:"DRIVER",status:"ACTIVE",profile:{vehicleType:"Pickup Truck",licenseNumber:"DL123456789"},createdAt:new Date(Date.now()-18144e5).toISOString()},{id:"5",phone:"+254790123456",email:"pending.farmer@zuasoko.com",firstName:"John",lastName:"Kimani",role:"FARMER",status:"PENDING",profile:{farmName:"Highlands Farm",county:"Nyeri"},createdAt:new Date(Date.now()-1728e5).toISOString()}];r(C)}catch(C){console.error("Error fetching users:",C),A.error("Failed to fetch users")}finally{n(!1)}},N=(C,I)=>{y(C),x(I),w(!0)},k=async()=>{if(d)try{let C=d.status,I="";switch(h){case"activate":C="ACTIVE",I="User activated successfully";break;case"suspend":C="SUSPENDED",I="User suspended successfully";break;case"block":C="BLOCKED",I="User blocked successfully";break;case"delete":r(a.filter(u=>u.id!==d.id)),A.success("User deleted successfully"),w(!1);return}r(a.map(u=>u.id===d.id?{...u,status:C}:u)),A.success(I),w(!1)}catch{A.error("Failed to update user")}},v=Array.isArray(a)?a:[],F=v.filter(C=>{const I=C.firstName.toLowerCase().includes(l.toLowerCase())||C.lastName.toLowerCase().includes(l.toLowerCase())||C.email?.toLowerCase().includes(l.toLowerCase())||C.phone.includes(l),u=c==="ALL"||C.role===c,L=m==="ALL"||C.status===m;return I&&u&&L}),M=(()=>{const C=v.length,I=v.filter(j=>j.status==="ACTIVE").length,u=v.filter(j=>j.status==="PENDING").length,L=v.filter(j=>j.status==="BLOCKED"||j.status==="SUSPENDED").length;return{total:C,active:I,pending:u,blocked:L}})();return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading users..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"User Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage platform users and their permissions")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(Oe,{className:"w-4 h-4"}),e.createElement("span",null,"Admin Panel")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>{f("ALL"),g("ALL"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(ke,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},M.total),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Users"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{f("ALL"),g("ACTIVE"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(ja,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},M.active),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Users"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{f("ALL"),g("PENDING"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(ja,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},M.pending),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Approval"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{f("ALL"),g("SUSPENDED"),o("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-red-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg group-hover:bg-red-200 transition-colors"},e.createElement(Sn,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-red-600 transition-colors"},M.blocked),e.createElement("p",{className:"text-gray-600 text-sm"},"Blocked/Suspended"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-red-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col lg:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.createElement("input",{type:"text",placeholder:"Search users...",value:l,onChange:C=>o(C.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:c,onChange:C=>f(C.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Roles"),e.createElement("option",{value:"ADMIN"},"Admin"),e.createElement("option",{value:"FARMER"},"Farmer"),e.createElement("option",{value:"CUSTOMER"},"Customer"),e.createElement("option",{value:"DRIVER"},"Driver"),e.createElement("option",{value:"AGENT"},"Agent")),e.createElement("select",{value:m,onChange:C=>g(C.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"ALL"},"All Status"),e.createElement("option",{value:"ACTIVE"},"Active"),e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"SUSPENDED"},"Suspended"),e.createElement("option",{value:"BLOCKED"},"Blocked"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Users (",F.length,")")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"min-w-full divide-y divide-gray-200"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"User"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contact"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Joined"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},F.map(C=>e.createElement("tr",{key:C.id,className:"hover:bg-gray-50"},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center"},e.createElement("span",{className:"text-primary-600 font-medium"},C.firstName[0],C.lastName[0])),e.createElement("div",{className:"ml-4"},e.createElement("div",{className:"text-sm font-medium text-gray-900"},C.firstName," ",C.lastName),C.profile?.farmName&&e.createElement("div",{className:"text-sm text-gray-500"},C.profile.farmName)))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("div",{className:"text-sm text-gray-900"},e.createElement("div",{className:"flex items-center gap-1 mb-1"},e.createElement(Ye,{className:"w-3 h-3"}),C.phone),C.email&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(ma,{className:"w-3 h-3"}),C.email))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${ii[C.role]||"bg-gray-100 text-gray-800"}`},C.role)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${mi[C.status]||"bg-gray-100 text-gray-800"}`},C.status)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},new Date(C.createdAt).toLocaleDateString()),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium"},e.createElement("div",{className:"flex items-center gap-2"},C.status==="PENDING"&&e.createElement("button",{onClick:()=>N(C,"activate"),className:"text-green-600 hover:text-green-900"},"Activate"),C.status==="ACTIVE"&&e.createElement("button",{onClick:()=>N(C,"suspend"),className:"text-yellow-600 hover:text-yellow-900"},"Suspend"),C.status!=="BLOCKED"&&e.createElement("button",{onClick:()=>N(C,"block"),className:"text-red-600 hover:text-red-900"},"Block"))))))))),b&&d&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Confirm Action")),e.createElement("div",{className:"p-6"},e.createElement("p",{className:"text-gray-600 mb-4"},"Are you sure you want to ",h,' user "',d.firstName," ",d.lastName,'"?'),h==="delete"&&e.createElement("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4"},e.createElement("p",{className:"text-red-700 text-sm"},e.createElement("strong",null,"Warning:")," This action cannot be undone. All user data will be permanently deleted.")),e.createElement("div",{className:"flex gap-4"},e.createElement("button",{type:"button",onClick:()=>w(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:k,className:`flex-1 px-4 py-2 rounded-lg transition-colors ${h==="delete"?"bg-red-600 text-white hover:bg-red-700":"bg-primary-600 text-white hover:bg-primary-700"}`},"Confirm ",h)))))))}const ui={PENDING:{color:"bg-yellow-100 text-yellow-800",icon:de,label:"Pending Review"},APPROVED:{color:"bg-green-100 text-green-800",icon:fe,label:"Approved"},REJECTED:{color:"bg-red-100 text-red-800",icon:kn,label:"Rejected"},PRICE_SUGGESTED:{color:"bg-blue-100 text-blue-800",icon:Ce,label:"Price Suggested"},DRIVER_ASSIGNED:{color:"bg-purple-100 text-purple-800",icon:me,label:"Driver Assigned"},IN_TRANSIT:{color:"bg-indigo-100 text-indigo-800",icon:me,label:"In Transit"},DELIVERED:{color:"bg-teal-100 text-teal-800",icon:B,label:"Delivered"},COMPLETED:{color:"bg-gray-100 text-gray-800",icon:fe,label:"Completed"}};function gi(){const{token:t}=X(),[a,r]=P.useState([]),[s,n]=P.useState([]),[l,o]=P.useState(!0),[c,f]=P.useState("ALL"),[m,g]=P.useState(null),[d,y]=P.useState(!1),[b,w]=P.useState("approve"),[h,x]=P.useState(""),[E,N]=P.useState("");P.useEffect(()=>{k(),v()},[]);const k=async()=>{try{console.log(" Fetching consignments from live database");const u=await V.get("/api/admin/consignments",{headers:{Authorization:`Bearer ${t}`}});console.log(" Consignments response:",u.data);const L=Array.isArray(u.data)?u.data:u.data.consignments||[];console.log(" Setting consignments array:",L),r(Array.isArray(L)?L:[])}catch(u){console.error(" Error fetching consignments:",u),A.error("Failed to fetch consignments from database"),r([])}finally{o(!1)}},v=async()=>{try{console.log(" Fetching drivers from live database");const u=await V.get("/api/admin/drivers",{headers:{Authorization:`Bearer ${t}`}});console.log(" Drivers response:",u.data);const L=Array.isArray(u.data)?u.data:u.data.drivers||[];console.log(" Setting drivers array:",L),n(Array.isArray(L)?L:[])}catch(u){console.error(" Error fetching drivers:",u),A.error("Failed to fetch drivers from database"),n([])}},F=async(u,L)=>{if(g(u),w(L),y(!0),L==="suggest_price"){const j=u.proposedPricePerUnit||u.price_per_unit||0;x(j.toString())}},R=async()=>{if(m)try{let u={};switch(b){case"approve":u={status:"APPROVED"};break;case"reject":u={status:"REJECTED"};break;case"suggest_price":if(!h||Number(h)<=0){A.error("Please enter a valid price");return}u={status:"PRICE_SUGGESTED",suggestedPrice:Number(h)};break;case"assign_driver":if(!E){A.error("Please select a driver");return}u={status:"DRIVER_ASSIGNED",driverId:E};break}await V.patch(`/api/admin/consignments/${m.id}`,u,{headers:{Authorization:`Bearer ${t}`}}),A.success("Consignment updated successfully!"),y(!1),k(),x(""),N("")}catch(u){console.error("Error updating consignment:",u),A.error("Failed to update consignment")}},M=Array.isArray(a)?a:[],C=c==="ALL"?M:M.filter(u=>u.status===c),I=u=>{switch(u.status){case"PENDING":return e.createElement("div",{className:"flex gap-2"},e.createElement("button",{onClick:()=>F(u,"approve"),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700"},"Approve"),e.createElement("button",{onClick:()=>F(u,"suggest_price"),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700"},"Suggest Price"),e.createElement("button",{onClick:()=>F(u,"reject"),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700"},"Reject"));case"APPROVED":return e.createElement("button",{onClick:()=>F(u,"assign_driver"),className:"bg-purple-600 text-white px-3 py-1 rounded text-sm hover:bg-purple-700"},"Assign Driver");default:return null}};return l?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading consignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Consignment Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Review and manage farmer consignments")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(de,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(u=>u.status==="PENDING").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Review")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(fe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(u=>u.status==="APPROVED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Approved")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(me,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(u=>u.status==="DRIVER_ASSIGNED"||u.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},M.filter(u=>u.status==="DELIVERED"||u.status==="COMPLETED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-wrap gap-2"},["ALL","PENDING","APPROVED","DRIVER_ASSIGNED","IN_TRANSIT","DELIVERED"].map(u=>e.createElement("button",{key:u,onClick:()=>f(u),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${c===u?"bg-primary-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`},u.replace("_"," "))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Consignments (",C.length,")")),C.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No consignments found"),e.createElement("p",{className:"text-gray-600"},c==="ALL"?"No consignments have been submitted yet":`No ${c.toLowerCase()} consignments`)):e.createElement("div",{className:"divide-y divide-gray-200"},C.map(u=>{const L=ui[u.status],j=L?.icon||B,K=(u.finalPricePerUnit||u.proposedPricePerUnit||u.price_per_unit||0)*(u.quantity||0);return e.createElement("div",{key:u.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},u.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},u.description),u.farmer&&e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ae,{className:"w-4 h-4"}),e.createElement("span",null,u.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ye,{className:"w-4 h-4"}),e.createElement("span",null,u.farmer.phone)),u.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Te,{className:"w-4 h-4"}),e.createElement("span",null,u.farmer.profile.county))),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,u.quantity," ",u.unit),e.createElement("span",null,""),e.createElement("span",null,"KSh ",u.proposedPricePerUnit||u.price_per_unit||0," per"," ",u.unit),e.createElement("span",null,""),e.createElement("span",null,u.category),e.createElement("span",null,""),e.createElement("span",null,"Total: KSh ",K.toLocaleString())),u.status==="PRICE_SUGGESTED"&&u.adminSuggestedPrice&&e.createElement("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("p",{className:"text-sm text-blue-700"},e.createElement("strong",null,"Price suggested:")," KSh"," ",u.adminSuggestedPrice," per"," ",u.unit,e.createElement("span",{className:"ml-2 text-blue-600"},"(Total: KSh"," ",(u.adminSuggestedPrice*u.quantity).toLocaleString(),")")))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${L?.color||"bg-gray-100 text-gray-800"}`},e.createElement(j,{className:"w-4 h-4"}),L?.label||u.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(st,{className:"w-3 h-3"}),new Date(u.createdAt).toLocaleDateString()),I(u))))}))),d&&m&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-md w-full"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},b==="approve"&&"Approve Consignment",b==="reject"&&"Reject Consignment",b==="suggest_price"&&"Suggest New Price",b==="assign_driver"&&"Assign Driver"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},m.title)),e.createElement("div",{className:"p-6"},b==="suggest_price"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Current proposed price: KSh"," ",m.proposedPricePerUnit||m.price_per_unit||0," per"," ",m.unit),e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Your suggested price (KSh per ",m.unit,")"),e.createElement("input",{type:"number",value:h,onChange:u=>x(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter suggested price",min:"1",required:!0}))),b==="assign_driver"&&e.createElement("div",{className:"space-y-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Select Driver"),e.createElement("select",{value:E,onChange:u=>N(u.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0},e.createElement("option",{value:""},"Choose a driver"),Array.isArray(s)?s.filter(u=>u.status==="ACTIVE"&&u.verified).map(u=>e.createElement("option",{key:u.id,value:u.id},u.first_name," ",u.last_name," - ",u.vehicle_type," (",u.vehicle_registration,") - Rating:"," ",u.rating,"")):[]))),(b==="approve"||b==="reject")&&e.createElement("p",{className:"text-gray-600"},"Are you sure you want to ",b," this consignment?"),e.createElement("div",{className:"flex gap-4 mt-6"},e.createElement("button",{type:"button",onClick:()=>y(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"},"Cancel"),e.createElement("button",{onClick:R,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors"},"Confirm")))))))}function fi(){const{token:t}=X(),a=_e(),[r,s]=P.useState(!0),[n,l]=P.useState("30"),[o,c]=P.useState({totalUsers:0,totalConsignments:0,totalOrders:0,totalRevenue:0,activeDrivers:0,pendingApprovals:0,userGrowth:0,revenueGrowth:0}),[f,m]=P.useState([]);P.useEffect(()=>{g()},[]);const g=async()=>{try{s(!0),console.log(" Fetching analytics data from database");const h=await ae.get("/admin/analytics/stats");h.data.success&&(c(h.data.stats),console.log(" Analytics stats loaded:",h.data.stats)),m([{month:"Jan",revenue:42e3,orders:156,users:89},{month:"Feb",revenue:38e3,orders:142,users:112},{month:"Mar",revenue:45e3,orders:168,users:95},{month:"Apr",revenue:52e3,orders:195,users:134},{month:"May",revenue:48e3,orders:178,users:108},{month:"Jun",revenue:55e3,orders:205,users:167}]),console.log(" Monthly chart data set (fallback data)")}catch(h){console.error(" Error fetching analytics:",h),A.error("Failed to fetch analytics data"),c({totalUsers:1247,totalConsignments:856,totalOrders:2341,totalRevenue:4567890,activeDrivers:23,pendingApprovals:12,userGrowth:12.5,revenueGrowth:8.2}),m([{name:"Jan",value:32e4},{name:"Feb",value:28e4},{name:"Mar",value:45e4},{name:"Apr",value:38e4},{name:"May",value:52e4},{name:"Jun",value:49e4},{name:"Jul",value:64e4},{name:"Aug",value:58e4},{name:"Sep",value:72e4},{name:"Oct",value:68e4},{name:"Nov",value:75e4},{name:"Dec",value:82e4}])}finally{s(!1)}},[d]=P.useState([{name:"Vegetables",value:45},{name:"Fruits",value:25},{name:"Grains",value:15},{name:"Leafy Greens",value:10},{name:"Others",value:5}]),[y]=P.useState([{id:1,type:"order",message:"New order placed by Mary Wangari",amount:"KSh 2,450",time:"5 minutes ago"},{id:2,type:"consignment",message:"Consignment approved for Jane Wanjiku",amount:"KSh 15,000",time:"12 minutes ago"},{id:3,type:"user",message:"New farmer registered: Peter Kamau",amount:"",time:"25 minutes ago"},{id:4,type:"delivery",message:"Delivery completed by Michael Kiprotich",amount:"KSh 3,200",time:"1 hour ago"},{id:5,type:"payment",message:"Payment processed for Grace Muthoni",amount:"KSh 8,750",time:"2 hours ago"}]);P.useEffect(()=>{setTimeout(()=>s(!1),1e3)},[n]);const b=h=>new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",minimumFractionDigits:0}).format(h||0),w=h=>{switch(h){case"order":return e.createElement(B,{className:"w-4 h-4 text-blue-600"});case"consignment":return e.createElement(it,{className:"w-4 h-4 text-green-600"});case"user":return e.createElement(ke,{className:"w-4 h-4 text-purple-600"});case"delivery":return e.createElement(me,{className:"w-4 h-4 text-orange-600"});case"payment":return e.createElement(Ce,{className:"w-4 h-4 text-emerald-600"});default:return e.createElement(Yt,{className:"w-4 h-4 text-gray-600"})}};return r?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading analytics..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Analytics Dashboard"),e.createElement("p",{className:"text-gray-600 mt-1"},"Platform insights and performance metrics")),e.createElement("div",{className:"flex items-center gap-4"},e.createElement("button",{onClick:g,disabled:r,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},e.createElement(Ve,{className:`w-4 h-4 ${r?"animate-spin":""}`}),e.createElement("span",null,"Refresh")),e.createElement("select",{value:n,onChange:h=>l(h.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"},e.createElement("option",{value:"7"},"Last 7 days"),e.createElement("option",{value:"30"},"Last 30 days"),e.createElement("option",{value:"90"},"Last 3 months"),e.createElement("option",{value:"365"},"Last year")),e.createElement("button",{className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(Wt,{className:"w-4 h-4"}),"Export")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Revenue"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},b(o.totalRevenue))),e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(Ce,{className:"w-6 h-6 text-green-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(it,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",o.revenueGrowth||0,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Users"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},(o.totalUsers||0).toLocaleString())),e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(ke,{className:"w-6 h-6 text-blue-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(it,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+",o.userGrowth||0,"%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Total Orders"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},(o.totalOrders||0).toLocaleString())),e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-purple-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(it,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+15.3%"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month"))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-600"},"Active Drivers"),e.createElement("p",{className:"text-2xl font-bold text-gray-900"},o.activeDrivers||0)),e.createElement("div",{className:"p-3 bg-orange-100 rounded-lg"},e.createElement(me,{className:"w-6 h-6 text-orange-600"}))),e.createElement("div",{className:"mt-4 flex items-center"},e.createElement(it,{className:"w-4 h-4 text-green-600 mr-1"}),e.createElement("span",{className:"text-sm font-medium text-green-600"},"+2"),e.createElement("span",{className:"text-sm text-gray-500 ml-2"},"vs last month")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Monthly Revenue"),e.createElement(Za,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"h-64 flex items-end justify-between gap-2"},f.map((h,x)=>e.createElement("div",{key:x,className:"flex flex-col items-center flex-1"},e.createElement("div",{className:"bg-primary-600 rounded-t w-full transition-all duration-300 hover:bg-primary-700",style:{height:`${h.value/Math.max(...f.map(E=>E.value))*100}%`,minHeight:"4px"}}),e.createElement("span",{className:"text-xs text-gray-500 mt-2"},h.name))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center justify-between mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Product Categories"),e.createElement(Cn,{className:"w-5 h-5 text-gray-400"})),e.createElement("div",{className:"space-y-4"},d.map((h,x)=>e.createElement("div",{key:x,className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"w-4 h-4 rounded mr-3",style:{backgroundColor:`hsl(${x*72}, 70%, 50%)`}}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},h.name)),e.createElement("span",{className:"text-sm text-gray-500"},h.value,"%")))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"Recent Activity"),e.createElement(Yt,{className:"w-5 h-5 text-gray-400"}))),e.createElement("div",{className:"divide-y divide-gray-200"},y.map(h=>e.createElement("div",{key:h.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-2 bg-gray-100 rounded-lg mr-4"},w(h.type)),e.createElement("div",null,e.createElement("p",{className:"text-sm font-medium text-gray-900"},h.message),e.createElement("p",{className:"text-sm text-gray-500"},h.time))),h.amount&&e.createElement("div",{className:"text-sm font-medium text-gray-900"},h.amount)))))),e.createElement("div",{className:"mt-8 bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},e.createElement("button",{onClick:()=>a("/admin/users"),className:"p-4 border border-gray-200 rounded-lg hover:bg-blue-50 hover:border-blue-300 transition-colors text-left group"},e.createElement(ke,{className:"w-6 h-6 text-blue-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-blue-700"},"Manage Users"),e.createElement("p",{className:"text-sm text-gray-500"},"View and manage platform users")),e.createElement("button",{onClick:()=>a("/admin/consignments"),className:"p-4 border border-gray-200 rounded-lg hover:bg-green-50 hover:border-green-300 transition-colors text-left group"},e.createElement(B,{className:"w-6 h-6 text-green-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-green-700"},"Review Consignments"),e.createElement("p",{className:"text-sm text-gray-500"},"Approve pending consignments")),e.createElement("button",{onClick:()=>a("/admin/registration-fees"),className:"p-4 border border-gray-200 rounded-lg hover:bg-purple-50 hover:border-purple-300 transition-colors text-left group"},e.createElement(Wt,{className:"w-6 h-6 text-purple-600 mb-2 group-hover:scale-110 transition-transform"}),e.createElement("h4",{className:"font-medium text-gray-900 group-hover:text-purple-700"},"Registration Fees"),e.createElement("p",{className:"text-sm text-gray-500"},"Manage farmer registration fees"))))))}function pi(){const{token:t}=X(),[a,r]=P.useState(!0),[s,n]=P.useState(!1),[l,o]=P.useState("platform"),[c,f]=P.useState(!1),[m,g]=P.useState({platform:{name:"Zuasoko Agricultural Platform",description:"Connecting farmers directly with customers and managing agricultural supply chains",supportEmail:"support@zuasoko.com",supportPhone:"+254700000000"},fees:{farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7},payments:{mpesaEnabled:!0,mpesaShortcode:"174379",mpesaPasskey:"",bankTransferEnabled:!0,commissionRate:5},notifications:{emailEnabled:!0,smsEnabled:!0,pushEnabled:!0,adminNotifications:!0},security:{passwordMinLength:8,sessionTimeout:24,twoFactorRequired:!1,maxLoginAttempts:5},features:{consignmentApprovalRequired:!0,autoDriverAssignment:!1,inventoryTracking:!0,priceModeration:!0}});P.useEffect(()=>{d()},[]);const d=async()=>{try{const h=await V.get("/api/admin/settings",{headers:{Authorization:`Bearer ${t}`}});h.data.settings&&g(h.data.settings)}catch{console.log("Using default settings - API endpoint not available")}finally{r(!1)}},y=async()=>{n(!0);try{await V.put("/api/admin/settings",m,{headers:{Authorization:`Bearer ${t}`}}),A.success("Settings saved successfully")}catch(h){console.error("Error saving settings:",h),A.success("Settings saved locally (demo mode)")}finally{n(!1)}},b=(h,x,E)=>{g(N=>({...N,[h]:{...N[h],[x]:E}}))},w=[{id:"platform",label:"Platform",icon:Ua},{id:"payments",label:"Payments",icon:Ie},{id:"fees",label:"Registration Fees",icon:Ce},{id:"notifications",label:"Notifications",icon:rt},{id:"security",label:"Security",icon:Oe},{id:"features",label:"Features",icon:at}];return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Ve,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading settings..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"System Settings"),e.createElement("p",{className:"text-gray-600 mt-1"},"Configure platform settings and system behavior")),e.createElement("button",{onClick:y,disabled:s,className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 disabled:opacity-50 flex items-center space-x-2"},s?e.createElement(Ve,{className:"w-4 h-4 animate-spin"}):e.createElement(da,{className:"w-4 h-4"}),e.createElement("span",null,s?"Saving...":"Save Changes")))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8"},e.createElement("div",{className:"lg:col-span-1"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-4 border-b border-gray-200"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Settings Categories")),e.createElement("nav",{className:"p-2"},w.map(h=>e.createElement("button",{key:h.id,onClick:()=>o(h.id),className:`w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors ${l===h.id?"bg-green-50 text-green-700 border border-green-200":"text-gray-600 hover:bg-gray-50"}`},e.createElement(h.icon,{className:"w-5 h-5"}),e.createElement("span",null,h.label)))))),e.createElement("div",{className:"lg:col-span-3"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},l==="platform"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Ua,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Name"),e.createElement("input",{type:"text",value:m.platform?.name||"",onChange:h=>b("platform","name",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Platform Description"),e.createElement("textarea",{value:m.platform?.description||"",onChange:h=>b("platform","description",h.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Email"),e.createElement("input",{type:"email",value:m.platform?.supportEmail||"",onChange:h=>b("platform","supportEmail",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Support Phone"),e.createElement("input",{type:"tel",value:m.platform?.supportPhone||"",onChange:h=>b("platform","supportPhone",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))))),l==="payments"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Ie,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Payment Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"M-Pesa Integration"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable M-Pesa payments")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.payments?.mpesaEnabled||!1,onChange:h=>b("payments","mpesaEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Bank Transfer"),e.createElement("p",{className:"text-sm text-gray-600"},"Enable bank transfers")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.payments?.bankTransferEnabled||!1,onChange:h=>b("payments","bankTransferEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))),m.payments.mpesaEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"M-Pesa Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Business Shortcode"),e.createElement("input",{type:"text",value:m.payments.mpesaShortcode,onChange:h=>b("payments","mpesaShortcode",h.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Passkey"),e.createElement("div",{className:"relative"},e.createElement("input",{type:c?"text":"password",value:m.payments.mpesaPasskey,onChange:h=>b("payments","mpesaPasskey",h.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter M-Pesa passkey"}),e.createElement("button",{type:"button",onClick:()=>f(!c),className:"absolute inset-y-0 right-0 pr-3 flex items-center"},c?e.createElement(kt,{className:"w-4 h-4 text-gray-400"}):e.createElement(Ke,{className:"w-4 h-4 text-gray-400"})))))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Commission Rate (%)"),e.createElement("input",{type:"number",min:"0",max:"20",step:"0.1",value:m.payments.commissionRate,onChange:h=>b("payments","commissionRate",parseFloat(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Platform commission charged on transactions")))),l==="notifications"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(rt,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Notification Settings")),e.createElement("div",{className:"space-y-4"},[{key:"emailEnabled",label:"Email Notifications",desc:"Send notifications via email"},{key:"smsEnabled",label:"SMS Notifications",desc:"Send notifications via SMS"},{key:"pushEnabled",label:"Push Notifications",desc:"Send push notifications to mobile apps"},{key:"adminNotifications",label:"Admin Notifications",desc:"Receive admin-specific notifications"}].map(h=>e.createElement("div",{key:h.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},h.label),e.createElement("p",{className:"text-sm text-gray-600"},h.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.notifications?.[h.key]||!1,onChange:x=>b("notifications",h.key,x.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))),l==="fees"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Ce,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Registration Fee Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(Pn,{className:"w-5 h-5 text-yellow-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-yellow-800"},"Important"),e.createElement("p",{className:"text-sm text-yellow-700 mt-1"},"Farmers must pay the registration fee before they can register consignments. This helps maintain platform quality and covers operational costs.")))),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Enable Registration Fee"),e.createElement("p",{className:"text-sm text-gray-600"},"Require farmers to pay registration fee before consignment submission")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.fees.registrationFeeEnabled,onChange:h=>b("fees","registrationFeeEnabled",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))),m.fees.registrationFeeEnabled&&e.createElement("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200"},e.createElement("h4",{className:"font-medium text-green-900"},"Registration Fee Settings"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Registration Fee Amount (KES)"),e.createElement("input",{type:"number",min:"0",step:"1",value:m.fees.farmerRegistrationFee,onChange:h=>b("fees","farmerRegistrationFee",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Amount farmers must pay to register on the platform")),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Grace Period (Days)"),e.createElement("input",{type:"number",min:"0",max:"30",value:m.fees.gracePeriodDays,onChange:h=>b("fees","gracePeriodDays",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}),e.createElement("p",{className:"text-sm text-gray-600 mt-1"},"Days to allow farmers to submit consignments before payment"))),e.createElement("div",{className:"bg-white p-4 rounded border border-green-300"},e.createElement("h5",{className:"font-medium text-gray-900 mb-2"},"Payment Process"),e.createElement("ol",{className:"text-sm text-gray-700 space-y-1 list-decimal list-inside"},e.createElement("li",null,"Farmer registers on the platform"),e.createElement("li",null,"Admin sends STK push for registration fee payment"),e.createElement("li",null,"Upon successful payment, farmer can submit consignments"),e.createElement("li",null,"Unpaid farmers have"," ",m.fees.gracePeriodDays," days grace period")))))),l==="security"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(Oe,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Security Configuration")),e.createElement("div",{className:"space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Minimum Password Length"),e.createElement("input",{type:"number",min:"6",max:"20",value:m.security.passwordMinLength,onChange:h=>b("security","passwordMinLength",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Session Timeout (hours)"),e.createElement("input",{type:"number",min:"1",max:"168",value:m.security.sessionTimeout,onChange:h=>b("security","sessionTimeout",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Maximum Login Attempts"),e.createElement("input",{type:"number",min:"3",max:"10",value:m.security.maxLoginAttempts,onChange:h=>b("security","maxLoginAttempts",parseInt(h.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})),e.createElement("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},"Two-Factor Authentication"),e.createElement("p",{className:"text-sm text-gray-600"},"Require 2FA for admin accounts")),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.security.twoFactorRequired,onChange:h=>b("security","twoFactorRequired",h.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"}))))),l==="features"&&e.createElement("div",{className:"p-6"},e.createElement("div",{className:"flex items-center space-x-3 mb-6"},e.createElement(at,{className:"w-6 h-6 text-green-600"}),e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Platform Features")),e.createElement("div",{className:"space-y-4"},[{key:"consignmentApprovalRequired",label:"Require Consignment Approval",desc:"Admin approval required for all consignments"},{key:"autoDriverAssignment",label:"Auto Driver Assignment",desc:"Automatically assign drivers to deliveries"},{key:"inventoryTracking",label:"Inventory Tracking",desc:"Track product inventory levels"},{key:"priceModeration",label:"Price Moderation",desc:"Review and moderate product prices"}].map(h=>e.createElement("div",{key:h.key,className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg"},e.createElement("div",null,e.createElement("h4",{className:"font-medium text-gray-900"},h.label),e.createElement("p",{className:"text-sm text-gray-600"},h.desc)),e.createElement("label",{className:"relative inline-flex items-center cursor-pointer"},e.createElement("input",{type:"checkbox",checked:m.features?.[h.key]||!1,onChange:x=>b("features",h.key,x.target.checked),className:"sr-only peer"}),e.createElement("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"})))))))))))}function yi(){const{token:t}=X(),[a,r]=P.useState("products"),[s,n]=P.useState(!0),[l,o]=P.useState([]),[c,f]=P.useState([]),[m,g]=P.useState([]),[d,y]=P.useState([]),[b,w]=P.useState(""),[h,x]=P.useState("all"),[E,N]=P.useState("all"),[k,v]=P.useState(!1),[F,R]=P.useState(null),[M,C]=P.useState(null),[I,u]=P.useState({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]}),[L,j]=P.useState([]),[$,K]=P.useState([]),[z,W]=P.useState({createProduct:null,updateProduct:null,deleteProduct:null,bulkActivate:null}),te=i=>{const p=i.response?.status,S=i.response?.data,O=typeof S=="string"&&S.includes("<!DOCTYPE html>"),T=p===404&&(S?.error==="API endpoint not found"||i.friendlyMessage?.includes("API endpoint not found")||i.message?.includes("API endpoint not found"));return console.log(" Checking if endpoint missing:",{status:p,isHtmlError:O,isApiNotFoundError:T,errorMessage:i.message,friendlyMessage:i.friendlyMessage,responseData:S}),p===404||O||i.isEndpointMissing||T},le=i=>{W(p=>({...p,[i]:!1}))},oe=i=>{W(p=>({...p,[i]:!0}))},[Ee,Se]=P.useState({totalProducts:0,activeProducts:0,totalOrders:0,pendingOrders:0,totalRevenue:0,unpaidOrders:0}),ft=async()=>{console.log(" Testing endpoint availability...");const i=[{name:"admin-products",url:"/admin/products",method:"GET"},{name:"admin-refresh",url:"/admin/refresh-products",method:"POST"},{name:"products",url:"/products",method:"GET"},{name:"marketplace-products",url:"/marketplace/products",method:"GET"}];for(const p of i)try{if(p.method==="GET"){const S=await ae.get(p.url);console.log(` ${p.name}: Available`)}else if(p.method==="POST"&&p.name==="admin-refresh")continue}catch(S){te(S)?console.log(` ${p.name}: Not available (404)`):console.log(` ${p.name}: Error but endpoint exists:`,S.message)}};P.useEffect(()=>{ft(),pt()},[a]),P.useEffect(()=>{wa()},[b,h,E,l,c]);const pt=async()=>{n(!0);try{a==="products"?await ot():a==="orders"&&await _t()}finally{n(!1)}},ot=async()=>{try{console.log(" Fetching admin products (including inactive)");try{const p=await ae.get("/admin/products");if(p.data.success){const S=p.data.products;console.log(" Setting admin product data:",S),o(S),Se(O=>({...O,totalProducts:S.length,activeProducts:S.filter(T=>T.is_active).length})),console.log(" Admin products state updated successfully");return}}catch(p){console.log(" Admin endpoint failed:",p.message||p),console.log(" Trying marketplace endpoint as fallback")}const i=await ae.get("/marketplace/products");if(i.data.success){const p=i.data.products;console.log(" Setting marketplace product data:",p),o(p),Se(S=>({...S,totalProducts:p.length,activeProducts:p.filter(O=>O.is_active).length})),console.log(" Marketplace products state updated successfully")}}catch(i){console.error(" Error fetching products:",i),o([]),Se(S=>({...S,totalProducts:0,activeProducts:0}));let p="Failed to fetch products from database";i.friendlyMessage?p=`Failed to fetch products: ${i.friendlyMessage}`:i.response?.data?.message?p=i.response.data.message:i.message&&i.message!=="[object Object]"&&(p=`Failed to fetch products: ${i.message}`),A.error(p)}},_t=async()=>{try{console.log(" Fetching orders (using fallback data - admin endpoint not available)");const p=[{id:1,customer_name:"John Kimani",customer_phone:"+254712345678",customer_email:"john@example.com",total_amount:2500,status:"PENDING",payment_status:"UNPAID",created_at:new Date(Date.now()-2*24*60*60*1e3).toISOString(),items:[{name:"Fresh Tomatoes",quantity:5,price:130},{name:"Spinach",quantity:10,price:50}]},{id:2,customer_name:"Mary Wanjiku",customer_phone:"+254723456789",customer_email:"mary@example.com",total_amount:1800,status:"COMPLETED",payment_status:"PAID",created_at:new Date(Date.now()-5*24*60*60*1e3).toISOString(),items:[{name:"Sweet Potatoes",quantity:3,price:80}]},{id:3,customer_name:"Peter Mwangi",customer_phone:"+254734567890",customer_email:"peter@example.com",total_amount:3200,status:"PROCESSING",payment_status:"PAID",created_at:new Date(Date.now()-1*24*60*60*1e3).toISOString(),items:[{name:"Fresh Tomatoes",quantity:8,price:130},{name:"Spinach",quantity:20,price:50}]}];f(p);const S=p.filter(O=>O.payment_status==="PAID").reduce((O,T)=>O+T.total_amount,0);Se(O=>({...O,totalOrders:p.length,pendingOrders:p.filter(T=>T.status==="PENDING").length,totalRevenue:S,unpaidOrders:p.filter(T=>T.payment_status==="UNPAID").length})),console.log(" Orders loaded (mock data):",p)}catch(i){console.error(" Error setting up mock orders:",i),A.error("Failed to load orders")}},wa=()=>{if(a==="products"){let i=l.filter(p=>{const S=p.name.toLowerCase().includes(b.toLowerCase())||p.description.toLowerCase().includes(b.toLowerCase()),O=h==="all"||h==="active"&&p.is_active||h==="inactive"&&!p.is_active,T=E==="all"||p.category===E;return S&&O&&T});g(i)}else if(a==="orders"){let i=c.filter(p=>{const S=p.first_name?.toLowerCase().includes(b.toLowerCase())||p.last_name?.toLowerCase().includes(b.toLowerCase())||p.customer_phone.includes(b)||p.customer_email?.toLowerCase().includes(b.toLowerCase()),O=h==="all"||p.status===h;return S&&O});y(i)}},yt=async i=>{if(i.preventDefault(),!I.name||!I.category||!I.price_per_unit){A.error("Please fill in all required fields");return}try{let p=I.images;L.length>0&&(console.log(" Uploading images..."),p=await ka(L));const S={...I,price_per_unit:parseFloat(I.price_per_unit),stock_quantity:parseInt(I.stock_quantity)||0,images:p,is_active:!0,is_featured:I.is_featured};console.log(" Saving product data:",S);let O;try{if(F)if(console.log(" Updating product:",F.id),z.updateProduct===!1)console.log(" PUT /products/:id endpoint known to be unavailable, using local update"),o(T=>T.map(_=>_.id===F.id?{..._,...S,updated_at:new Date().toISOString()}:_)),A.success("Product updated locally (server endpoint not available)"),O={data:{success:!0}};else try{O=await ae.put(`/products/${F.id}`,S),O.data.success&&(oe("updateProduct"),o(T=>T.map(_=>_.id===F.id?O.data.product:_)),A.success("Product updated successfully in database!"))}catch(T){te(T)?(console.log(" PUT /products/:id endpoint not available, marking as unavailable"),le("updateProduct")):(console.log(" API error during product update, using local fallback"),console.error("Update error:",T)),o(_=>_.map(q=>q.id===F.id?{...q,...S,updated_at:new Date().toISOString()}:q)),A.success("Product updated locally (server endpoint not available)"),O={data:{success:!0}}}else if(console.log(" Creating new product"),z.createProduct===!1){console.log(" POST /products endpoint known to be unavailable, using local creation");const T={id:Date.now(),...S,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};o(_=>[..._,T]),A.success("Product created locally (server endpoint not available)"),O={data:{success:!0}}}else try{O=await ae.post("/products",S),O.data.success&&(oe("createProduct"),o(T=>[...T,O.data.product]),A.success("Product created successfully in database!"))}catch(T){te(T)?(console.log(" POST /products endpoint not available, marking as unavailable"),le("createProduct")):(console.log(" API error during product creation, using local fallback"),console.error("Creation error:",T));const _={id:Date.now(),...S,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};o(q=>[...q,_]),A.success("Product created locally (server endpoint not available)"),O={data:{success:!0}}}}catch(T){throw T}O.data.success?(console.log(" Product update response:",O.data),v(!1),R(null),Be(),await ot()):(console.error(" Product update failed:",O.data),A.error(O.data.message||"Failed to save product"))}catch(p){console.error(" Error saving product:",p);let S="Failed to save product";p.friendlyMessage?S=p.friendlyMessage:p.response?.data?.message?S=p.response.data.message:p.message&&p.message!=="[object Object]"&&(S=p.message),A.error(S)}},Mt=async i=>{if(confirm("Are you sure you want to delete this product?"))try{if(console.log(" Deleting product:",i),z.deleteProduct===!1)console.log(" DELETE /products/:id endpoint known to be unavailable, using local delete"),o(p=>p.filter(S=>S.id!==i)),A.success("Product removed locally (server endpoint not available)");else try{const p=await ae.delete(`/products/${i}`);if(p.data.success)oe("deleteProduct"),o(S=>S.filter(O=>O.id!==i)),A.success("Product deleted successfully from database!");else throw new Error(p.data.message||"Failed to delete product")}catch(p){te(p)?(console.log(" DELETE /products/:id endpoint not available, marking as unavailable"),le("deleteProduct")):(console.log(" API error during product deletion, using local fallback"),console.error("Deletion error:",p)),o(S=>S.filter(O=>O.id!==i)),A.success("Product removed locally (server endpoint not available)")}}catch(p){console.error(" Error deleting product:",p);let S="Failed to delete product";p.friendlyMessage?S=p.friendlyMessage:p.response?.data?.message?S=p.response.data.message:p.message&&p.message!=="[object Object]"&&(S=p.message),A.error(S)}},ht=i=>{console.log(" Editing product:",i),R(i),u({name:i.name,category:i.category,price_per_unit:i.price_per_unit.toString(),unit:i.unit,description:i.description||"",stock_quantity:i.stock_quantity.toString(),is_featured:i.is_featured||!1,farmer_name:i.farmer_name||"Admin",farmer_county:i.farmer_county||"Central",images:i.images||[]}),v(!0)},Be=()=>{u({name:"",category:"",price_per_unit:"",unit:"kg",description:"",stock_quantity:"",is_featured:!1,farmer_name:"Admin",farmer_county:"Central",images:[]}),j([]),K([])},Sa=i=>{const p=Array.from(i.target.files||[]);if(p.length===0)return;const S=p.slice(0,5);j(S);const O=S.map(T=>URL.createObjectURL(T));K(O),console.log(" Selected images:",S.map(T=>T.name))},Lt=i=>{const p=L.filter((O,T)=>T!==i),S=$.filter((O,T)=>T!==i);j(p),K(S)},ka=async i=>{const p=i.map(S=>new Promise((O,T)=>{const _=new FileReader;_.onload=()=>O(_.result),_.onerror=T,_.readAsDataURL(S)}));try{const S=await Promise.all(p);return console.log(" Images converted to base64 (simulated upload)"),S}catch(S){throw console.error(" Error uploading images:",S),S}},bt=async i=>{try{console.log(" Simulating STK push (admin endpoint not available):",{orderId:i.id,phone:i.customer_phone,amount:i.total_amount}),A.success("STK push initiated successfully (simulated)")}catch(p){console.error(" Error initiating STK push:",p),A.error("Failed to initiate STK push")}},jt=async()=>{try{console.log(" Refreshing database with sample products"),n(!0);const i=await ae.post("/admin/refresh-products",{});i.data.success?(A.success(`Database refreshed with ${i.data.count} premium products with images!`),await ot()):A.error(i.data.message||"Failed to refresh database")}catch(i){console.error(" Error refreshing database:",i);let p="Failed to refresh database with sample products";i.friendlyMessage?p=i.friendlyMessage:i.response?.data?.message?p=i.response.data.message:i.message&&i.message!=="[object Object]"&&(p=i.message),A.error(p)}finally{n(!1)}},Ca=async()=>{try{if(console.log(" Activating all products"),z.bulkActivate===!1)console.log(" PATCH /products/bulk-activate endpoint known to be unavailable, using local activation"),o(i=>i.map(p=>({...p,is_active:!0}))),Se(i=>({...i,activeProducts:l.length})),A.success("Products activated locally (server endpoint not available)");else try{const i=await ae.patch("/products/bulk-activate",{});if(i.data.success)oe("bulkActivate"),A.success(`${i.data.activated_products?.length||0} products activated!`),await ot();else throw new Error(i.data.message||"Failed to activate products")}catch(i){te(i)?(console.log(" PATCH /products/bulk-activate endpoint not available, marking as unavailable"),le("bulkActivate")):(console.log(" API error during product activation, using local fallback"),console.error("Activation error:",i)),o(p=>p.map(S=>({...S,is_active:!0}))),Se(p=>({...p,activeProducts:l.length})),A.success("Products activated locally (server endpoint not available)")}}catch(i){console.error(" Error activating products:",i);let p="Failed to activate products";i.friendlyMessage?p=i.friendlyMessage:i.response?.data?.message?p=i.response.data.message:i.message&&i.message!=="[object Object]"&&(p=i.message),A.error(p)}},Ut=async i=>{try{console.log(" Generating mock invoice (admin endpoint not available):",i.id);const p={invoice_number:`INV-${i.id}-${Date.now()}`,order_id:i.id,created_at:new Date().toISOString(),due_date:new Date(Date.now()+30*24*60*60*1e3).toISOString(),payment_status:"Pending",customer:{name:i.customer_name||"Customer",phone:i.customer_phone||"+254000000000",email:i.customer_email||"customer@example.com",county:"Kenya"}},S=window.open("","_blank");S&&(S.document.write(`
            <html>
              <head>
                <title>Invoice ${p.invoice_number}</title>
                <style>
                  body { font-family: Arial, sans-serif; margin: 20px; }
                  .header { text-align: center; margin-bottom: 30px; }
                  .invoice-details { margin-bottom: 20px; }
                  .customer-info { margin-bottom: 20px; }
                  table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
                  th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
                  th { background-color: #f2f2f2; }
                  .total { font-weight: bold; font-size: 18px; }
                  .footer { margin-top: 30px; text-align: center; color: #666; }
                </style>
              </head>
              <body>
                <div class="header">
                  <h1>Zuasoko Agricultural Platform</h1>
                  <h2>Invoice ${p.invoice_number}</h2>
                </div>
                
                <div class="invoice-details">
                  <p><strong>Order ID:</strong> ${p.order_id}</p>
                  <p><strong>Date:</strong> ${new Date(p.created_at).toLocaleDateString()}</p>
                  <p><strong>Due Date:</strong> ${new Date(p.due_date).toLocaleDateString()}</p>
                  <p><strong>Status:</strong> ${p.payment_status}</p>
                </div>
                
                <div class="customer-info">
                  <h3>Customer Information</h3>
                  <p><strong>Name:</strong> ${p.customer.name}</p>
                  <p><strong>Phone:</strong> ${p.customer.phone}</p>
                  <p><strong>Email:</strong> ${p.customer.email}</p>
                  <p><strong>County:</strong> ${p.customer.county}</p>
                </div>
                
                <table>
                  <thead>
                    <tr>
                      <th>Product</th>
                      <th>Quantity</th>
                      <th>Unit Price</th>
                      <th>Total</th>
                    </tr>
                  </thead>
                  <tbody>
                    ${p.items.map(O=>`
                      <tr>
                        <td>${O.product_name}</td>
                        <td>${O.quantity}</td>
                        <td>KSh ${O.unit_price?.toLocaleString()}</td>
                        <td>KSh ${(O.total||O.quantity*O.unit_price)?.toLocaleString()}</td>
                      </tr>
                    `).join("")}
                  </tbody>
                  <tfoot>
                    <tr class="total">
                      <td colspan="3"><strong>Total Amount</strong></td>
                      <td><strong>KSh ${p.total_amount.toLocaleString()}</strong></td>
                    </tr>
                  </tfoot>
                </table>
                
                <div class="footer">
                  <p>Thank you for your business!</p>
                  <p>For any inquiries, contact us at support@zuasoko.com</p>
                </div>
              </body>
            </html>
          `),S.document.close(),S.print()),A.success("Invoice generated successfully")}catch(p){console.error(" Error generating invoice:",p),A.error("Failed to generate invoice")}},Pa=["Vegetables","Fruits","Grains","Leafy Greens","Root Vegetables","Herbs"],qt=["kg","pieces","bunches","bags","boxes"];return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Ve,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading marketplace data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Marketplace Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage products, orders, and marketplace operations")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:pt,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(Ve,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),a==="products"&&e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:jt,className:"bg-purple-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-purple-700 flex items-center space-x-2"},e.createElement(Ve,{className:"w-4 h-4"}),e.createElement("span",null,"Add Sample Items")),e.createElement("button",{onClick:Ca,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 flex items-center space-x-2"},e.createElement(fe,{className:"w-4 h-4"}),e.createElement("span",null,"Activate All")),e.createElement("button",{onClick:()=>{Be(),R(null),v(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Dt,{className:"w-4 h-4"}),e.createElement("span",null,"Add Product")))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},e.createElement("div",{onClick:()=>{r("products"),x("all"),N("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-blue-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg group-hover:bg-blue-200 transition-colors"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors"},Ee.totalProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Products"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("products"),x("active"),N("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-green-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg group-hover:bg-green-200 transition-colors"},e.createElement(fe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-green-600 transition-colors"},Ee.activeProducts),e.createElement("p",{className:"text-gray-600 text-sm"},"Active Products"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-green-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("orders"),x("all"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-purple-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg group-hover:bg-purple-200 transition-colors"},e.createElement($e,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-purple-600 transition-colors"},Ee.totalOrders),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Orders"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-purple-600 group-hover:translate-x-1 transition-all duration-200"}))),e.createElement("div",{onClick:()=>{r("orders"),x("completed"),w("")},className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md hover:border-yellow-300 transition-all duration-200 cursor-pointer group"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg group-hover:bg-yellow-200 transition-colors"},e.createElement(Ce,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-yellow-600 transition-colors"},"KSh ",Ee.totalRevenue.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Revenue"))),e.createElement(be,{className:"w-5 h-5 text-gray-400 group-hover:text-yellow-600 group-hover:translate-x-1 transition-all duration-200"})))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"border-b border-gray-200"},e.createElement("nav",{className:"flex"},[{id:"products",label:"Products",icon:B},{id:"orders",label:"Orders",icon:$e}].map(i=>e.createElement("button",{key:i.id,onClick:()=>r(i.id),className:`flex items-center space-x-2 px-6 py-4 border-b-2 font-medium text-sm ${a===i.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`},e.createElement(i.icon,{className:"w-5 h-5"}),e.createElement("span",null,i.label))))),e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:a==="products"?"Search products...":"Search orders...",value:b,onChange:i=>w(i.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",{className:"flex gap-4"},e.createElement("select",{value:h,onChange:i=>x(i.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Status"),a==="products"?e.createElement(e.Fragment,null,e.createElement("option",{value:"active"},"Active"),e.createElement("option",{value:"inactive"},"Inactive")):e.createElement(e.Fragment,null,e.createElement("option",{value:"PENDING"},"Pending"),e.createElement("option",{value:"COMPLETED"},"Completed"),e.createElement("option",{value:"CANCELLED"},"Cancelled"))),a==="products"&&e.createElement("select",{value:E,onChange:i=>N(i.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Categories"),Pa.map(i=>e.createElement("option",{key:i,value:i},i)))))),a==="products"&&e.createElement("div",{className:"p-6"},m.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No products found"),e.createElement("p",{className:"text-gray-600 mb-4"},b||h!=="all"||E!=="all"?"Try adjusting your search or filters":"Get started by adding your first product"),e.createElement("button",{onClick:()=>{Be(),R(null),v(!0)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700"},"Add Product")):e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},m.map(i=>e.createElement("div",{key:i.id,className:"border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow"},e.createElement("div",{className:"h-48 bg-gray-100 flex items-center justify-center relative"},i.images&&i.images.length>0&&i.images[0]?e.createElement(e.Fragment,null,e.createElement("img",{src:i.images[0],alt:i.name,className:"w-full h-full object-cover",onError:p=>{console.log("Image failed to load for product:",i.name),p.currentTarget.style.display="none";const S=p.currentTarget.nextElementSibling;S&&(S.style.display="flex")}}),e.createElement("div",{className:"hidden absolute inset-0 items-center justify-center text-center"},e.createElement("div",null,e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500 text-sm"},"Image unavailable")))):e.createElement("div",{className:"text-center"},e.createElement(B,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),e.createElement("p",{className:"text-gray-500 text-sm"},"No image"))),e.createElement("div",{className:"p-4"},e.createElement("div",{className:"flex items-start justify-between mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900 line-clamp-2"},i.name),i.is_featured&&e.createElement(At,{className:"w-4 h-4 text-yellow-500 fill-current flex-shrink-0 ml-2"})),e.createElement("p",{className:"text-sm text-gray-600 mb-2"},i.category),e.createElement("p",{className:"text-sm text-gray-700 mb-3 line-clamp-2"},i.description),e.createElement("div",{className:"flex items-center justify-between mb-3"},e.createElement("span",{className:"text-lg font-semibold text-green-600"},"KSh ",i.price_per_unit.toLocaleString(),"/",i.unit),e.createElement("span",{className:"text-sm text-gray-600"},"Stock: ",i.stock_quantity)),e.createElement("div",{className:"flex items-center justify-between mb-4"},e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`},i.is_active?"Active":"Inactive"),e.createElement("span",{className:"text-xs text-gray-500"},i.farmer_name)),e.createElement("div",{className:"flex space-x-2"},e.createElement("button",{onClick:()=>ht(i),className:"flex-1 bg-blue-600 text-white px-3 py-2 rounded text-sm hover:bg-blue-700 flex items-center justify-center space-x-1"},e.createElement(An,{className:"w-4 h-4"}),e.createElement("span",null,"Edit")),e.createElement("button",{onClick:()=>Mt(i.id),className:"flex-1 bg-red-600 text-white px-3 py-2 rounded text-sm hover:bg-red-700 flex items-center justify-center space-x-1"},e.createElement(er,{className:"w-4 h-4"}),e.createElement("span",null,"Delete")))))))),a==="orders"&&e.createElement("div",{className:"p-6"},d.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement($e,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No orders found"),e.createElement("p",{className:"text-gray-600"},b||h!=="all"?"Try adjusting your search or filters":"Orders will appear here once customers start placing them")):e.createElement("div",{className:"space-y-4"},d.map(i=>e.createElement("div",{key:i.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},"Order #",i.id),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="COMPLETED"?"bg-green-100 text-green-800":i.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},i.status),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${i.payment_status==="PAID"?"bg-green-100 text-green-800":i.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},i.payment_status)),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Customer:")," ",i.first_name," ",i.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",i.customer_phone)),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Email:")," ",i.customer_email),e.createElement("p",null,e.createElement("strong",null,"Amount:")," KSh"," ",i.total_amount.toLocaleString())),e.createElement("div",null,e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(i.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Items:")," ",i.items?.length||0," products")))),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("button",{onClick:()=>C(i),className:"bg-blue-600 text-white px-4 py-2 rounded text-sm hover:bg-blue-700 flex items-center space-x-1"},e.createElement(Ke,{className:"w-4 h-4"}),e.createElement("span",null,"Details")),e.createElement("button",{onClick:()=>Ut(i),className:"bg-gray-600 text-white px-4 py-2 rounded text-sm hover:bg-gray-700 flex items-center space-x-1"},e.createElement(hr,{className:"w-4 h-4"}),e.createElement("span",null,"Invoice")),i.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>bt(i),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Zt,{className:"w-4 h-4"}),e.createElement("span",null,"STK Push")))))))))),k&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},F?"Edit Product":"Add New Product"),e.createElement("button",{onClick:()=>{v(!1),R(null),Be()},className:"text-gray-400 hover:text-gray-600"},e.createElement(Fe,{className:"w-6 h-6"})))),e.createElement("form",{onSubmit:yt,className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Name *"),e.createElement("input",{type:"text",required:!0,value:I.name,onChange:i=>u({...I,name:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product name"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Category *"),e.createElement("select",{required:!0,value:I.category,onChange:i=>u({...I,category:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:""},"Select category"),Pa.map(i=>e.createElement("option",{key:i,value:i},i)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Price per Unit *"),e.createElement("input",{type:"number",required:!0,min:"0",step:"0.01",value:I.price_per_unit,onChange:i=>u({...I,price_per_unit:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0.00"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Unit"),e.createElement("select",{value:I.unit,onChange:i=>u({...I,unit:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},qt.map(i=>e.createElement("option",{key:i,value:i},i)))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Stock Quantity"),e.createElement("input",{type:"number",min:"0",value:I.stock_quantity,onChange:i=>u({...I,stock_quantity:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"0"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Farmer County"),e.createElement("input",{type:"text",value:I.farmer_county,onChange:i=>u({...I,farmer_county:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"County"}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Description"),e.createElement("textarea",{rows:4,value:I.description,onChange:i=>u({...I,description:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter product description"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-center w-full"},e.createElement("label",{className:"flex flex-col items-center justify-center w-full h-32 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 hover:bg-gray-100"},e.createElement("div",{className:"flex flex-col items-center justify-center pt-5 pb-6"},e.createElement(Jt,{className:"w-8 h-8 mb-4 text-gray-500"}),e.createElement("p",{className:"mb-2 text-sm text-gray-500"},e.createElement("span",{className:"font-semibold"},"Click to upload")," product images"),e.createElement("p",{className:"text-xs text-gray-500"},"PNG, JPG or JPEG (MAX. 5 images)")),e.createElement("input",{type:"file",className:"hidden",multiple:!0,accept:"image/*",onChange:Sa}))),$.length>0&&e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4"},$.map((i,p)=>e.createElement("div",{key:p,className:"relative group"},e.createElement("img",{src:i,alt:`Preview ${p+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{type:"button",onClick:()=>Lt(p),className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e.createElement(Fe,{className:"w-3 h-3"}))))),F&&I.images.length>0&&$.length===0&&e.createElement("div",null,e.createElement("p",{className:"text-sm text-gray-600 mb-2"},"Current Images:"),e.createElement("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4"},I.images.map((i,p)=>e.createElement("div",{key:p,className:"relative group"},e.createElement("img",{src:i,alt:`Current ${p+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{type:"button",onClick:()=>{const S=I.images.filter((O,T)=>T!==p);u({...I,images:S})},className:"absolute top-1 right-1 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity"},e.createElement(Fe,{className:"w-3 h-3"})))))))),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("label",{className:"flex items-center"},e.createElement("input",{type:"checkbox",checked:I.is_featured,onChange:i=>u({...I,is_featured:i.target.checked}),className:"rounded border-gray-300 text-green-600 focus:ring-green-500"}),e.createElement("span",{className:"ml-2 text-sm text-gray-700"},"Featured Product"))),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{type:"button",onClick:()=>{v(!1),R(null),Be()},className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50"},"Cancel"),e.createElement("button",{type:"submit",className:"bg-green-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(da,{className:"w-4 h-4"}),e.createElement("span",null,F?"Update":"Create"," Product")))))),M&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Order #",M.id," Details"),e.createElement("button",{onClick:()=>C(null),className:"text-gray-400 hover:text-gray-600"},e.createElement(Fe,{className:"w-6 h-6"})))),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Customer Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Name:")," ",M.first_name," ",M.last_name),e.createElement("p",null,e.createElement("strong",null,"Phone:")," ",M.customer_phone),e.createElement("p",null,e.createElement("strong",null,"Email:")," ",M.customer_email))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Information"),e.createElement("div",{className:"space-y-2 text-sm"},e.createElement("p",null,e.createElement("strong",null,"Status:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${M.status==="COMPLETED"?"bg-green-100 text-green-800":M.status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},M.status)),e.createElement("p",null,e.createElement("strong",null,"Payment:"),e.createElement("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${M.payment_status==="PAID"?"bg-green-100 text-green-800":M.payment_status==="PENDING"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},M.payment_status)),e.createElement("p",null,e.createElement("strong",null,"Date:")," ",new Date(M.created_at).toLocaleDateString()),e.createElement("p",null,e.createElement("strong",null,"Total:")," KSh"," ",M.total_amount.toLocaleString())))),e.createElement("div",null,e.createElement("h3",{className:"font-semibold text-gray-900 mb-3"},"Order Items"),M.items&&M.items.length>0?e.createElement("div",{className:"space-y-2"},M.items.map((i,p)=>e.createElement("div",{key:p,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},e.createElement("div",null,e.createElement("p",{className:"font-medium"},i.product_name),e.createElement("p",{className:"text-sm text-gray-600"},"Quantity: ",i.quantity)),e.createElement("div",{className:"text-right"},e.createElement("p",{className:"font-medium"},"KSh"," ",(i.unit_price*i.quantity).toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"@ KSh ",i.unit_price,"/unit"))))):e.createElement("p",{className:"text-gray-600"},"No items available")),e.createElement("div",{className:"flex justify-end space-x-4 pt-6 border-t border-gray-200"},e.createElement("button",{onClick:()=>Ut(M),className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(hr,{className:"w-4 h-4"}),e.createElement("span",null,"Generate Invoice")),M.payment_status==="UNPAID"&&e.createElement("button",{onClick:()=>{bt(M),C(null)},className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Zt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))}function hi(){const{token:t}=X(),[a,r]=P.useState(!0),[s,n]=P.useState([]),[l,o]=P.useState([]),[c,f]=P.useState(""),[m,g]=P.useState("all"),[d,y]=P.useState({farmerRegistrationFee:300,registrationFeeEnabled:!0,gracePeriodDays:7}),[b,w]=P.useState({totalUnpaid:0,withinGracePeriod:0,overdue:0,totalOutstanding:0});P.useEffect(()=>{h()},[]),P.useEffect(()=>{x()},[c,m,s]);const h=async()=>{r(!0);try{console.log(" Fetching unpaid farmers data");const k=await ae.get("/admin/settings");k.data.success&&k.data.settings.fees&&y(k.data.settings.fees);const v=await ae.get("/admin/registration-fees/unpaid");if(v.data.success){const F=v.data.farmers;n(F);const R=F.length,M=F.filter(u=>u.gracePeriodRemaining>0).length,C=F.filter(u=>u.gracePeriodRemaining<=0).length,I=F.length*d.farmerRegistrationFee;w({totalUnpaid:R,withinGracePeriod:M,overdue:C,totalOutstanding:I}),console.log(" Unpaid farmers loaded:",F)}}catch(k){console.error(" Error fetching unpaid farmers:",k);const v=[{id:"farmer-001",firstName:"John",lastName:"Kimani",email:"john@example.com",phone:"+254712345678",county:"Nakuru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-5*24*60*60*1e3).toISOString(),daysSinceRegistration:5,gracePeriodRemaining:2,consignmentCount:0},{id:"farmer-002",firstName:"Mary",lastName:"Wanjiku",email:"mary@example.com",phone:"+254723456789",county:"Meru",registrationFeePaid:!1,registeredAt:new Date(Date.now()-10*24*60*60*1e3).toISOString(),daysSinceRegistration:10,gracePeriodRemaining:-3,consignmentCount:2},{id:"farmer-003",firstName:"Peter",lastName:"Mwangi",email:"peter@example.com",phone:"+254734567890",county:"Kiambu",registrationFeePaid:!1,registeredAt:new Date(Date.now()-3*24*60*60*1e3).toISOString(),daysSinceRegistration:3,gracePeriodRemaining:4,consignmentCount:1}];n(v),w({totalUnpaid:3,withinGracePeriod:2,overdue:1,totalOutstanding:900}),A.error("Failed to fetch data, showing demo")}finally{r(!1)}},x=()=>{let k=s.filter(v=>{const F=v.firstName.toLowerCase().includes(c.toLowerCase())||v.lastName.toLowerCase().includes(c.toLowerCase())||v.phone.includes(c)||v.email.toLowerCase().includes(c.toLowerCase()),R=m==="all"||m==="grace"&&v.gracePeriodRemaining>0||m==="overdue"&&v.gracePeriodRemaining<=0;return F&&R});o(k)},E=async k=>{try{console.log(` Initiating STK push for farmer ${k.id}`);const v=await ae.post("/admin/registration-fees/stk-push",{farmer_id:k.id,phone_number:k.phone,amount:d.farmerRegistrationFee});v.data.success?(A.success(`STK push sent to ${k.firstName} ${k.lastName}`),n(F=>F.map(R=>R.id===k.id?{...R,lastPaymentAttempt:new Date().toISOString()}:R))):A.error(v.data.message||"Failed to send STK push")}catch(v){console.error(" STK push error:",v),A.error(v.response?.data?.message||"Failed to send STK push")}},N=async()=>{if(confirm(`Send STK push to all ${l.length} farmers?`))try{const k=l.map(v=>E(v));await Promise.all(k),A.success(`STK push sent to ${l.length} farmers`)}catch{A.error("Some STK pushes failed")}};return a?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Ve,{className:"w-5 h-5 animate-spin text-green-600"}),e.createElement("span",null,"Loading registration fees data..."))):e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Registration Fees Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage farmer registration fees and payment collection")),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{onClick:h,className:"bg-gray-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-gray-700 flex items-center space-x-2"},e.createElement(Ve,{className:"w-4 h-4"}),e.createElement("span",null,"Refresh")),l.length>0&&e.createElement("button",{onClick:N,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 flex items-center space-x-2"},e.createElement(Zt,{className:"w-4 h-4"}),e.createElement("span",null,"Bulk STK Push"))))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(Ie,{className:"w-5 h-5 text-blue-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-blue-800"},"Current Fee Settings"),e.createElement("p",{className:"text-sm text-blue-700 mt-1"},"Registration Fee:"," ",e.createElement("strong",null,"KSh ",d.farmerRegistrationFee.toLocaleString())," "," Grace Period:"," ",e.createElement("strong",null,d.gracePeriodDays," days"),"  Status:"," ",e.createElement("strong",null,d.registrationFeeEnabled?"Enabled":"Disabled"))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(ke,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.totalUnpaid),e.createElement("p",{className:"text-gray-600 text-sm"},"Unpaid Farmers")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(de,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.withinGracePeriod),e.createElement("p",{className:"text-gray-600 text-sm"},"Within Grace Period")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-red-100 rounded-lg"},e.createElement(lt,{className:"w-6 h-6 text-red-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},b.overdue),e.createElement("p",{className:"text-gray-600 text-sm"},"Overdue")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(Ce,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"KSh ",b.totalOutstanding.toLocaleString()),e.createElement("p",{className:"text-gray-600 text-sm"},"Total Outstanding"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-8"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"relative"},e.createElement(ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.createElement("input",{type:"text",placeholder:"Search farmers by name, phone, or email...",value:c,onChange:k=>f(k.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"}))),e.createElement("div",null,e.createElement("select",{value:m,onChange:k=>g(k.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"},e.createElement("option",{value:"all"},"All Farmers"),e.createElement("option",{value:"grace"},"Within Grace Period"),e.createElement("option",{value:"overdue"},"Overdue"))))),e.createElement("div",{className:"p-6"},l.length===0?e.createElement("div",{className:"text-center py-12"},e.createElement(ke,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No unpaid farmers found"),e.createElement("p",{className:"text-gray-600"},c||m!=="all"?"Try adjusting your search or filters":"All farmers have paid their registration fees")):e.createElement("div",{className:"space-y-4"},l.map(k=>e.createElement("div",{key:k.id,className:"border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-center space-x-4 mb-2"},e.createElement("h3",{className:"font-semibold text-gray-900"},k.firstName," ",k.lastName),e.createElement("span",{className:`px-2 py-1 rounded-full text-xs ${k.gracePeriodRemaining>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`},k.gracePeriodRemaining>0?`${k.gracePeriodRemaining} days remaining`:`${Math.abs(k.gracePeriodRemaining)} days overdue`),k.consignmentCount>0&&e.createElement("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs"},k.consignmentCount," consignments")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600"},e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(Ye,{className:"w-4 h-4"}),e.createElement("span",null,k.phone)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(ma,{className:"w-4 h-4"}),e.createElement("span",null,k.email)),e.createElement("div",{className:"flex items-center space-x-2"},e.createElement(st,{className:"w-4 h-4"}),e.createElement("span",null,"Registered ",k.daysSinceRegistration," days ago"))),k.lastPaymentAttempt&&e.createElement("div",{className:"mt-2 text-sm text-gray-500"},"Last STK push:"," ",new Date(k.lastPaymentAttempt).toLocaleDateString())),e.createElement("div",{className:"flex flex-col sm:flex-row gap-2"},e.createElement("div",{className:"text-right mb-2 sm:mb-0 sm:mr-4"},e.createElement("p",{className:"font-semibold text-gray-900"},"KSh"," ",d.farmerRegistrationFee.toLocaleString()),e.createElement("p",{className:"text-sm text-gray-600"},"Registration Fee")),e.createElement("button",{onClick:()=>E(k),className:"bg-green-600 text-white px-4 py-2 rounded text-sm hover:bg-green-700 flex items-center space-x-1"},e.createElement(Zt,{className:"w-4 h-4"}),e.createElement("span",null,"Send STK Push")))))))))))}function bi(){const[t,a]=P.useState(!0),[r,s]=P.useState(!1),[n,l]=P.useState(!1),[o,c]=P.useState(!1),[f,m]=P.useState({consumer_key:"",consumer_secret:"",passkey:"",shortcode:"",environment:"sandbox",callback_url:"",configured:!1});P.useEffect(()=>{g()},[]);const g=async()=>{try{a(!0);const b=await ae.get("/admin/mpesa-settings");b.data.success&&m(b.data.settings)}catch(b){console.error("Error fetching M-Pesa settings:",b),A.error("Failed to load M-Pesa settings")}finally{a(!1)}},d=async b=>{if(b.preventDefault(),!f.consumer_key||!f.consumer_secret||!f.passkey||!f.shortcode){A.error("All M-Pesa credentials are required");return}s(!0);try{const w=await ae.put("/admin/mpesa-settings",f);w.data.success&&(A.success("M-Pesa settings saved successfully!"),m(w.data.settings))}catch(w){console.error("Error saving M-Pesa settings:",w),A.error(w.response?.data?.error||"Failed to save settings")}finally{s(!1)}},y=async()=>{l(!0);try{(await ae.post("/admin/mpesa-test",{})).data.success&&A.success("M-Pesa connection test successful!")}catch(b){console.error("M-Pesa test failed:",b),A.error(b.response?.data?.error||"M-Pesa connection test failed")}finally{l(!1)}};return t?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading M-Pesa settings..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"M-Pesa Settings"),e.createElement("p",{className:"text-gray-600 mt-1"},"Configure M-Pesa API credentials for payments and withdrawals")),e.createElement("div",{className:"flex items-center space-x-2"},f.configured?e.createElement(e.Fragment,null,e.createElement(fe,{className:"w-5 h-5 text-green-600"}),e.createElement("span",{className:"text-green-600 font-medium"},"Configured")):e.createElement(e.Fragment,null,e.createElement(lt,{className:"w-5 h-5 text-yellow-600"}),e.createElement("span",{className:"text-yellow-600 font-medium"},"Not Configured"))))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`p-3 rounded-lg ${f.configured?"bg-green-100":"bg-yellow-100"}`},e.createElement(Oe,{className:`w-6 h-6 ${f.configured?"text-green-600":"text-yellow-600"}`})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},f.configured?"Active":"Inactive"),e.createElement("p",{className:"text-gray-600 text-sm"},"M-Pesa Integration")))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(Ua,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},f.environment||"Not Set"),e.createElement("p",{className:"text-gray-600 text-sm"},"Environment")))),e.createElement("div",{className:"bg-white p-6 rounded-lg shadow-sm border"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-purple-100 rounded-lg"},e.createElement(Ye,{className:"w-6 h-6 text-purple-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},f.shortcode||"Not Set"),e.createElement("p",{className:"text-gray-600 text-sm"},"Shortcode"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"px-6 py-4 border-b border-gray-200"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},"M-Pesa API Configuration"),e.createElement("div",{className:"flex items-center space-x-4"},e.createElement("button",{type:"button",onClick:()=>c(!o),className:"flex items-center text-gray-600 hover:text-gray-800"},o?e.createElement(e.Fragment,null,e.createElement(kt,{className:"w-4 h-4 mr-1"}),"Hide Secrets"):e.createElement(e.Fragment,null,e.createElement(Ke,{className:"w-4 h-4 mr-1"}),"Show Secrets")),f.configured&&e.createElement("button",{onClick:y,disabled:n,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:bg-gray-400 flex items-center"},n?e.createElement(Ve,{className:"w-4 h-4 mr-2 animate-spin"}):e.createElement(Dn,{className:"w-4 h-4 mr-2"}),"Test Connection")))),e.createElement("form",{onSubmit:d,className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Environment *"),e.createElement("select",{value:f.environment,onChange:b=>m(w=>({...w,environment:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0},e.createElement("option",{value:"sandbox"},"Sandbox (Testing)"),e.createElement("option",{value:"production"},"Production (Live)")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Use sandbox for testing, production for live transactions")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Consumer Key *"),e.createElement("input",{type:o?"text":"password",value:f.consumer_key,onChange:b=>m(w=>({...w,consumer_key:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter consumer key",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Consumer Secret *"),e.createElement("input",{type:o?"text":"password",value:f.consumer_secret,onChange:b=>m(w=>({...w,consumer_secret:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter consumer secret",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Passkey *"),e.createElement("input",{type:o?"text":"password",value:f.passkey,onChange:b=>m(w=>({...w,passkey:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter passkey",required:!0})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Shortcode *"),e.createElement("input",{type:"text",value:f.shortcode,onChange:b=>m(w=>({...w,shortcode:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., 174379",required:!0}))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Callback URL"),e.createElement("input",{type:"url",value:f.callback_url,onChange:b=>m(w=>({...w,callback_url:b.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"https://yourdomain.com/api/mpesa/callback"}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"URL where M-Pesa will send payment notifications")),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("div",{className:"flex items-start space-x-3"},e.createElement(at,{className:"w-5 h-5 text-blue-600 mt-1"}),e.createElement("div",null,e.createElement("h4",{className:"font-medium text-blue-800"},"How to get M-Pesa credentials:"),e.createElement("ol",{className:"text-sm text-blue-700 mt-2 space-y-1 list-decimal list-inside"},e.createElement("li",null,"Visit ",e.createElement("a",{href:"https://developer.safaricom.co.ke",target:"_blank",rel:"noopener noreferrer",className:"underline"},"developer.safaricom.co.ke")),e.createElement("li",null,"Create an account and log in"),e.createElement("li",null,"Create a new app for your business"),e.createElement("li",null,"Copy the Consumer Key and Consumer Secret"),e.createElement("li",null,"Get your Lipa Na M-Pesa Online Passkey"),e.createElement("li",null,"Use your business shortcode or test shortcode"))))),e.createElement("div",{className:"flex justify-end space-x-4 pt-6"},e.createElement("button",{type:"button",onClick:g,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50"},"Reset"),e.createElement("button",{type:"submit",disabled:r,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center"},r?e.createElement(Ve,{className:"w-4 h-4 mr-2 animate-spin"}):e.createElement(da,{className:"w-4 h-4 mr-2"}),"Save Settings"))))))}function Ei(){const{user:t,token:a}=X(),[r,s]=P.useState([]),[n,l]=P.useState(!0);P.useEffect(()=>{o()},[]);const o=async()=>{try{const E=await V.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${a}`}});s(E.data.assignments||E.data)}catch(E){console.error("Error fetching assignments:",E),E.response?.status===404?(console.log(" Using fallback demo assignments (endpoint not found)"),s([{id:"assign_1",consignmentId:"cons_1",title:"Organic Tomatoes Delivery",farmerName:"Jane Wanjiku",farmerPhone:"+254712345678",pickupLocation:"Nakuru, Rift Valley",deliveryLocation:"Nairobi Central Market",quantity:"100 kg",status:"DRIVER_ASSIGNED",estimatedValue:13e3,distance:"180 km",estimatedTime:"3 hours"},{id:"assign_2",consignmentId:"cons_2",title:"Fresh Spinach Delivery",farmerName:"Peter Kamau",farmerPhone:"+254723456789",pickupLocation:"Kiambu, Central Kenya",deliveryLocation:"Westlands Market",quantity:"50 bunches",status:"IN_TRANSIT",estimatedValue:2500,distance:"45 km",estimatedTime:"1.5 hours"}]),A.success("Using demo data - backend deployment needed")):A.error("Failed to fetch assignments")}finally{l(!1)}},c=async E=>{try{await V.put(`/api/driver/assignments/${E}/status`,{status:"IN_TRANSIT",notes:"Pickup started"},{headers:{Authorization:`Bearer ${a}`}}),A.success(`Started pickup for delivery ${E}`),o()}catch(N){console.error("Error updating delivery status:",N),N.response?.status===404?(A.success("Demo mode: Status update simulated"),o()):A.error("Failed to start pickup")}},f=async E=>{try{await V.put(`/api/driver/assignments/${E}/status`,{status:"DELIVERED",notes:"Delivery completed"},{headers:{Authorization:`Bearer ${a}`}}),A.success(`Marked delivery ${E} as completed`),o()}catch(N){console.error("Error updating delivery status:",N),N.response?.status===404?(A.success("Demo mode: Delivery marked as completed"),o()):A.error("Failed to mark as delivered")}},m=async()=>{try{if(!navigator.geolocation){A.error("Geolocation is not supported by this browser");return}A("Getting your location...",{icon:""}),navigator.geolocation.getCurrentPosition(async E=>{const{latitude:N,longitude:k}=E.coords;try{await V.put("/api/driver/location",{latitude:N,longitude:k,timestamp:new Date().toISOString()},{headers:{Authorization:`Bearer ${a}`}}),A.success(`Location updated: ${N.toFixed(6)}, ${k.toFixed(6)}`)}catch(v){console.error("Error updating location on server:",v),A.success(`Location obtained: ${N.toFixed(6)}, ${k.toFixed(6)}`),A("Could not sync with server - using local GPS",{icon:""})}},E=>{console.error("Geolocation error:",E),A.error("Failed to get location. Please enable GPS and try again.")},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})}catch(E){console.error("Location update error:",E),A.error("Failed to update location")}},g=()=>{A.success("Looking for new deliveries...")},d=()=>{A("Issue reporting form would open here",{icon:""})},y=()=>{A("Earnings details would be shown here",{icon:""})},b=[{title:"Deliveries Today",value:"8",icon:e.createElement(me,{className:"w-6 h-6"}),color:"bg-blue-500"},{title:"Total Earnings",value:"KES 12,500",icon:e.createElement(Ce,{className:"w-6 h-6"}),color:"bg-green-500"},{title:"Average Rating",value:"4.8",icon:e.createElement(fe,{className:"w-6 h-6"}),color:"bg-yellow-500"},{title:"Pending Pickups",value:"3",icon:e.createElement(lt,{className:"w-6 h-6"}),color:"bg-red-500"}],w=r.map(E=>({id:E.id,customer:`${E.farmer?.user?.firstName||"Unknown"} ${E.farmer?.user?.lastName||"Farmer"}`,location:E.location||"Unknown location",status:E.status==="DRIVER_ASSIGNED"?"pending":E.status==="IN_TRANSIT"?"in_transit":E.status==="DELIVERED"?"delivered":"unknown",time:new Date(E.createdAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),value:`KES ${((E.finalPricePerUnit||E.bidPricePerUnit)*E.quantity).toLocaleString()}`})),h=E=>{switch(E){case"pending":return"bg-yellow-100 text-yellow-800";case"in_transit":return"bg-blue-100 text-blue-800";case"delivered":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},x=E=>{switch(E){case"pending":return"Pending Pickup";case"in_transit":return"In Transit";case"delivered":return"Delivered";default:return E}};return e.createElement("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},e.createElement("div",{className:"mb-8"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Welcome back, ",t?.firstName,"!"),e.createElement("p",{className:"text-gray-600 mt-2"},"Here's your delivery schedule for today.")),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},b.map((E,N)=>e.createElement("div",{key:N,className:"bg-white rounded-lg shadow p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:`${E.color} text-white p-3 rounded-lg`},E.icon),e.createElement("div",{className:"ml-4"},e.createElement("p",{className:"text-sm font-medium text-gray-600"},E.title),e.createElement("p",{className:"text-2xl font-semibold text-gray-900"},E.value)))))),e.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Driver Status"),e.createElement("div",{className:"space-y-4"},e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Status"),e.createElement("span",{className:"bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium"},"Available")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Vehicle"),e.createElement("span",{className:"text-gray-900 font-medium"},"Pickup Truck - KCA123X")),e.createElement("div",{className:"flex items-center justify-between"},e.createElement("span",{className:"text-gray-600"},"Current Location"),e.createElement("span",{className:"text-gray-900 font-medium"},"Nairobi CBD")),e.createElement("button",{onClick:m,className:"w-full bg-primary-600 text-white py-2 px-4 rounded-lg hover:bg-primary-700 transition-colors"},"Update Location"))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Quick Actions"),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:g,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Accept New Delivery"),e.createElement("div",{className:"text-sm text-gray-600"},"Find deliveries near you")),e.createElement("button",{onClick:d,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"Report Issue"),e.createElement("div",{className:"text-sm text-gray-600"},"Report delivery problems")),e.createElement("button",{onClick:y,className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors"},e.createElement("div",{className:"font-medium text-gray-900"},"View Earnings"),e.createElement("div",{className:"text-sm text-gray-600"},"Check payment history")))),e.createElement("div",{className:"bg-white rounded-lg shadow p-6"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900 mb-4"},"Today's Summary"),e.createElement("div",{className:"space-y-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Completed"),e.createElement("span",{className:"font-semibold text-green-600"},"5 deliveries")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"In Progress"),e.createElement("span",{className:"font-semibold text-blue-600"},"1 delivery")),e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Pending"),e.createElement("span",{className:"font-semibold text-orange-600"},"2 deliveries")),e.createElement("div",{className:"border-t pt-3 mt-3"},e.createElement("div",{className:"flex justify-between"},e.createElement("span",{className:"text-gray-600"},"Total Earnings"),e.createElement("span",{className:"font-semibold text-gray-900"},"KES 2,400")))))),e.createElement("div",{className:"bg-white rounded-lg shadow"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-lg font-semibold text-gray-900"},"Today's Deliveries")),e.createElement("div",{className:"overflow-x-auto"},e.createElement("table",{className:"w-full"},e.createElement("thead",{className:"bg-gray-50"},e.createElement("tr",null,e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Order ID"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Customer"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Location"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Time"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Value"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),e.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),e.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},n?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"Loading deliveries...")):w.length===0?e.createElement("tr",null,e.createElement("td",{colSpan:6,className:"px-6 py-4 text-center text-gray-500"},"No deliveries assigned")):w.map(E=>e.createElement("tr",{key:E.id},e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},E.id),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.customer),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(Te,{className:"w-4 h-4 text-gray-400 mr-1"}),E.location)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},e.createElement("div",{className:"flex items-center"},e.createElement(de,{className:"w-4 h-4 text-gray-400 mr-1"}),E.time)),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.value),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},e.createElement("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${h(E.status)}`},x(E.status))),e.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900"},E.status==="pending"&&e.createElement("button",{onClick:()=>c(E.id),className:"text-primary-600 hover:text-primary-700 font-medium"},"Start Pickup"),E.status==="in_transit"&&e.createElement("button",{onClick:()=>f(E.id),className:"text-green-600 hover:text-green-700 font-medium"},"Mark Delivered"),E.status==="delivered"&&e.createElement("span",{className:"text-gray-400"},"Completed")))))))))}const xi={DRIVER_ASSIGNED:{color:"bg-yellow-100 text-yellow-800",icon:de,label:"Ready for Pickup",action:"Start Transport"},IN_TRANSIT:{color:"bg-blue-100 text-blue-800",icon:qa,label:"In Transit",action:"Mark as Delivered"},DELIVERED:{color:"bg-green-100 text-green-800",icon:fe,label:"Delivered",action:null}};function vi(){const{token:t}=X(),[a,r]=P.useState([]),[s,n]=P.useState(!0),[l,o]=P.useState(null);P.useEffect(()=>{c()},[]);const c=async()=>{try{const g=await V.get("/api/driver/assignments",{headers:{Authorization:`Bearer ${t}`}});r(g.data.assignments)}catch(g){console.error("Error fetching assignments:",g),A.error("Failed to fetch assignments")}finally{n(!1)}},f=async(g,d)=>{o(g);try{await V.patch(`/api/driver/assignments/${g}/status`,{status:d},{headers:{Authorization:`Bearer ${t}`}}),A.success("Assignment status updated successfully!"),c()}catch(y){console.error("Error updating assignment status:",y),A.error("Failed to update assignment status")}finally{o(null)}},m=g=>{g.status==="DRIVER_ASSIGNED"?f(g.id,"IN_TRANSIT"):g.status==="IN_TRANSIT"&&f(g.id,"DELIVERED")};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading assignments..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"My Assignments"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage your transport assignments and deliveries")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(me,{className:"w-4 h-4"}),e.createElement("span",null,"Driver Dashboard")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(de,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(g=>g.status==="DRIVER_ASSIGNED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Ready for Pickup")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(qa,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(g=>g.status==="IN_TRANSIT").length),e.createElement("p",{className:"text-gray-600 text-sm"},"In Transit")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(fe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(g=>g.status==="DELIVERED").length),e.createElement("p",{className:"text-gray-600 text-sm"},"Completed"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Active Assignments")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(me,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No assignments yet"),e.createElement("p",{className:"text-gray-600"},"You'll see your transport assignments here when they are assigned to you")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(g=>{const d=xi[g.status],y=d?.icon||B,b=g.finalPricePerUnit*g.quantity;return e.createElement("div",{key:g.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},g.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},g.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-3"},e.createElement("span",null,g.quantity," ",g.unit),e.createElement("span",null,""),e.createElement("span",null,g.category),e.createElement("span",null,""),e.createElement("span",null,"Value: KSh ",b.toLocaleString())),g.farmer&&e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-3"},e.createElement("h4",{className:"text-sm font-medium text-blue-900 mb-2"},"Farmer Contact"),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-blue-700"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ae,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.name)),e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Ye,{className:"w-4 h-4"}),e.createElement("a",{href:`tel:${g.farmer.phone}`,className:"hover:underline"},g.farmer.phone)),g.farmer.profile?.county&&e.createElement("div",{className:"flex items-center gap-1"},e.createElement(Te,{className:"w-4 h-4"}),e.createElement("span",null,g.farmer.profile.county)))),e.createElement("div",{className:"flex items-center gap-4 text-sm text-gray-500"},e.createElement("div",{className:"flex items-center gap-1"},e.createElement(st,{className:"w-4 h-4"}),e.createElement("span",null,"Expected:"," ",new Date(g.expectedDeliveryDate).toLocaleDateString())))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},e.createElement("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full text-sm font-medium ${d?.color||"bg-gray-100 text-gray-800"}`},e.createElement(y,{className:"w-4 h-4"}),d?.label||g.status),e.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-400"},e.createElement(st,{className:"w-3 h-3"}),"Assigned:"," ",new Date(g.createdAt).toLocaleDateString()),d?.action&&e.createElement("button",{onClick:()=>m(g),disabled:l===g.id,className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-colors ${g.status==="DRIVER_ASSIGNED"?"bg-blue-600 text-white hover:bg-blue-700":"bg-green-600 text-white hover:bg-green-700"} disabled:bg-gray-400 disabled:cursor-not-allowed`},l===g.id?e.createElement(e.Fragment,null,e.createElement("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Updating..."):e.createElement(e.Fragment,null,g.status==="DRIVER_ASSIGNED"?e.createElement(Rn,{className:"w-4 h-4"}):e.createElement(Fn,{className:"w-4 h-4"}),d.action)),g.status==="DELIVERED"&&e.createElement("div",{className:"text-xs text-green-600 font-medium"}," Ready for warehouse processing"))),g.status==="DRIVER_ASSIGNED"&&e.createElement("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(lt,{className:"w-4 h-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-yellow-700"},e.createElement("p",{className:"font-medium mb-1"},"Transport Instructions:"),e.createElement("ul",{className:"text-xs space-y-1"},e.createElement("li",null," Contact farmer to arrange pickup time"),e.createElement("li",null," Verify produce quality and quantity"),e.createElement("li",null," Handle with care during transport"),e.createElement("li",null," Deliver to Main Warehouse, Nairobi Industrial Area"))))),g.status==="IN_TRANSIT"&&e.createElement("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg"},e.createElement("div",{className:"flex items-start gap-2"},e.createElement(qa,{className:"w-4 h-4 text-blue-600 mt-0.5 flex-shrink-0"}),e.createElement("div",{className:"text-sm text-blue-700"},e.createElement("p",{className:"font-medium mb-1"},"En Route to Warehouse"),e.createElement("p",{className:"text-xs"},"Mark as delivered once you arrive at the warehouse and unload the produce.")))))})))))}function Ni(){const{token:t}=X(),[a,r]=P.useState([]),[s,n]=P.useState(!0),[l,o]=P.useState(!1),[c,f]=P.useState(null),[m,g]=P.useState({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]}),[d,y]=P.useState(""),[b,w]=P.useState(!1);P.useEffect(()=>{h()},[]);const h=async()=>{try{const R=await V.get("/api/warehouse/inventory",{headers:{Authorization:`Bearer ${t}`}});r(R.data.inventory)}catch(R){console.error("Error fetching inventory:",R),A.error("Failed to fetch warehouse inventory")}finally{n(!1)}},x=R=>{f(R),g({marketPrice:R.finalPricePerUnit.toString(),description:R.description,images:R.images,isFeatured:!1,tags:[]}),o(!0)},E=()=>{d.trim()&&!m.tags.includes(d.trim())&&(g({...m,tags:[...m.tags,d.trim()]}),y(""))},N=R=>{g({...m,tags:m.tags.filter(M=>M!==R)})},k=()=>{const R=prompt("Enter image URL:");R&&R.trim()&&g({...m,images:[...m.images,R.trim()]})},v=R=>{g({...m,images:m.images.filter((M,C)=>C!==R)})},F=async()=>{if(c){if(!m.marketPrice||Number(m.marketPrice)<=0){A.error("Please enter a valid market price");return}w(!0);try{await V.post("/api/warehouse/add-to-marketplace",{consignmentId:c.id,marketPrice:Number(m.marketPrice),description:m.description,images:m.images,isFeatured:m.isFeatured,tags:m.tags},{headers:{Authorization:`Bearer ${t}`}}),A.success("Product added to marketplace successfully!"),o(!1),h(),g({marketPrice:"",description:"",images:[],isFeatured:!1,tags:[]})}catch(R){console.error("Error adding to marketplace:",R),A.error("Failed to add product to marketplace")}finally{w(!1)}}};return s?e.createElement("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center"},e.createElement("div",{className:"text-center"},e.createElement("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary-600 mx-auto"}),e.createElement("p",{className:"mt-4 text-gray-600"},"Loading warehouse inventory..."))):e.createElement("div",{className:"min-h-screen bg-gray-50 py-8"},e.createElement("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8"},e.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},e.createElement("div",null,e.createElement("h1",{className:"text-3xl font-bold text-gray-900"},"Warehouse Management"),e.createElement("p",{className:"text-gray-600 mt-1"},"Manage delivered produce and add items to marketplace")),e.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600"},e.createElement(B,{className:"w-4 h-4"}),e.createElement("span",null,"Inventory Manager")))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8"},e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-blue-100 rounded-lg"},e.createElement(B,{className:"w-6 h-6 text-blue-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.length),e.createElement("p",{className:"text-gray-600 text-sm"},"Items in Warehouse")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-green-100 rounded-lg"},e.createElement(fe,{className:"w-6 h-6 text-green-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(R=>R.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Added to Marketplace")))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6"},e.createElement("div",{className:"flex items-center"},e.createElement("div",{className:"p-3 bg-yellow-100 rounded-lg"},e.createElement(Jt,{className:"w-6 h-6 text-yellow-600"})),e.createElement("div",{className:"ml-4"},e.createElement("h3",{className:"text-lg font-semibold text-gray-900"},a.filter(R=>!R.marketplaceProductId).length),e.createElement("p",{className:"text-gray-600 text-sm"},"Pending Upload"))))),e.createElement("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Warehouse Inventory")),a.length===0?e.createElement("div",{className:"p-12 text-center"},e.createElement(B,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"No inventory items"),e.createElement("p",{className:"text-gray-600"},"Delivered produce will appear here for marketplace processing")):e.createElement("div",{className:"divide-y divide-gray-200"},a.map(R=>e.createElement("div",{key:R.id,className:"p-6 hover:bg-gray-50"},e.createElement("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between gap-4"},e.createElement("div",{className:"flex-1"},e.createElement("div",{className:"flex items-start gap-4"},e.createElement("div",{className:"w-20 h-20 bg-gray-100 rounded-lg flex items-center justify-center flex-shrink-0"},R.images.length>0?e.createElement("img",{src:R.images[0],alt:R.title,className:"w-full h-full object-cover rounded-lg"}):e.createElement(B,{className:"w-8 h-8 text-gray-600"})),e.createElement("div",{className:"flex-1 min-w-0"},e.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-1"},R.title),e.createElement("p",{className:"text-gray-600 text-sm mb-3"},R.description),e.createElement("div",{className:"flex flex-wrap items-center gap-4 text-sm text-gray-500 mb-2"},e.createElement("span",null,R.quantity," ",R.unit),e.createElement("span",null,""),e.createElement("span",null,"KSh ",R.finalPricePerUnit," per ",R.unit),e.createElement("span",null,""),e.createElement("span",null,R.category)),e.createElement("div",{className:"text-sm"},e.createElement("span",{className:"text-gray-500"},"Total Value: "),e.createElement("span",{className:"font-semibold text-gray-900"},"KSh"," ",(R.finalPricePerUnit*R.quantity).toLocaleString()))))),e.createElement("div",{className:"flex flex-col lg:items-end gap-3"},R.marketplaceProductId?e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-medium"},e.createElement(fe,{className:"w-4 h-4"}),"On Marketplace"):e.createElement("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium"},e.createElement(Jt,{className:"w-4 h-4"}),"Ready to Upload"),R.marketplaceProductId?e.createElement("button",{className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center gap-2",disabled:!0},e.createElement(Ke,{className:"w-4 h-4"}),"View on Marketplace"):e.createElement("button",{onClick:()=>x(R),className:"bg-primary-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-primary-700 transition-colors flex items-center gap-2"},e.createElement(Dt,{className:"w-4 h-4"}),"Add to Marketplace"))))))),l&&c&&e.createElement("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},e.createElement("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto"},e.createElement("div",{className:"p-6 border-b border-gray-200"},e.createElement("h2",{className:"text-xl font-semibold text-gray-900"},"Add to Marketplace"),e.createElement("p",{className:"text-gray-600 text-sm mt-1"},c.title)),e.createElement("div",{className:"p-6 space-y-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Price (KSh per ",c.unit,") *"),e.createElement("input",{type:"number",value:m.marketPrice,onChange:R=>g({...m,marketPrice:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enter market price",min:"1",required:!0}),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Farmer price: KSh ",c.finalPricePerUnit," per"," ",c.unit)),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Market Description"),e.createElement("textarea",{value:m.description,onChange:R=>g({...m,description:R.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Enhance the product description for customers"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Images"),e.createElement("div",{className:"space-y-3"},m.images.length>0&&e.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3"},m.images.map((R,M)=>e.createElement("div",{key:M,className:"relative"},e.createElement("img",{src:R,alt:`Product ${M+1}`,className:"w-full h-24 object-cover rounded-lg border border-gray-200"}),e.createElement("button",{onClick:()=>v(M),className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600"},"")))),e.createElement("button",{onClick:k,className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-gray-400 transition-colors"},e.createElement(rs,{className:"w-6 h-6 text-gray-400 mx-auto mb-2"}),e.createElement("span",{className:"text-sm text-gray-600"},"Add Image URL")))),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Product Tags"),e.createElement("div",{className:"space-y-3"},m.tags.length>0&&e.createElement("div",{className:"flex flex-wrap gap-2"},m.tags.map((R,M)=>e.createElement("span",{key:M,className:"inline-flex items-center gap-1 bg-primary-100 text-primary-800 px-2 py-1 rounded text-sm"},R,e.createElement("button",{onClick:()=>N(R),className:"text-primary-600 hover:text-primary-800"},"")))),e.createElement("div",{className:"flex gap-2"},e.createElement("input",{type:"text",value:d,onChange:R=>y(R.target.value),onKeyPress:R=>R.key==="Enter"&&E(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Add a tag (e.g., organic, fresh)"}),e.createElement("button",{onClick:E,className:"bg-gray-100 text-gray-700 px-3 py-2 rounded-lg hover:bg-gray-200 transition-colors"},e.createElement(ss,{className:"w-4 h-4"}))))),e.createElement("div",null,e.createElement("label",{className:"flex items-center gap-2"},e.createElement("input",{type:"checkbox",checked:m.isFeatured,onChange:R=>g({...m,isFeatured:R.target.checked}),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.createElement("span",{className:"text-sm font-medium text-gray-700"},"Mark as Featured Product")),e.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Featured products appear prominently on the marketplace")),e.createElement("div",{className:"flex gap-4 pt-4"},e.createElement("button",{type:"button",onClick:()=>o(!1),className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:b},"Cancel"),e.createElement("button",{onClick:F,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:b},b?"Adding...":"Add to Marketplace")))))))}function wi({title:t="Coming Soon",description:a="This feature is currently under development and will be available soon.",features:r=[]}){const s=_e();return e.createElement("div",{className:"min-h-screen bg-gradient-to-br from-primary-50 to-primary-100 flex items-center justify-center py-12 px-4"},e.createElement("div",{className:"max-w-md w-full"},e.createElement("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center"},e.createElement("div",{className:"w-20 h-20 bg-primary-100 rounded-full flex items-center justify-center mx-auto mb-6"},e.createElement(On,{className:"w-10 h-10 text-primary-600"})),e.createElement("h1",{className:"text-2xl font-bold text-gray-900 mb-4"},t),e.createElement("p",{className:"text-gray-600 mb-6"},a),r.length>0&&e.createElement("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left"},e.createElement("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center"},e.createElement(At,{className:"w-4 h-4 text-yellow-500 mr-2"}),"Coming Features:"),e.createElement("ul",{className:"space-y-2"},r.map((n,l)=>e.createElement("li",{key:l,className:"text-sm text-gray-600 flex items-center"},e.createElement("div",{className:"w-1.5 h-1.5 bg-primary-600 rounded-full mr-2"}),n)))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6"},e.createElement("div",{className:"flex items-center justify-center text-blue-700"},e.createElement(de,{className:"w-4 h-4 mr-2"}),e.createElement("span",{className:"text-sm font-medium"},"Expected Launch: Coming Soon"))),e.createElement("div",{className:"space-y-3"},e.createElement("button",{onClick:()=>s(-1),className:"w-full bg-primary-600 text-white py-3 px-4 rounded-lg hover:bg-primary-700 transition-colors flex items-center justify-center"},e.createElement(St,{className:"w-4 h-4 mr-2"}),"Go Back"),e.createElement(H,{to:"/",className:"block w-full bg-gray-100 text-gray-700 py-3 px-4 rounded-lg hover:bg-gray-200 transition-colors"},"Return to Homepage")),e.createElement("div",{className:"mt-6 pt-6 border-t border-gray-200"},e.createElement("p",{className:"text-xs text-gray-500"},"We're working hard to bring you the best experience.",e.createElement("br",null),"Thank you for your patience!")))))}function Si(){const[t,a]=P.useState("0712345678"),[r,s]=P.useState(100),[n,l]=P.useState(!1),o=()=>localStorage.getItem("token"),c=async()=>{l(!0);try{const d=o();if(!d){A.error("Please login first");return}const y=await V.post("/api/payments/registration-fee",{phoneNumber:t},{headers:{Authorization:`Bearer ${d}`}});A.success("Registration fee payment initiated!"),console.log("Registration fee response:",y.data)}catch(d){A.error(d.response?.data?.error||"Payment failed"),console.error("Registration fee error:",d)}finally{l(!1)}},f=async()=>{l(!0);try{const d=o();if(!d){A.error("Please login first");return}const y=await V.post("/api/wallet/withdraw",{amount:r,phoneNumber:t},{headers:{Authorization:`Bearer ${d}`}});A.success("Wallet withdrawal initiated!"),console.log("Withdrawal response:",y.data)}catch(d){A.error(d.response?.data?.error||"Withdrawal failed"),console.error("Withdrawal error:",d)}finally{l(!1)}},m=async()=>{l(!0);try{const d=ca(t);if(!Ya(d)){A.error("Please enter a valid Kenyan phone number");return}const y=await V.post("/api/payments/stk-push",{phone:d,amount:r,orderId:"test-order-"+Date.now(),accountReference:"Test Payment",transactionDesc:"Test STK Push"});y.data.success?(A.success("M-Pesa payment request sent!"),console.log("STK Push response:",y.data)):A.error("Failed to initiate payment")}catch(d){A.error(d.response?.data?.error||"STK Push failed"),console.error("STK Push error:",d)}finally{l(!1)}},g=()=>{const d=ca(t),y=Ya(t);A(`Phone: ${t}  ${d} (Valid: ${y})`,{icon:""}),console.log("Phone validation:",{original:t,formatted:d,isValid:y})};return e.createElement("div",{className:"max-w-4xl mx-auto p-6"},e.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-8"},"M-Pesa Integration Test"),e.createElement("div",{className:"bg-white rounded-lg shadow p-6 mb-6"},e.createElement("h2",{className:"text-xl font-semibold mb-4"},"Test Configuration"),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6"},e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Phone Number"),e.createElement("input",{type:"tel",value:t,onChange:d=>a(d.target.value),placeholder:"0712345678",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})),e.createElement("div",null,e.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-2"},"Amount (KES)"),e.createElement("input",{type:"number",value:r,onChange:d=>s(Number(d.target.value)),min:"1",max:"150000",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}))),e.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},e.createElement("button",{onClick:g,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors"},"Validate Phone"),e.createElement("button",{onClick:c,disabled:n,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50"},"Test Registration Fee"),e.createElement("button",{onClick:f,disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50"},"Test Withdrawal"),e.createElement("button",{onClick:m,disabled:n,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50"},"Test STK Push"))),e.createElement("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6"},e.createElement("h3",{className:"text-lg font-semibold text-yellow-800 mb-2"},"Demo Configuration"),e.createElement("div",{className:"text-sm text-yellow-700 space-y-1"},e.createElement("p",null,e.createElement("strong",null,"Environment:")," Sandbox"),e.createElement("p",null,e.createElement("strong",null,"Business Short Code:")," 174379"),e.createElement("p",null,e.createElement("strong",null,"Test Phone:")," 0712345678 (or any valid Kenyan number)"),e.createElement("p",null,e.createElement("strong",null,"Demo Credentials:")," Configured for development"))),e.createElement("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4"},e.createElement("h3",{className:"text-lg font-semibold text-blue-800 mb-2"},"How to Test"),e.createElement("div",{className:"text-sm text-blue-700 space-y-2"},e.createElement("p",null,"1. ",e.createElement("strong",null,"Login:")," Use demo credentials to login as farmer/customer"),e.createElement("p",null,"2. ",e.createElement("strong",null,"Registration Fee:")," Test farmer activation payment (KES 300)"),e.createElement("p",null,"3. ",e.createElement("strong",null,"Wallet Withdrawal:")," Test farmer wallet withdrawal"),e.createElement("p",null,"4. ",e.createElement("strong",null,"STK Push:")," Test direct M-Pesa payment request"),e.createElement("p",null,"5. ",e.createElement("strong",null,"Checkout:")," Go to marketplace, add items, and checkout with M-Pesa"))))}const pe=({children:t,allowedRoles:a})=>{const{user:r,isAuthenticated:s}=X();return s?a&&r&&!a.includes(r.role)?e.createElement(Ue,{to:"/",replace:!0}):e.createElement(e.Fragment,null,t):e.createElement(Ue,{to:"/login",replace:!0})},ki=()=>{const{user:t}=X();if(!t)return e.createElement(Ue,{to:"/login",replace:!0});switch(t.role){case"FARMER":return e.createElement(Ue,{to:"/farmer/dashboard",replace:!0});case"CUSTOMER":return e.createElement(Ue,{to:"/customer/profile",replace:!0});case"ADMIN":return e.createElement(Ue,{to:"/admin/dashboard",replace:!0});case"DRIVER":return e.createElement(Ue,{to:"/driver/dashboard",replace:!0});default:return e.createElement(Ue,{to:"/",replace:!0})}};function Ci(){const{isAuthenticated:t,user:a}=X();return P.useEffect(()=>{yc()},[]),e.createElement(pc,null,e.createElement(on,null,e.createElement("div",{className:"min-h-screen bg-gray-50"},e.createElement(bc,null),e.createElement("main",{className:"pb-16 lg:pb-0"},e.createElement(cn,null,e.createElement(Y,{path:"/",element:e.createElement(wc,null)}),e.createElement(Y,{path:"/marketplace",element:e.createElement(Sc,null)}),e.createElement(Y,{path:"/marketplace/product/:id",element:e.createElement(kc,null)}),e.createElement(Y,{path:"/login",element:e.createElement(Cc,null)}),e.createElement(Y,{path:"/register",element:e.createElement(Yc,null)}),e.createElement(Y,{path:"/dashboard",element:e.createElement(ki,null)}),e.createElement(Y,{path:"/farmer/dashboard",element:e.createElement(pe,{allowedRoles:["FARMER"]},e.createElement(Xc,null))}),e.createElement(Y,{path:"/customer/dashboard",element:e.createElement(pe,{allowedRoles:["CUSTOMER"]},e.createElement(ti,null))}),e.createElement(Y,{path:"/customer/profile",element:e.createElement(pe,{allowedRoles:["CUSTOMER"]},e.createElement(ai,null))}),e.createElement(Y,{path:"/customer/orders",element:e.createElement(pe,{allowedRoles:["CUSTOMER"]},e.createElement(ri,null))}),e.createElement(Y,{path:"/cart",element:e.createElement(si,null)}),e.createElement(Y,{path:"/checkout",element:e.createElement(oi,null)}),e.createElement(Y,{path:"/admin/dashboard",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(ci,null))}),e.createElement(Y,{path:"/admin/users",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(di,null))}),e.createElement(Y,{path:"/admin/consignments",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(gi,null))}),e.createElement(Y,{path:"/admin/analytics",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(fi,null))}),e.createElement(Y,{path:"/admin/settings",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(pi,null))}),e.createElement(Y,{path:"/admin/marketplace",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(yi,null))}),e.createElement(Y,{path:"/admin/registration-fees",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(hi,null))}),e.createElement(Y,{path:"/admin/mpesa-settings",element:e.createElement(pe,{allowedRoles:["ADMIN"]},e.createElement(bi,null))}),e.createElement(Y,{path:"/driver/dashboard",element:e.createElement(pe,{allowedRoles:["DRIVER"]},e.createElement(Ei,null))}),e.createElement(Y,{path:"/driver/assignments",element:e.createElement(pe,{allowedRoles:["DRIVER"]},e.createElement(vi,null))}),e.createElement(Y,{path:"/driver/warehouse",element:e.createElement(pe,{allowedRoles:["DRIVER"]},e.createElement(Ni,null))}),e.createElement(Y,{path:"/farmer/consignments",element:e.createElement(Ue,{to:"/farmer/dashboard",replace:!0})}),e.createElement(Y,{path:"/farmer/wallet",element:e.createElement(Ue,{to:"/farmer/dashboard",replace:!0})}),e.createElement(Y,{path:"/test-mpesa",element:e.createElement(Si,null)}),e.createElement(Y,{path:"*",element:e.createElement(wi,null)}))),t&&a&&e.createElement(Ec,null),e.createElement(xc,null),e.createElement(Tn,{position:"top-right"}))))}window.addEventListener("error",t=>{t.error&&t.error.message&&t.error.message.includes("filter is not a function")&&(console.error(" ARRAY OPERATION ERROR DETECTED:",t.error.message),console.error("This error has been caught and handled gracefully."),t.preventDefault())});window.addEventListener("unhandledrejection",t=>{t.reason&&typeof t.reason=="string"&&t.reason.includes("filter")&&(console.error(" PROMISE REJECTION WITH ARRAY ERROR:",t.reason),t.preventDefault())});const Pi=new Xn({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:2,staleTime:10*60*1e3,cacheTime:15*60*1e3},mutations:{retry:1}}}),Xs=document.getElementById("root");if(!Xs)throw new Error("Root element not found");const Ai=$a.createRoot(Xs);Ai.render(e.createElement(sl,{client:Pi},e.createElement(Ci)));
